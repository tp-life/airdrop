!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var r=0;function a(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var o="__private_"+r+++"_"+"send",i=class{constructor({name:e}){Object.defineProperty(this,o,{writable:!0,value:async(e,t,n)=>{const{tabId:r,senderMetadata:a}=t||{},o={async:n,tabId:r,data:e,channel:this.name,senderMetadata:a};return"number"==typeof r?chrome.tabs.sendMessage(r,o):chrome.runtime.sendMessage(o)}}),this.sendMessage=(async(e,t)=>{await a(this,o)[o](e,t,!1)}),this.call=(async(e,t)=>{const n=await a(this,o)[o](e,t,!0);if(!n||!n.success)throw new Error(`Failed to call with: ${JSON.stringify(e)}`);return n.data}),this.onMessage=(e=>{chrome.runtime.onMessage.addListener((t,n,r)=>{if(t.async||t.channel!==this.name)return!1;try{n.metadata=t.senderMetadata,e(t.data,n)}catch(e){console.error(e)}return r({success:!0}),!0})}),this.onCall=(e=>{chrome.runtime.onMessage.addListener((t,n,r)=>{const a=e=>{r({success:!0,data:e})};return!(!t.async||this.name!==t.channel||((async()=>{try{n.metadata=t.senderMetadata,await e(t.data,n,a)}catch(e){r({success:!1})}})(),0))})}),this.name=e}};const s=Object.create(null);var c=new Proxy(s,{get:(e,t)=>(e[t]=e[t]||new i({name:t}),e[t])}),d=0;function u(e){return"__private_"+d+++"_"+e}function l(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}class h{constructor({name:e,target:t,transport:n}){this.name=void 0,this.target=void 0,Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:e=>e.target===this.name&&e.data}),this.write=(e=>{l(this,m)[m].write({target:this.target,data:e})}),this.on=((e,t)=>{l(this,m)[m].on(e,e=>{l(this,w)[w](e)&&t(e.data)})}),this.name=e,this.target=t,l(this,m)[m]=n}removeListener(e,t){l(this,m)[m].removeListener(e,t)}}var m=u("transport"),w=u("isValidEvent"),g=0;class p{constructor(){Object.defineProperty(this,f,{writable:!0,value:e=>{return"object"==typeof(null==e?void 0:e.data)&&e.origin===window.location.origin}}),this.write=(e=>{var t;const n=window;if(null!=(t=n.ReactNativeWebView)&&t.postMessage)n.ReactNativeWebView.postMessage(JSON.stringify(e));else{if(!window.postMessage)throw new Error("unable to write data because no postMessage is available");{const t=window.location.origin;window.postMessage(e,t)}}}),this.on=((e,t)=>{window.addEventListener("message",e=>{(function(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e})(this,f)[f](e)&&t(e.data)})})}removeListener(e,t){}}var f=function(e){return"__private_"+g+++"_"+e}("isValidEvent");const y=e=>btoa([...e].map(e=>String.fromCharCode(e)).join("")),v=e=>{try{const t=e.sizes.value.match(/\d+/gm);return parseInt(t[0],10)}catch(e){return 0}},b=e=>{const t=new Image;return t.crossOrigin="anonymous",t.src=e,new Promise(e=>{t.onload=(()=>{const n=document.createElement("canvas"),r=n.getContext("2d"),a=((e,t)=>{const n=e.width/e.height;let r,a,o,i,s,c;return n>1?(o=r=Math.min(e.width,t),a=r,i=Math.round(r/n),s=0,c=Math.floor((o-i)/2)):(i=a=Math.min(e.height,t),r=a,o=Math.round(a*n),c=0,s=Math.floor((i-o)/2)),{width:r,height:a,dWidth:o,dHeight:i,dx:s,dy:c}})(t,120),o=a.width,i=a.height;n.width=o,n.height=i,r.drawImage(t,a.dx,a.dy,a.dWidth,a.dHeight);const{data:s}=r.getImageData(0,0,o,i);e({width:o,height:i,data:y(s)})}),t.onerror=(()=>e(null))})},M=new Promise(e=>{window.addEventListener("load",async()=>{const t=(()=>{const e=document.querySelector('head > meta[property="og:site_name"]');if(e)return e.content;const t=document.querySelector('head > meta[name="title"]');return t?t.content:document.title})(),n=await(async()=>{var e;const t=document.querySelectorAll('head > link[rel~="icon"]'),n=(null==(e=Array.from(t).sort((e,t)=>v(t)-v(e))[0])?void 0:e.href)||`${document.location.origin}/favicon.ico`;return b(n)})();e({title:t,icon:n})})}),O=({extensionName:e,channelName:t})=>{if("string"!=typeof e||"string"!=typeof t)throw new Error("Unable to create RPC because channelName or extensionName are missing");const n=c[t],r=function({name:e,target:t}){const n=new p;return new h({name:e,target:t,transport:n})}({name:`${e}-${t}`,target:`${e}-${t}-window`});r.on("data",async e=>{const t=!JSON.parse(e).method,a={senderMetadata:await M};t?n.sendMessage(e,a):n.call(e,a).then(r.write)}),n.onMessage((e,t)=>{t.tab||r.write(e)})},j="provider-config",_={prioritizeMagicEden:!1},E=new Set(Object.keys(_)),P=chrome.storage.local;var x={get:async function(e){if(!E.has(e))throw new Error("Unknown key!");const t=`!${j}!${e}`,n=await P.get(t),r=Object.hasOwn(_,e)?_[e]:void 0;return Object.hasOwn(n,t)?n[t]:r}};(async()=>{const e=await x.get("prioritizeMagicEden"),t=chrome.runtime.getURL("inapp.js"),n={"data-extension-id":chrome.runtime.id,"data-prioritize-magic-eden":e||!1};await(({id:e,src:t,attributes:n={}})=>new Promise(r=>{const a=document.head||document.documentElement,o=document.createElement("script");o.id=e,o.src=t,Object.keys(n).map(e=>{o.setAttribute(e,n[e])}),o.addEventListener("load",()=>{r(),a.contains(o)&&o.remove()}),a.insertBefore(o,a.children[0])}))({id:"magic-eden-extension",src:t,attributes:n})})(),O({extensionName:"magic-eden",channelName:"provider"}),O({extensionName:"magic-eden",channelName:"content"})}]);