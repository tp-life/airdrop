import{c as I}from"./chunk-ZTXKK5SN.js";import{V as L,Ya as w,Yc as U}from"./chunk-D7Z6MPRS.js";import{j as y}from"./chunk-27TD4NX4.js";import{n as _}from"./chunk-TKSJVOQZ.js";import{a as C,z as F}from"./chunk-UA6ADLWZ.js";import{f as P,h as i,n as a}from"./chunk-3KENBVE7.js";i();a();i();a();var s=P(C());i();a();var O=t=>t.reduce((o,n)=>{let e=o;for(let c of n.accounts){let r=c.chain.name.toLowerCase();if(o[r]?.balance&&o[r]?.history)continue;let l="amount"in c?parseFloat(c.amount)>0:!1,u=c.hasAccountActivity;if(!o[r]){e={...e,[r]:{balance:l,history:u}};continue}e={...e,[r]:{...e[r],balance:l||e[r]?.balance,history:u||e[r]?.history}}}return e},{});i();a();var v=P(C()),R=t=>{let o=U(),n=(0,v.useCallback)(e=>o.includes(w.getChainID(e.chain.id)),[o]);return(0,v.useMemo)(()=>t?t.map(e=>e.status==="undiscovered"?{...e,accounts:e.accounts.filter(c=>n(c))}:{...e,accounts:e.accounts.filter(c=>n(c)&&c.hasAccountActivity)}):[],[n,t])};i();a();var S=P(C()),T=t=>{let[o,n]=(0,S.useState)(null);return(0,S.useEffect)(()=>{if(t.length){let e=new L(t);return n(e),()=>{n(null),e.cleanup()}}},[t]),o};var $=t=>(0,s.useMemo)(()=>t.reduce((o,n,e)=>(o[e]=e===0||n.isSelectedByDefault,o),{}),[t]),ee=(t,o)=>(0,s.useMemo)(()=>t?.reduce((n,e,c)=>o[c]?[...n,e]:n,[])??[],[t,o]),te=(t,o)=>{(0,s.useEffect)(()=>{o(n=>{let{length:e}=Object.keys(t),c={};for(let r=0;r<e;r++)c[r]=n[r]===void 0?t[r]:n[r];return c})},[t,o])},oe=3e3,ne=(t,o)=>{let{t:n}=y();return(0,s.useEffect)(()=>{let e;if(t){let{pages:c}=t,r=c.length>1,l=c[c.length-1].length===0;r&&l&&(o(n("onboardingSelectAccountsFindMoreNoneFound")),e=setTimeout(()=>{o(n("onboardingSelectAccountsFindMoreAccounts"))},oe))}return()=>{e&&clearTimeout(e)}},[t])},ce=({activeAccountsNumber:t,allAccountsNumber:o,hasDiscoveryFailed:n})=>{let{t:e}=y(),c=t>0&&!n;return(0,s.useMemo)(()=>o===0?e("onboardingImportImportingFindingAccounts"):t===0?e("onboardingImportAccountsEmptyResult"):o===1?c?e("onboardingImportAccountsFoundAccounts_one",{numberOfWallets:t}):e("onboardingImportAccountsFoundAccountsNoActivity_one",{numberOfWallets:o}):o>1?c?e("onboardingImportAccountsFoundAccounts_other",{numberOfWallets:t}):e("onboardingImportAccountsFoundAccountsNoActivity_other",{numberOfWallets:o}):"",[t,o,c,e])},H={extension:7,ios:7,android:7,web:7},re=({seed:t,navigationCallback:o,storageCallback:n,enabledAddressTypes:e,enabledChains:c})=>{let{t:r}=y(),l=r("onboardingSelectAccountsFindMoreAccounts"),[u,A]=(0,s.useState)({}),[b,M]=(0,s.useState)(!1),[W,B]=(0,s.useState)(!1),[k,K]=(0,s.useState)(l),N=T(t),{data:D,status:p,fetchNextPage:Q,isFetchingNextPage:V}=I({batchSize:H[F],hdWallet:N,enabledAddressTypes:e,enabledChains:c}),g=(0,s.useMemo)(()=>D?.pages.flat()??[],[D]),x=R(g),j=$(x),m=ee(g,u),Y=ce({activeAccountsNumber:x.length,allAccountsNumber:g.length,hasDiscoveryFailed:g[0]?.status==="undiscovered"});ne(D,K),te(j,A);let q=(0,s.useCallback)(()=>B(!0),[]),G=(0,s.useCallback)(h=>{if(p!=="success")return;let d={...u};d[h]=!d[h],A(d)},[p,u,A]),Z=(0,s.useCallback)(()=>{p==="success"&&A(h=>{let d={...h},X=Object.values(d).every(Boolean);return Object.keys(d).forEach((ae,J)=>{d[J]=!X}),d})},[p,A]),z=(0,s.useCallback)(async()=>{b||(M(!0),await _(0),await n(m,O(m)),M(!1),o(O(m)))},[b,m,o,n]),E={expanded:W,findMoreAccountsButtonText:k,isFetchingMoreAccounts:V,isImporting:b,renderedPages:x,selectedAccounts:u,subtitle:Y,findMoreAccounts:Q,onExpand:q,onImport:z,onSelect:G,onSelectAll:Z};return p!=="success"?{status:"loading",isImportButtonDisabled:!0,...E}:{status:"success",isImportButtonDisabled:m.length===0,...E}};i();a();export{H as a,re as b};
//# sourceMappingURL=chunk-SYHI4WMU.js.map
