import{r as Hs}from"./chunk-US2EC2AF.js";import{Ab as ks,Ba as sr,Bd as Ks,Ca as To,Cb as Ps,Da as It,Ea as Ss,Ed as Qs,Fa as ws,Fb as Os,H as Cs,I as rr,Jc as _s,Kc as Fs,Lc as $s,Ma as xs,Mb as Us,Nb as Ms,Oc as zs,Pb as Bs,Sa as ar,Ua as lr,Va as cr,Vb as dr,Wb as yi,_b as kt,bb as Ts,bc as tt,cc as gi,dc as vo,fa as Yt,fd as qs,ga as X,gc as Ci,gd as Gs,ha as ir,hc as Ds,ia as xo,ib as Jc,ic as Eo,ja as E,jb as vs,ka as bi,kb as Es,la as Xt,lc as Si,ma as Jt,mc as pr,n as wo,na as I,nc as Rs,oa as V,oc as Ls,od as Ws,pa as ht,pc as Ns,qa as W,r as fs,ra as w,sa as pe,t as hs,ta as Zt,tc as Vs,u as bs,ua as k,va as nr,w as or,wa as ce,x as ys,xa as et,xb as ur,ya as z,yb as As,yc as js,z as gs,za as F,zb as Is}from"./chunk-EIQDOUTB.js";import{a as ds,c as ps,j as ms}from"./chunk-O3RSUGZX.js";import{H as Wn,K as Ie,Ka as os,L as B,Ma as Yo,Tc as Qt,Va as Xo,Vd as er,Wa as rs,Ya as L,Za as is,Zd as tr,_a as Kt,hb as ns,nb as ss,sb as Jo,tb as as,vd as us,wb as ls,wd as Zo,xb as cs,y as mi,yc as ae}from"./chunk-D7Z6MPRS.js";import{n as Gt}from"./chunk-NZAWO25Q.js";import{g as Q,j as mt,k as ft}from"./chunk-E2H5RB2U.js";import{d as xe,j as Z}from"./chunk-27TD4NX4.js";import{w as re}from"./chunk-YJV3X2ON.js";import{D as q,u as se,w as Be,z as oe}from"./chunk-FBDT5S2M.js";import{T as es,X as fi,a as So,aa as Ko,b as de,c as Kn,ca as hi,e as Qn,ea as Qo,ha as ts,j as Yn,k as Xn,n as Jn,o as Wt,q as Wo,r as Zn,w as Y}from"./chunk-TKSJVOQZ.js";import{a as P,h as b,j as Go}from"./chunk-UA6ADLWZ.js";import{f as v,h as s,l as Xc,m as Buffer,n as a}from"./chunk-3KENBVE7.js";s();a();var Te=t=>{if(t!=null&&!(t.constructor===Object&&Object.keys(t).length===0))return t},Zc=t=>t??[],ke=class extends Error{constructor(e){super(e),this.name="CollectiblesError"}},j=b.string().nullish().transform(Te),Pt=b.number().nullish().transform(Te),wi=b.union([j,Pt]).transform(t=>typeof t=="number"?t.toString():t),eu=b.object({name:j,symbol:j,decimals:Pt,address:j}),xi=(y=>(y[y.Uninitialized=0]="Uninitialized",y[y.EditionV1=1]="EditionV1",y[y.MasterEditionV1=2]="MasterEditionV1",y[y.ReservationListV1=3]="ReservationListV1",y[y.MetadataV1=4]="MetadataV1",y[y.ReservationListV2=5]="ReservationListV2",y[y.MasterEditionV2=6]="MasterEditionV2",y[y.EditionMarker=7]="EditionMarker",y[y.UseAuthorityRecord=8]="UseAuthorityRecord",y[y.CollectionAuthorityRecord=9]="CollectionAuthorityRecord",y[y.TokenOwnedEscrow=10]="TokenOwnedEscrow",y[y.TokenRecord=11]="TokenRecord",y[y.MetadataDelegate=12]="MetadataDelegate",y))(xi||{}),mr=b.nativeEnum(xi),Ys=b.object({price:b.number(),token:eu.nullish().transform(Te)}),tu=Ys.nullish().transform(Te),ou=b.object({name:j,url:j,isVerified:b.coerce.boolean()}),Xs=b.object({id:b.string(),isValidCollectionId:b.coerce.boolean(),name:j,description:j,externalUrl:j,imageUrl:j,isSpam:b.coerce.boolean(),spamStatus:b.nativeEnum(kt).optional().default("NOT_VERIFIED"),floorPrice:Ys.nullish().transform(Te),ownerCount:Pt,totalCount:Pt,tokenCount:Pt,marketplaces:b.array(ou)}),ru=b.object({small:j,medium:j,large:j,blurhash:j}),iu=ru.nullish().transform(Te),nu=b.enum(["image","video","audio","model","other"]),su=b.object({url:j}),Ao=su.nullish().transform(Te),au=b.object({type:nu,image:Ao,video:Ao,audio:Ao,model:Ao,other:Ao,previews:iu}),lu=au.nullish().transform(Te),cu=b.object({trait_type:j,value:j.or(Pt),display_type:j}),uu=b.object({id:b.string(),contract:b.string(),standard:b.nativeEnum(yi)}),Js=b.object({compressed:b.boolean(),merkleTree:b.string(),leafIndex:b.number()}),du=b.object({mint:b.string(),tokenAccount:b.string(),standard:b.nativeEnum(dr),compression:Js.nullish().transform(Te),programId:b.string(),mintExtensions:Yn(Bs).optional()}),pu=b.object({id:b.string(),url:b.string(),displayName:b.string(),description:b.string(),count:b.number()}),mu=b.object({hash:b.string(),index:b.number(),distinctRareSats:b.number(),satributes:b.array(pu),blockNumber:b.number(),value:b.number(),backgroundImageUrl:b.string()}),fu=b.object({firstCreatedTransactionHash:b.string(),firstCreatedInscriptionId:b.string(),inscriptionId:j,inscriptionNumber:wi,outputValue:wi,satNumber:wi,satName:j,satRarity:j,protocolName:j,utxoHash:j,utxoIndex:Pt,createdAt:b.string().nullish().transform(Te),utxoDetails:mu.nullish().transform(Te)}),hu=b.object({objectId:b.string().optional(),kioskId:b.string().optional()}),bu=b.object({listingPrice:b.string(),listingPriceUiAmount:b.string(),isNative:b.boolean(),url:b.string()}),yu=b.union([du,uu,fu,hu]),Ti=b.object({id:is,chain:ss,name:j,symbol:j,description:j,externalUrl:j,collection:Xs,media:lu,uri:j,attributes:b.array(cu).nullish().transform(Zc),lastSalePrice:tu,balance:j,decimals:j,owner:j,chainData:yu.optional(),listings:b.record(bu).nullish().transform(Te)}),gu=Xs.extend({items:b.array(Ti)}),nh=b.object({items:b.array(gu),isTrimmed:b.boolean()});var sh=b.object({compression:Js.nullish().transform(Te).refine(t=>t?.compressed),mint:b.string()}),ah=b.object({root:b.string(),proof:b.array(b.string()),merkleTree:b.string(),dataHash:b.string(),creatorHash:b.string(),leafIndex:b.number(),owner:b.string(),delegate:b.string().optional()});s();a();function K(t){return t?.tokenAccount!==void 0}function De(t){return t?.contract!==void 0}function Qe(t){return t!==void 0&&"firstCreatedTransactionHash"in t}function Zs(t){return t!==void 0&&"objectId"in t}function ea(t){return t!==void 0&&"outputValue"in t&&"utxoHash"in t&&"utxoIndex"in t}function eo(t){return t!==void 0&&"utxoDetails"in t}s();a();s();a();var vi=v(Xc());s();a();var ta=new B.PublicKey("NTYeYJ1wr4bpM5xo6zx5En44SvJFAd35zTxxNoERYqd"),hh=new B.PublicKey("M2mx93ekt1fmXSVkTrUL9xVFHkmME8HTUi5Cyc5aF7K"),bh="https://magiceden.io/terms-of-service.pdf";var to=t=>{for(let e of t.instructions)for(let o of e.keys)if(o.isSigner&&o.pubkey.toBase58()===ta.toBase58())return!0;return!1},Ye=t=>{switch(t){case"mainnet-beta":return 101;case"testnet":return 102;case"devnet":return 103;case"localhost":return 101}},fr=t=>new de(t).multipliedBy(B.LAMPORTS_PER_SOL).toNumber();function hr(t){let e=[2,6],o=mr.safeParse(t);return o.success&&e.includes(o.data)}var Ei=vi.Buffer.from("metadata"),Cu=vi.Buffer.from("edition"),Ai=wo.toBuffer();function Eh(t){let[e]=B.PublicKey.findProgramAddressSync([Ei,Ai,t],wo);return e}function oa(t){let[e]=B.PublicKey.findProgramAddressSync([Ei,Ai,t,Cu],wo);return e}function Ah(t){let[e]=B.PublicKey.findProgramAddressSync([Ei,Ai,t],wo);return e}s();a();s();a();var Pe=(t,e,o,r)=>{(!e||e>=400&&e<500)&&(q.addBreadcrumb(o,t.message,"info",r),q.captureError(t,"collectibles"))};s();a();var br=t=>{let e=!1;return{collectibles:t.reduce((r,i)=>{let n=Ti.safeParse(i);return n.success?r.push(n.data):e=!0,r},[]),containsParseFailure:e}};var Su="collectibles",wu=new Error("Failed to fetch collectibles for addresses");async function yr(t){let e="/collectibles/v1";try{let r=(await Q.api().post(e,{addresses:t})).data,i=!!r.isTrimmed;if(!r.collectibles)throw wu;let{collectibles:n,containsParseFailure:l}=br(r.collectibles);return l&&q.captureError(new Error("collectibles failed to parse some items"),"collectibles"),{allCollectibles:n,isTrimmed:i}}catch(o){if(ft(o)){let r=o.response?.status;Pe(o,r,Su)}throw o}}s();a();var ra=new Error("Failed to fetch spl collectible marketplace stats"),Ii=async(t,e,o)=>{let r=`/solana/nft/v1/mint/${t}/stats`,i=new URLSearchParams;i.set("chainId",e.toString()),o&&i.set("pubkey",o);let n;try{n=await Q.api().headers({Accept:"application/json"}).get(`${r}?${i.toString()}`)}catch{throw ra}if(!mt(n))throw ra;return n.data.stats};s();a();var xu="spl-listings",Tu=new Error("Failed to fetch SPL listings"),gr=async t=>{let e;try{let o=t.chainId.replace("solana:",""),r=t.address,i=new URLSearchParams;i.append("chainId",o);let n=await Q.api().headers({Accept:"application/json"}).get(`/solana/nft/v1/pubkey/${r}/listings?${i.toString()}`);if(e=n.status,!mt(n))throw Tu;return n.data.filter(d=>!!d.listings?.magic_eden)}catch(o){let r=o instanceof Error?o:new Error("Non-Error was thrown during fetching of spl listings");throw Pe(r,e,xu),r}};var vu=Y({seconds:10}),Eu=Y({seconds:5}),Au="CollectibleEdition";function Iu(t,e){return oe({queryKey:[Au,{mintAddress:t}],async queryFn(){if(!e)return{};let o=Buffer.from(new B.PublicKey(t).toBytes()),r=oa(o),{Edition:i}=await hs();try{let n=await i.fromAccountAddress(e,r),l=mr.safeParse(n.key);if(!l.success)throw new Error(`Invalid MetaplexTokenEdition: ${n.key}`);return{key:l.data,isMasterEdition:hr(n.key)}}catch{return{key:void 0,isMasterEdition:void 0}}}})}var ku="SPLTokenAccountListingStats";function Pu(t,e,o){return oe({enabled:e!=="",refetchInterval:vu,gcTime:Eu,queryKey:[ku,{cluster:t,mint:e,pubkey:o}],async queryFn({queryKey:r}){let[,{mint:i,cluster:n}]=r,l=Ye(n);return await Ii(i,l,o)}})}var Ou=async(t,e,o,r,i=20,n=1e3)=>{try{let l=Ye(e);return await Wt(async()=>{let d=await Ii(t,l);if(!d[o])return;let m=(d[o].activities??[]).find(f=>f.signature===r);if(!m)throw new Error("no activity with that signature yet!");return m},()=>!0,i,n)}catch{}},Uu=async(t,e,o,r,i=20,n=1e3)=>{try{let l=Ye(o);return await Wt(async()=>{let d=await gr({address:t,chainId:`solana:${l}`});for(let p of d)if(p.listings?.[r]&&p.asset.mintPubKey===e)throw new Error("still in listings");return d},()=>!0,i,n)}catch{}},Mu=async(t,e,o=20,r=1e3)=>{try{return await Wt(async()=>{let{allCollectibles:n}=await yr(t.map(ar));for(let l of n)if(K(l.chainData)&&l.chainData.mint===e)return l;throw new Error("cant find mint in tokens")},()=>!0,o,r)}catch{}};s();a();var Pi=v(P());s();a();s();a();var Bu="collectibles",ia=new Error("Failed to fetch collectibles details for addresses");async function na(t){let e="/collectibles/v1/collectibles-details",o;try{let r=await Q.api().post(e,{addresses:t});if(o=r.status,!mt(r))throw ia;let i=r.data;if(!i.collectibles)throw ia;let{collectibles:n,containsParseFailure:l}=br(i.collectibles);return l&&q.captureError(new Error("collectibles failed to parse some items"),"collectibles"),n}catch(r){let i=r instanceof Error?r:new Error("Non-Error was thrown during fetching of collectibles details");throw Pe(i,o,Bu),i}}var sa=async t=>{let e=t.find(m=>L.isSolanaNetworkID(m.chainId));if(!e)throw new Error("no solana account");let{chainId:o}=e,r=await Wt(()=>gr(e),()=>!0),i=r.reduce((m,f)=>({...m,[f.asset.mintPubKey]:f}),{}),n=r.map(m=>({chainId:o,address:m.asset.mintPubKey})),c=Kn(n,100).map(m=>na(m));return(await Promise.all(c)).flat().reduce((m,f)=>{if(!K(f.chainData))return m;let{asset:g,listings:y}=i[f.chainData.mint];return m.push({...f,chainData:{...f.chainData,tokenAccount:g.pubkey},...y?{listings:y}:{}}),m},[])};s();a();s();a();var la=t=>{let e=[];for(let[o,r]of t){r.sort((n,l)=>{let c=n.name??"",d=l.name??"",p=c.localeCompare(d);if(c.localeCompare(d))return p;let m=aa(n),f=aa(l);return m.localeCompare(f)});let[i]=r;i&&e.push({..."externalUrl"in i?{externalUrl:i.externalUrl}:void 0,...i.collection,items:r})}return e.sort((o,r)=>{if(o.items.length>r.items.length)return-1;if(r.items.length>o.items.length)return 1;let i=o.name??o.id??"",n=r.name??r.id??"";return i.localeCompare(n)})};function aa(t){let e=t.chainData;return K(e)?e.tokenAccount:De(e)?e.id:(Qe(e),t.id)}function ca(t){let e=new Map;for(let o of t){let r=o.collection.id,i=e.get(r)??[];i.push(o),e.set(r,i)}return la(e)}s();a();var ua=(t,e)=>{let o=[],r=new Set,i=[...t,...e];for(let n of i)r.has(n.id)||(o.push(n),r.add(n.id));return o};s();a();s();a();var Le="collectibles",ki=[Le,"collectibleBids"],U={collections:t=>[Le,"collections",{addresses:t.map(ar)}],hiddenCollections:t=>[Le,"hiddenCollections",t],unhiddenCollections:t=>[Le,"unhiddenCollections",t],visibilityOverrides:t=>[Le,"visibilityOverrides",t],pinnedCollections:t=>[Le,"pinnedCollections",t],optimisticUpdates:()=>[Le,"optimisticUpdates"],collectibleBids:t=>[...ki,t],collectibleMintGasEstimation:t=>[Le,"mintNFTGasEstimation",t],collectibleSellSteps:t=>[Le,"collectibleSellSteps",t],createMintTransaction:t=>[Le,"createMintTransaction",t],transferTransaction:t=>[Le,"transferTransaction",t]};var Du=20;function oo(t,e){let o=U.optimisticUpdates(),r=t.getQueryData(o)??[];t.setQueryData(o,[...r,e])}async function da(t,e){let o=U.optimisticUpdates(),r=await t.getQueryState(o);if(r){let i=e??Date.now(),n=r.dataUpdatedAt,l=Y({seconds:Du});return i-n>l?(t.removeQueries({queryKey:o}),[]):r?.data??[]}else return[]}function pa(t,e){let o=e.reduce((r,i)=>{let{id:n,amount:l}=i,c=new de(l);return r[n]=(r[n]??new de(0)).plus(c),r},{});for(let r of t)r.items=r.items.reduce((i,n)=>{let l=n.id,c=o[l];if(c){let d=new de(n.balance??0);return d.minus(c).isGreaterThan(0)?i.concat({...n,balance:d.minus(c).toString()}):i}else return i.concat(n)},[]);return t=t.filter(r=>r.items.length>0),t}s();a();var Ne=(i=>(i[i.Always=1/0]="Always",i[i.Short=Y({days:1})]="Short",i[i.Medium=Y({days:3})]="Medium",i[i.Long=Y({days:7})]="Long",i))(Ne||{}),Xe=(n=>(n[n.Immediate=0]="Immediate",n[n.Short=Y({minutes:1})]="Short",n[n.Medium=Y({minutes:2.5})]="Medium",n[n.Long=Y({minutes:5})]="Long",n[n.Never=1/0]="Never",n))(Xe||{}),Io=(c=>(c[c.Shortest=Y({seconds:10})]="Shortest",c[c.Shorter=Y({seconds:30})]="Shorter",c[c.Short=Y({minutes:1})]="Short",c[c.Medium=Y({minutes:2.5})]="Medium",c[c.Long=Y({minutes:5})]="Long",c[c.Longer=Y({minutes:7.5})]="Longer",c[c.Longest=Y({minutes:10})]="Longest",c))(Io||{});var ma=({addresses:t,queryOptions:e={staleTime:Xe.Short,refetchInterval:Io.Long,enabled:!0},select:o})=>{let r=se(),i=U.collections(t),n=t.length!==0&&t.every(l=>!L.isLocalNetworkID(l.networkID));return oe({enabled:n&&e.enabled,queryKey:i,gcTime:Ne.Medium,staleTime:e.staleTime,refetchInterval:e.refetchInterval,async queryFn({queryKey:[,,{addresses:l}]}){let[c,d]=await Promise.allSettled([sa(l),yr(l)]);if(d.status==="rejected")throw new Error("failed to load unlisted collections");let{allCollectibles:p,isTrimmed:m}=d.status==="fulfilled"?d.value:{allCollectibles:[],isTrimmed:!1},f=c.status==="fulfilled"?c.value:[],g=ua(f,p),y=ca(g),C=await da(r),S=pa(y,C);return{items:S,nrOfItems:S.reduce((T,O)=>T+O.items.length,0),isTrimmed:m}},select:o})},Ot=t=>ma({...t,select:(0,Pi.useCallback)(e=>e.items,[])}),Ru=t=>ma({...t,select:(0,Pi.useCallback)(o=>o.isTrimmed,[])}).data??!1;s();a();s();a();var Oi=class extends ke{constructor(e){super(e),this.name="GetPinnedCollectionsError"}};async function Cr(t){try{return await t.get("pinnedCollections")}catch{throw new Oi("")}}var Ui=class extends ke{constructor(e){super(e),this.name="SetPinnedCollectionsError"}};async function Mi(t,e){try{return await t.set("pinnedCollections",e)}catch{throw new Ui("")}}var Sr=t=>{let e=re();return oe({enabled:t.length!==0,queryKey:U.pinnedCollections(t),gcTime:Ne.Long,staleTime:1/0,refetchInterval:!1,refetchOnMount:!0,async queryFn(){try{return(await Cr(e)??{})[t]||[]}catch(o){return o instanceof Error&&q.captureError(o,"collectibles"),[]}}})};s();a();var fa=v(P());var Lu=({id:t,addresses:e})=>{let{data:o,isSuccess:r}=Ot({addresses:e});return(0,fa.useMemo)(()=>{let n={isSuccess:r,data:void 0};for(let l of o??[])for(let c of l.items)if(c.id===t)return{...n,data:c};return n},[t,o,r])};s();a();var fe=v(P());s();a();function Ce(t){let e=re();return oe({gcTime:Ne.Long,staleTime:1/0,enabled:!!t,queryKey:U.visibilityOverrides(t??""),async queryFn(){return t?await tt(e,t):new Map}})}s();a();var Mt=v(P());s();a();function Ut(){let t=re(),e=se(),o=ae();return Be({async mutationFn({accountId:r,mutations:i}){await vo(t,o,{accountId:r,mutations:i})},async onSuccess(r,{accountId:i}){await e.invalidateQueries({queryKey:U.visibilityOverrides(i)}),await Promise.allSettled([e.invalidateQueries({queryKey:U.hiddenCollections(i)}),e.invalidateQueries({queryKey:U.unhiddenCollections(i)})])}})}async function xr({collectible:t,visibilityOverrides:e,setVisibilityOverrides:o,accountId:r,desiredVisibility:i,onSuccess:n,onError:l}){if(!e)return;let c=t.collection.id||t.id,d=e.get(c)?.status;try{let p=ba(i,t.collection);await o({accountId:r,mutations:[{id:c,visibility:p}]}),await n({collectible:t,desiredVisibility:i,previousVisibility:d,updatedVisibility:p})}catch(p){await l(p,{collectible:t,desiredVisibility:i})}}async function ha({collection:t,visibilityOverrides:e,setVisibilityOverrides:o,accountId:r,desiredVisibility:i,onSuccess:n,onError:l}){if(!e)return;let c=t.id,d=e.get(c)?.status;try{let p=ba(i,t);await o({accountId:r,mutations:[{id:c,visibility:p}]}),n&&await n({collection:t,desiredVisibility:i,previousVisibility:d,updatedVisibility:p})}catch(p){l&&await l(p,{collection:t,desiredVisibility:i})}}function ba(t,e){let{spamStatus:o}=e;switch(t){case"hidden:reported_spam":if(o==="NOT_VERIFIED"||o==="VERIFIED")return"hidden:reported_spam";if(o==="POSSIBLE_SPAM"||o==="SPAM")return null;throw new Error(`Unexpected spam status: ${o} found while marking spam.`);case"visible:reported_notSpam":if(o==="NOT_VERIFIED"||o==="VERIFIED")return null;if(o==="POSSIBLE_SPAM"||o==="SPAM")return"visible:reported_notSpam";throw new Error(`Unexpected spam status: ${o} found while marking not spam.`);case"hidden":if(o==="NOT_VERIFIED"||o==="VERIFIED")return"hidden";if(o==="POSSIBLE_SPAM"||o==="SPAM")return null;throw new Error(`Unexpected spam status: ${o} found while marking hidden.`);case"visible":if(o==="NOT_VERIFIED"||o==="VERIFIED")return null;if(o==="POSSIBLE_SPAM"||o==="SPAM")return"visible";throw new Error(`Unexpected spam status: ${o} found while marking visible.`)}throw new Error(`Unexpected desired visibility: ${t} found while calculating new visibility.`)}function bt(t){return{networkId:t.chain.id,chainId:L.getChainID(t.chain.id),collectionId:t.collection.id,collectibleId:t.id,collectibleName:t.name,collectibleDescription:t.description,collectionName:t.collection.name,collectionDescription:t.collection.description,collectionUrl:t.collection.externalUrl}}function ya({accountId:t,onError:e,onSuccess:o}){let{data:r}=Ce(t),{mutateAsync:i}=Ut();return(0,Mt.useCallback)(async n=>{await xr({collectible:n,visibilityOverrides:r,setVisibilityOverrides:i,accountId:t,desiredVisibility:"hidden:reported_spam",onSuccess:o,onError:e})},[r,i,t,e,o])}function ga({accountId:t,onError:e,onSuccess:o}){let{data:r}=Ce(t),{mutateAsync:i}=Ut();return(0,Mt.useCallback)(async n=>{await xr({collectible:n,visibilityOverrides:r,setVisibilityOverrides:i,accountId:t,desiredVisibility:"visible:reported_notSpam",onSuccess:o,onError:e})},[r,i,t,e,o])}function Ca({accountId:t,onError:e,onSuccess:o}){let{data:r}=Ce(t),{mutateAsync:i}=Ut();return(0,Mt.useCallback)(async n=>{await xr({collectible:n,visibilityOverrides:r,setVisibilityOverrides:i,accountId:t,desiredVisibility:"hidden",onSuccess:o,onError:e})},[r,i,t,e,o])}function Sa({accountId:t,onError:e,onSuccess:o}){let{data:r}=Ce(t),{mutateAsync:i}=Ut();return(0,Mt.useCallback)(async n=>{await xr({collectible:n,visibilityOverrides:r,setVisibilityOverrides:i,accountId:t,desiredVisibility:"visible",onSuccess:o,onError:e})},[r,i,t,e,o])}function wa({accountId:t,onError:e,onSuccess:o}){let{data:r}=Ce(t),{mutateAsync:i}=Ut();return(0,Mt.useCallback)(async n=>{await ha({collection:n,visibilityOverrides:r,setVisibilityOverrides:i,accountId:t,desiredVisibility:"hidden",onSuccess:o,onError:e})},[r,i,t,e,o])}function xa({accountId:t,onError:e,onSuccess:o}){let{data:r}=Ce(t),{mutateAsync:i}=Ut();return(0,Mt.useCallback)(async n=>{await ha({collection:n,visibilityOverrides:r,setVisibilityOverrides:i,accountId:t,desiredVisibility:"visible",onSuccess:o,onError:e})},[r,i,t,e,o])}s();a();var Bi=v(P());var Ta=({toast:t,accountId:e})=>{let{t:o}=Z(),r=ae(),i=(0,Bi.useCallback)(({collectible:l,updatedVisibility:c})=>{c!==null&&r.capture("collectionHidden",{data:bt(l)}),t&&t.success(o("collectionHideSuccess"))},[o,t,r]),n=(0,Bi.useCallback)((l,c)=>{t&&t.error(o("collectionHideFail"))},[o,t]);return Ca({accountId:e,onSuccess:i,onError:n})};s();a();var Di=v(P());var va=({toast:t,accountId:e})=>{let{t:o}=Z(),r=ae(),i=(0,Di.useCallback)(({collectible:l,updatedVisibility:c})=>{c!==null&&r.capture("collectionUnhidden",{data:bt(l)}),t&&t.success(o("collectionUnhideSuccess"))},[o,t,r]),n=(0,Di.useCallback)((l,c)=>{t&&t.error(o("collectionUnhideFail"))},[o,t]);return Sa({accountId:e,onSuccess:i,onError:n})};function Nu({accountId:t,collectible:e,toast:o}){let r=Ta({accountId:t,toast:o}),i=(0,fe.useCallback)(()=>{if(e)return r(e)},[r,e]),n=va({accountId:t,toast:o}),l=(0,fe.useCallback)(()=>{if(e)return n(e)},[n,e]),{data:c}=Ce(t??""),d=(0,fe.useMemo)(()=>c?.get(e?.collection.id??e?.id??""),[c,e]),p=(0,fe.useMemo)(()=>e?pr(d,{spamStatus:e.collection.spamStatus}):!1,[e,d]),m=(0,fe.useCallback)(()=>p?l():i(),[p,i,l]);return(0,fe.useMemo)(()=>({isHidden:p,onHideCollectible:i,onUnhideCollectible:l,onToggleHide:m}),[i,m,l,p])}function Vu(t){let{data:e,isPending:o}=Ce(t),r=(0,fe.useCallback)(l=>{if(!l)return!1;let c=l.collection.id||l.id;return Si(e,{spamStatus:l.collection.spamStatus,key:c})},[e]),i=(0,fe.useCallback)(l=>{if(!l)return"NOT_VERIFIED";let c=l.collection.id||l.id;return Ci(e,{spamStatus:l.collection.spamStatus,key:c})},[e]),n=(0,fe.useCallback)(l=>Eo(i(l)),[i]);return(0,fe.useMemo)(()=>({getIsHidden:r,getSpamStatus:i,getIsSpam:n,isLoading:o}),[r,i,n,o])}function Ea(t){let{data:e,isPending:o}=Ce(t),r=(0,fe.useCallback)(l=>{if(!l)return!1;let c=l.id;return Si(e,{spamStatus:l.spamStatus,key:c})},[e]),i=(0,fe.useCallback)(l=>{if(!l)return"NOT_VERIFIED";let c=l.id;return Ci(e,{spamStatus:l.spamStatus,key:c})},[e]),n=(0,fe.useCallback)(l=>Eo(i(l)),[i]);return(0,fe.useMemo)(()=>({getIsHidden:r,getSpamStatus:i,getIsSpam:n,isLoading:o}),[r,i,n,o])}function Aa(t){let e=Ea(t),o=wa({accountId:t}),r=xa({accountId:t});return(0,fe.useMemo)(()=>({...e,hideCollection:o,unhideCollection:r}),[e,o,r])}s();a();var Ia=v(P());var ju=({id:t,addresses:e})=>{let{data:o}=Ot({addresses:e});return(0,Ia.useMemo)(()=>(o??[]).find(r=>r.id===t),[t,o])};s();a();var ka=v(P()),Tr=(t,e)=>(0,ka.useMemo)(()=>e?t.includes(e):!1,[e,t]);s();a();var Ag=t=>`${t/100}%`,Pa=(t,e)=>t*e/100/100;s();a();var Da=v(fi()),Bt=v(P());s();a();var _u=b.object({caip19:b.string(),name:b.string(),symbol:b.string()}),Ua=b.object({bps:b.number(),kind:b.union([b.literal("marketplace"),b.literal("royalty")]),recipient:b.string().optional()}),Fu=b.object({amount:b.number(),feeBreakdown:b.array(Ua),netAmount:b.number(),token:_u,totalFeeBps:b.number()}),$u=b.object({name:b.string(),logo:b.string(),url:b.string().optional()}),Ma=b.object({id:b.string(),expiration:b.string().optional(),price:Fu,source:$u}),zu=b.object({bids:b.array(Ma)}),Oa=new ke("Failed to fetch collectible bids."),Hu="collectible-instant-sell-bids",qu=async t=>{if(!t.address)throw Oa;try{let e=await Q.api().validateStatus(!0).post("/collectibles/v1/bids",{asset:t}),{bids:o}=zu.parse(e.data);return o}catch(e){if(ft(e)){let o=e.response?.status;Pe(e,o,Hu)}throw Oa}},Ri=({bidAsset:t,isEnabled:e})=>{let o=e&&t.address!==null&&t.chainId!==null;return oe({enabled:o,staleTime:Xe.Short,refetchInterval:Io.Shortest,queryKey:U.collectibleBids(t),async queryFn(){return qu(t)}})},vr=t=>{let e=t?.chainData,o=t?.chain.id??null,r=De(e),i=K(e),n=r?{tokenId:e.id}:{},l=i?{contractType:e.standard}:{},c=r?e.contract.toLowerCase():i?e.mint:null;return{chainId:o,address:c,resourceType:"address",...n,...l}};s();a();var Gu=v(P());var le=b.enum(["auth","nft-approval","sale","order-signature","refetch","blur-swap","update-proof"]),Wu=b.enum(["/execute/auth-signature/v1","/order/v3"]),Je=b.enum(["transaction","signature","post","refetch"]),Ku=b.enum(["eip712","eip191"]),Qu=b.object({domain:b.any(),types:b.any(),value:b.any()}),Yu=b.object({message:b.string()}),Xu=b.object({from:b.string(),to:b.string(),data:b.string()}),Ju=b.object({endpoint:Wu,body:b.object({id:b.string(),kind:b.string()})}),Zu=b.object({action:le,chainId:Xo,type:b.literal(Je.enum.signature),data:b.object({signatureKind:Ku,signatureData:b.union([Yu,Qu]),postData:Ju})}),ed=b.object({chainId:Xo,action:le,data:Xu,type:b.literal(Je.enum.transaction)}),td=b.object({chainId:Xo,action:le,type:b.literal(Je.enum.refetch),data:b.object({resource:b.string()})}),od=b.union([Zu,ed,td]),rd=b.object({action:le,chainId:rs,type:b.literal(Je.enum.transaction),data:b.object({transaction:b.string()})}),id=b.union([od,rd]),nd=b.object({steps:b.array(id),orderId:b.string().optional()}),sd=new ke("Failed to fetch collectible sell steps."),ad="collectible-instant-sell-steps",ld=async t=>{try{let e=await Q.api().validateStatus(!0).post("/collectibles/v1/sell",t);return nd.parse(e.data)}catch(e){if(ft(e)){let o=e.response?.status;if(Pe(e,o,ad),e.response?.data?.code){let{code:r}=e.response.data;throw{code:r}}if(o)throw e}throw sd}},Li=({sellAsset:t})=>{let e=t.details.orderId!==void 0;return oe({enabled:e,queryKey:U.collectibleSellSteps(t),staleTime:1/0,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:(o,r)=>r.code?!1:o<3,async queryFn(){return ld(t)}})};var Ba=(t,e,o)=>{let r=o?.chainData,i=De(r),n=K(r),l=o?.owner,c=i?l?.toLowerCase():l,d=e?.id,p=e?.source?.name,m=n?{minPrice:e?.price?.netAmount,tokenAccount:r.tokenAccount}:{};return{details:{asset:t,owner:c,orderId:d,marketplace:p,...m}}};s();a();So.config({EXPONENTIAL_AT:1e3,DECIMAL_PLACES:78});var ro=(t,e)=>new So(t).div(Ko(e)).toNumber();var cd={steps:[],orderId:""},ud=({collectible:t})=>{let{t:e}=Z(),o=(0,Bt.useMemo)(()=>vr(t),[t]),r=(0,Bt.useMemo)(()=>Ra(t),[t]),{data:i=[],isPending:n,isError:l}=Ri({bidAsset:o,isEnabled:!r}),c=(0,Bt.useMemo)(()=>i.length>0?i[0]:void 0,[i]),d=(0,Bt.useMemo)(()=>Ba(o,c,t),[o,c,t]),{data:p=cd,isPending:m,isError:f,refetch:g,error:y}=Li({sellAsset:d}),C=(0,Bt.useMemo)(()=>c&&t?La({t:e,bid:c,collectible:t}):void 0,[e,c,t]),S=(0,Bt.useMemo)(()=>f?Number.isInteger(y.code):!1,[f,y]);return{bid:c,bidSummary:C,isLoadingBids:n,isErrorBids:l,sellSteps:p,isLoadingSellSteps:m,isErrorSellSteps:f,refetchSellSteps:g,sellStepsError:y,isSellErrorCode:S,isListedOnSolana:r}},dd=({lastSale:t,receiveAmount:e})=>t!==void 0?e-t:e,Ra=t=>{if(!t)return!1;let{listings:e,chainData:o}=t,i=(e?Object.keys(e):[]).length>0,n=o?K(o):!1;return i&&n},pd=({offerAmount:t,collectionFloor:e})=>t-e,md=t=>{let e=Math.abs(t)<.001?"0.0000%":"0.00%",o=(0,Da.default)(t).format(e);return`${t>0?"+":""}${o}`},fd=t=>{if(t){let{price:e,token:o}=t,r=o?.decimals;if(r)return ro(e,r)}},hd=t=>{if(t){let{price:e,token:o}=t,r=o?.decimals;if(r)return ro(e,r)}},bd=t=>{if(!t||!t.previews)return;let{previews:e}=t;if(e.small)return e.small;if(e.medium)return e.medium;if(e.large)return e.large};var La=({bid:t,collectible:e,t:o})=>{let{lastSalePrice:r,media:i,name:n,collection:l}=e,{name:c,logo:d}=t.source,{amount:p,netAmount:m,feeBreakdown:f,token:g,totalFeeBps:y}=t.price,{symbol:C,caip19:S}=g,T=0,O=m,_=l.id,$=e.id,A=hd(r),Me=C.slice(0,6),ie=e.chain.symbol,Ke=fd(l.floorPrice),ne=Ke?pd({offerAmount:p,collectionFloor:Ke}):void 0,ee=ne?md(ne):void 0;return{bidTokenSymbol:Me,caip19:S,collectionId:_,collectibleId:$,orderId:t.id,collectibleChainId:e.chain.id,collectibleChainSymbol:ie,collectionFloor:Ke,collectibleImage:bd(i),collectibleName:n??o("collectiblesUnknownCollectible"),collectionName:l.name??o("collectiblesUnknownCollection"),currencySymbol:t.source.name==="Blur"?ie:Me,fees:f,floorDifference:ne,floorDifferencePercent:ee,lastSale:A,marketplace:c,marketplaceLogoURL:d,offerAmount:p,offerAmountFormatted:Qo(p),phantomFeePercentage:T,pnl:dd({lastSale:A,receiveAmount:O}),receiveAmount:O,receiveAmountFormatted:Qo(O),totalFeeBps:y}},yd=({gasFee:t,totalFeeBps:e,offerAmount:o})=>{let r=Pa(e,o)+t.toNumber();return{raw:r,formatted:Qo(r)}};s();a();var Na=new Map([[le.enum["nft-approval"],8e4],[le.enum["blur-swap"],42e3],[le.enum.sale,39e4],["default",42e4]]),Cd=(t,e,o,r)=>{let i=t==="Blur",n=o.filter(S=>S.type==="transaction").map(({action:S})=>({action:S}));if(n.some(({action:S})=>S===le.enum["nft-approval"])||(n=[...n,{action:le.enum["nft-approval"]}]),i){let S=n.some(({action:O})=>O===le.enum.sale),T=n.some(({action:O})=>O===le.enum["blur-swap"]);S||(n=[...n,{action:le.enum.sale}]),T||(n=[...n,{action:le.enum["blur-swap"]}])}let c=n?.reduce((S,{action:T})=>{let O=Na.get(T)??Na.get("default");return S+(O??0)},0),d=new de(c),{status:p,data:m}=Ns({gasLimit:d,networkID:e,transactionSpeed:"standard"}),{data:f}=js(e,m),g=Cs(m),y=Number(g?.replace(/[^\d.]/g,"")??0),C=r?r.isGreaterThan(y):!1;return{gasEvm:y,gasEstimation:m,gasEstimationStatus:p,ethFeeUI:g,gasEstimationPrice:f,hasEnoughGas:C}};s();a();var ot=v(P());s();a();var Er=(t,e)=>{t.invalidateQueries({queryKey:ki}),t.invalidateQueries({predicate:({queryKey:o})=>o.includes("collectibleSellSteps")&&o[2].details.orderId===e?.orderId})};var Td=()=>{let{data:t}=Zo();return(0,ot.useMemo)(()=>{let o=t?.type,r=t?.name??"",i=t?.addresses??[],n=t?.identifier??"";return{isLedger:t?.type==="ledger",accountName:r,accountType:o,chainAddresses:i,accountIdentifier:n}},[t])},vd=({networkID:t,unsignedTransaction:e,pendingActivityRows:o,accountIdentifier:r,accountSigner:i,storage:n,includeCallPayload:l})=>({accountSigner:i,accountIdentifier:r,networkID:t,unsignedTransaction:e,...l&&{callPayload:{from:e.from,to:e.to,data:e.data,value:e.value}},pendingTransactionInput:{ownerAddress:e.from,networkID:t,data:{nonce:"",unsignedTransaction:e,hash:""},type:"sell",display:{summary:o}},storage:n}),Ed=async(t,e,o,r,i,n,l)=>{try{if(!o)throw new Error("Gas estimation is required");if(!l)throw new Error("Bid summary is required");let{data:c,chainId:d,action:p}=e,{collectionName:m,marketplace:f,receiveAmount:g,currencySymbol:y,collectibleChainSymbol:C,bidTokenSymbol:S}=l,T=Wo(f),O={};p==="nft-approval"&&(O={topRight:{text:""},bottomRight:{text:""},topLeft:{text:t("collectiblesApproveCollection",{collectionName:m})},bottomLeft:{text:T}}),p==="sale"&&(O={topRight:{text:`+${g} ${y}`},topLeft:{text:t("collectiblesSoldCollectible")},bottomRight:{text:`-${m}`},bottomLeft:{text:T}}),p==="blur-swap"&&(O={topRight:{text:`+${g} ${C}`},topLeft:{text:t("transactionsSwapped")},bottomRight:{text:`-${g} ${S}`},bottomLeft:{text:T}});let _=Gt.parse({type:"0x2",to:c.to,from:c.from,data:c.data,chainId:L.getEVMNetworkIDValue(d),gas:`0x${o.gasLimit.toString(16)}`,maxFeePerGas:`0x${o.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${o.maxPriorityFeePerGas.toString(16)}`}),$=vd({storage:r,accountSigner:i,pendingActivityRows:O,includeCallPayload:!1,networkID:d,unsignedTransaction:_,accountIdentifier:n.accountIdentifier}),A=await Ts($);return{type:e.type,data:A}}catch(c){return{type:e.type,error:c}}},Ad=async(t,e,o)=>{try{let{chainId:r,data:i}=t,{signatureData:n,signatureKind:l,postData:c}=i;if(l==="eip191"&&"message"in n){let d=await e.sign(o.accountIdentifier,{signingType:"message",chainType:"eip155",message:n.message});if(d.status==="success")return await Q.api().post("/collectibles/v1/submit-signature",{chainId:r,signature:d.signature,postData:c}),{type:t.type,data:"success"};throw new Error("Execute Sell: Couldn't sign message")}throw new Error("Execute Sell: EIP721 is not yet supported")}catch(r){return{type:t.type,error:r}}},Id=async(t,e)=>{try{let{resource:o}=t.data;if(o==="/sell"){let{data:r}=await e();return{type:t.type,data:r?.steps}}throw new Error("Execute Sell: Resource is not supported")}catch(o){return{type:t.type,error:o}}},kd=[le.enum.auth,le.enum["nft-approval"],le.enum.sale],Pd="Steps are required",Od="These steps are not from the same bid",Ar=class extends Error{message=Pd},Ir=class extends Error{message=Od},Ud=(t,e,o,r,i,n,l)=>{let c=re(),d=ae(),p=se(),m=Qt(),[f,g]=(0,ot.useState)("idle"),[y,C]=(0,ot.useState)(null),[S,T]=(0,ot.useState)(null),{t:O}=Z(),_=Td(),{chainAddresses:$,isLedger:A}=_;(0,ot.useEffect)(function(){f==="loading"&&Er(p,i)},[f,p,i]),(0,ot.useEffect)(function(){f==="success"&&i&&oo(p,{id:i.collectibleId,amount:1})},[f,p,$,i]);let Me=()=>{g("idle"),C(null),T(null)},ie=l&&i?.receiveAmount?i.receiveAmount*l:void 0,Ke=async(ne,ee=new Map)=>{let Ae=ne??e;try{if(t&&t!==""&&t!==i?.orderId)throw new Ir;if(!Array.isArray(Ae)||Ae.length===0)throw new Ar;g("loading");for await(let dt of Ae){let{action:pt}=dt,Wc=ee.get(pt)==="success",Kc=pt===le.enum.sale,Hn=pt===le.enum.refetch,Qc=kd.some(qt=>qt===pt);if(Wc)continue;Hn||ee.set(pt,"loading");let Yc=async qt=>{switch(qt.type){case Je.enum.transaction:return await Ed(O,qt,o,c,m,_,i);case Je.enum.signature:return await Ad(qt,m,_);case Je.enum.refetch:return await Id(qt,r)}},{type:qn,data:pi,error:Gn}=await Yc(dt);if(Qc&&Gn)throw Gn;if(pi&&(Hn||ee.set(pt,"success"),qn===Je.enum.transaction&&Kc&&T(pi),qn===Je.enum.refetch))return await Jn(500),await Ke(pi,ee)}g("success"),d.capture("collectibleSellSuccess",{data:{bidSummary:i,usdSaleValue:ie}})}catch(dt){let pt=dt?.message??"";(!(dt instanceof Ar)||!(dt instanceof Ir))&&(q.captureError(dt,"collectibles"),d.capture("collectibleSellFailure",{data:{bidSummary:i,usdSaleValue:ie,errorMessage:pt}})),g("error"),C(dt)}};return{executeSellEvmSteps:Ke,reset:Me,error:y,result:S,status:f,isLedger:A}};s();a();var Ve=v(P());var Md=()=>{let{data:t}=Zo();return(0,Ve.useMemo)(()=>{let o=t?.identifier??"",r=t?.type==="ledger",i=t?.addresses??[],n=i.find(ns),l=n?.networkID,c=n?.address??"",d=ws(l),p=Ss(d);return{accountIdentifier:o,chainAddresses:i,chainId:l,solanaPublicKey:c,isLedger:r,cluster:d,connection:p}},[t])},Bd=(t,e)=>{let[o,r]=(0,Ve.useState)(void 0);return(0,Ve.useEffect)(()=>{(async()=>{if(!t)return;let l=t.find(m=>m.type==="transaction")?.data?.transaction;if(!l)return;let c=mi(l,"base64"),d=await ks(e,[c.message]),p=Wn(d.value);r(p)})()},[t,e]),o},Dd=async(t,e,o,r,i,n)=>{if(!n)throw new Error("Bid summary is required");let{collectionName:l,marketplace:c,receiveAmount:d,currencySymbol:p}=n,m={topRight:{text:`+${d} ${p}`},topLeft:{text:t("collectiblesSoldCollectible")},bottomRight:{text:`-${l}`},bottomLeft:{text:Wo(c)}},{data:f,chainId:g,type:y}=e,{transaction:C}=f,S=mi(C,"base64"),T={ownerAddress:o.solanaPublicKey,networkID:g,data:{signature:""},type:"sell",display:{summary:m}},{accountIdentifier:O,solanaPublicKey:_,connection:$}=o,A=new B.PublicKey(_),Me=await Os({accountIdentifier:O,feePayer:A,transaction:S,pendingTransactionInput:T,connection:$,accountSigner:r,storage:i,opts:{skipPreflight:!0}});return{type:y,data:Me}},Rd="Steps are required",Ld="These steps are not from the same bid",kr=class extends Error{message=Rd},Pr=class extends Error{message=Ld},Nd=(t,e,o,r)=>{let i=re(),n=ae(),l=se(),c=Qt(),[d,p]=(0,Ve.useState)("idle"),[m,f]=(0,Ve.useState)(null),[g,y]=(0,Ve.useState)(null),{t:C}=Z(),S=Md(),{chainId:T,connection:O,chainAddresses:_,isLedger:$}=S,A=T&&L.isSolanaNetworkID(T)?T:Kt.Solana.Mainnet,Me=Bd(e,A);(0,Ve.useEffect)(function(){d==="loading"&&Er(l,o)},[d,l,o]),(0,Ve.useEffect)(function(){d==="success"&&o&&oo(l,{id:o.collectibleId,amount:1})},[d,l,_,o]);let ie=()=>{p("idle"),f(null),y(null)},Ke=r&&o?.receiveAmount?o.receiveAmount*r:void 0;return{executeSellSolanaSteps:async()=>{try{if(t&&t!==o?.orderId)throw new Pr;if(!Array.isArray(e)||e.length===0)throw new kr;p("loading");for await(let ee of e){let Ae=await Dd(C,ee,S,c,i,o);y(Ae.data),await Ps({connection:O,signature:Ae.data})}p("success"),n.capture("collectibleSellSuccess",{data:{bidSummary:o,usdSaleValue:Ke}})}catch(ee){let Ae=ee?.message??"";(!(ee instanceof kr)||!(ee instanceof Pr))&&(q.captureError(ee,"collectibles"),n.capture("collectibleSellFailure",{data:{bidSummary:o,usdSaleValue:Ke,errorMessage:Ae}})),p("error"),f(ee)}},reset:ie,gas:Me,error:m,result:g,status:d,isLedger:$}};s();a();var Vd=.01,jd=t=>{let{fungible:e}=Ws({key:Qs(t.collectibleChainId,void 0)}),o=e?.data.balance;return{hasEnoughGas:o?o.isGreaterThan(Vd):!1}};s();a();var _a=v(P()),_d=t=>t.reduce((e,o)=>({...e,[o]:1}),{});function Ni({allCollections:t=[],pinnedCollectionIds:e=[],getIsHidden:o,getIsSpam:r}){let i=[],n=[],l=[],c=[],d=_d(e),p={};for(let f of t)r(f)&&o(f)?c.push(f):o(f)?n.push(f):d[f.id]?p[f.id]=f:r(f)?l.push(f):i.push(f);let m=[];for(let f of e)p[f]&&m.push(p[f]);return{collections:[...m,...i,...l],hiddenCollections:n,spamCollections:c}}var Fd=({allCollections:t=[],pinnedCollectionIds:e=[],getIsHidden:o,getIsSpam:r})=>(0,_a.useMemo)(()=>Ni({allCollections:t,pinnedCollectionIds:e,getIsHidden:o,getIsSpam:r}),[t,o,r,e]);s();a();var Or=v(P()),Vi={location:0,distance:50,threshold:.3},yS={...Vi,keys:["name"]},gS={...Vi,keys:["name"]},CS={...Vi,keys:["name"]},ko=(t,e)=>{if(e===void 0)return!1;let o=t.toLowerCase();return e.toLowerCase().split(" ").map(r=>r.startsWith(o)||o.startsWith(r)&&e.toLowerCase().includes(o)).includes(!0)};var Fa=(t,e)=>(0,Or.useMemo)(()=>({collections:t.filter(r=>ko(e,r.name||r.items[0].name))}),[e,t]),$d=(t,e,o,r)=>{let i=(0,Or.useMemo)(()=>t.flatMap(n=>n.items),[t]);return(0,Or.useMemo)(()=>{let n=t.filter(p=>ko(r,p.name)),l=i.filter(p=>ko(r,p.name)),c=e.filter(p=>ko(r,p.name)),d=o.filter(p=>ko(r,p.name));return{collections:n,collectibles:l,hiddenCollections:c,spamCollections:d}},[r,i,t,e,o])};s();a();var yt=v(P());var zd=Y({seconds:10}),Hd=Y({seconds:5});function qd({account:t}){let e=t?.identifier??"",o=t?.addresses??[],{data:r=[],isLoading:i}=Ot({addresses:o,queryOptions:{staleTime:Hd,refetchInterval:zd}}),[n,l]=(0,yt.useState)(""),c=es(n)??"",d=(0,yt.useCallback)($=>l(typeof $=="string"?$:$.currentTarget.value),[l]),{getIsHidden:p,getIsSpam:m,getSpamStatus:f,hideCollection:g,unhideCollection:y,isLoading:C}=Aa(e),S=(0,yt.useMemo)(()=>{let{collections:$,hiddenCollections:A,spamCollections:Me}=Ni({allCollections:r,getIsHidden:p,getIsSpam:m});return[...$,...A,...Me]},[r]),T=Fa(S,c),O=(0,yt.useCallback)(({item:$,status:A})=>A==="show"?y($):g($),[y,g]);return{viewState:(0,yt.useMemo)(()=>({accountId:e,listItems:c?T.collections:S,searchQuery:n,debouncedSearchQuery:c,handleSearch:d,getIsHidden:p,getIsSpam:m,getSpamStatus:f,onToggleHidden:O}),[e,T.collections,n,d,S,O,p,m,f,c]),viewStateLoading:C||i}}s();a();var $a={listCollectible:null,listCollectiblePrice:null,editListCollectiblePrice:null,unlistCollectible:null,transactionURL:null},rt=tr(t=>({...$a,reset:()=>t({...$a}),setListCollectible:e=>t({listCollectible:e}),setListPrice:e=>t({listCollectiblePrice:e}),setEditListPrice:e=>t({editListCollectiblePrice:e}),setUnlistCollectible:e=>t({unlistCollectible:e}),setTransactionURL:e=>t({transactionURL:e})}));s();a();var me=v(Jc());var Gd="token-account-min-balances",za=me.struct([me.blob(32,"mint"),me.blob(32,"owner"),me.nu64("amount"),me.blob(93)]),VS=me.struct([me.blob(44),me.u8("decimals"),me.blob(37)]),Wd=me.struct([me.blob(679)]),Kd=me.struct([me.u8("edition"),me.blob(281)]),Qd=async t=>t.getMinimumBalanceForRentExemption(za.span).then(de),Yd=async t=>de(await t.getMinimumBalanceForRentExemption(Wd.span)+await t.getMinimumBalanceForRentExemption(Kd.span)+await t.getMinimumBalanceForRentExemption(za.span));function Xd({tokenEdition:t,connection:e}){return oe({queryKey:[Gd,{tokenEdition:t}],queryFn:async()=>e?t===null||!hr(t)?Qd(e):Yd(e):de(0)})}s();a();var Ha=v(P()),Jd=(t,e,o=!1,r)=>(0,Ha.useMemo)(()=>{if(t)return Ur({collectibleMedia:t,isImageAnimationEnabled:o,previewSize:r??"medium",mediaTypeOverride:e})},[t,e,o,r]),Ur=({collectibleMedia:t,isImageAnimationEnabled:e,previewSize:o,mediaTypeOverride:r})=>{let i=r??t.type;if((i==="image"||i==="other")&&t.previews?.[o]){let l=e?"":`${o==="medium"?"=":"-"}k`;return`${t.previews[o]}${l}`}return t[i]?.url};s();a();var qa=v(P());var Zd=!1,ep="small",tp="image",op=t=>(0,qa.useMemo)(()=>Ga(t),[t]),Ga=(t,e=ep)=>{if(!t)return;let{media:o,collection:r}=t,i=Zd,n=tp;return o?Ur({collectibleMedia:o,isImageAnimationEnabled:i,previewSize:e,mediaTypeOverride:n}):r.imageUrl};s();a();var Wa=v(P()),Ka=t=>{let{items:e}=t;if(e.length!==0)return e.find(({media:o})=>o?.type==="image")},rp=t=>(0,Wa.useMemo)(()=>{if(t)return Ka(t)??t.items[0]},[t]);s();a();var Qa=v(P());var ip=t=>(0,Qa.useMemo)(()=>{if(!(!t||t.items.length===0))return Ya(t)},[t]),Ya=t=>{let{items:e}=t,{length:o}=e;if(o===1){let[{balance:r="",chainData:i}]=e;if(K(i)&&i.standard==="SemiFungible"){let n=parseInt(r,10);return isNaN(n)?1:n}}return o};s();a();s();a();var Xa={burnCollectibleTx:void 0,burnCollectibleTxFee:void 0},Ja=t=>({...Xa,resetBurnCollectible:()=>t({...Xa}),setBurnCollectibleTx:e=>t({burnCollectibleTx:e}),setBurnCollectibleTxFee:e=>t({burnCollectibleTxFee:e})});s();a();var Za={multichainSellCollectible:void 0},el=t=>({...Za,resetMultichainSellCollectible:()=>t({...Za}),setMultichainSellCollectible:e=>t({multichainSellCollectible:e})});s();a();var tl={listCollectible:null,listCollectiblePrice:null,editListCollectiblePrice:null,unlistCollectible:null,transactionURL:null},ol=t=>({...tl,reset:()=>t({...tl}),setListCollectible:e=>t({listCollectible:e}),setListPrice:e=>t({listCollectiblePrice:e}),setEditListPrice:e=>t({editListCollectiblePrice:e}),setUnlistCollectible:e=>t({unlistCollectible:e}),setTransactionURL:e=>t({transactionURL:e})});s();a();var rl={multichainListCollectible:null,multichainListCollectiblePrice:null,editMultichainListCollectiblePrice:null,unlistMultichainCollectible:null,multichainTransactionURL:null},il=t=>({...rl,reset:()=>t({...rl}),setMultichainListCollectible:e=>t({multichainListCollectible:e}),setMultichainListPrice:e=>t({multichainListCollectiblePrice:e}),setEditMultichainListPrice:e=>t({editMultichainListCollectiblePrice:e}),setUnlistMultichainCollectible:e=>t({unlistMultichainCollectible:e}),setMultichainTransactionURL:e=>t({multichainTransactionURL:e})});var np=tr((t,e)=>({...ol(t,e),...Ja(t,e),...il(t,e),...el(t,e)}));s();a();s();a();var sp=500,nl=U.collections([])[1],ap=[nl,U.hiddenCollections("")[1],U.unhiddenCollections("")[1],U.pinnedCollections("")[1]],lp=t=>{let e=String(t.queryKey[1]);return e===nl?t.state.data?.nrOfItems<=sp:ap.includes(e)};s();a();var ml=v(P());s();a();s();a();s();a();var sl="#F7931A",cp=5e4,up="https://help.magiceden.io/en/articles/8450002-mastering-utxo-management-extracting-splitting-sats-on-magic-eden-bitcoin",al={sendSuccessCondition:"SUBMISSION",collectibleDetailPrecision:7,collectibleDetailCtaBanner:(t,e)=>{let o=t.chainData;if(eo(o)&&e){let r=new de(o.utxoDetails.value??0);if(r.lte(cp))return;let i=Object.values(o.utxoDetails.satributes).reduce((d,{count:p})=>d+p,0),n=hi(i,L.bitcoin.tokenDecimals),l=hi(r,L.bitcoin.tokenDecimals),c=ts(l.minus(n).times(e));return{title:xe.t("collectibleDetailUtxoSplitterCtaTitle"),subtitle:xe.t("collectibleDetailUtxoSplitterCtaSubtitle",{value:c}),iconFill:sl,modal:{title:xe.t("collectibleDetailUtxoSplitterModalCtaTitle"),subtitle:xe.t("collectibleDetailUtxoSplitterModalCtaSubtitle",{value:c}),buttonText:xe.t("collectibleDetailUtxoSplitterModalCtaButton"),uri:up,iconFill:sl}}}}};s();a();var io={sendSuccessCondition:"CONFIRMATION",collectibleDetailPrecision:5,collectibleDetailCtaBanner:void 0};s();a();var ll={sendSuccessCondition:"CONFIRMATION",collectibleDetailPrecision:5,collectibleDetailCtaBanner:void 0};s();a();var cl={sendSuccessCondition:"CONFIRMATION",collectibleDetailPrecision:9,collectibleDetailCtaBanner:void 0};var dp=new cs({solana:ll,ethereum:io,polygon:io,base:io,monad:io,arbitrum:io,bitcoin:al,sui:cl}),Dt=ls(dp);s();a();var pl=v(P());s();a();var ul=v(fi()),dl=({value:t,type:e})=>{if(!t)return"";try{switch(e){case"number":return(0,ul.default)(t).format("0,0.[00]").toString();case"date":return new Date(Number(t)).toLocaleDateString();default:return`${t}`}}catch{return`${t}`}};var ji=t=>(0,pl.useMemo)(()=>{if(!t)return[];let e=t.chainData;return Qe(e)&&e.utxoDetails?e.utxoDetails.satributes.map(({count:o,displayName:r,description:i,url:n})=>({type:r.toUpperCase(),value:xe.t(pp(o,"collectibleDetailSatsCount_one","collectibleDetailSatsCount_other"),{count:o})??"",modal:{name:r,description:i,iconUrl:n}})):t.attributes.map(({trait_type:o,value:r,display_type:i})=>({type:o,value:dl({value:r,type:i})}))},[t]),pp=(t,e,o)=>t===1?e:o;function mp(t){let{chain:e,owner:o}=t||{},r=e?.id,{data:i}=er({address:o,networkID:r});$s(i);let n=ji(t),l=r?L.getChainID(r):void 0,c=l?as(l):void 0,{data:d}=Vs({query:c?{data:c}:void 0});return{ctaBanner:(0,ml.useMemo)(()=>{if(!(!t||!d||!l))return Dt.get(l).collectibleDetailCtaBanner?.(t,d.price)},[l,t,d]),traits:n}}s();a();s();a();s();a();s();a();var fl=v(Yo()),hl=v(Yo()),bl=v(os()),yl=({value:t,senderAddress:e,recipient:o,utxoState:{safeToSendUtxos:r},feerate:i,utxoHash:n,utxoIndex:l})=>{let c={transactionHash:n,index:l,value:t,isSafeToSend:!1,owner:e},d=[c],p=[{address:o,value:parseFloat(c.value),script:(0,bl.toOutputScript)(o)}],m=lr(Jo(Kt.Bitcoin.Mainnet,e),r,p,i,d),f=new hl.Psbt({network:fl.networks.bitcoin});if(m.type==="success"){let{inputs:g,outputs:y}=m;f.addInputs(g.map(C=>cr(C,e,!0))),f.addOutputs(y)}return[f,f.data.inputs.map((g,y)=>({address:e,signingIndexes:[y]})),m.vb]};s();a();var gl=v(Yo()),Cl=v(Yo()),Sl=v(os()),wl=({hash:t,index:e,value:o,senderAddress:r,recipient:i,utxoState:{safeToSendUtxos:n},feerate:l})=>{let c={index:e,transactionHash:t,value:o,isSafeToSend:!1,owner:r},d=[c],p=[{address:i,value:parseFloat(c.value),script:(0,Sl.toOutputScript)(i)}],m=lr(Jo(Kt.Bitcoin.Mainnet,r),n,p,l,d),f=new Cl.Psbt({network:gl.networks.bitcoin});if(m.type==="success"){let{inputs:y,outputs:C}=m;f.addInputs(y.map(S=>cr(S,r,!0))),f.addOutputs(C)}let g=f.data.inputs.map((y,C)=>({address:r,signingIndexes:[C]}));return[f,g,m.vb]};function xl({chain:t,owner:e,chainData:o},{recipient:r,transactionSpeed:i="standard"},{utxoState:n,transactionSpeedsToUnitCost:l}){let c,d,p;if(!e)throw new Error("Owner is required");let m=t.id,f=l[i],g=o,y=f,C=Math.round(y?gs(y.btcPerKilobyte).toNumber():ys);if(ea(g)){let{outputValue:S,utxoHash:T,utxoIndex:O}=g;[c,d,p]=yl({value:S,senderAddress:e,recipient:r,utxoState:n,feerate:C,utxoHash:T,utxoIndex:O})}else if(eo(g)){let{utxoDetails:S}=g;[c,d,p]=wl({feerate:C,senderAddress:e,recipient:r,utxoState:n,hash:S.hash,index:S.index,value:S.value.toString()})}else throw new Error("Unsupported bitcoin transfer transaction");return{networkID:m,psbt:c,vb:p,psbtChain:void 0,inputsToSign:d}}s();a();s();a();var fp=["function safeTransferFrom(address from, address to, uint256 tokenId)","function transferFrom(address from, address to, uint256 tokenId)"],Tl=new Error("Error populating ERC721 transaction data."),vl=async t=>{let{sender:e,networkID:o,destination:r,contractAddress:i,tokenID:n}=t,l=rr(o,i,fp,e),c;try{let p=await l.populateTransaction.safeTransferFrom(e,r,new de(n).toString(10));if(p.data)c=p.data;else throw Tl}catch{throw Tl}return Gt.parse({type:"0x2",from:e,to:i,chainId:L.getEVMNetworkIDValue(o),data:c})};s();a();var hp=["function safeTransferFrom(address from, address to, uint256 id, uint256 amount, bytes data)","function transferFrom(address from, address to, uint256 id, uint256 amount, bytes data)"],El=new Error("Error populating ERC1155 transaction data."),Al=async t=>{let{sender:e,networkID:o,destination:r,contractAddress:i,tokenID:n,value:l}=t,c=rr(o,i,hp,e),d;try{let m=await c.populateTransaction.safeTransferFrom(e,r,new de(n).toString(10),l.toString(10),[]);if(m.data)d=m.data;else throw El}catch{throw El}return Gt.parse({type:"0x2",from:e,to:i,chainId:L.getEVMNetworkIDValue(o),data:d})};async function Il({chain:t,chainData:e,owner:o},{recipient:r,amountAsset:i}){let n=e,l=t.id,c;if(bp(n)){let{contract:d,id:p}=n;c=await vl({networkID:l,sender:o??"",destination:r,contractAddress:d,tokenID:p})}else if(yp(n)){let{contract:d,id:p}=n;c=await Al({networkID:l,sender:o??"",destination:r,contractAddress:d,tokenID:p,value:i??"1"})}else throw new Error(`Unsupported EVM collectible type: ${n.standard}`);return{networkID:l,unsignedTransaction:c}}function bp(t){return t.standard==="ERC721"}function yp(t){return t.standard==="ERC1155"}s();a();s();a();s();a();var Br=class extends Error{constructor(e){super(e),this.name="ProofError"}};async function kl({networkID:t,mintAddress:e}){let o="/collectibles/v1/proof",r;try{r=await Q.api().post(o,{chainId:t,address:e})}catch{let n=new Br(`Failed to fetch proof for ${e} on network ${t}.`);throw q.captureError(n,"collectibles"),n}if(r.status!==200){let n=new Br(`Failed to fetch proof for ${e} on network ${t}.`);throw q.captureError(n,"collectibles"),n}return await r.data}async function Pl({networkID:t,mint:e,recipient:o}){let r=new Ie.Transaction,i=await kl({networkID:t,mintAddress:e});return r.add(await fs({...i,destination:o})),r}s();a();async function Ol({networkID:t,destination:e,mint:o,senderAddress:r}){let{createComputeBudgetIx:i,createOCPTransferIX:n,getOCPMintState:l}=await or(),c=It(t),d=new B.PublicKey(o),p=await l(d,c);if(!p)throw new Error("Mint state not found for OCP transfer");Go()&&console.log("This is a Magic Eden Open Creator Protocol Token");let m=new Ie.Transaction;m.add(i());let{destinationAddress:f}=await ur({solanaConnection:c,destination:new B.PublicKey(e),mint:d,programId:To}),g=new B.PublicKey(r.address),{initAccountIX:y,transferIX:C}=await n({senderAddress:g,destinationAddress:f,mintAddress:d,mintState:p,connection:c});return y&&m.add(y),m.add(C),m}s();a();async function Ul({networkID:t,senderAddress:e,senderAccount:o,destination:r,mint:i}){let n=It(t),l=new B.PublicKey(i),{destinationAddress:c,destinationAccount:d}=await ur({solanaConnection:n,destination:new B.PublicKey(r),mint:l,programId:To}),{createPNFTTransferIX:p}=await or(),m=new Ie.Transaction,f=new B.PublicKey(e.address),g=new B.PublicKey(o),y=d;if(!y){let[C,S]=await Es(f,c,l,To);m.add(vs({account:c,owner:B.SystemProgram.programId})),m.add(C),y=S}return m.add(await p({senderAddress:f,tokenAccount:g,destinationAddress:c,destinationAccount:y,mintAddress:l,connection:n})),m}async function Ml(t,e){let{chain:o,owner:r,decimals:i="0"}=t,n=parseFloat(i),{solana:l}=e,{memo:c,references:d}=l,p=o.id,m=It(p),f={networkID:t.chain.id,addressType:"solana",address:t.owner??""};if(!K(t.chainData))throw new Error("Chain data is not a SolanaCollectibleChainData");let g;if(gp(t))g=await Pl({networkID:p,mint:t.chainData.mint,recipient:e.recipient});else if(Cp(t))g=await Ul({networkID:p,senderAddress:f,senderAccount:t.chainData.tokenAccount,destination:e.recipient,mint:t.chainData.mint});else if(await Sp(t))g=await Ol({networkID:p,destination:e.recipient,mint:t.chainData.mint,senderAddress:f});else if(wp(t)){let y=Gs(t),C=e.amountAsset.isZero()?"1":e.amountAsset.toFixed();g=await Is({networkID:p,destination:e.recipient,mint:t.chainData.mint,senderAddress:f,senderAccount:t.chainData.tokenAccount,decimals:n,programId:t.chainData.programId,amount:C,references:d?.map(S=>S.toString())??[],memo:c??"",transferHookProgramId:y,connection:m})}else throw new Error("Unsupported transferSPLSolana args");return c&&g.add(As({memoText:c})),g.feePayer=new B.PublicKey(r??""),g=await xs(g,{connection:m}),g.recentBlockhash=(await m.getLatestBlockhash("confirmed")).blockhash,{networkID:p,transaction:[g]}}function gp(t){return K(t.chainData)?"compression"in t.chainData&&!!t.chainData.compression?.compressed:!1}function Cp(t){return K(t.chainData)?"standard"in t.chainData&&(t.chainData.standard==="ProgrammableNonFungible"||t.chainData.standard==="ProgrammableNonFungibleEdition"):!1}async function Sp(t){let{chainData:e}=t;if(!K(e))return!1;let{mint:o}=e,r=It(t.chain.id);return await bs(new B.PublicKey(o),r)!==null}function wp(t){return K(t.chainData)}s();a();s();a();s();a();s();a();var Bl="1.21.2",Dl="1.43.0";s();a();var xp={"-32700":"ParseError","-32701":"OversizedRequest","-32702":"OversizedResponse","-32600":"InvalidRequest","-32601":"MethodNotFound","-32602":"InvalidParams","-32603":"InternalError","-32604":"ServerBusy","-32000":"CallExecutionFailed","-32001":"UnknownError","-32003":"SubscriptionClosed","-32004":"SubscriptionClosedWithError","-32005":"BatchesNotSupported","-32006":"TooManySubscriptions","-32050":"TransientError","-32002":"TransactionExecutionClientError"},Dr=class extends Error{},no=class extends Dr{constructor(e,o){super(e),this.code=o,this.type=xp[o]??"ServerError"}},Rr=class extends Dr{constructor(e,o,r){super(e),this.status=o,this.statusText=r}};s();a();var Rl=t=>{throw TypeError(t)},Fi=(t,e,o)=>e.has(t)||Rl("Cannot "+o),te=(t,e,o)=>(Fi(t,e,"read from private field"),o?o.call(t):e.get(t)),Rt=(t,e,o)=>e.has(t)?Rl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,o),so=(t,e,o,r)=>(Fi(t,e,"write to private field"),r?r.call(t,o):e.set(t,o),o),Ll=(t,e,o)=>(Fi(t,e,"access private method"),o),Tp=(t,e,o,r)=>({set _(i){so(t,e,i,o)},get _(){return te(t,e,r)}}),Lt,Po,it,Nt,Oo,ao,Lr,Nl,Vl;function vp(t){let e=new URL(t);return e.protocol=e.protocol.replace("http","ws"),e.toString()}var Ep={WebSocketConstructor:typeof WebSocket<"u"?WebSocket:void 0,callTimeout:3e4,reconnectTimeout:3e3,maxReconnects:5},Nr=class{constructor(e,o={}){if(Rt(this,Lr),Rt(this,Lt,0),Rt(this,Po,0),Rt(this,it,null),Rt(this,Nt,null),Rt(this,Oo,new Set),Rt(this,ao,new Map),this.endpoint=e,this.options={...Ep,...o},!this.options.WebSocketConstructor)throw new Error("Missing WebSocket constructor");this.endpoint.startsWith("http")&&(this.endpoint=vp(this.endpoint))}async makeRequest(e,o){let r=await Ll(this,Lr,Nl).call(this);return new Promise((i,n)=>{so(this,Lt,te(this,Lt)+1),te(this,ao).set(te(this,Lt),{resolve:i,reject:n,timeout:setTimeout(()=>{te(this,ao).delete(te(this,Lt)),n(new Error(`Request timeout: ${e}`))},this.options.callTimeout)}),r.send(JSON.stringify({jsonrpc:"2.0",id:te(this,Lt),method:e,params:o}))}).then(({error:i,result:n})=>{if(i)throw new no(i.message,i.code);return n})}async subscribe(e){let o=new _i(e);return te(this,Oo).add(o),await o.subscribe(this),()=>o.unsubscribe(this)}};Lt=new WeakMap;Po=new WeakMap;it=new WeakMap;Nt=new WeakMap;Oo=new WeakMap;ao=new WeakMap;Lr=new WeakSet;Nl=function(){return te(this,Nt)?te(this,Nt):(so(this,Nt,new Promise(t=>{te(this,it)?.close(),so(this,it,new this.options.WebSocketConstructor(this.endpoint)),te(this,it).addEventListener("open",()=>{so(this,Po,0),t(te(this,it))}),te(this,it).addEventListener("close",()=>{Tp(this,Po)._++,te(this,Po)<=this.options.maxReconnects&&setTimeout(()=>{Ll(this,Lr,Vl).call(this)},this.options.reconnectTimeout)}),te(this,it).addEventListener("message",({data:e})=>{let o;try{o=JSON.parse(e)}catch(r){console.error(new Error(`Failed to parse RPC message: ${e}`,{cause:r}));return}if("id"in o&&o.id!=null&&te(this,ao).has(o.id)){let{resolve:r,timeout:i}=te(this,ao).get(o.id);clearTimeout(i),r(o)}else if("params"in o){let{params:r}=o;te(this,Oo).forEach(i=>{i.subscriptionId===r.subscription&&r.subscription===i.subscriptionId&&i.onMessage(r.result)})}})})),te(this,Nt))};Vl=async function(){return te(this,it)?.close(),so(this,Nt,null),Promise.allSettled([...te(this,Oo)].map(t=>t.subscribe(this)))};var _i=class{constructor(e){this.subscriptionId=null,this.subscribed=!1,this.input=e}onMessage(e){this.subscribed&&this.input.onMessage(e)}async unsubscribe(e){let{subscriptionId:o}=this;return this.subscribed=!1,o==null?!1:(this.subscriptionId=null,e.makeRequest(this.input.unsubscribe,[o]))}async subscribe(e){this.subscriptionId=null,this.subscribed=!0;let o=await e.makeRequest(this.input.method,this.input.params);this.subscribed&&(this.subscriptionId=o)}};var jl=t=>{throw TypeError(t)},Hi=(t,e,o)=>e.has(t)||jl("Cannot "+o),Oe=(t,e,o)=>(Hi(t,e,"read from private field"),o?o.call(t):e.get(t)),Vr=(t,e,o)=>e.has(t)?jl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,o),$i=(t,e,o,r)=>(Hi(t,e,"write to private field"),r?r.call(t,o):e.set(t,o),o),Ap=(t,e,o)=>(Hi(t,e,"access private method"),o),Uo,je,Mo,zi,_l,jr=class{constructor(e){Vr(this,zi),Vr(this,Uo,0),Vr(this,je),Vr(this,Mo),$i(this,je,e)}fetch(e,o){let r=Oe(this,je).fetch??fetch;if(!r)throw new Error("The current environment does not support fetch, you can provide a fetch implementation in the options for SuiHTTPTransport.");return r(e,o)}async request(e){$i(this,Uo,Oe(this,Uo)+1);let o=await this.fetch(Oe(this,je).rpc?.url??Oe(this,je).url,{method:"POST",headers:{"Content-Type":"application/json","Client-Sdk-Type":"typescript","Client-Sdk-Version":Bl,"Client-Target-Api-Version":Dl,"Client-Request-Method":e.method,...Oe(this,je).rpc?.headers},body:JSON.stringify({jsonrpc:"2.0",id:Oe(this,Uo),method:e.method,params:e.params})});if(!o.ok)throw new Rr(`Unexpected status code: ${o.status}`,o.status,o.statusText);let r=await o.json();if("error"in r&&r.error!=null)throw new no(r.error.message,r.error.code);return r.result}async subscribe(e){let o=await Ap(this,zi,_l).call(this).subscribe(e);return async()=>!!await o()}};Uo=new WeakMap;je=new WeakMap;Mo=new WeakMap;zi=new WeakSet;_l=function(){if(!Oe(this,Mo)){let t=Oe(this,je).WebSocketConstructor??WebSocket;if(!t)throw new Error("The current environment does not support WebSocket, you can provide a WebSocketConstructor in the options for SuiHTTPTransport.");$i(this,Mo,new Nr(Oe(this,je).websocket?.url??Oe(this,je).url,{WebSocketConstructor:t,...Oe(this,je).websocket}))}return Oe(this,Mo)};s();a();s();a();s();a();s();a();s();a();function Ip(t){if(t.length>=255)throw new TypeError("Alphabet too long");let e=new Uint8Array(256);for(let p=0;p<e.length;p++)e[p]=255;for(let p=0;p<t.length;p++){let m=t.charAt(p),f=m.charCodeAt(0);if(e[f]!==255)throw new TypeError(m+" is ambiguous");e[f]=p}let o=t.length,r=t.charAt(0),i=Math.log(o)/Math.log(256),n=Math.log(256)/Math.log(o);function l(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";let m=0,f=0,g=0,y=p.length;for(;g!==y&&p[g]===0;)g++,m++;let C=(y-g)*n+1>>>0,S=new Uint8Array(C);for(;g!==y;){let _=p[g],$=0;for(let A=C-1;(_!==0||$<f)&&A!==-1;A--,$++)_+=256*S[A]>>>0,S[A]=_%o>>>0,_=_/o>>>0;if(_!==0)throw new Error("Non-zero carry");f=$,g++}let T=C-f;for(;T!==C&&S[T]===0;)T++;let O=r.repeat(m);for(;T<C;++T)O+=t.charAt(S[T]);return O}function c(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;let m=0,f=0,g=0;for(;p[m]===r;)f++,m++;let y=(p.length-m)*i+1>>>0,C=new Uint8Array(y);for(;p[m];){let _=e[p.charCodeAt(m)];if(_===255)return;let $=0;for(let A=y-1;(_!==0||$<g)&&A!==-1;A--,$++)_+=o*C[A]>>>0,C[A]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");g=$,m++}let S=y-g;for(;S!==y&&C[S]===0;)S++;let T=new Uint8Array(f+(y-S)),O=f;for(;S!==y;)T[O++]=C[S++];return T}function d(p){let m=c(p);if(m)return m;throw new Error("Non-base"+o+" character")}return{encode:l,decodeUnsafe:c,decode:d}}var Fl=Ip;var kp="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",qi=Fl(kp);var nt=t=>qi.encode(t),_e=t=>qi.decode(t);s();a();function he(t){return Uint8Array.from(atob(t),e=>e.charCodeAt(0))}var Gi=8192;function J(t){if(t.length<Gi)return btoa(String.fromCharCode(...t));let e="";for(var o=0;o<t.length;o+=Gi){let r=t.slice(o,o+Gi);e+=String.fromCharCode(...r)}return btoa(e)}s();a();s();a();function lo(t){let e=t.startsWith("0x")?t.slice(2):t,o=e.length%2===0?e:`0${e}`,r=o.match(/[0-9a-fA-F]{2}/g)?.map(i=>parseInt(i,16))??[];if(r.length!==o.length/2)throw new Error(`Invalid hex string ${t}`);return Uint8Array.from(r)}function Ze(t){return t.reduce((e,o)=>e+o.toString(16).padStart(2,"0"),"")}s();a();s();a();function Vt(t){let e=[],o=0;if(t===0)return[0];for(;t>0;)e[o]=t&127,(t>>=7)&&(e[o]|=128),o+=1;return e}function $l(t){let e=0,o=0,r=0;for(;;){let i=t[r];if(r+=1,e|=(i&127)<<o,!(i&128))break;o+=7}return{value:e,length:r}}var _r=class{constructor(e){this.bytePosition=0,this.dataView=new DataView(e.buffer)}shift(e){return this.bytePosition+=e,this}read8(){let e=this.dataView.getUint8(this.bytePosition);return this.shift(1),e}read16(){let e=this.dataView.getUint16(this.bytePosition,!0);return this.shift(2),e}read32(){let e=this.dataView.getUint32(this.bytePosition,!0);return this.shift(4),e}read64(){let e=this.read32(),r=this.read32().toString(16)+e.toString(16).padStart(8,"0");return BigInt("0x"+r).toString(10)}read128(){let e=BigInt(this.read64()),r=BigInt(this.read64()).toString(16)+e.toString(16).padStart(16,"0");return BigInt("0x"+r).toString(10)}read256(){let e=BigInt(this.read128()),r=BigInt(this.read128()).toString(16)+e.toString(16).padStart(32,"0");return BigInt("0x"+r).toString(10)}readBytes(e){let o=this.bytePosition+this.dataView.byteOffset,r=new Uint8Array(this.dataView.buffer,o,e);return this.shift(e),r}readULEB(){let e=this.bytePosition+this.dataView.byteOffset,o=new Uint8Array(this.dataView.buffer,e),{value:r,length:i}=$l(o);return this.shift(i),r}readVec(e){let o=this.readULEB(),r=[];for(let i=0;i<o;i++)r.push(e(this,i,o));return r}};s();a();s();a();function Wi(t,e){switch(e){case"base58":return nt(t);case"base64":return J(t);case"hex":return Ze(t);default:throw new Error("Unsupported encoding, supported values are: base64, hex")}}function Fr(t,e=["<",">"]){let[o,r]=e,i=[],n="",l=0;for(let c=0;c<t.length;c++){let d=t[c];if(d===o&&l++,d===r&&l--,l===0&&d===","){i.push(n.trim()),n="";continue}n+=d}return i.push(n.trim()),i}var $r=class{constructor({initialSize:e=1024,maxSize:o=1/0,allocateSize:r=1024}={}){this.bytePosition=0,this.size=e,this.maxSize=o,this.allocateSize=r,this.dataView=new DataView(new ArrayBuffer(e))}ensureSizeOrGrow(e){let o=this.bytePosition+e;if(o>this.size){let r=Math.min(this.maxSize,this.size+this.allocateSize);if(o>r)throw new Error(`Attempting to serialize to BCS, but buffer does not have enough size. Allocated size: ${this.size}, Max size: ${this.maxSize}, Required size: ${o}`);this.size=r;let i=new ArrayBuffer(this.size);new Uint8Array(i).set(new Uint8Array(this.dataView.buffer)),this.dataView=new DataView(i)}}shift(e){return this.bytePosition+=e,this}write8(e){return this.ensureSizeOrGrow(1),this.dataView.setUint8(this.bytePosition,Number(e)),this.shift(1)}write16(e){return this.ensureSizeOrGrow(2),this.dataView.setUint16(this.bytePosition,Number(e),!0),this.shift(2)}write32(e){return this.ensureSizeOrGrow(4),this.dataView.setUint32(this.bytePosition,Number(e),!0),this.shift(4)}write64(e){return Ki(BigInt(e),8).forEach(o=>this.write8(o)),this}write128(e){return Ki(BigInt(e),16).forEach(o=>this.write8(o)),this}write256(e){return Ki(BigInt(e),32).forEach(o=>this.write8(o)),this}writeULEB(e){return Vt(e).forEach(o=>this.write8(o)),this}writeVec(e,o){return this.writeULEB(e.length),Array.from(e).forEach((r,i)=>o(this,r,i,e.length)),this}*[Symbol.iterator](){for(let e=0;e<this.bytePosition;e++)yield this.dataView.getUint8(e);return this.toBytes()}toBytes(){return new Uint8Array(this.dataView.buffer.slice(0,this.bytePosition))}toString(e){return Wi(this.toBytes(),e)}};function Ki(t,e){let o=new Uint8Array(e),r=0;for(;t>0;)o[r]=Number(t%BigInt(256)),t=t/BigInt(256),r+=1;return o}var zl=t=>{throw TypeError(t)},Hl=(t,e,o)=>e.has(t)||zl("Cannot "+o),Fe=(t,e,o)=>(Hl(t,e,"read from private field"),o?o.call(t):e.get(t)),Hr=(t,e,o)=>e.has(t)?zl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,o),qr=(t,e,o,r)=>(Hl(t,e,"write to private field"),r?r.call(t,o):e.set(t,o),o),co,Bo,zr,gt,Pp=class ql{constructor(e){Hr(this,co),Hr(this,Bo),this.name=e.name,this.read=e.read,this.serializedSize=e.serializedSize??(()=>null),qr(this,co,e.write),qr(this,Bo,e.serialize??((o,r)=>{let i=new $r({initialSize:this.serializedSize(o)??void 0,...r});return Fe(this,co).call(this,o,i),i.toBytes()})),this.validate=e.validate??(()=>{})}write(e,o){this.validate(e),Fe(this,co).call(this,e,o)}serialize(e,o){return this.validate(e),new Gr(this,Fe(this,Bo).call(this,e,o))}parse(e){let o=new _r(e);return this.read(o)}fromHex(e){return this.parse(lo(e))}fromBase58(e){return this.parse(_e(e))}fromBase64(e){return this.parse(he(e))}transform({name:e,input:o,output:r,validate:i}){return new ql({name:e??this.name,read:n=>r?r(this.read(n)):this.read(n),write:(n,l)=>Fe(this,co).call(this,o?o(n):n,l),serializedSize:n=>this.serializedSize(o?o(n):n),serialize:(n,l)=>Fe(this,Bo).call(this,o?o(n):n,l),validate:n=>{i?.(n),this.validate(o?o(n):n)}})}};co=new WeakMap;Bo=new WeakMap;var Ue=Pp,Gl=Symbol.for("@mysten/serialized-bcs");function uo(t){return!!t&&typeof t=="object"&&t[Gl]===!0}var Gr=class{constructor(e,o){Hr(this,zr),Hr(this,gt),qr(this,zr,e),qr(this,gt,o)}get[Gl](){return!0}toBytes(){return Fe(this,gt)}toHex(){return Ze(Fe(this,gt))}toBase64(){return J(Fe(this,gt))}toBase58(){return nt(Fe(this,gt))}parse(){return Fe(this,zr).parse(Fe(this,gt))}};zr=new WeakMap;gt=new WeakMap;function Do({size:t,...e}){return new Ue({...e,serializedSize:()=>t})}function Wr({readMethod:t,writeMethod:e,...o}){return Do({...o,read:r=>r[t](),write:(r,i)=>i[e](r),validate:r=>{if(r<0||r>o.maxValue)throw new TypeError(`Invalid ${o.name} value: ${r}. Expected value in range 0-${o.maxValue}`);o.validate?.(r)}})}function Kr({readMethod:t,writeMethod:e,...o}){return Do({...o,read:r=>r[t](),write:(r,i)=>i[e](BigInt(r)),validate:r=>{let i=BigInt(r);if(i<0||i>o.maxValue)throw new TypeError(`Invalid ${o.name} value: ${i}. Expected value in range 0-${o.maxValue}`);o.validate?.(i)}})}function Wl({serialize:t,...e}){let o=new Ue({...e,serialize:t,write:(r,i)=>{for(let n of o.serialize(r).toBytes())i.write8(n)}});return o}function Kl({toBytes:t,fromBytes:e,...o}){return new Ue({...o,read:r=>{let i=r.readULEB(),n=r.readBytes(i);return e(n)},write:(r,i)=>{let n=t(r);i.writeULEB(n.length);for(let l=0;l<n.length;l++)i.write8(n[l])},serialize:r=>{let i=t(r),n=Vt(i.length),l=new Uint8Array(n.length+i.length);return l.set(n,0),l.set(i,n.length),l},validate:r=>{if(typeof r!="string")throw new TypeError(`Invalid ${o.name} value: ${r}. Expected string`);o.validate?.(r)}})}function Ql(t){let e=null;function o(){return e||(e=t()),e}return new Ue({name:"lazy",read:r=>o().read(r),serializedSize:r=>o().serializedSize(r),write:(r,i)=>o().write(r,i),serialize:(r,i)=>o().serialize(r,i).toBytes()})}s();a();var u={u8(t){return Wr({name:"u8",readMethod:"read8",writeMethod:"write8",size:1,maxValue:2**8-1,...t})},u16(t){return Wr({name:"u16",readMethod:"read16",writeMethod:"write16",size:2,maxValue:2**16-1,...t})},u32(t){return Wr({name:"u32",readMethod:"read32",writeMethod:"write32",size:4,maxValue:2**32-1,...t})},u64(t){return Kr({name:"u64",readMethod:"read64",writeMethod:"write64",size:8,maxValue:2n**64n-1n,...t})},u128(t){return Kr({name:"u128",readMethod:"read128",writeMethod:"write128",size:16,maxValue:2n**128n-1n,...t})},u256(t){return Kr({name:"u256",readMethod:"read256",writeMethod:"write256",size:32,maxValue:2n**256n-1n,...t})},bool(t){return Do({name:"bool",size:1,read:e=>e.read8()===1,write:(e,o)=>o.write8(e?1:0),...t,validate:e=>{if(t?.validate?.(e),typeof e!="boolean")throw new TypeError(`Expected boolean, found ${typeof e}`)}})},uleb128(t){return Wl({name:"uleb128",read:e=>e.readULEB(),serialize:e=>Uint8Array.from(Vt(e)),...t})},bytes(t,e){return Do({name:`bytes[${t}]`,size:t,read:o=>o.readBytes(t),write:(o,r)=>{let i=new Uint8Array(o);for(let n=0;n<t;n++)r.write8(i[n]??0)},...e,validate:o=>{if(e?.validate?.(o),!o||typeof o!="object"||!("length"in o))throw new TypeError(`Expected array, found ${typeof o}`);if(o.length!==t)throw new TypeError(`Expected array of length ${t}, found ${o.length}`)}})},byteVector(t){return new Ue({name:"bytesVector",read:e=>{let o=e.readULEB();return e.readBytes(o)},write:(e,o)=>{let r=new Uint8Array(e);o.writeULEB(r.length);for(let i=0;i<r.length;i++)o.write8(r[i]??0)},...t,serializedSize:e=>{let o="length"in e?e.length:null;return o==null?null:Vt(o).length+o},validate:e=>{if(t?.validate?.(e),!e||typeof e!="object"||!("length"in e))throw new TypeError(`Expected array, found ${typeof e}`)}})},string(t){return Kl({name:"string",toBytes:e=>new TextEncoder().encode(e),fromBytes:e=>new TextDecoder().decode(e),...t})},fixedArray(t,e,o){return new Ue({name:`${e.name}[${t}]`,read:r=>{let i=new Array(t);for(let n=0;n<t;n++)i[n]=e.read(r);return i},write:(r,i)=>{for(let n of r)e.write(n,i)},...o,validate:r=>{if(o?.validate?.(r),!r||typeof r!="object"||!("length"in r))throw new TypeError(`Expected array, found ${typeof r}`);if(r.length!==t)throw new TypeError(`Expected array of length ${t}, found ${r.length}`)}})},option(t){return u.enum(`Option<${t.name}>`,{None:null,Some:t}).transform({input:e=>e==null?{None:!0}:{Some:e},output:e=>e.$kind==="Some"?e.Some:null})},vector(t,e){return new Ue({name:`vector<${t.name}>`,read:o=>{let r=o.readULEB(),i=new Array(r);for(let n=0;n<r;n++)i[n]=t.read(o);return i},write:(o,r)=>{r.writeULEB(o.length);for(let i of o)t.write(i,r)},...e,validate:o=>{if(e?.validate?.(o),!o||typeof o!="object"||!("length"in o))throw new TypeError(`Expected array, found ${typeof o}`)}})},tuple(t,e){return new Ue({name:`(${t.map(o=>o.name).join(", ")})`,serializedSize:o=>{let r=0;for(let i=0;i<t.length;i++){let n=t[i].serializedSize(o[i]);if(n==null)return null;r+=n}return r},read:o=>{let r=[];for(let i of t)r.push(i.read(o));return r},write:(o,r)=>{for(let i=0;i<t.length;i++)t[i].write(o[i],r)},...e,validate:o=>{if(e?.validate?.(o),!Array.isArray(o))throw new TypeError(`Expected array, found ${typeof o}`);if(o.length!==t.length)throw new TypeError(`Expected array of length ${t.length}, found ${o.length}`)}})},struct(t,e,o){let r=Object.entries(e);return new Ue({name:t,serializedSize:i=>{let n=0;for(let[l,c]of r){let d=c.serializedSize(i[l]);if(d==null)return null;n+=d}return n},read:i=>{let n={};for(let[l,c]of r)n[l]=c.read(i);return n},write:(i,n)=>{for(let[l,c]of r)c.write(i[l],n)},...o,validate:i=>{if(o?.validate?.(i),typeof i!="object"||i==null)throw new TypeError(`Expected object, found ${typeof i}`)}})},enum(t,e,o){let r=Object.entries(e);return new Ue({name:t,read:i=>{let n=i.readULEB(),l=r[n];if(!l)throw new TypeError(`Unknown value ${n} for enum ${t}`);let[c,d]=l;return{[c]:d?.read(i)??!0,$kind:c}},write:(i,n)=>{let[l,c]=Object.entries(i).filter(([d])=>Object.hasOwn(e,d))[0];for(let d=0;d<r.length;d++){let[p,m]=r[d];if(p===l){n.writeULEB(d),m?.write(c,n);return}}},...o,validate:i=>{if(o?.validate?.(i),typeof i!="object"||i==null)throw new TypeError(`Expected object, found ${typeof i}`);let n=Object.keys(i).filter(c=>i[c]!==void 0&&Object.hasOwn(e,c));if(n.length!==1)throw new TypeError(`Expected object with one key, but found ${n.length} for type ${t}}`);let[l]=n;if(!Object.hasOwn(e,l))throw new TypeError(`Invalid enum variant ${l}`)}})},map(t,e){return u.vector(u.tuple([t,e])).transform({name:`Map<${t.name}, ${e.name}>`,input:o=>[...o.entries()],output:o=>{let r=new Map;for(let[i,n]of o)r.set(i,n);return r}})},lazy(t){return Ql(t)}};s();a();s();a();s();a();s();a();s();a();var Op=32;function Qr(t){try{return _e(t).length===Op}catch{return!1}}var Ro=32;function ve(t){return Up(t)&&Mp(t)===Ro}function po(t){return ve(t)}function M(t,e=!1){let o=t.toLowerCase();return!e&&o.startsWith("0x")&&(o=o.slice(2)),`0x${o.padStart(Ro*2,"0")}`}function Se(t,e=!1){return M(t,e)}function Up(t){return/^(0x|0X)?[a-fA-F0-9]+$/.test(t)&&t.length%2===0}function Mp(t){return/^(0x|0X)/.test(t)?(t.length-2)/2:t.length/2}s();a();var Bp=/^vector<(.+)>$/,Dp=/^([^:]+)::([^:]+)::([^<]+)(<(.+)>)?/,st=class t{static parseFromStr(e,o=!1){if(e==="address")return{address:null};if(e==="bool")return{bool:null};if(e==="u8")return{u8:null};if(e==="u16")return{u16:null};if(e==="u32")return{u32:null};if(e==="u64")return{u64:null};if(e==="u128")return{u128:null};if(e==="u256")return{u256:null};if(e==="signer")return{signer:null};let r=e.match(Bp);if(r)return{vector:t.parseFromStr(r[1],o)};let i=e.match(Dp);if(i)return{struct:{address:o?M(i[1]):i[1],module:i[2],name:i[3],typeParams:i[5]===void 0?[]:t.parseStructTypeArgs(i[5],o)}};throw new Error(`Encountered unexpected token when parsing type args for ${e}`)}static parseStructTypeArgs(e,o=!1){return Fr(e).map(r=>t.parseFromStr(r,o))}static tagToString(e){if("bool"in e)return"bool";if("u8"in e)return"u8";if("u16"in e)return"u16";if("u32"in e)return"u32";if("u64"in e)return"u64";if("u128"in e)return"u128";if("u256"in e)return"u256";if("address"in e)return"address";if("signer"in e)return"signer";if("vector"in e)return`vector<${t.tagToString(e.vector)}>`;if("struct"in e){let o=e.struct,r=o.typeParams.map(t.tagToString).join(", ");return`${o.address}::${o.module}::${o.name}${r?`<${r}>`:""}`}throw new Error("Invalid TypeTag")}};function Rp(t){return u.u64({name:"unsafe_u64",...t}).transform({input:e=>e,output:e=>Number(e)})}function Lp(t){return u.enum("Option",{None:null,Some:t})}var H=u.bytes(Ro).transform({validate:t=>{let e=typeof t=="string"?t:Ze(t);if(!e||!ve(M(e)))throw new Error(`Invalid Sui address ${e}`)},input:t=>typeof t=="string"?lo(M(t)):t,output:t=>M(Ze(t))}),Ee=u.vector(u.u8()).transform({name:"ObjectDigest",input:t=>_e(t),output:t=>nt(new Uint8Array(t)),validate:t=>{if(_e(t).length!==32)throw new Error("ObjectDigest must be 32 bytes")}}),we=u.struct("SuiObjectRef",{objectId:H,version:u.u64(),digest:Ee}),Qi=u.struct("SharedObjectRef",{objectId:H,initialSharedVersion:u.u64(),mutable:u.bool()}),Yi=u.enum("ObjectArg",{ImmOrOwnedObject:we,SharedObject:Qi,Receiving:we}),Xi=u.enum("CallArg",{Pure:u.struct("Pure",{bytes:u.vector(u.u8()).transform({input:t=>typeof t=="string"?he(t):t,output:t=>J(new Uint8Array(t))})}),Object:Yi}),Ji=u.enum("TypeTag",{bool:null,u8:null,u64:null,u128:null,address:null,signer:null,vector:u.lazy(()=>Ji),struct:u.lazy(()=>nn),u16:null,u32:null,u256:null}),Yr=Ji.transform({input:t=>typeof t=="string"?st.parseFromStr(t,!0):t,output:t=>st.tagToString(t)}),$e=u.enum("Argument",{GasCoin:null,Input:u.u16(),Result:u.u16(),NestedResult:u.tuple([u.u16(),u.u16()])}),Zi=u.struct("ProgrammableMoveCall",{package:H,module:u.string(),function:u.string(),typeArguments:u.vector(Yr),arguments:u.vector($e)}),en=u.enum("Command",{MoveCall:Zi,TransferObjects:u.struct("TransferObjects",{objects:u.vector($e),address:$e}),SplitCoins:u.struct("SplitCoins",{coin:$e,amounts:u.vector($e)}),MergeCoins:u.struct("MergeCoins",{destination:$e,sources:u.vector($e)}),Publish:u.struct("Publish",{modules:u.vector(u.vector(u.u8()).transform({input:t=>typeof t=="string"?he(t):t,output:t=>J(new Uint8Array(t))})),dependencies:u.vector(H)}),MakeMoveVec:u.struct("MakeMoveVec",{type:Lp(Yr).transform({input:t=>t===null?{None:!0}:{Some:t},output:t=>t.Some??null}),elements:u.vector($e)}),Upgrade:u.struct("Upgrade",{modules:u.vector(u.vector(u.u8()).transform({input:t=>typeof t=="string"?he(t):t,output:t=>J(new Uint8Array(t))})),dependencies:u.vector(H),package:H,ticket:$e})}),tn=u.struct("ProgrammableTransaction",{inputs:u.vector(Xi),commands:u.vector(en)}),on=u.enum("TransactionKind",{ProgrammableTransaction:tn,ChangeEpoch:null,Genesis:null,ConsensusCommitPrologue:null}),rn=u.enum("TransactionExpiration",{None:null,Epoch:Rp()}),nn=u.struct("StructTag",{address:H,module:u.string(),name:u.string(),typeParams:u.vector(Ji)}),sn=u.struct("GasData",{payment:u.vector(we),owner:H,price:u.u64(),budget:u.u64()}),an=u.struct("TransactionDataV1",{kind:on,sender:H,gasData:sn,expiration:rn}),ln=u.enum("TransactionData",{V1:an}),cn=u.enum("IntentScope",{TransactionData:null,TransactionEffects:null,CheckpointSummary:null,PersonalMessage:null}),un=u.enum("IntentVersion",{V0:null}),dn=u.enum("AppId",{Sui:null}),pn=u.struct("Intent",{scope:cn,version:un,appId:dn});function mn(t){return u.struct(`IntentMessage<${t.name}>`,{intent:pn,value:t})}var fn=u.enum("CompressedSignature",{ED25519:u.fixedArray(64,u.u8()),Secp256k1:u.fixedArray(64,u.u8()),Secp256r1:u.fixedArray(64,u.u8()),ZkLogin:u.vector(u.u8())}),hn=u.enum("PublicKey",{ED25519:u.fixedArray(32,u.u8()),Secp256k1:u.fixedArray(33,u.u8()),Secp256r1:u.fixedArray(33,u.u8()),ZkLogin:u.vector(u.u8())}),bn=u.struct("MultiSigPkMap",{pubKey:hn,weight:u.u8()}),yn=u.struct("MultiSigPublicKey",{pk_map:u.vector(bn),threshold:u.u16()}),Yl=u.struct("MultiSig",{sigs:u.vector(fn),bitmap:u.u16(),multisig_pk:yn}),Np=u.vector(u.u8()).transform({input:t=>typeof t=="string"?he(t):t,output:t=>J(new Uint8Array(t))}),gn=u.struct("SenderSignedTransaction",{intentMessage:mn(ln),txSignatures:u.vector(Np)}),Xl=u.vector(gn,{name:"SenderSignedData"}),Jl=u.struct("PasskeyAuthenticator",{authenticatorData:u.vector(u.u8()),clientDataJson:u.string(),userSignature:u.vector(u.u8())});s();a();var Vp=u.enum("PackageUpgradeError",{UnableToFetchPackage:u.struct("UnableToFetchPackage",{packageId:H}),NotAPackage:u.struct("NotAPackage",{objectId:H}),IncompatibleUpgrade:null,DigestDoesNotMatch:u.struct("DigestDoesNotMatch",{digest:u.vector(u.u8())}),UnknownUpgradePolicy:u.struct("UnknownUpgradePolicy",{policy:u.u8()}),PackageIDDoesNotMatch:u.struct("PackageIDDoesNotMatch",{packageId:H,ticketId:H})}),jp=u.struct("ModuleId",{address:H,name:u.string()}),Zl=u.struct("MoveLocation",{module:jp,function:u.u16(),instruction:u.u16(),functionName:u.option(u.string())}),_p=u.enum("CommandArgumentError",{TypeMismatch:null,InvalidBCSBytes:null,InvalidUsageOfPureArg:null,InvalidArgumentToPrivateEntryFunction:null,IndexOutOfBounds:u.struct("IndexOutOfBounds",{idx:u.u16()}),SecondaryIndexOutOfBounds:u.struct("SecondaryIndexOutOfBounds",{resultIdx:u.u16(),secondaryIdx:u.u16()}),InvalidResultArity:u.struct("InvalidResultArity",{resultIdx:u.u16()}),InvalidGasCoinUsage:null,InvalidValueUsage:null,InvalidObjectByValue:null,InvalidObjectByMutRef:null,SharedObjectOperationNotAllowed:null}),Fp=u.enum("TypeArgumentError",{TypeNotFound:null,ConstraintNotSatisfied:null}),$p=u.enum("ExecutionFailureStatus",{InsufficientGas:null,InvalidGasObject:null,InvariantViolation:null,FeatureNotYetSupported:null,MoveObjectTooBig:u.struct("MoveObjectTooBig",{objectSize:u.u64(),maxObjectSize:u.u64()}),MovePackageTooBig:u.struct("MovePackageTooBig",{objectSize:u.u64(),maxObjectSize:u.u64()}),CircularObjectOwnership:u.struct("CircularObjectOwnership",{object:H}),InsufficientCoinBalance:null,CoinBalanceOverflow:null,PublishErrorNonZeroAddress:null,SuiMoveVerificationError:null,MovePrimitiveRuntimeError:u.option(Zl),MoveAbort:u.tuple([Zl,u.u64()]),VMVerificationOrDeserializationError:null,VMInvariantViolation:null,FunctionNotFound:null,ArityMismatch:null,TypeArityMismatch:null,NonEntryFunctionInvoked:null,CommandArgumentError:u.struct("CommandArgumentError",{argIdx:u.u16(),kind:_p}),TypeArgumentError:u.struct("TypeArgumentError",{argumentIdx:u.u16(),kind:Fp}),UnusedValueWithoutDrop:u.struct("UnusedValueWithoutDrop",{resultIdx:u.u16(),secondaryIdx:u.u16()}),InvalidPublicFunctionReturnType:u.struct("InvalidPublicFunctionReturnType",{idx:u.u16()}),InvalidTransferObject:null,EffectsTooLarge:u.struct("EffectsTooLarge",{currentSize:u.u64(),maxSize:u.u64()}),PublishUpgradeMissingDependency:null,PublishUpgradeDependencyDowngrade:null,PackageUpgradeError:u.struct("PackageUpgradeError",{upgradeError:Vp}),WrittenObjectsTooLarge:u.struct("WrittenObjectsTooLarge",{currentSize:u.u64(),maxSize:u.u64()}),CertificateDenied:null,SuiMoveVerificationTimedout:null,SharedObjectOperationNotAllowed:null,InputObjectDeleted:null,ExecutionCancelledDueToSharedObjectCongestion:u.struct("ExecutionCancelledDueToSharedObjectCongestion",{congestedObjects:u.vector(H)}),AddressDeniedForCoin:u.struct("AddressDeniedForCoin",{address:H,coinType:u.string()}),CoinTypeGlobalPause:u.struct("CoinTypeGlobalPause",{coinType:u.string()}),ExecutionCancelledDueToRandomnessUnavailable:null}),ec=u.enum("ExecutionStatus",{Success:null,Failed:u.struct("ExecutionFailed",{error:$p,command:u.option(u.u64())})}),tc=u.struct("GasCostSummary",{computationCost:u.u64(),storageCost:u.u64(),storageRebate:u.u64(),nonRefundableStorageFee:u.u64()}),mo=u.enum("Owner",{AddressOwner:H,ObjectOwner:H,Shared:u.struct("Shared",{initialSharedVersion:u.u64()}),Immutable:null}),zp=u.struct("TransactionEffectsV1",{status:ec,executedEpoch:u.u64(),gasUsed:tc,modifiedAtVersions:u.vector(u.tuple([H,u.u64()])),sharedObjects:u.vector(we),transactionDigest:Ee,created:u.vector(u.tuple([we,mo])),mutated:u.vector(u.tuple([we,mo])),unwrapped:u.vector(u.tuple([we,mo])),deleted:u.vector(we),unwrappedThenDeleted:u.vector(we),wrapped:u.vector(we),gasObject:u.tuple([we,mo]),eventsDigest:u.option(Ee),dependencies:u.vector(Ee)}),Cn=u.tuple([u.u64(),Ee]),Hp=u.enum("ObjectIn",{NotExist:null,Exist:u.tuple([Cn,mo])}),qp=u.enum("ObjectOut",{NotExist:null,ObjectWrite:u.tuple([Ee,mo]),PackageWrite:Cn}),Gp=u.enum("IDOperation",{None:null,Created:null,Deleted:null}),Wp=u.struct("EffectsObjectChange",{inputState:Hp,outputState:qp,idOperation:Gp}),Kp=u.enum("UnchangedSharedKind",{ReadOnlyRoot:Cn,MutateDeleted:u.u64(),ReadDeleted:u.u64(),Cancelled:u.u64(),PerEpochConfig:null}),Qp=u.struct("TransactionEffectsV2",{status:ec,executedEpoch:u.u64(),gasUsed:tc,transactionDigest:Ee,gasObjectIndex:u.option(u.u32()),eventsDigest:u.option(Ee),dependencies:u.vector(Ee),lamportVersion:u.u64(),changedObjects:u.vector(u.tuple([H,Wp])),unchangedSharedObjects:u.vector(u.tuple([H,Kp])),auxDataDigest:u.option(Ee)}),oc=u.enum("TransactionEffects",{V1:zp,V2:Qp});s();a();function fo(t){switch(t){case"u8":return u.u8();case"u16":return u.u16();case"u32":return u.u32();case"u64":return u.u64();case"u128":return u.u128();case"u256":return u.u256();case"bool":return u.bool();case"string":return u.string();case"id":case"address":return H}let e=t.match(/^(vector|option)<(.+)>$/);if(e){let[o,r]=e.slice(1);return o==="vector"?u.vector(fo(r)):u.option(fo(r))}throw new Error(`Invalid Pure type name: ${t}`)}var D={...u,U8:u.u8(),U16:u.u16(),U32:u.u32(),U64:u.u64(),U128:u.u128(),U256:u.u256(),ULEB128:u.uleb128(),Bool:u.bool(),String:u.string(),Address:H,AppId:dn,Argument:$e,CallArg:Xi,CompressedSignature:fn,GasData:sn,Intent:pn,IntentMessage:mn,IntentScope:cn,IntentVersion:un,MultiSig:Yl,MultiSigPkMap:bn,MultiSigPublicKey:yn,ObjectArg:Yi,ObjectDigest:Ee,ProgrammableMoveCall:Zi,ProgrammableTransaction:tn,PublicKey:hn,SenderSignedData:Xl,SenderSignedTransaction:gn,SharedObjectRef:Qi,StructTag:nn,SuiObjectRef:we,Command:en,TransactionData:ln,TransactionDataV1:an,TransactionExpiration:rn,TransactionKind:on,TypeTag:Yr,TransactionEffects:oc,PasskeyAuthenticator:Jl};s();a();s();a();var Yp=/^(?!.*(^(?!@)|[-.@])($|[-.@]))(?:[a-z0-9-]{0,63}(?:\.[a-z0-9-]{0,63})*)?@[a-z0-9-]{0,63}$/i,Xp=/^(?!.*(^|[-.])($|[-.]))(?:[a-z0-9-]{0,63}\.)+sui$/i;function rc(t,e="at"){let o=t.toLowerCase(),r;if(o.includes("@")){if(!Yp.test(o))throw new Error(`Invalid SuiNS name ${t}`);let[i,n]=o.split("@");r=[...i?i.split("."):[],n]}else{if(!Xp.test(o))throw new Error(`Invalid SuiNS name ${t}`);r=o.split(".").slice(0,-1)}return e==="dot"?`${r.join(".")}.sui`:`${r.slice(0,-1).join(".")}@${r[r.length-1]}`}s();a();var Jp=BigInt(1e9),Sn="0x1",Xr="0x2";var Zp=Se("0x6");var wn=`${Xr}::sui::SUI`,em=Se("0x5");s();a();s();a();s();a();function Jr(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function tm(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function xn(t,...e){if(!tm(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Tn(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ic(t,e){xn(t);let o=e.outputLen;if(t.length<o)throw new Error(`digestInto() expects output buffer of length at least ${o}`)}s();a();var ho=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));var Ct=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,nc=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255,ze=Ct?t=>t:t=>nc(t);function jt(t){for(let e=0;e<t.length;e++)t[e]=nc(t[e])}function om(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function _t(t){return typeof t=="string"&&(t=om(t)),xn(t),t}var Zr=class{clone(){return this._cloneInto()}},iA={}.toString;function sc(t){let e=(r,i)=>t(i).update(_t(r)).digest(),o=t({});return e.outputLen=o.outputLen,e.blockLen=o.blockLen,e.create=r=>t(r),e}var ac=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3]),ei=class extends Zr{constructor(e,o,r={},i,n,l){if(super(),this.blockLen=e,this.outputLen=o,this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,Jr(e),Jr(o),Jr(i),o<0||o>i)throw new Error("outputLen bigger than keyLen");if(r.key!==void 0&&(r.key.length<1||r.key.length>i))throw new Error(`key must be up 1..${i} byte long or undefined`);if(r.salt!==void 0&&r.salt.length!==n)throw new Error(`salt must be ${n} byte long or undefined`);if(r.personalization!==void 0&&r.personalization.length!==l)throw new Error(`personalization must be ${l} byte long or undefined`);this.buffer32=ho(this.buffer=new Uint8Array(e))}update(e){Tn(this);let{blockLen:o,buffer:r,buffer32:i}=this;e=_t(e);let n=e.length,l=e.byteOffset,c=e.buffer;for(let d=0;d<n;){this.pos===o&&(Ct||jt(i),this.compress(i,0,!1),Ct||jt(i),this.pos=0);let p=Math.min(o-this.pos,n-d),m=l+d;if(p===o&&!(m%4)&&d+p<n){let f=new Uint32Array(c,m,Math.floor((n-d)/4));Ct||jt(f);for(let g=0;d+o<n;g+=i.length,d+=o)this.length+=o,this.compress(f,g,!1);Ct||jt(f);continue}r.set(e.subarray(d,d+p),this.pos),this.pos+=p,this.length+=p,d+=p}return this}digestInto(e){Tn(this),ic(e,this);let{pos:o,buffer32:r}=this;this.finished=!0,this.buffer.subarray(o).fill(0),Ct||jt(r),this.compress(r,0,!0),Ct||jt(r);let i=ho(e);this.get().forEach((n,l)=>i[l]=ze(n))}digest(){let{buffer:e,outputLen:o}=this;this.digestInto(e);let r=e.slice(0,o);return this.destroy(),r}_cloneInto(e){let{buffer:o,length:r,finished:i,destroyed:n,outputLen:l,pos:c}=this;return e||(e=new this.constructor({dkLen:l})),e.set(...this.get()),e.length=r,e.finished=i,e.destroyed=n,e.outputLen=l,e.buffer.set(o),e.pos=c,e}};s();a();var ti=BigInt(4294967295),vn=BigInt(32);function lc(t,e=!1){return e?{h:Number(t&ti),l:Number(t>>vn&ti)}:{h:Number(t>>vn&ti)|0,l:Number(t&ti)|0}}function rm(t,e=!1){let o=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:n,l}=lc(t[i],e);[o[i],r[i]]=[n,l]}return[o,r]}var im=(t,e)=>BigInt(t>>>0)<<vn|BigInt(e>>>0),nm=(t,e,o)=>t>>>o,sm=(t,e,o)=>t<<32-o|e>>>o,am=(t,e,o)=>t>>>o|e<<32-o,lm=(t,e,o)=>t<<32-o|e>>>o,cm=(t,e,o)=>t<<64-o|e>>>o-32,um=(t,e,o)=>t>>>o-32|e<<64-o,dm=(t,e)=>e,pm=(t,e)=>t,mm=(t,e,o)=>t<<o|e>>>32-o,fm=(t,e,o)=>e<<o|t>>>32-o,hm=(t,e,o)=>e<<o-32|t>>>64-o,bm=(t,e,o)=>t<<o-32|e>>>64-o;function ym(t,e,o,r){let i=(e>>>0)+(r>>>0);return{h:t+o+(i/2**32|0)|0,l:i|0}}var gm=(t,e,o)=>(t>>>0)+(e>>>0)+(o>>>0),Cm=(t,e,o,r)=>e+o+r+(t/2**32|0)|0,Sm=(t,e,o,r)=>(t>>>0)+(e>>>0)+(o>>>0)+(r>>>0),wm=(t,e,o,r,i)=>e+o+r+i+(t/2**32|0)|0,xm=(t,e,o,r,i)=>(t>>>0)+(e>>>0)+(o>>>0)+(r>>>0)+(i>>>0),Tm=(t,e,o,r,i,n)=>e+o+r+i+n+(t/2**32|0)|0;var vm={fromBig:lc,split:rm,toBig:im,shrSH:nm,shrSL:sm,rotrSH:am,rotrSL:lm,rotrBH:cm,rotrBL:um,rotr32H:dm,rotr32L:pm,rotlSH:mm,rotlSL:fm,rotlBH:hm,rotlBL:bm,add:ym,add3L:gm,add3H:Cm,add4L:Sm,add4H:wm,add5H:Tm,add5L:xm},be=vm;var ue=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),x=new Uint32Array(32);function St(t,e,o,r,i,n){let l=i[n],c=i[n+1],d=x[2*t],p=x[2*t+1],m=x[2*e],f=x[2*e+1],g=x[2*o],y=x[2*o+1],C=x[2*r],S=x[2*r+1],T=be.add3L(d,m,l);p=be.add3H(T,p,f,c),d=T|0,{Dh:S,Dl:C}={Dh:S^p,Dl:C^d},{Dh:S,Dl:C}={Dh:be.rotr32H(S,C),Dl:be.rotr32L(S,C)},{h:y,l:g}=be.add(y,g,S,C),{Bh:f,Bl:m}={Bh:f^y,Bl:m^g},{Bh:f,Bl:m}={Bh:be.rotrSH(f,m,24),Bl:be.rotrSL(f,m,24)},x[2*t]=d,x[2*t+1]=p,x[2*e]=m,x[2*e+1]=f,x[2*o]=g,x[2*o+1]=y,x[2*r]=C,x[2*r+1]=S}function wt(t,e,o,r,i,n){let l=i[n],c=i[n+1],d=x[2*t],p=x[2*t+1],m=x[2*e],f=x[2*e+1],g=x[2*o],y=x[2*o+1],C=x[2*r],S=x[2*r+1],T=be.add3L(d,m,l);p=be.add3H(T,p,f,c),d=T|0,{Dh:S,Dl:C}={Dh:S^p,Dl:C^d},{Dh:S,Dl:C}={Dh:be.rotrSH(S,C,16),Dl:be.rotrSL(S,C,16)},{h:y,l:g}=be.add(y,g,S,C),{Bh:f,Bl:m}={Bh:f^y,Bl:m^g},{Bh:f,Bl:m}={Bh:be.rotrBH(f,m,63),Bl:be.rotrBL(f,m,63)},x[2*t]=d,x[2*t+1]=p,x[2*e]=m,x[2*e+1]=f,x[2*o]=g,x[2*o+1]=y,x[2*r]=C,x[2*r+1]=S}var En=class extends ei{constructor(e={}){super(128,e.dkLen===void 0?64:e.dkLen,e,64,16,16),this.v0l=ue[0]|0,this.v0h=ue[1]|0,this.v1l=ue[2]|0,this.v1h=ue[3]|0,this.v2l=ue[4]|0,this.v2h=ue[5]|0,this.v3l=ue[6]|0,this.v3h=ue[7]|0,this.v4l=ue[8]|0,this.v4h=ue[9]|0,this.v5l=ue[10]|0,this.v5h=ue[11]|0,this.v6l=ue[12]|0,this.v6h=ue[13]|0,this.v7l=ue[14]|0,this.v7h=ue[15]|0;let o=e.key?e.key.length:0;if(this.v0l^=this.outputLen|o<<8|65536|1<<24,e.salt){let r=ho(_t(e.salt));this.v4l^=ze(r[0]),this.v4h^=ze(r[1]),this.v5l^=ze(r[2]),this.v5h^=ze(r[3])}if(e.personalization){let r=ho(_t(e.personalization));this.v6l^=ze(r[0]),this.v6h^=ze(r[1]),this.v7l^=ze(r[2]),this.v7h^=ze(r[3])}if(e.key){let r=new Uint8Array(this.blockLen);r.set(_t(e.key)),this.update(r)}}get(){let{v0l:e,v0h:o,v1l:r,v1h:i,v2l:n,v2h:l,v3l:c,v3h:d,v4l:p,v4h:m,v5l:f,v5h:g,v6l:y,v6h:C,v7l:S,v7h:T}=this;return[e,o,r,i,n,l,c,d,p,m,f,g,y,C,S,T]}set(e,o,r,i,n,l,c,d,p,m,f,g,y,C,S,T){this.v0l=e|0,this.v0h=o|0,this.v1l=r|0,this.v1h=i|0,this.v2l=n|0,this.v2h=l|0,this.v3l=c|0,this.v3h=d|0,this.v4l=p|0,this.v4h=m|0,this.v5l=f|0,this.v5h=g|0,this.v6l=y|0,this.v6h=C|0,this.v7l=S|0,this.v7h=T|0}compress(e,o,r){this.get().forEach((d,p)=>x[p]=d),x.set(ue,16);let{h:i,l:n}=be.fromBig(BigInt(this.length));x[24]=ue[8]^n,x[25]=ue[9]^i,r&&(x[28]=~x[28],x[29]=~x[29]);let l=0,c=ac;for(let d=0;d<12;d++)St(0,4,8,12,e,o+2*c[l++]),wt(0,4,8,12,e,o+2*c[l++]),St(1,5,9,13,e,o+2*c[l++]),wt(1,5,9,13,e,o+2*c[l++]),St(2,6,10,14,e,o+2*c[l++]),wt(2,6,10,14,e,o+2*c[l++]),St(3,7,11,15,e,o+2*c[l++]),wt(3,7,11,15,e,o+2*c[l++]),St(0,5,10,15,e,o+2*c[l++]),wt(0,5,10,15,e,o+2*c[l++]),St(1,6,11,12,e,o+2*c[l++]),wt(1,6,11,12,e,o+2*c[l++]),St(2,7,8,13,e,o+2*c[l++]),wt(2,7,8,13,e,o+2*c[l++]),St(3,4,9,14,e,o+2*c[l++]),wt(3,4,9,14,e,o+2*c[l++]);this.v0l^=x[0]^x[16],this.v0h^=x[1]^x[17],this.v1l^=x[2]^x[18],this.v1h^=x[3]^x[19],this.v2l^=x[4]^x[20],this.v2h^=x[5]^x[21],this.v3l^=x[6]^x[22],this.v3h^=x[7]^x[23],this.v4l^=x[8]^x[24],this.v4h^=x[9]^x[25],this.v5l^=x[10]^x[26],this.v5h^=x[11]^x[27],this.v6l^=x[12]^x[28],this.v6h^=x[13]^x[29],this.v7l^=x[14]^x[30],this.v7h^=x[15]^x[31],x.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},cc=sc(t=>new En(t));var Em="object",Am="ID",Im="ascii",km="String",Pm="string",Om="String",Um="option",Mm="Option";function uc(t){let e=typeof t.body=="object"&&"datatype"in t.body?t.body.datatype:null;return!!e&&M(e.package)===M("0x2")&&e.module==="tx_context"&&e.type==="TxContext"}function oi(t){if(typeof t=="string")switch(t){case"address":return D.Address;case"bool":return D.Bool;case"u8":return D.U8;case"u16":return D.U16;case"u32":return D.U32;case"u64":return D.U64;case"u128":return D.U128;case"u256":return D.U256;default:throw new Error(`Unknown type signature ${t}`)}if("vector"in t){if(t.vector==="u8")return D.vector(D.U8).transform({input:o=>typeof o=="string"?new TextEncoder().encode(o):o,output:o=>o});let e=oi(t.vector);return e?D.vector(e):null}if("datatype"in t){let e=M(t.datatype.package);if(e===M(Sn)){if(t.datatype.module===Im&&t.datatype.type===km)return D.String;if(t.datatype.module===Pm&&t.datatype.type===Om)return D.String;if(t.datatype.module===Um&&t.datatype.type===Mm){let o=oi(t.datatype.typeParameters[0]);return o?D.vector(o):null}}if(e===M(Xr)&&t.datatype.module===Em&&t.datatype.type===Am)return D.Address}return null}function dc(t){return typeof t=="object"&&"Reference"in t?{ref:"&",body:Lo(t.Reference)}:typeof t=="object"&&"MutableReference"in t?{ref:"&mut",body:Lo(t.MutableReference)}:{ref:null,body:Lo(t)}}function Lo(t){if(typeof t=="string")switch(t){case"Address":return"address";case"Bool":return"bool";case"U8":return"u8";case"U16":return"u16";case"U32":return"u32";case"U64":return"u64";case"U128":return"u128";case"U256":return"u256";default:throw new Error(`Unexpected type ${t}`)}if("Vector"in t)return{vector:Lo(t.Vector)};if("Struct"in t)return{datatype:{package:t.Struct.address,module:t.Struct.module,type:t.Struct.name,typeParameters:t.Struct.typeArguments.map(Lo)}};if("TypeParameter"in t)return{typeParameter:t.TypeParameter};throw new Error(`Unexpected type ${JSON.stringify(t)}`)}s();a();function Bm(t){return{$kind:"Pure",Pure:{bytes:t instanceof Uint8Array?J(t):t.toBase64()}}}var He={Pure:Bm,ObjectRef({objectId:t,digest:e,version:o}){return{$kind:"Object",Object:{$kind:"ImmOrOwnedObject",ImmOrOwnedObject:{digest:e,version:o,objectId:M(t)}}}},SharedObjectRef({objectId:t,mutable:e,initialSharedVersion:o}){return{$kind:"Object",Object:{$kind:"SharedObject",SharedObject:{mutable:e,initialSharedVersion:o,objectId:M(t)}}}},ReceivingRef({objectId:t,digest:e,version:o}){return{$kind:"Object",Object:{$kind:"Receiving",Receiving:{digest:e,version:o,objectId:M(t)}}}}};s();a();s();a();function Tt(t){let e=Object.entries(t).map(([o,r])=>w({[o]:r}));return F(ce(e),ir(o=>({...o,$kind:Object.keys(o)[0]})))}var Ft=F(k(),ir(t=>M(t)),Yt(ve)),ge=Ft,xt=k(),ye=F(ce([k(),F(W(),X())]),Yt(t=>{try{return BigInt(t),BigInt(t)>=0&&BigInt(t)<=18446744073709551615n}catch{return!1}},"Invalid u64")),qe=w({objectId:Ft,version:ye,digest:k()}),G=F(ce([w({GasCoin:I(!0)}),w({Input:F(W(),X()),type:pe(I("pure"))}),w({Input:F(W(),X()),type:pe(I("object"))}),w({Result:F(W(),X())}),w({NestedResult:nr([F(W(),X()),F(W(),X())])})]),ir(t=>({...t,$kind:Object.keys(t)[0]}))),Dm=w({budget:V(ye),price:V(ye),owner:V(Ft),payment:V(E(qe))}),qA=w({address:k(),module:k(),name:k(),typeParams:E(k())}),An=ce([I("address"),I("bool"),I("u8"),I("u16"),I("u32"),I("u64"),I("u128"),I("u256"),w({vector:Jt(()=>An)}),w({datatype:w({package:k(),module:k(),type:k(),typeParameters:E(Jt(()=>An))})}),w({typeParameter:F(W(),X())})]),Rm=w({ref:V(ce([I("&"),I("&mut")])),body:An}),Lm=w({package:ge,module:k(),function:k(),typeArguments:E(k()),arguments:E(G),_argumentTypes:pe(V(E(Rm)))}),Nm=w({name:k(),inputs:Zt(k(),ce([G,E(G)])),data:Zt(k(),et())}),Vm=Tt({MoveCall:Lm,TransferObjects:w({objects:E(G),address:G}),SplitCoins:w({coin:G,amounts:E(G)}),MergeCoins:w({destination:G,sources:E(G)}),Publish:w({modules:E(xt),dependencies:E(ge)}),MakeMoveVec:w({type:V(k()),elements:E(G)}),Upgrade:w({modules:E(xt),dependencies:E(ge),package:ge,ticket:G}),$Intent:Nm}),pc=Tt({ImmOrOwnedObject:qe,SharedObject:w({objectId:ge,initialSharedVersion:ye,mutable:Xt()}),Receiving:qe}),jm=Tt({Object:pc,Pure:w({bytes:xt}),UnresolvedPure:w({value:et()}),UnresolvedObject:w({objectId:ge,version:pe(V(ye)),digest:pe(V(k())),initialSharedVersion:pe(V(ye))})}),In=Tt({Object:pc,Pure:w({bytes:xt})}),kn=Tt({None:I(!0),Epoch:ye}),bo=w({version:I(2),sender:ht(Ft),expiration:ht(kn),gasData:Dm,inputs:E(jm),commands:E(Vm)});var vt={MoveCall(t){let[e,o="",r=""]="target"in t?t.target.split("::"):[t.package,t.module,t.function];return{$kind:"MoveCall",MoveCall:{package:e,module:o,function:r,typeArguments:t.typeArguments??[],arguments:t.arguments??[]}}},TransferObjects(t,e){return{$kind:"TransferObjects",TransferObjects:{objects:t.map(o=>z(G,o)),address:z(G,e)}}},SplitCoins(t,e){return{$kind:"SplitCoins",SplitCoins:{coin:z(G,t),amounts:e.map(o=>z(G,o))}}},MergeCoins(t,e){return{$kind:"MergeCoins",MergeCoins:{destination:z(G,t),sources:e.map(o=>z(G,o))}}},Publish({modules:t,dependencies:e}){return{$kind:"Publish",Publish:{modules:t.map(o=>typeof o=="string"?o:J(new Uint8Array(o))),dependencies:e.map(o=>Se(o))}}},Upgrade({modules:t,dependencies:e,package:o,ticket:r}){return{$kind:"Upgrade",Upgrade:{modules:t.map(i=>typeof i=="string"?i:J(new Uint8Array(i))),dependencies:e.map(i=>Se(i)),package:o,ticket:z(G,r)}}},MakeMoveVec({type:t,elements:e}){return{$kind:"MakeMoveVec",MakeMoveVec:{type:t??null,elements:e.map(o=>z(G,o))}}},Intent({name:t,inputs:e={},data:o={}}){return{$kind:"$Intent",$Intent:{name:t,inputs:Object.fromEntries(Object.entries(e).map(([r,i])=>[r,Array.isArray(i)?i.map(n=>z(G,n)):z(G,i)])),data:o}}}};s();a();s();a();var Pn=w({digest:k(),objectId:k(),version:ce([F(W(),X()),k(),bi()])}),_m=Tt({ImmOrOwned:Pn,Shared:w({objectId:ge,initialSharedVersion:ye,mutable:Xt()}),Receiving:Pn}),mc=Tt({Object:_m,Pure:E(F(W(),X()))}),hc=ce([w({kind:I("Input"),index:F(W(),X()),value:et(),type:pe(I("object"))}),w({kind:I("Input"),index:F(W(),X()),value:et(),type:I("pure")})]),Fm=ce([w({Epoch:F(W(),X())}),w({None:V(I(!0))})]),fc=F(ce([W(),k(),bi()]),Yt(t=>{if(!["string","number","bigint"].includes(typeof t))return!1;try{return BigInt(t),!0}catch{return!1}})),On=ce([w({bool:V(I(!0))}),w({u8:V(I(!0))}),w({u64:V(I(!0))}),w({u128:V(I(!0))}),w({address:V(I(!0))}),w({signer:V(I(!0))}),w({vector:Jt(()=>On)}),w({struct:Jt(()=>$m)}),w({u16:V(I(!0))}),w({u32:V(I(!0))}),w({u256:V(I(!0))})]),$m=w({address:k(),module:k(),name:k(),typeParams:E(On)}),zm=w({budget:pe(fc),price:pe(fc),payment:pe(E(Pn)),owner:pe(k())}),Hm=[hc,w({kind:I("GasCoin")}),w({kind:I("Result"),index:F(W(),X())}),w({kind:I("NestedResult"),index:F(W(),X()),resultIndex:F(W(),X())})],ct=ce([...Hm]),qm=w({kind:I("MoveCall"),target:F(k(),Yt(t=>t.split("::").length===3)),typeArguments:E(k()),arguments:E(ct)}),Gm=w({kind:I("TransferObjects"),objects:E(ct),address:ct}),Wm=w({kind:I("SplitCoins"),coin:ct,amounts:E(ct)}),Km=w({kind:I("MergeCoins"),destination:ct,sources:E(ct)}),Qm=w({kind:I("MakeMoveVec"),type:ce([w({Some:On}),w({None:V(I(!0))})]),objects:E(ct)}),Ym=w({kind:I("Publish"),modules:E(E(F(W(),X()))),dependencies:E(k())}),Xm=w({kind:I("Upgrade"),modules:E(E(F(W(),X()))),dependencies:E(k()),packageId:k(),ticket:ct}),Jm=[qm,Gm,Wm,Km,Ym,Xm,Qm],Zm=ce([...Jm]),sI=w({version:I(1),sender:pe(k()),expiration:ht(Fm),gasConfig:zm,inputs:E(hc),transactions:E(Zm)});function Un(t){let e=t.inputs.map((o,r)=>{if(o.Object)return{kind:"Input",index:r,value:{Object:o.Object.ImmOrOwnedObject?{ImmOrOwned:o.Object.ImmOrOwnedObject}:o.Object.Receiving?{Receiving:{digest:o.Object.Receiving.digest,version:o.Object.Receiving.version,objectId:o.Object.Receiving.objectId}}:{Shared:{mutable:o.Object.SharedObject.mutable,initialSharedVersion:o.Object.SharedObject.initialSharedVersion,objectId:o.Object.SharedObject.objectId}}},type:"object"};if(o.Pure)return{kind:"Input",index:r,value:{Pure:Array.from(he(o.Pure.bytes))},type:"pure"};if(o.UnresolvedPure)return{kind:"Input",type:"pure",index:r,value:o.UnresolvedPure.value};if(o.UnresolvedObject)return{kind:"Input",type:"object",index:r,value:o.UnresolvedObject.objectId};throw new Error("Invalid input")});return{version:1,sender:t.sender??void 0,expiration:t.expiration?.$kind==="Epoch"?{Epoch:Number(t.expiration.Epoch)}:t.expiration?{None:!0}:null,gasConfig:{owner:t.gasData.owner??void 0,budget:t.gasData.budget??void 0,price:t.gasData.price??void 0,payment:t.gasData.payment??void 0},inputs:e,transactions:t.commands.map(o=>{if(o.MakeMoveVec)return{kind:"MakeMoveVec",type:o.MakeMoveVec.type===null?{None:!0}:{Some:st.parseFromStr(o.MakeMoveVec.type)},objects:o.MakeMoveVec.elements.map(r=>at(r,e))};if(o.MergeCoins)return{kind:"MergeCoins",destination:at(o.MergeCoins.destination,e),sources:o.MergeCoins.sources.map(r=>at(r,e))};if(o.MoveCall)return{kind:"MoveCall",target:`${o.MoveCall.package}::${o.MoveCall.module}::${o.MoveCall.function}`,typeArguments:o.MoveCall.typeArguments,arguments:o.MoveCall.arguments.map(r=>at(r,e))};if(o.Publish)return{kind:"Publish",modules:o.Publish.modules.map(r=>Array.from(he(r))),dependencies:o.Publish.dependencies};if(o.SplitCoins)return{kind:"SplitCoins",coin:at(o.SplitCoins.coin,e),amounts:o.SplitCoins.amounts.map(r=>at(r,e))};if(o.TransferObjects)return{kind:"TransferObjects",objects:o.TransferObjects.objects.map(r=>at(r,e)),address:at(o.TransferObjects.address,e)};if(o.Upgrade)return{kind:"Upgrade",modules:o.Upgrade.modules.map(r=>Array.from(he(r))),dependencies:o.Upgrade.dependencies,packageId:o.Upgrade.package,ticket:at(o.Upgrade.ticket,e)};throw new Error(`Unknown transaction ${Object.keys(o)}`)})}}function at(t,e){if(t.$kind==="GasCoin")return{kind:"GasCoin"};if(t.$kind==="Result")return{kind:"Result",index:t.Result};if(t.$kind==="NestedResult")return{kind:"NestedResult",index:t.NestedResult[0],resultIndex:t.NestedResult[1]};if(t.$kind==="Input")return e[t.Input];throw new Error(`Invalid argument ${Object.keys(t)}`)}function bc(t){return z(bo,{version:2,sender:t.sender??null,expiration:t.expiration?"Epoch"in t.expiration?{Epoch:t.expiration.Epoch}:{None:!0}:null,gasData:{owner:t.gasConfig.owner??null,budget:t.gasConfig.budget?.toString()??null,price:t.gasConfig.price?.toString()??null,payment:t.gasConfig.payment?.map(e=>({digest:e.digest,objectId:e.objectId,version:e.version.toString()}))??null},inputs:t.inputs.map(e=>{if(e.kind==="Input"){if(xo(mc,e.value)){let o=z(mc,e.value);if(o.Object){if(o.Object.ImmOrOwned)return{Object:{ImmOrOwnedObject:{objectId:o.Object.ImmOrOwned.objectId,version:String(o.Object.ImmOrOwned.version),digest:o.Object.ImmOrOwned.digest}}};if(o.Object.Shared)return{Object:{SharedObject:{mutable:o.Object.Shared.mutable??null,initialSharedVersion:o.Object.Shared.initialSharedVersion,objectId:o.Object.Shared.objectId}}};if(o.Object.Receiving)return{Object:{Receiving:{digest:o.Object.Receiving.digest,version:String(o.Object.Receiving.version),objectId:o.Object.Receiving.objectId}}};throw new Error("Invalid object input")}return{Pure:{bytes:J(new Uint8Array(o.Pure))}}}return e.type==="object"?{UnresolvedObject:{objectId:e.value}}:{UnresolvedPure:{value:e.value}}}throw new Error("Invalid input")}),commands:t.transactions.map(e=>{switch(e.kind){case"MakeMoveVec":return{MakeMoveVec:{type:"Some"in e.type?st.tagToString(e.type.Some):null,elements:e.objects.map(o=>lt(o))}};case"MergeCoins":return{MergeCoins:{destination:lt(e.destination),sources:e.sources.map(o=>lt(o))}};case"MoveCall":{let[o,r,i]=e.target.split("::");return{MoveCall:{package:o,module:r,function:i,typeArguments:e.typeArguments,arguments:e.arguments.map(n=>lt(n))}}}case"Publish":return{Publish:{modules:e.modules.map(o=>J(Uint8Array.from(o))),dependencies:e.dependencies}};case"SplitCoins":return{SplitCoins:{coin:lt(e.coin),amounts:e.amounts.map(o=>lt(o))}};case"TransferObjects":return{TransferObjects:{objects:e.objects.map(o=>lt(o)),address:lt(e.address)}};case"Upgrade":return{Upgrade:{modules:e.modules.map(o=>J(Uint8Array.from(o))),dependencies:e.dependencies,package:e.packageId,ticket:lt(e.ticket)}}}throw new Error(`Unknown transaction ${Object.keys(e)}`)})})}function lt(t){switch(t.kind){case"GasCoin":return{GasCoin:!0};case"Result":return{Result:t.index};case"NestedResult":return{NestedResult:[t.index,t.resultIndex]};case"Input":return{Input:t.index}}}s();a();function No(t){return ce(Object.entries(t).map(([e,o])=>w({[e]:o})))}var Ge=No({GasCoin:I(!0),Input:F(W(),X()),Result:F(W(),X()),NestedResult:nr([F(W(),X()),F(W(),X())])}),ef=w({budget:V(ye),price:V(ye),owner:V(Ft),payment:V(E(qe))}),tf=w({package:ge,module:k(),function:k(),typeArguments:E(k()),arguments:E(Ge)}),of=w({name:k(),inputs:Zt(k(),ce([Ge,E(Ge)])),data:Zt(k(),et())}),rf=No({MoveCall:tf,TransferObjects:w({objects:E(Ge),address:Ge}),SplitCoins:w({coin:Ge,amounts:E(Ge)}),MergeCoins:w({destination:Ge,sources:E(Ge)}),Publish:w({modules:E(xt),dependencies:E(ge)}),MakeMoveVec:w({type:V(k()),elements:E(Ge)}),Upgrade:w({modules:E(xt),dependencies:E(ge),package:ge,ticket:Ge}),$Intent:of}),nf=No({ImmOrOwnedObject:qe,SharedObject:w({objectId:ge,initialSharedVersion:ye,mutable:Xt()}),Receiving:qe}),sf=No({Object:nf,Pure:w({bytes:xt}),UnresolvedPure:w({value:et()}),UnresolvedObject:w({objectId:ge,version:pe(V(ye)),digest:pe(V(k())),initialSharedVersion:pe(V(ye))})}),af=No({None:I(!0),Epoch:ye}),yc=w({version:I(2),sender:ht(Ft),expiration:ht(af),gasData:ef,inputs:E(sf),commands:E(rf)});s();a();var lf=50,cf=1000n,uf=5e10;async function Cc(t,e,o){return await hf(t,e),await ff(t,e),e.onlyTransactionKind||(await df(t,e),await pf(t,e),await mf(t,e)),await bf(t),await o()}async function df(t,e){t.gasConfig.price||(t.gasConfig.price=String(await Vo(e).getReferenceGasPrice()))}async function pf(t,e){if(t.gasConfig.budget)return;let o=await Vo(e).dryRunTransactionBlock({transactionBlock:t.build({overrides:{gasData:{budget:String(uf),payment:[]}}})});if(o.effects.status.status!=="success")throw new Error(`Dry run failed, could not automatically determine a budget: ${o.effects.status.error}`,{cause:o});let r=cf*BigInt(t.gasConfig.price||1n),i=BigInt(o.effects.gasUsed.computationCost)+r,n=i+BigInt(o.effects.gasUsed.storageCost)-BigInt(o.effects.gasUsed.storageRebate);t.gasConfig.budget=String(n>i?n:i)}async function mf(t,e){if(!t.gasConfig.payment){let r=(await Vo(e).getCoins({owner:t.gasConfig.owner||t.sender,coinType:wn})).data.filter(i=>!t.inputs.find(l=>l.Object?.ImmOrOwnedObject?i.coinObjectId===l.Object.ImmOrOwnedObject.objectId:!1)).map(i=>({objectId:i.coinObjectId,digest:i.digest,version:i.version}));if(!r.length)throw new Error("No valid gas coins found for the transaction.");t.gasConfig.payment=r.map(i=>z(qe,i))}}async function ff(t,e){let o=t.inputs.filter(m=>m.UnresolvedObject&&!(m.UnresolvedObject.version||m.UnresolvedObject?.initialSharedVersion)),r=[...new Set(o.map(m=>Se(m.UnresolvedObject.objectId)))],i=r.length?Sf(r,lf):[],n=(await Promise.all(i.map(m=>Vo(e).multiGetObjects({ids:m,options:{showOwner:!0}})))).flat(),l=new Map(r.map((m,f)=>[m,n[f]])),c=Array.from(l).filter(([m,f])=>f.error).map(([m,f])=>JSON.stringify(f.error));if(c.length)throw new Error(`The following input objects are invalid: ${c.join(", ")}`);let d=n.map(m=>{if(m.error||!m.data)throw new Error(`Failed to fetch object: ${m.error}`);let f=m.data.owner,g=f&&typeof f=="object"&&"Shared"in f?f.Shared.initial_shared_version:null;return{objectId:m.data.objectId,digest:m.data.digest,version:m.data.version,initialSharedVersion:g}}),p=new Map(r.map((m,f)=>[m,d[f]]));for(let[m,f]of t.inputs.entries()){if(!f.UnresolvedObject)continue;let g,y=M(f.UnresolvedObject.objectId),C=p.get(y);f.UnresolvedObject.initialSharedVersion??C?.initialSharedVersion?g=He.SharedObjectRef({objectId:y,initialSharedVersion:f.UnresolvedObject.initialSharedVersion||C?.initialSharedVersion,mutable:yf(t,m)}):gf(t,m)&&(g=He.ReceivingRef({objectId:y,digest:f.UnresolvedObject.digest??C?.digest,version:f.UnresolvedObject.version??C?.version})),t.inputs[t.inputs.indexOf(f)]=g??He.ObjectRef({objectId:y,digest:f.UnresolvedObject.digest??C?.digest,version:f.UnresolvedObject.version??C?.version})}}async function hf(t,e){let{inputs:o,commands:r}=t,i=[],n=new Set;r.forEach(c=>{if(c.MoveCall){if(c.MoveCall._argumentTypes)return;if(c.MoveCall.arguments.map(m=>m.$kind==="Input"?t.inputs[m.Input]:null).some(m=>m?.UnresolvedPure||m?.UnresolvedObject)){let m=`${c.MoveCall.package}::${c.MoveCall.module}::${c.MoveCall.function}`;n.add(m),i.push(c.MoveCall)}}switch(c.$kind){case"SplitCoins":c.SplitCoins.amounts.forEach(d=>{gc(d,D.U64,t)});break;case"TransferObjects":gc(c.TransferObjects.address,D.Address,t);break}});let l=new Map;if(n.size>0){let c=Vo(e);await Promise.all([...n].map(async d=>{let[p,m,f]=d.split("::"),g=await c.getNormalizedMoveFunction({package:p,module:m,function:f});l.set(d,g.parameters.map(y=>dc(y)))}))}i.length&&await Promise.all(i.map(async c=>{let d=l.get(`${c.package}::${c.module}::${c.function}`);if(!d)return;let m=d.length>0&&uc(d.at(-1))?d.slice(0,d.length-1):d;c._argumentTypes=m})),r.forEach(c=>{if(!c.MoveCall)return;let d=c.MoveCall,p=`${d.package}::${d.module}::${d.function}`,m=d._argumentTypes;if(m){if(m.length!==c.MoveCall.arguments.length)throw new Error(`Incorrect number of arguments for ${p}`);m.forEach((f,g)=>{let y=d.arguments[g];if(y.$kind!=="Input")return;let C=o[y.Input];if(!C.UnresolvedPure&&!C.UnresolvedObject)return;let S=C.UnresolvedPure?.value??C.UnresolvedObject?.objectId,T=oi(f.body);if(T){y.type="pure",o[o.indexOf(C)]=He.Pure(T.serialize(S));return}if(typeof S!="string")throw new Error(`Expect the argument to be an object id string, got ${JSON.stringify(S,null,2)}`);y.type="object";let O=C.UnresolvedPure?{$kind:"UnresolvedObject",UnresolvedObject:{objectId:S}}:C;o[y.Input]=O})}})}function bf(t){t.inputs.forEach((e,o)=>{if(e.$kind!=="Object"&&e.$kind!=="Pure")throw new Error(`Input at index ${o} has not been resolved.  Expected a Pure or Object input, but found ${JSON.stringify(e)}`)})}function gc(t,e,o){if(t.$kind!=="Input")return;let r=o.inputs[t.Input];r.$kind==="UnresolvedPure"&&(o.inputs[t.Input]=He.Pure(e.serialize(r.UnresolvedPure.value)))}function yf(t,e){let o=!1;return t.getInputUses(e,(r,i)=>{if(i.MoveCall&&i.MoveCall._argumentTypes){let n=i.MoveCall.arguments.indexOf(r);o=i.MoveCall._argumentTypes[n].ref!=="&"||o}(i.$kind==="MakeMoveVec"||i.$kind==="MergeCoins"||i.$kind==="SplitCoins")&&(o=!0)}),o}function gf(t,e){let o=!1;return t.getInputUses(e,(r,i)=>{if(i.MoveCall&&i.MoveCall._argumentTypes){let n=i.MoveCall.arguments.indexOf(r);o=Cf(i.MoveCall._argumentTypes[n])||o}}),o}function Cf(t){return typeof t.body!="object"||!("datatype"in t.body)?!1:t.body.datatype.package==="0x2"&&t.body.datatype.module==="transfer"&&t.body.datatype.type==="Receiving"}function Vo(t){if(!t.client)throw new Error("No sui client passed to Transaction#build, but transaction data was not sufficient to build offline.");return t.client}function Sf(t,e){return Array.from({length:Math.ceil(t.length/e)},(o,r)=>t.slice(r*e,r*e+e))}s();a();function Sc(t){function e(o){return t(o)}return e.system=()=>e("0x5"),e.clock=()=>e("0x6"),e.random=()=>e("0x8"),e.denyList=()=>e("0x403"),e.option=({type:o,value:r})=>i=>i.moveCall({typeArguments:[o],target:`0x1::option::${r===null?"none":"some"}`,arguments:r===null?[]:[i.object(r)]}),e}s();a();function wc(t){function e(o,r){if(typeof o=="string")return t(fo(o).serialize(r));if(o instanceof Uint8Array||uo(o))return t(o);throw new Error("tx.pure must be called either a bcs type name, or a serialized bcs value")}return e.u8=o=>t(D.U8.serialize(o)),e.u16=o=>t(D.U16.serialize(o)),e.u32=o=>t(D.U32.serialize(o)),e.u64=o=>t(D.U64.serialize(o)),e.u128=o=>t(D.U128.serialize(o)),e.u256=o=>t(D.U256.serialize(o)),e.bool=o=>t(D.Bool.serialize(o)),e.string=o=>t(D.String.serialize(o)),e.address=o=>t(D.Address.serialize(o)),e.id=e.address,e.vector=(o,r)=>t(D.vector(fo(o)).serialize(r)),e.option=(o,r)=>t(D.option(fo(o)).serialize(r)),e}s();a();s();a();function xc(t,e){let o=Array.from(`${t}::`).map(i=>i.charCodeAt(0)),r=new Uint8Array(o.length+e.length);return r.set(o),r.set(e,o.length),cc(r,{dkLen:32})}function Tc(t){return M(t).replace("0x","")}var Et=class t{constructor(e){this.version=2,this.sender=e?.sender??null,this.expiration=e?.expiration??null,this.inputs=e?.inputs??[],this.commands=e?.commands??[],this.gasData=e?.gasData??{budget:null,price:null,owner:null,payment:null}}static fromKindBytes(e){let r=D.TransactionKind.parse(e).ProgrammableTransaction;if(!r)throw new Error("Unable to deserialize from bytes.");return t.restore({version:2,sender:null,expiration:null,gasData:{budget:null,owner:null,payment:null,price:null},inputs:r.inputs,commands:r.commands})}static fromBytes(e){let r=D.TransactionData.parse(e)?.V1,i=r.kind.ProgrammableTransaction;if(!r||!i)throw new Error("Unable to deserialize from bytes.");return t.restore({version:2,sender:r.sender,expiration:r.expiration,gasData:r.gasData,inputs:i.inputs,commands:i.commands})}static restore(e){return e.version===2?new t(z(bo,e)):new t(z(bo,bc(e)))}static getDigestFromBytes(e){let o=xc("TransactionData",e);return nt(o)}get gasConfig(){return this.gasData}set gasConfig(e){this.gasData=e}build({maxSizeBytes:e=1/0,overrides:o,onlyTransactionKind:r}={}){let i=this.inputs,n=this.commands,l={ProgrammableTransaction:{inputs:i,commands:n}};if(r)return D.TransactionKind.serialize(l,{maxSize:e}).toBytes();let c=o?.expiration??this.expiration,d=o?.sender??this.sender,p={...this.gasData,...o?.gasConfig,...o?.gasData};if(!d)throw new Error("Missing transaction sender");if(!p.budget)throw new Error("Missing gas budget");if(!p.payment)throw new Error("Missing gas payment");if(!p.price)throw new Error("Missing gas price");let m={sender:Tc(d),expiration:c||{None:!0},gasData:{payment:p.payment,owner:Tc(this.gasData.owner??d),price:BigInt(p.price),budget:BigInt(p.budget)},kind:{ProgrammableTransaction:{inputs:i,commands:n}}};return D.TransactionData.serialize({V1:m},{maxSize:e}).toBytes()}addInput(e,o){let r=this.inputs.length;return this.inputs.push(o),{Input:r,type:e,$kind:"Input"}}getInputUses(e,o){this.mapArguments((r,i)=>(r.$kind==="Input"&&r.Input===e&&o(r,i),r))}mapArguments(e){for(let o of this.commands)switch(o.$kind){case"MoveCall":o.MoveCall.arguments=o.MoveCall.arguments.map(i=>e(i,o));break;case"TransferObjects":o.TransferObjects.objects=o.TransferObjects.objects.map(i=>e(i,o)),o.TransferObjects.address=e(o.TransferObjects.address,o);break;case"SplitCoins":o.SplitCoins.coin=e(o.SplitCoins.coin,o),o.SplitCoins.amounts=o.SplitCoins.amounts.map(i=>e(i,o));break;case"MergeCoins":o.MergeCoins.destination=e(o.MergeCoins.destination,o),o.MergeCoins.sources=o.MergeCoins.sources.map(i=>e(i,o));break;case"MakeMoveVec":o.MakeMoveVec.elements=o.MakeMoveVec.elements.map(i=>e(i,o));break;case"Upgrade":o.Upgrade.ticket=e(o.Upgrade.ticket,o);break;case"$Intent":let r=o.$Intent.inputs;o.$Intent.inputs={};for(let[i,n]of Object.entries(r))o.$Intent.inputs[i]=Array.isArray(n)?n.map(l=>e(l,o)):e(n,o);break;case"Publish":break;default:throw new Error(`Unexpected transaction kind: ${o.$kind}`)}}replaceCommand(e,o){if(!Array.isArray(o)){this.commands[e]=o;return}let r=o.length-1;this.commands.splice(e,1,...o),r!==0&&this.mapArguments(i=>{switch(i.$kind){case"Result":i.Result>e&&(i.Result+=r);break;case"NestedResult":i.NestedResult[0]>e&&(i.NestedResult[0]+=r);break}return i})}getDigest(){let e=this.build({onlyTransactionKind:!1});return t.getDigestFromBytes(e)}snapshot(){return z(bo,this)}};s();a();function Mn(t){if(typeof t=="string")return M(t);if(t.Object)return t.Object.ImmOrOwnedObject?M(t.Object.ImmOrOwnedObject.objectId):t.Object.Receiving?M(t.Object.Receiving.objectId):M(t.Object.SharedObject.objectId);if(t.UnresolvedObject)return M(t.UnresolvedObject.objectId)}var Ac=t=>{throw TypeError(t)},Ln=(t,e,o)=>e.has(t)||Ac("Cannot "+o),R=(t,e,o)=>(Ln(t,e,"read from private field"),o?o.call(t):e.get(t)),jo=(t,e,o)=>e.has(t)?Ac("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,o),$t=(t,e,o,r)=>(Ln(t,e,"write to private field"),r?r.call(t,o):e.set(t,o),o),ut=(t,e,o)=>(Ln(t,e,"access private method"),o),Fo,$o,zt,N,We,ri,Nn,Dn,Vn;function vc(t,e=1/0){let o={$kind:"Result",Result:t},r=[],i=n=>r[n]??(r[n]={$kind:"NestedResult",NestedResult:[t,n]});return new Proxy(o,{set(){throw new Error("The transaction result is a proxy, and does not support setting properties directly")},get(n,l){if(l in n)return Reflect.get(n,l);if(l===Symbol.iterator)return function*(){let d=0;for(;d<e;)yield i(d),d++};if(typeof l=="symbol")return;let c=parseInt(l,10);if(!(Number.isNaN(c)||c<0))return i(c)}})}var Ic=Symbol.for("@mysten/transaction");function ii(t){return!!t&&typeof t=="object"&&t[Ic]===!0}var Ec={buildPlugins:new Map,serializationPlugins:new Map},Bn=Symbol.for("@mysten/transaction/registry");function _o(){try{let t=globalThis;return t[Bn]||(t[Bn]=Ec),t[Bn]}catch{return Ec}}var wf=class Rn{constructor(){jo(this,We),jo(this,Fo),jo(this,$o),jo(this,zt,new Map),jo(this,N),this.object=Sc(o=>{if(typeof o=="function")return this.object(o(this));if(typeof o=="object"&&xo(G,o))return o;let r=Mn(o),i=R(this,N).inputs.find(n=>r===Mn(n));return i?.Object?.SharedObject&&typeof o=="object"&&o.Object?.SharedObject&&(i.Object.SharedObject.mutable=i.Object.SharedObject.mutable||o.Object.SharedObject.mutable),i?{$kind:"Input",Input:R(this,N).inputs.indexOf(i),type:"object"}:R(this,N).addInput("object",typeof o=="string"?{$kind:"UnresolvedObject",UnresolvedObject:{objectId:M(o)}}:o)});let e=_o();$t(this,N,new Et),$t(this,$o,[...e.buildPlugins.values()]),$t(this,Fo,[...e.serializationPlugins.values()])}static fromKind(e){let o=new Rn;return $t(o,N,Et.fromKindBytes(typeof e=="string"?he(e):e)),o}static from(e){let o=new Rn;return ii(e)?$t(o,N,new Et(e.getData())):typeof e!="string"||!e.startsWith("{")?$t(o,N,Et.fromBytes(typeof e=="string"?he(e):e)):$t(o,N,Et.restore(JSON.parse(e))),o}static registerGlobalSerializationPlugin(e,o){_o().serializationPlugins.set(e,o??e)}static unregisterGlobalSerializationPlugin(e){_o().serializationPlugins.delete(e)}static registerGlobalBuildPlugin(e,o){_o().buildPlugins.set(e,o??e)}static unregisterGlobalBuildPlugin(e){_o().buildPlugins.delete(e)}addSerializationPlugin(e){R(this,Fo).push(e)}addBuildPlugin(e){R(this,$o).push(e)}addIntentResolver(e,o){if(R(this,zt).has(e)&&R(this,zt).get(e)!==o)throw new Error(`Intent resolver for ${e} already exists`);R(this,zt).set(e,o)}setSender(e){R(this,N).sender=e}setSenderIfNotSet(e){R(this,N).sender||(R(this,N).sender=e)}setExpiration(e){R(this,N).expiration=e?z(kn,e):null}setGasPrice(e){R(this,N).gasConfig.price=String(e)}setGasBudget(e){R(this,N).gasConfig.budget=String(e)}setGasBudgetIfNotSet(e){R(this,N).gasData.budget==null&&(R(this,N).gasConfig.budget=String(e))}setGasOwner(e){R(this,N).gasConfig.owner=e}setGasPayment(e){R(this,N).gasConfig.payment=e.map(o=>z(qe,o))}get blockData(){return Un(R(this,N).snapshot())}getData(){return R(this,N).snapshot()}get[Ic](){return!0}get pure(){return Object.defineProperty(this,"pure",{enumerable:!1,value:wc(e=>uo(e)?R(this,N).addInput("pure",{$kind:"Pure",Pure:{bytes:e.toBase64()}}):R(this,N).addInput("pure",xo(In,e)?z(In,e):e instanceof Uint8Array?He.Pure(e):{$kind:"UnresolvedPure",UnresolvedPure:{value:e}}))}),this.pure}get gas(){return{$kind:"GasCoin",GasCoin:!0}}objectRef(...e){return this.object(He.ObjectRef(...e))}receivingRef(...e){return this.object(He.ReceivingRef(...e))}sharedObjectRef(...e){return this.object(He.SharedObjectRef(...e))}add(e){if(typeof e=="function")return e(this);let o=R(this,N).commands.push(e);return vc(o-1)}splitCoins(e,o){let r=vt.SplitCoins(typeof e=="string"?this.object(e):ut(this,We,Nn).call(this,e),o.map(n=>typeof n=="number"||typeof n=="bigint"||typeof n=="string"?this.pure.u64(n):ut(this,We,ri).call(this,n))),i=R(this,N).commands.push(r);return vc(i-1,o.length)}mergeCoins(e,o){return this.add(vt.MergeCoins(this.object(e),o.map(r=>this.object(r))))}publish({modules:e,dependencies:o}){return this.add(vt.Publish({modules:e,dependencies:o}))}upgrade({modules:e,dependencies:o,package:r,ticket:i}){return this.add(vt.Upgrade({modules:e,dependencies:o,package:r,ticket:this.object(i)}))}moveCall({arguments:e,...o}){return this.add(vt.MoveCall({...o,arguments:e?.map(r=>ut(this,We,ri).call(this,r))}))}transferObjects(e,o){return this.add(vt.TransferObjects(e.map(r=>this.object(r)),typeof o=="string"?this.pure.address(o):ut(this,We,ri).call(this,o)))}makeMoveVec({type:e,elements:o}){return this.add(vt.MakeMoveVec({type:e,elements:o.map(r=>this.object(r))}))}serialize(){return JSON.stringify(Un(R(this,N).snapshot()))}async toJSON(e={}){return await this.prepareForSerialization(e),JSON.stringify(z(yc,R(this,N).snapshot()),(o,r)=>typeof r=="bigint"?r.toString():r,2)}async sign(e){let{signer:o,...r}=e,i=await this.build(r);return o.signTransaction(i)}async build(e={}){return await this.prepareForSerialization(e),await ut(this,We,Dn).call(this,e),R(this,N).build({onlyTransactionKind:e.onlyTransactionKind})}async getDigest(e={}){return await ut(this,We,Dn).call(this,e),R(this,N).getDigest()}async prepareForSerialization(e){let o=new Set;for(let i of R(this,N).commands)i.$Intent&&o.add(i.$Intent.name);let r=[...R(this,Fo)];for(let i of o)if(!e.supportedIntents?.includes(i)){if(!R(this,zt).has(i))throw new Error(`Missing intent resolver for ${i}`);r.push(R(this,zt).get(i))}await ut(this,We,Vn).call(this,r,e)}};Fo=new WeakMap;$o=new WeakMap;zt=new WeakMap;N=new WeakMap;We=new WeakSet;ri=function(t){return uo(t)?this.pure(t):ut(this,We,Nn).call(this,t)};Nn=function(t){return typeof t=="function"?z(G,t(this)):z(G,t)};Dn=async function(t){if(!t.onlyTransactionKind&&!R(this,N).sender)throw new Error("Missing transaction sender");await ut(this,We,Vn).call(this,[...R(this,$o),Cc],t)};Vn=async function(t,e){let o=r=>{if(r>=t.length)return()=>{};let i=t[r];return async()=>{let n=o(r+1),l=!1,c=!1;if(await i(R(this,N),e,async()=>{if(l)throw new Error(`next() was call multiple times in TransactionPlugin ${r}`);l=!0,await n(),c=!0}),!l)throw new Error(`next() was not called in TransactionPlugin ${r}`);if(!c)throw new Error(`next() was not awaited in TransactionPlugin ${r}`)}};await o(0)()};var jn=wf;var xf=Symbol.for("@mysten/SuiClient");var zo=class{get[xf](){return!0}constructor(e){this.transport=e.transport??new jr({url:e.url})}async getRpcApiVersion(){return(await this.transport.request({method:"rpc.discover",params:[]})).info.version}async getCoins(e){if(!e.owner||!ve(M(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getCoins",params:[e.owner,e.coinType,e.cursor,e.limit]})}async getAllCoins(e){if(!e.owner||!ve(M(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getAllCoins",params:[e.owner,e.cursor,e.limit]})}async getBalance(e){if(!e.owner||!ve(M(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getBalance",params:[e.owner,e.coinType]})}async getAllBalances(e){if(!e.owner||!ve(M(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getAllBalances",params:[e.owner]})}async getCoinMetadata(e){return await this.transport.request({method:"suix_getCoinMetadata",params:[e.coinType]})}async getTotalSupply(e){return await this.transport.request({method:"suix_getTotalSupply",params:[e.coinType]})}async call(e,o){return await this.transport.request({method:e,params:o})}async getMoveFunctionArgTypes(e){return await this.transport.request({method:"sui_getMoveFunctionArgTypes",params:[e.package,e.module,e.function]})}async getNormalizedMoveModulesByPackage(e){return await this.transport.request({method:"sui_getNormalizedMoveModulesByPackage",params:[e.package]})}async getNormalizedMoveModule(e){return await this.transport.request({method:"sui_getNormalizedMoveModule",params:[e.package,e.module]})}async getNormalizedMoveFunction(e){return await this.transport.request({method:"sui_getNormalizedMoveFunction",params:[e.package,e.module,e.function]})}async getNormalizedMoveStruct(e){return await this.transport.request({method:"sui_getNormalizedMoveStruct",params:[e.package,e.module,e.struct]})}async getOwnedObjects(e){if(!e.owner||!ve(M(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getOwnedObjects",params:[e.owner,{filter:e.filter,options:e.options},e.cursor,e.limit]})}async getObject(e){if(!e.id||!po(Se(e.id)))throw new Error("Invalid Sui Object id");return await this.transport.request({method:"sui_getObject",params:[e.id,e.options]})}async tryGetPastObject(e){return await this.transport.request({method:"sui_tryGetPastObject",params:[e.id,e.version,e.options]})}async multiGetObjects(e){if(e.ids.forEach(r=>{if(!r||!po(Se(r)))throw new Error(`Invalid Sui Object id ${r}`)}),e.ids.length!==new Set(e.ids).size)throw new Error(`Duplicate object ids in batch call ${e.ids}`);return await this.transport.request({method:"sui_multiGetObjects",params:[e.ids,e.options]})}async queryTransactionBlocks(e){return await this.transport.request({method:"suix_queryTransactionBlocks",params:[{filter:e.filter,options:e.options},e.cursor,e.limit,(e.order||"descending")==="descending"]})}async getTransactionBlock(e){if(!Qr(e.digest))throw new Error("Invalid Transaction digest");return await this.transport.request({method:"sui_getTransactionBlock",params:[e.digest,e.options]})}async multiGetTransactionBlocks(e){if(e.digests.forEach(r=>{if(!Qr(r))throw new Error(`Invalid Transaction digest ${r}`)}),e.digests.length!==new Set(e.digests).size)throw new Error(`Duplicate digests in batch call ${e.digests}`);return await this.transport.request({method:"sui_multiGetTransactionBlocks",params:[e.digests,e.options]})}async executeTransactionBlock({transactionBlock:e,signature:o,options:r,requestType:i}){let n=await this.transport.request({method:"sui_executeTransactionBlock",params:[typeof e=="string"?e:J(e),Array.isArray(o)?o:[o],r]});if(i==="WaitForLocalExecution")try{await this.waitForTransaction({digest:n.digest})}catch{}return n}async signAndExecuteTransaction({transaction:e,signer:o,...r}){let i;e instanceof Uint8Array?i=e:(e.setSenderIfNotSet(o.toSuiAddress()),i=await e.build({client:this}));let{signature:n,bytes:l}=await o.signTransaction(i);return this.executeTransactionBlock({transactionBlock:l,signature:n,...r})}async getTotalTransactionBlocks(){let e=await this.transport.request({method:"sui_getTotalTransactionBlocks",params:[]});return BigInt(e)}async getReferenceGasPrice(){let e=await this.transport.request({method:"suix_getReferenceGasPrice",params:[]});return BigInt(e)}async getStakes(e){if(!e.owner||!ve(M(e.owner)))throw new Error("Invalid Sui address");return await this.transport.request({method:"suix_getStakes",params:[e.owner]})}async getStakesByIds(e){return e.stakedSuiIds.forEach(o=>{if(!o||!po(Se(o)))throw new Error(`Invalid Sui Stake id ${o}`)}),await this.transport.request({method:"suix_getStakesByIds",params:[e.stakedSuiIds]})}async getLatestSuiSystemState(){return await this.transport.request({method:"suix_getLatestSuiSystemState",params:[]})}async queryEvents(e){return await this.transport.request({method:"suix_queryEvents",params:[e.query,e.cursor,e.limit,(e.order||"descending")==="descending"]})}async subscribeEvent(e){return this.transport.subscribe({method:"suix_subscribeEvent",unsubscribe:"suix_unsubscribeEvent",params:[e.filter],onMessage:e.onMessage})}async subscribeTransaction(e){return this.transport.subscribe({method:"suix_subscribeTransaction",unsubscribe:"suix_unsubscribeTransaction",params:[e.filter],onMessage:e.onMessage})}async devInspectTransactionBlock(e){let o;if(ii(e.transactionBlock))e.transactionBlock.setSenderIfNotSet(e.sender),o=J(await e.transactionBlock.build({client:this,onlyTransactionKind:!0}));else if(typeof e.transactionBlock=="string")o=e.transactionBlock;else if(e.transactionBlock instanceof Uint8Array)o=J(e.transactionBlock);else throw new Error("Unknown transaction block format.");return await this.transport.request({method:"sui_devInspectTransactionBlock",params:[e.sender,o,e.gasPrice?.toString(),e.epoch]})}async dryRunTransactionBlock(e){return await this.transport.request({method:"sui_dryRunTransactionBlock",params:[typeof e.transactionBlock=="string"?e.transactionBlock:J(e.transactionBlock)]})}async getDynamicFields(e){if(!e.parentId||!po(Se(e.parentId)))throw new Error("Invalid Sui Object id");return await this.transport.request({method:"suix_getDynamicFields",params:[e.parentId,e.cursor,e.limit]})}async getDynamicFieldObject(e){return await this.transport.request({method:"suix_getDynamicFieldObject",params:[e.parentId,e.name]})}async getLatestCheckpointSequenceNumber(){let e=await this.transport.request({method:"sui_getLatestCheckpointSequenceNumber",params:[]});return String(e)}async getCheckpoint(e){return await this.transport.request({method:"sui_getCheckpoint",params:[e.id]})}async getCheckpoints(e){return await this.transport.request({method:"sui_getCheckpoints",params:[e.cursor,e?.limit,e.descendingOrder]})}async getCommitteeInfo(e){return await this.transport.request({method:"suix_getCommitteeInfo",params:[e?.epoch]})}async getNetworkMetrics(){return await this.transport.request({method:"suix_getNetworkMetrics",params:[]})}async getAddressMetrics(){return await this.transport.request({method:"suix_getLatestAddressMetrics",params:[]})}async getEpochMetrics(e){return await this.transport.request({method:"suix_getEpochMetrics",params:[e?.cursor,e?.limit,e?.descendingOrder]})}async getAllEpochAddressMetrics(e){return await this.transport.request({method:"suix_getAllEpochAddressMetrics",params:[e?.descendingOrder]})}async getEpochs(e){return await this.transport.request({method:"suix_getEpochs",params:[e?.cursor,e?.limit,e?.descendingOrder]})}async getMoveCallMetrics(){return await this.transport.request({method:"suix_getMoveCallMetrics",params:[]})}async getCurrentEpoch(){return await this.transport.request({method:"suix_getCurrentEpoch",params:[]})}async getValidatorsApy(){return await this.transport.request({method:"suix_getValidatorsApy",params:[]})}async getChainIdentifier(){let e=await this.getCheckpoint({id:"0"}),o=_e(e.digest);return Ze(o.slice(0,4))}async resolveNameServiceAddress(e){return await this.transport.request({method:"suix_resolveNameServiceAddress",params:[e.name]})}async resolveNameServiceNames({format:e="dot",...o}){let{nextCursor:r,hasNextPage:i,data:n}=await this.transport.request({method:"suix_resolveNameServiceNames",params:[o.address,o.cursor,o.limit]});return{hasNextPage:i,nextCursor:r,data:n.map(l=>rc(l,e))}}async getProtocolConfig(e){return await this.transport.request({method:"sui_getProtocolConfig",params:[e?.version]})}async waitForTransaction({signal:e,timeout:o=60*1e3,pollInterval:r=2*1e3,...i}){let n=AbortSignal.timeout(o),l=new Promise((c,d)=>{n.addEventListener("abort",()=>d(n.reason))});for(l.catch(()=>{});!n.aborted;){e?.throwIfAborted();try{return await this.getTransactionBlock(i)}catch{await Promise.race([new Promise(d=>setTimeout(d,r)),l])}}throw n.throwIfAborted(),new Error("Unexpected error while waiting for transaction block.")}};var kc=async({chain:t,owner:e,chainData:o},{recipient:r})=>{let i=t.id,{objectId:n}=o,l=L.getRpcProxyUrl(i);if(!n)throw new Error("Unable to determine object id for collectible");if(!e)throw new Error("Unable to determine owner for collectible");if(!l)throw new Error("Failed to get Sui RPC url");let c=new zo({url:l}),d=new jn;d.setSender(e),d.transferObjects([n],r);let p=await d.build({client:c});return{networkID:i,transaction:p}};async function Pc(t,e,o){let{chain:r}=t,i=r.id;return L.isSolanaNetworkID(i)?Ml(t,e):L.isEVMNetworkID(i)?Il(t,e):L.isSuiNetworkID(i)?kc(t,e):L.isBitcoinNetworkID(i)?xl(t,e,o):Xn(i)}var Tf="collectible-transfer-tx",vf=Y({seconds:30});function Ef(t){return t&&!t.isNaN()}function Af(t){let{collectible:e,sendFormValues:o}=t??{},{chain:r,owner:i}=e??{},{id:n}=r??{},{recipient:l,amountAsset:c}=o??{},d=zs(l,n)??"",p=c?.isNaN()?void 0:c,m=Ef(p),{data:f}=er({address:i,networkID:n}),{data:g}=Fs(f),{data:y}=Ls({networkID:n,enableFallback:!0}),C=If(n,y,g,f),S=C?.sendContextRequired?C.sendContext:void 0;return oe({staleTime:vf,enabled:m&&!!e&&!!t&&!!C,queryKey:U.transferTransaction({collectible:e,sendFormValues:o,sendContext:S}),async queryFn(){try{if(!e||!o||!C)throw new Error("Missing required data to construct fungible transfer transaction");return await Pc(e,{...o,recipient:d},S)}catch(T){if(ft(T)){let O=T.response?.status;Pe(T,O,Tf)}throw T}}})}function If(t,e,o,r){if(t)return L.isBitcoinNetworkID(t)?!e||!o||!r?void 0:{sendContextRequired:!0,sendContext:{transactionSpeedsToUnitCost:e,utxoState:o,chainAddress:r}}:{sendContextRequired:!1}}s();a();var ni=t=>{let e=re();return oe({enabled:t.length!==0,queryKey:U.hiddenCollections(t),gcTime:Ne.Long,staleTime:1/0,async queryFn(){try{let o=await tt(e,t);return Array.from(o.values()).filter(r=>pr(r,{spamStatus:"NOT_VERIFIED"})).map(({id:r})=>r)}catch(o){return o instanceof Error&&q.captureError(o,"collectibles"),[]}}})};s();a();s();a();var Oc=v(P());var kf=t=>{let e=se();return(0,Oc.useCallback)(()=>e.invalidateQueries({queryKey:U.collections(t)}),[e,t])};s();a();var Pf=2e3,si=class extends ke{constructor(e){super(e),this.name="UsePinCollectionError"}};function ai(){let t=re(),e=se();return Be({async mutationFn({collectionId:o,accountId:r,pinned:i}){let n=await Cr(t)??{},l=n[r]??[];if(i){if(Object.values(n).flat().length+1>Pf)throw new si("Pinned limit reached");let d=[...new Set([...l,o])],p={...n,[r]:d};await Mi(t,p)}else{let c=l.indexOf(o);if(c===-1)throw new si("Collection not previously pinned");let d=[...l];d.splice(c,1);let p={...n,[r]:d};await Mi(t,p)}},async onSuccess(o,r){await e.invalidateQueries({queryKey:U.pinnedCollections(r.accountId)})}})}s();a();var Uc=v(P());var Of=t=>{let e=se();return(0,Uc.useCallback)(()=>e.refetchQueries({queryKey:U.collections(t)}),[e,t])};s();a();s();a();var Uf=new Error("Failed to report event for collectible");async function Mc(t){try{let e=await Q.api().post("/collectibles/v1/events",{events:t});if(!mt(e))throw new Error}catch{throw Uf}}function Bc(){return Be({async mutationFn({event:t}){try{await Mc([t])}catch{}}})}s();a();function Mf(){let{data:t}=us(),e=re(),o=se(),r=_s(),i=Qt();return Be({mutationFn:async({multichainTransaction:l,pendingTransactionInput:c,senderAddress:d,optimisticUpdate:p,gasEstimation:m})=>{if(!t)throw new Error("No account identifier found");let{networkID:f}=l,g=await sr.get(f).onBeforeSend({multichainTransaction:l,gasEstimation:m}),y=await Ms({accountIdentifier:t,accountSigner:i,multichainTransaction:g,networkID:f,pendingTransactionInput:c,senderAddress:d,storage:e,utxoManager:r});return p&&oo(o,p),Us(f,y)},onError(l){l instanceof Error&&q.captureError(l,"collectibles")}})}s();a();var li=t=>{let e=re();return oe({enabled:t.length!==0,queryKey:U.unhiddenCollections(t),gcTime:Ne.Long,staleTime:1/0,async queryFn(){try{let o=await tt(e,t);return Array.from(o.values()).filter(r=>Rs(r,{spamStatus:"NOT_VERIFIED"})).map(({id:r})=>r)}catch(o){return o instanceof Error&&q.captureError(o,"collectibles"),[]}}})};s();a();var Bf=2e3,_n=class extends Error{constructor(e){super(e),this.name="UseUnhideCollectionError"}};function ci(){let t=re(),e=se(),o=ae();return Be({async mutationFn(r){let{collectionId:i,accountId:n}=r,l=await gi(t);if(!(await tt(t,n)).has(i)&&l>=Bf)throw new _n("Too many ids unhidden");await vo(t,o,{accountId:n,mutations:[{id:i,visibility:"visible"}]})},async onSuccess(r,i){await e.invalidateQueries({queryKey:U.unhiddenCollections(i.accountId)}),await e.invalidateQueries({queryKey:U.hiddenCollections(i.accountId)})}})}s();a();var Ht=v(P());s();a();var Fn=v(P());var Dc=({toast:t,accountId:e})=>{let{t:o}=Z(),r=ae(),i=(0,Fn.useCallback)(({collectible:l,previousVisibility:c,updatedVisibility:d})=>{d!==null&&r.capture("collectiblesReportAsNotSpam",{data:bt(l)}),t.success(c==="visible"?o("collectiblesNotSpamSuccess"):o("collectiblesNotSpamAndUnhiddenSuccess"))},[o,t,r]),n=(0,Fn.useCallback)((l,c)=>{t.error(o("collectiblesNotSpamFail"))},[o,t]);return ga({accountId:e,onSuccess:i,onError:n})};s();a();var $n=v(P());var Rc=({toast:t,accountId:e})=>{let{t:o}=Z(),r=ae(),i=(0,$n.useCallback)(({collectible:l,previousVisibility:c,updatedVisibility:d})=>{d!==null&&r.capture("collectiblesReportAsSpam",{data:bt(l)}),t.success(c==="hidden"?o("collectiblesSpamSuccess"):o("collectiblesSpamAndHiddenSuccess"))},[o,t,r]),n=(0,$n.useCallback)((l,c)=>{t.error(o("collectiblesSpamFail"))},[o,t]);return ya({accountId:e,onSuccess:i,onError:n})};function Df({accountId:t,collectible:e,toast:o}){let r=Rc({collectible:e,accountId:t,toast:o}),i=(0,Ht.useCallback)(()=>{if(e)return r(e)},[r,e]),n=Dc({collectible:e,accountId:t,toast:o}),l=(0,Ht.useCallback)(()=>{if(e)return n(e)},[n,e]),{data:c}=Ce(t??""),d=(0,Ht.useMemo)(()=>c?.get(e?.collection.id??e?.id??""),[c,e]),p=(0,Ht.useMemo)(()=>e?Ds(d,{spamStatus:e.collection.spamStatus}):"NOT_VERIFIED",[e,d]),m=Eo(p);return(0,Ht.useMemo)(()=>({isSpam:m,spamStatus:p,onReportSpam:m?void 0:i,onReportNotSpam:m?l:void 0}),[p,m,i,l])}s();a();var Lc=v(fi()),Nc=v(P());s();a();var ui=(t,e)=>{let o=new So(t);if(o.isZero())return"0";let r=Ko(-e);return o.abs().lt(r)?o.isPositive()?`<${r.toFixed()}`:`-<${r.toFixed()}`:parseFloat(o.toString()).toLocaleString("en-US",{maximumFractionDigits:e})};var Rf=(t,e)=>{let{t:o}=Z();return(0,Nc.useMemo)(()=>{let i=[];if(!t)return i;let n=t?.chain.id,l=Dt.get(n).collectibleDetailPrecision;t.collection.name&&i.push({label:o("collectibleScreenCollectionLabel"),value:t.collection.name});let c,d;if(t.collection.floorPrice){let{price:f,token:g}=t.collection.floorPrice;if(g&&g.decimals&&g.symbol){let{decimals:y,symbol:C}=g,S=ro(f,y);i.push({label:o("collectiblesFloorPrice"),value:`${ui(S,l)} ${C}`}),c=S,d=C}}let p,m;if(t.lastSalePrice){let{price:f,token:g}=t.lastSalePrice;if(g&&g.decimals&&(g.symbol||g.name)){let{decimals:y,symbol:C,name:S}=g,T=ro(f,y);i.push({label:o("collectiblesLastSalePrice"),value:`${ui(T,l)} ${C??S}`}),p=T,m=C}}if(c&&p&&d===m){let f=c-p;i.push({label:o("collectiblesTotalReturn"),value:`${ui(f,l)} ${m}`,color:f>0?e?.positiveColor:f===0?void 0:e?.negativeColor})}return t.collection.ownerCount&&i.push({label:o("collectiblesUniqueHolders"),value:(0,Lc.default)(t.collection.ownerCount).format("0,0")}),t.chain.name&&i.push({label:o("sendFungibleSummaryNetwork"),value:L.getNetworkName(t.chain.id)}),Go()&&i.push({label:"Standard",value:Lf(t)}),qs(t)&&i.push({label:o("collectiblesNonTransferable"),value:o("collectiblesNonTransferableYes")}),i},[t,e?.negativeColor,e?.positiveColor,o])};function Lf(t){let e=t.chainData;if(K(e))return e.standard;if(De(e))return e.standard;if(Qe(e))return"Ordinals"}s();a();var jc=v(P());s();a();var Nf=v(P());s();a();var Vf=v(P());s();a();var Vc=v(P()),di=(t,e,o,r)=>(0,Vc.useMemo)(()=>e.includes(o)?!1:t.includes(o)?!0:!!r,[t,e,o,r]);s();a();var Ho=v(P());s();a();var _c=v(P()),zn=({accountId:t,collectionId:e,isPinned:o,pinMessages:r,pinCollection:i,toast:n,sendAnalyticEvent:l,unhideCollection:c,isHidden:d})=>(0,_c.useCallback)(()=>{(async()=>{if(!e||!t){n.error(o?r.unpinFail:r.pinFail);return}try{await i({collectionId:e,accountId:t,pinned:!o}),d&&!o&&await c({collectionId:e,accountId:t}),n.success(o?r.unpinSuccess:r.pinSuccess),l&&l(o?"collectionUnpinned":"collectionPinned")}catch{n.error(o?r.unpinFail:r.pinFail)}})()},[e,t,o,r,i,n,l,c,d]);var $f=({collectionId:t,isSpam:e,accountId:o,networkId:r,toast:i})=>{let{t:n}=Z(),l=ae(),{mutateAsync:c}=ci(),{data:d=[]}=ni(o||""),{data:p=[]}=li(o||""),m=di(d,p,t??"",!!e),{mutateAsync:f}=ai(),{data:g=[]}=Sr(o||""),y=Tr(g,t??""),C=(0,Ho.useMemo)(()=>({pinSuccess:n("collectionPinSuccess"),pinFail:n("collectionPinFail"),unpinSuccess:n("collectionUnpinSuccess"),unpinFail:n("collectionUnpinFail")}),[n]),S=(0,Ho.useCallback)(O=>{r&&l.capture(O,{data:{networkId:r,chainId:L.getChainID(r)}})},[l,r]),T=zn({accountId:o,collectionId:t,isPinned:y,pinMessages:C,pinCollection:f,toast:i,sendAnalyticEvent:S,unhideCollection:c,isHidden:m});return(0,Ho.useMemo)(()=>({isPinned:y,onTogglePin:T}),[y,T])};s();a();var qo=v(P());var zf=({networkID:t,isTxError:e,isTxConfirmed:o,isTxSubmitted:r})=>{let i=Dt.get(t).sendSuccessCondition,n=(0,qo.useMemo)(()=>e?"ERROR":i==="SUBMISSION"&&r||i==="CONFIRMATION"&&o?"SUCCESS":"LOADING",[o,e,r,i]),l=i==="CONFIRMATION"?"sendStatusConfirmedSuccessTitle":"sendStatusSubmittedSuccessTitle",c=(0,qo.useMemo)(()=>{switch(n){case"LOADING":return xe.t("sendStatusLoadingTitle");case"ERROR":return xe.t("sendStatusErrorTitle");case"SUCCESS":return xe.t(l)}},[n,l]),{isError:d,isSuccess:p}=(0,qo.useMemo)(()=>({isError:n==="ERROR",isSuccess:n==="SUCCESS"}),[n]),{transactionSpeed:m="standard"}=Hs(g=>g.sendFormValues),f=(0,qo.useMemo)(()=>{let g=sr.get(t).transactionSpeedDescription(m);return g?xe.t(g):""},[t,m]);return{title:c,isError:d,isSuccess:p,sendSuccessCondition:i,estimatedTime:f}};s();a();var yo=v(P());var Hf=()=>{let t=rt(p=>p.listCollectible),e=rt(p=>p.editListCollectiblePrice),[o,r]=(0,yo.useState)(),[i,n]=(0,yo.useState)(!1),[l,c]=(0,yo.useState)();return{editList:(0,yo.useCallback)(async(p,m)=>{if(r(void 0),n(!0),!t||!e){r(new Error("missing collectible or price")),n(!1);return}try{let f=new URLSearchParams;f.set("pubKey",m.toBase58()),f.set("mint",t.asset.mintPubKey),f.set("account",t.asset.pubkey),f.set("quotePrice",`${fr(e)}`),f.set("marketplace","magic_eden");let g=Ye(p);f.set("chainId",g.toString());let y=`/solana/composer/v1/list?${f.toString()}`,S=(await Q.api().retry(3,2e3).get(y)).data,T=Ie.Transaction.from(Buffer.from(S.transaction,"base64"));to(T)?c(T):r(new Error("Failed to initialize transaction")),n(!1)}catch(f){console.error(f),r(new Error("Failed to initialize transaction")),n(!1)}},[t,e]),isLoading:i,error:o,transaction:l}};s();a();var go=v(P());var qf=()=>{let t=rt(p=>p.listCollectible),e=rt(p=>p.listCollectiblePrice),[o,r]=(0,go.useState)(),[i,n]=(0,go.useState)(!1),[l,c]=(0,go.useState)();return{list:(0,go.useCallback)(async(p,m)=>{if(r(void 0),n(!0),!t||!e){r(new Error("missing collectible or price")),n(!1);return}try{let f=new URLSearchParams;f.set("pubKey",m.toBase58()),f.set("mint",t.asset.mintPubKey),f.set("account",t.asset.pubkey),f.set("quotePrice",`${fr(e)}`),f.set("marketplace","magic_eden");let g=Ye(p);f.set("chainId",g.toString());let y=`/solana/composer/v1/list?${f.toString()}`,S=(await Q.api().retry(3,2e3).get(y)).data,T=Ie.Transaction.from(Buffer.from(S.transaction,"base64"));to(T)?c(T):r(new Error("Failed to initialize transaction")),n(!1)}catch(f){r(new Error("Failed to initialize transaction")),n(!1),q.captureError(f,"magicEden")}},[t,e]),isLoading:i,error:o,transaction:l}};s();a();var Co=v(P());var Gf=()=>{let t=rt(d=>d.unlistCollectible),[e,o]=(0,Co.useState)(),[r,i]=(0,Co.useState)(!1),[n,l]=(0,Co.useState)();return{unlist:(0,Co.useCallback)(async(d,p)=>{if(o(void 0),i(!0),!t){o(new Error("missing collectible")),i(!1);return}try{let m=new URLSearchParams;m.set("pubKey",p.toBase58()),m.set("mint",t.asset.mintPubKey),m.set("account",t.asset.pubkey),m.set("marketplace","magic_eden");let f=Ye(d);m.set("chainId",f.toString());let g=`/solana/composer/v1/unlist?${m.toString()}`,C=(await Q.api().retry(3,2e3).get(g)).data,S=Ie.Transaction.from(Buffer.from(C.transaction,"base64"));to(S)?l(S):o(new Error("Failed to initialize transaction")),i(!1)}catch(m){o(new Error("Failed to initialize transaction")),i(!1),q.captureError(m,"magicEden")}},[t]),isLoading:r,error:e,transaction:n}};s();a();var Fc=v(P()),Wf=t=>(0,Fc.useMemo)(()=>t.filter(e=>e?.media?.type==="image"),[t]);s();a();var $c=v(P());var Kf=(t,e)=>(0,$c.useMemo)(()=>{if(!t||!e)return;let o=t.chain.id,r=e.explorers[o]??ds.get(o).defaultExplorer,i,n;if(K(t.chainData))n="address",i=t.chainData.mint;else if(De(t.chainData))if(t.chainData.contract)t.chainData.id?(n="nft",i=[t.chainData.contract,t.chainData.id]):(n="token",i=t.chainData.contract);else return;else if(Qe(t.chainData))if(eo(t.chainData)){let{hash:c,index:d}=t.chainData.utxoDetails;n="transaction",i=`${c}#flow=&vout=${d}`}else return{name:"Ordinals",url:`https://ordinals.com/inscription/${t.chainData.firstCreatedInscriptionId}`};else if(Zs(t.chainData))n="nft",i=t.chainData.objectId??"";else throw new Error(`Unhandled collectible explorer for chain id: ${t.chain.id}`);if(!i)return;let l=ms({networkID:o,endpoint:n,explorerType:r,param:i});if(l)return{name:ps[r],url:l}},[t,e]);s();a();var zc=v(P()),Qf=t=>(0,zc.useMemo)(()=>{let e=new Set;return t.filter(o=>{if(!o?.media?.image?.url)return!1;let{url:r}=o.media.image;return e.has(r)?!1:(e.add(r),!0)})},[t]);s();a();var Hc=v(P());var Yf=t=>{let{t:e}=Z();return(0,Hc.useMemo)(()=>{let r=[];if(!t)return;let i=t.chainData;if(Qe(i)){let{outputValue:n,satNumber:l,satName:c,inscriptionId:d,inscriptionNumber:p,protocolName:m,createdAt:f,utxoDetails:g}=i,y=e(d?"collectibleDetailOrdinalInfo":"collectibleDetailRareSatsInfo"),C;return n?C=parseFloat(n).toLocaleString("en-US"):g&&(C=g.value.toLocaleString("en-US")),r.push(C?{label:e("collectibleDetailSatsInUtxo"),value:e("collectibleDetailSatsInUtxoValue",{satsInUtxo:C})??void 0}:null),r.push(l?{label:e("collectibleDetailSatNumber"),value:l}:null),r.push(c?{label:e("collectibleDetailSatName"),value:c}:null),r.push(d?{label:e("collectibleDetailInscriptionId"),value:Zn(d,5,3)}:null),r.push(p?{label:e("collectibleDetailInscriptionNumber"),value:p}:null),r.push(m?{label:e("collectibleDetailStandard"),value:m?.toUpperCase()}:null),r.push(f?{label:e("collectibleDetailCreated"),value:Xf(new Date(f))}:null),{label:y,items:r.filter(Qn)}}},[t,e])};function Xf(t){let e=t.toLocaleDateString(void 0,{month:"numeric",day:"numeric",year:"numeric"}),o=t.toLocaleTimeString();return`${e} ${o}`}s();a();var Gc=v(P()),At=()=>{},qc=new Map([["send",1],["list",2],["pin",3],["unpin",4],["share",5],["setAsAvatar",6],["saveToLibrary",7],["hide",8],["reportAsSpam",9],["reportAsNotSpam",10],["burnToken",11],["viewOnExplorer",12]]);function Jf(t){let{amountToBurn:e=0,explorerName:o,isBurnable:r,isHidden:i,isPinned:n,isSpam:l,onBurnToken:c,onReportNotSpam:d,onReportSpam:p,onSaveToLibrary:m,onSend:f,onSetAsAvatar:g,onShare:y,onToggleHide:C,onTogglePin:S,onViewOnExplorer:T,shortcuts:O,shouldDisplaySend:_,shouldDisplayShortcuts:$}=t,{t:A}=Z();return(0,Gc.useMemo)(()=>{let ie=[];if(_&&ie.push({text:A("commandSend"),type:"send",onClick:f??At}),m&&ie.push({text:A("assetDetailSaveToPhotos"),singleWordAltText:A("commandSave"),type:"saveToLibrary",menuOnly:!0,onClick:m??At}),g&&!l&&ie.push({text:A("collectibleDetailSetAsAvatar"),singleWordAltText:A("collectibleDetailSetAsAvatarSingleWorkAlt"),type:"setAsAvatar",menuOnly:!0,onClick:g??At}),y&&ie.push({text:A("collectibleDetailShare"),singleWordAltText:A("commandShare"),type:"share",menuOnly:!0,onClick:y??At}),S){let ne=A(n?"assetDetailUnpinCollection":"assetDetailPinCollection"),ee=A(n?"commandUnpin":"commandPin"),Ae=n?"unpin":"pin";ie.push({text:ne,singleWordAltText:ee,type:Ae,menuOnly:!0,onClick:S??At})}if(C){let ne=A(i?"assetDetailUnhideCollection":"assetDetailHideCollection"),ee=A(i?"commandUnhide":"commandHide"),Ae=i?"unhide":"hide";ie.push({text:ne,singleWordAltText:ee,type:Ae,menuOnly:!0,onClick:C??At})}if(d){let ne=A("collectiblesReportAsNotSpam");ie.push({text:ne,type:"reportAsNotSpam",singleWordAltText:A("collectiblesReportNotSpam"),menuOnly:!0,isDestructive:!0,onClick:d})}if(p){let ne=A("collectiblesReportAsSpam");ie.push({text:ne,type:"reportAsSpam",singleWordAltText:A("commandReport"),menuOnly:!0,isDestructive:!0,onClick:p})}if(r){let ne=A(e===1?"collectibleBurnTitleWithCount_one":"collectibleBurnTitleWithCount_other");ie.push({text:ne,singleWordAltText:A("commandBurn"),type:"burnToken",menuOnly:!0,isDestructive:!0,onClick:c??At})}return!!T&&!!o&&ie.push({text:A("assetDetailViewOnExplorer",{explorer:o}),singleWordAltText:A("commandView"),type:"viewOnExplorer",menuOnly:!0,onClick:T??At}),ie.sort((ne,ee)=>(qc.get(ne.type)??100)-(qc.get(ee.type)??100)),{actions:Ks(ie,4),shortcuts:$?O:[]}},[e,o,r,i,n,l,c,d,p,m,f,g,y,C,S,T,O,_,$,A])}s();a();export{nu as a,bh as b,hr as c,Eh as d,oa as e,Ah as f,K as g,De as h,Qe as i,Zs as j,eo as k,Iu as l,Pu as m,Ou as n,Uu as o,Mu as p,lp as q,mp as r,kl as s,Af as t,Ot as u,Ru as v,kf as w,Sr as x,Of as y,Bc as z,Mf as A,Lu as B,Nu as C,Vu as D,Ea as E,Df as F,Rf as G,ju as H,Tr as I,Ag as J,Pa as K,ud as L,yd as M,Cd as N,Ud as O,Ld as P,Nd as Q,jd as R,Fd as S,$d as T,qd as U,$f as V,zf as W,rt as X,Hf as Y,qf as Z,Gf as _,Xd as $,Jd as aa,op as ba,rp as ca,ip as da,Wf as ea,Kf as fa,Qf as ga,Yf as ha,Jf as ia,np as ja};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=chunk-G7OTLN34.js.map
