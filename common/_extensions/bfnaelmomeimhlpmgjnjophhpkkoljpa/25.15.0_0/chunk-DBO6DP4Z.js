import{b as v,h as P,i as Q,j as S,m as M}from"./chunk-5W7YPRT3.js";import{Ya as g,db as D,eb as A,wd as x}from"./chunk-D7Z6MPRS.js";import{g as T,j as k,z as I}from"./chunk-E2H5RB2U.js";import{d as C}from"./chunk-27TD4NX4.js";import{z as h}from"./chunk-FBDT5S2M.js";import{w as d}from"./chunk-TKSJVOQZ.js";import{x as U}from"./chunk-UA6ADLWZ.js";import{h as t,n as o}from"./chunk-3KENBVE7.js";t();o();t();o();t();o();t();o();t();o();var w=a=>a.sort((s,r)=>g.compareNetworkID(s.token.caip19.chainId,r.token.caip19.chainId));var H=a=>{let s=a?.groups.flatMap(r=>r.tokens)??[];return w(s)};t();o();t();o();var V=new P("Failed to get FiatRampTokens"),O=async(a,s,r)=>{try{let e=await T.api().headers(a).bearer(r).post("/fiat_ramp/v2/onramp/tokens",s);if(!k(e))throw V;return e.data}catch{throw V}};var X=d({days:7}),z=d({hours:1}),q=(a,s,r,e=!0,n)=>{let{data:p}=x(),i=Array.from(new Set(p?.addresses?.map(m=>m.networkID))),u=Array.from(new Set(p?.addresses?.map(m=>m.addressType))),y={chainIDs:i},F={"x-client-platform":a,"x-client-app-version":s,"x-client-locale":r},{data:l}=I(),E=l?.userID,_=l?.accessToken;return h({queryKey:M.fiatRampTokens(F,y,E),queryFn:()=>O(F,y,_),gcTime:X,staleTime:z,enabled:e&&i.length>0,select:m=>{let f={...m,groups:m.groups.map(R=>({...R,tokens:w(R.tokens.filter(L=>L.addressType?u.includes(L.addressType):!0))}))};return n?n(f):f}})};var b=(a,s,r,e=!0)=>q(a,s,r,e,H);var K=({clientPlatform:a,appVersion:s,locale:r,caip19:e,addressType:n})=>{let{data:p,isLoading:i,isError:u,isFetched:y}=x(),{data:F=[],isLoading:l,isError:E,isFetched:_}=b(a,s,r),m=F.find(R=>n&&g.getChainName(D(e).chainId)===g.bitcoin.name?A(R.token.caip19)===e&&"addressType"in R&&R.addressType===n:A(R.token.caip19)===e),f=p?.addresses.find(R=>m?.addressType?R.addressType===m.addressType&&R.networkID===m?.token.caip19.chainId:R.networkID===m?.token.caip19.chainId)?.address??"";return m?.token.caip19.chainId&&g.isEVMNetworkID(m.token.caip19.chainId)&&(f=f.toLowerCase()),{tokenToBuy:m,destinationAddress:f,isLoading:i||l,isError:u||E,isFetched:y&&_}};var J=({addressType:a,caip19:s,amount:r,context:e,redirectURL:n,captureAnalyticsEvent:p,navigateToFiatRampForm:i,onClose:u})=>{let{setState:y}=S(),{tokenToBuy:F,destinationAddress:l,isLoading:E,isError:_,isFetched:m}=K({clientPlatform:"web",appVersion:U,locale:C.language,caip19:s,addressType:a}),f=!!F&&!!l;return{canBuy:f,openBuy:()=>{f&&(y({...Q,onClose:u??(()=>{}),ownerPublicKey:l,fungible:F.token,purchaseAmount:r??"",context:e??"modal",redirectURL:n}),p&&p(),i&&i(F.token,l))},destinationAddress:l,token:F,isLoading:E,isError:_,isFetched:m}};t();o();t();o();t();o();var N=new P("Failed to get FiatRampPaymentMethods"),j=async(a,s,r)=>{try{let e=await T.api().headers(a).bearer(r).post("/fiat_ramp/v2/onramp/payment_methods",s);if(!k(e))throw N;return e.data}catch{throw N}};var Z=d({days:7}),$=d({hours:1}),ee=(a,s,r,e)=>{let n={"x-client-platform":a,"x-client-app-version":s,"x-client-locale":r},{data:p}=I(),i=p?.userID,u=p?.accessToken;return h({queryKey:M.fiatRampPaymentMethods(n,e,i),queryFn:()=>j(n,e,u),gcTime:Z,staleTime:$})};t();o();t();o();var B=new P("Failed to get ramp status"),Y=async(a,s,r)=>{try{let e=await T.api().headers(a).bearer(r).post("/fiat_ramp/v2/onramp/event_status",s);if(!k(e))throw B;return e.data}catch{throw B}};var te=d({seconds:v}),oe=d({hours:1}),ae=(a,s,r,e)=>{let n={"x-client-platform":a,"x-client-app-version":s,"x-client-locale":r},{data:p}=I(),i=p?.userID,u=p?.accessToken;return h({enabled:!!e,queryKey:M.fiatRampStatus(n,e,i),queryFn:()=>Y(n,{sessionId:e},u),gcTime:oe,staleTime:te,refetchInterval:1e4})};t();o();t();o();t();o();var W=new P("Failed to get FiatRampRecommendedQuote"),G=async(a,s,r)=>{try{let e=await T.api().headers(a).bearer(r).post("/fiat_ramp/v2/onramp/recommended_quote",s);if(!k(e))throw W;return e.data}catch{throw W}};var se=d({days:7}),re=d({hours:1}),ne=(a,s,r,e,n=!0)=>{let p={"x-client-platform":a,"x-client-app-version":s,"x-client-locale":r},{data:i}=I(),u=i?.userID,y=i?.accessToken;return h({queryKey:M.fiatRampRecommendedQuote(p,e,u),queryFn:()=>G(p,e,y),gcTime:se,staleTime:re,enabled:n})};export{q as a,b,J as c,ee as d,ne as e,ae as f};
//# sourceMappingURL=chunk-DBO6DP4Z.js.map
