import{d as lo,e as co}from"./chunk-TCYNB4II.js";import{h as xo,k as vo}from"./chunk-JKOFAFN3.js";import{a as Xe,b as _o,c as fo,d as yo}from"./chunk-64U6VGZH.js";import{a as po,b as uo}from"./chunk-TW5NSKIQ.js";import{a as De}from"./chunk-TEHSOGCP.js";import{a as mo}from"./chunk-L5MAEEVU.js";import{a as To}from"./chunk-3LIMLX72.js";import{a as Xt,b as Ge,d as Rt,e as ao,g as io,i as ro,k as so,m as ge}from"./chunk-ZVOB6UOQ.js";import{b as $t}from"./chunk-VT47VYXB.js";import{a as no}from"./chunk-XKK5N6CR.js";import{c as Je,e as Qt}from"./chunk-ICLH7VK5.js";import{a as $e,b as to,c as oo}from"./chunk-3RJOXTRR.js";import{a as jt,f as Ke,t as Kt}from"./chunk-NNO7KFUF.js";import{h as eo}from"./chunk-P6MBUJNT.js";import{b as qt}from"./chunk-2XYRURE2.js";import{c as Jt}from"./chunk-VUB7XYHG.js";import{d as Te}from"./chunk-4NCQWC2K.js";import{b as Vt}from"./chunk-SR5VKAMR.js";import{a as Mt}from"./chunk-PB7BCSCP.js";import{a as Be,d as Lt}from"./chunk-L3G6DHBI.js";import{a as Ot,b as Ht}from"./chunk-QO3FK7IQ.js";import{c as Yt}from"./chunk-A52XYJMT.js";import{A as Tt,la as gt}from"./chunk-FJBNQZUR.js";import{h as Zt}from"./chunk-XN45YXW3.js";import{a as Wt,d as zt}from"./chunk-OQJOA7JT.js";import{a as Ut}from"./chunk-UEENMIFU.js";import{b as ve}from"./chunk-JYKQJVIF.js";import{f as St,h as je,l as Bt,m as Gt,q as O}from"./chunk-GBQG32PI.js";import{o as Fe}from"./chunk-A3FIPWG3.js";import{Ca as Nt,H as Ft,K as Et,Pa as At,Ta as It,Ua as Qe,ac as tn,zb as Pt}from"./chunk-NTISK7TT.js";import{D as bt,V as Q,_ as Se,b as Le,d as Ct,k as wt}from"./chunk-CU7RFE6B.js";import{a as Z}from"./chunk-IVA2TTR4.js";import{d as kt}from"./chunk-OG3IV3YP.js";import{g as Dt}from"./chunk-35FUKWV2.js";import{c as h}from"./chunk-TU7CE5HJ.js";import{Ac as ht,Gb as Ye,Hb as ct,Ib as Ze,Jb as Pe,Lb as mt,Nb as xe,Oc as en,Vb as pt,W as lt,Ya as Xo,fc as ke,lc as ut,oc as Ro}from"./chunk-YILNSICT.js";import{A as yt,G as xt,H as vt,b as _t,d as ft,o as J,q as qe}from"./chunk-L4N7WJIQ.js";import{K as ye,e as st,pa as ze}from"./chunk-LBCQTFOD.js";import{N as te,l as V,v as be,w as o}from"./chunk-V63HWKAL.js";import{H as Ve,T as dt,ca as A}from"./chunk-2EJYCNYZ.js";import{a as ee}from"./chunk-B75PPTYD.js";import{f as M,m as a,o as i}from"./chunk-UGZFXKPB.js";a();i();a();i();te();a();i();var Ee=M(ee());a();i();a();i();var j=M(ee()),go=M(tn());te();ke();a();i();var K={title:"_title_1xthp_1",subtitle:"_subtitle_1xthp_9",fee:"_fee_1xthp_15",feeTitle:"_feeTitle_1xthp_21",feeDetail:"_feeDetail_1xthp_26",speedDetail:"_speedDetail_1xthp_33",gasDetail:"_gasDetail_1xthp_36"};var on=()=>{let e=qt(),t=eo(),r=Zt(),n=(0,go.useSelector)(Pt),l=$t(),v=lo(),s=async(u,f,m,F=0)=>{let{baseCoin:T}=await e(m,!0),E=r?.[T.coinId]||"0",w=Ye(u,f),N=Gt(Ze(w,F),{symbol:T.symbol,decimals:T.decimals}),_=Bt(Ye(ct(Ze(w,F),10**T.decimals),E),{symbol:n.symbol});return`${N} ${_}`},p=(u,f)=>{let m=l(u);return o("wallet_extension_transaction_confirmation_gas_detail",{gasPrice:V.thousandFormat(m),gasLimit:V.thousandFormat(f)})},d=async(u,f)=>{try{return await v({...u,coinId:f})}catch{return""}},c=({userGasInfo:u,updateGasInfo:f,fetchParams:m})=>{let{gasPrice:F,maxFeePerGas:T,maxPriorityFeePerGas:E}=f,{supportEip1559:w,gasLimit:N,gasPrice:_,maxFeePerGas:g,maxPriorityFeePerGas:G}=u;return w?(delete m.gasPrice,{...m,value:m?.amount,maxFeePerGas:T||g,maxPriorityFeePerGas:E||G,gasLimit:N}):{...m,value:m?.amount,gasPrice:F||_,gasLimit:N}};return async({coinId:u,baseCoinAmountUse:f,userGasInfo:m,updateGasInfo:F,serverSignInfo:T,fetchParams:E})=>{let{gasPrice:w,maxFeePerGas:N}=F,{supportEip1559:_,gasLimit:g,gasPrice:G,maxFeePerGas:b}=m,B=0;T?.needExtFee&&(B=await d(c({userGasInfo:m,updateGasInfo:F,fetchParams:E}),u));let k=_?b:G,W=await s(k,g,u),D=p(k,g),z=_?N:w,Y=await s(z,g,u,B),$=p(z,g);return new Promise((U,q)=>{let re=J.prompt({hideCloseBtn:!1,alignBottom:!1,titleCenter:!1,infoType:null,confirmText:o("extension_toast_btn_confirmgasfee"),confirmBtnProps:{type:A.TYPE.highlight,size:A.SIZE.lg},onConfirm:async()=>{re.destroy();let{baseCoin:X}=await e(u,!0),{coinAmountInt:R}=t(X.coinId),oe=Pe(R,f);so({userGasInfo:m,updateGasInfo:F,baseCoinAmountAvailable:oe,L1FEE:B})?(xt.error({title:o("extension_toast_text_insufficient_balance")}),q(new Error(ge))):U(F)},onClose:()=>{re.destroy(),q(new Error(ge))},renderContent:X=>j.default.createElement(X,null,j.default.createElement("div",{className:K.title},o("extension_toast_title_transaction_replace")),j.default.createElement("div",{className:K.subtitle},o("extension_toast_subtitle_gasincrease")),j.default.createElement("div",{className:K.feeTitle},o("extension_toast_title_current_transaction")),j.default.createElement("div",{className:K.fee},j.default.createElement("div",{className:K.feeDetail},W),j.default.createElement("div",{className:K.gasDetail},D)),j.default.createElement("div",{className:K.feeTitle},o("extension_toast_title_gasprice")),j.default.createElement("div",{className:K.fee},j.default.createElement("div",{className:K.speedDetail},Y),j.default.createElement("div",{className:K.gasDetail},$)))})})}},ho=on;var nn=()=>{let e=ho();return async({coinId:r,baseCoinAmountUse:n,userGasInfo:l,serverGasInfo:v,serverSignInfo:s,originTxGasInfo:p,fetchParams:d})=>{let c=ro({userGasInfo:l,serverGasInfo:v,originTxGasInfo:p});return c?.gasPrice||c?.maxFeePerGas?(await e({coinId:r,baseCoinAmountUse:n,userGasInfo:l,updateGasInfo:c,serverSignInfo:s,fetchParams:d}),Promise.resolve(c)):Promise.resolve()}},Co=nn;a();i();var Me={content:"_content_18w99_1",title:"_title_18w99_4",text:"_text_18w99_10"};var an=()=>{let e=Co();return async({coinId:r,baseCoinAmountUse:n="0",showSelectNonceDialog:l=!1,onChainNonce:v="0",newNonce:s="0",userGasInfo:p={},serverGasInfo:d={},serverSignInfo:c={},originTxGasInfo:x={},fetchParams:u={},title:f="",text:m="",confirmText:F="",cancelText:T=""})=>new Promise((E,w)=>{if(l){let N=J.prompt({hideCloseBtn:!0,alignBottom:!1,titleCenter:!1,infoType:null,cancelBtnProps:{category:A.CATEGORY.outline,size:A.SIZE.lg},confirmBtnProps:{type:A.TYPE.highlight,size:A.SIZE.lg},confirmText:F,cancelText:T,onConfirm:async()=>{N.destroy();try{let _=await e({coinId:r,baseCoinAmountUse:n,userGasInfo:p,serverGasInfo:d,serverSignInfo:c,originTxGasInfo:x,fetchParams:u});E(_?{nonce:v,updateGasInfo:_}:{nonce:v})}catch(_){w(_)}},onCancel:()=>{N.destroy(),E({nonce:s})},renderContent:_=>Ee.default.createElement(_,null,Ee.default.createElement("div",{className:Me.content},Ee.default.createElement("div",{className:Me.title},f),Ee.default.createElement("div",{className:Me.text},m)))})}else E({nonce:s})})},Oe=an;var rn=()=>{let e=Oe();return async({coinId:r,baseCoinAmountUse:n,hasFailedTx:l,onChainNonce:v,newNonce:s,userGasInfo:p,serverGasInfo:d,originTxGasInfo:c,serverSignInfo:x,fetchParams:u})=>e({coinId:r,baseCoinAmountUse:n,showSelectNonceDialog:l,onChainNonce:v,newNonce:s,userGasInfo:p,serverGasInfo:d,serverSignInfo:x,originTxGasInfo:c,fetchParams:u,title:o("wallet_extension_transaction_popup_failed_transaction"),text:o("wallet_extension_transaction_popup_replace_failed_transaction"),confirmText:o("wallet_extension_transaction_popup_btn_replace"),cancelText:o("wallet_extension_transaction_popup_btn_skip")})},wo=rn;a();i();te();var sn=()=>{let e=Oe();return async({coinId:r,baseCoinAmountUse:n,hasPendingTx:l,onChainNonce:v,newNonce:s,userGasInfo:p,serverGasInfo:d,originTxGasInfo:c,serverSignInfo:x,fetchParams:u})=>e({coinId:r,baseCoinAmountUse:n,showSelectNonceDialog:l,onChainNonce:v,newNonce:s,userGasInfo:p,serverGasInfo:d,serverSignInfo:x,fetchParams:u,originTxGasInfo:c,title:o("wallet_extension_transaction_popup_pending_transaction"),text:o("wallet_extension_transaction_popup_replace_pending_transaction"),confirmText:o("wallet_extension_transaction_popup_btn_replace"),cancelText:o("wallet_extension_transaction_popup_btn_continue_wait")})},bo=sn;a();i();te();ze();var ln=()=>async({isRepeat:t,onCancel:r})=>new Promise((n,l)=>{if(t){let v=J.prompt({alignBottom:!1,hideCloseBtn:!0,infoType:J.Prompt.INFO_TYPE.warn,confirmBtnProps:{type:A.TYPE.highlight,size:A.SIZE.lg},cancelBtnProps:{category:A.CATEGORY.outline,size:A.SIZE.lg},title:o("wallet_extension_popup_repeat_order"),confirmText:o("wallet_extension_popup_repeat_order_btn_continue"),cancelText:r?o("wallet_extension_popup_repeat_order_btn_viewhistory"):null,text:o("wallet_extension_popup_repeat_order_desc"),onConfirm:()=>{v.destroy(),n()},onCancel:()=>{v.destroy(),st(r)&&r(),l(new Error(ge))}})}else n()}),Fo=ln;var Eo="FetchError";var No=()=>{let e=wo(),t=bo(),r=Fo(),n=async({coinId:s,from:p,to:d,amount:c,gasPrice:x})=>{let[{data:u=[]},{data:f={}}]=await Promise.all([Et({checkTypes:[Se.REPEAT,Se.OVERWRITTEN],coinId:s,from:p,to:d,amount:c,gasPrice:x}),Ft({coinId:s,address:p},{fromAddr:p,scenario:wt.SCENARIO_SEND_COIN})]);return{txToastCheckData:u,signInfoData:f}},l=s=>{let{hasFailedTx:p,hasPendingTx:d,nonce:c,newNonce:x,originGasPrice:u,originPriorityFee:f}=io(s),m=ao(s,Se.REPEAT);return{hasFailedTx:p,hasPendingTx:d,nonce:c,newNonce:x,originGasPrice:u,originPriorityFee:f,isRepeat:m}};return async({coinId:s,from:p,to:d,amount:c,gasPrice:x,baseCoinAmountUse:u,userGasInfo:f,whetherCheckRepeat:m,onRepeatCancel:F})=>{let T=[],E={};try{let Y=await n({coinId:s,from:p,to:d,amount:c,gasPrice:x});if(!Array.isArray(Y.txToastCheckData)||typeof Y.signInfoData!="object")throw new Error(Eo);T=Y.txToastCheckData,E=Y.signInfoData?.info||{}}catch{throw new Error(Eo)}let w=l(T),{nonce:N,newNonce:_,originGasPrice:g,originPriorityFee:G,hasFailedTx:b,hasPendingTx:B,isRepeat:k}=w,W={originGasPrice:g,originPriorityFee:G},D={coinId:s,baseCoinAmountUse:u,onChainNonce:N,newNonce:_,userGasInfo:f,serverGasInfo:E.gasPrice,serverSignInfo:E,originTxGasInfo:W,fetchParams:{amount:c,coinId:s,from:p,gasPrice:x,to:d}},z={nonce:_};return b?z=await e({...D,hasFailedTx:b}):B&&(z=await t({...D,hasPendingTx:B})),m&&await r({isRepeat:k,onCancel:F}),z}};a();i();var H=M(ee()),de=M(Fe());ze();te();a();i();var Ne=M(ee()),pe=M(Ve());te();a();i();var ce={root:"_root_wpiv5_1",title:"_title_wpiv5_4",header:"_header_wpiv5_8",icon:"_icon_wpiv5_12",content:"_content_wpiv5_16",textarea:"_textarea_wpiv5_19",errorTip:"_errorTip_wpiv5_22",errorBordered:"_errorBordered_wpiv5_29"};function cn({className:e,value:t,onChange:r,error:n,titleClass:l,errorTipClass:v,headerClassName:s,contentClassName:p,...d}){return Ne.default.createElement(_t,{defaultExpanded:!0,className:(0,pe.default)(ce.root,e),titleClass:(0,pe.default)(ce.title,l),headerClassName:(0,pe.default)(ce.header,s),contentClassName:(0,pe.default)(ce.content,p),customHeaderIcon:c=>Ne.default.createElement(ve,{icon:"okds-arrow-chevron-down-md",size:ve.SIZE.xs,className:(0,pe.default)({"okui-accordion-header-icon-expanded":c},ce.icon)}),title:o("wallet_extension_inscription_text_hex_data_optional")},Ne.default.createElement(qe.TextArea,{...d,inputClassName:ce.textarea,errorType:qe.TIP_TYPE.always,error:!!n,value:t,onChange:c=>{let x=c.target.value||"";r?.(x.trim())}}),!!n&&Ne.default.createElement(O.Text,{className:(0,pe.default)(ce.errorTip,v)},n))}var Ao=cn;a();i();te();function Io(e){return!!e&&(e.toLowerCase()==="0x"||!Lt(e)||e.length%2!==0)?o("wallet_extension_inscription_text_input_formatting_error"):null}a();i();var Po=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"unpause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"account",type:"address"}],name:"isPauser",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"paused",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"renouncePauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"account",type:"address"}],name:"addPauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"pause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{name:"name",type:"string"},{name:"symbol",type:"string"},{name:"decimals",type:"uint8"},{name:"totalSupply",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Unpaused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"}];a();i();var y=M(ee()),ue=M(Fe()),Re=M(Ve());ze();te();a();i();var ae=M(ee()),ko=M(Fe());a();i();var P={"mev-control-enter":"_mev-control-enter_1499c_1",mevControlEnter:"_mev-control-enter_1499c_1","mev-control-content":"_mev-control-content_1499c_6",mevControlContent:"_mev-control-content_1499c_6","mev-control-content-title":"_mev-control-content-title_1499c_9",mevControlContentTitle:"_mev-control-content-title_1499c_9","mev-control-content-desc":"_mev-control-content-desc_1499c_14",mevControlContentDesc:"_mev-control-content-desc_1499c_14","list-content":"_list-content_1499c_18",listContent:"_list-content_1499c_18","list-wrap":"_list-wrap_1499c_21",listWrap:"_list-wrap_1499c_21","list-item":"_list-item_1499c_24",listItem:"_list-item_1499c_24","item-icon":"_item-icon_1499c_30",itemIcon:"_item-icon_1499c_30","list-item-text":"_list-item-text_1499c_34",listItemText:"_list-item-text_1499c_34","mev-control-title":"_mev-control-title_1499c_38",mevControlTitle:"_mev-control-title_1499c_38","mev-control-sub-title":"_mev-control-sub-title_1499c_43",mevControlSubTitle:"_mev-control-sub-title_1499c_43","mev-control-picture":"_mev-control-picture_1499c_48",mevControlPicture:"_mev-control-picture_1499c_48","mev-control-divider":"_mev-control-divider_1499c_52",mevControlDivider:"_mev-control-divider_1499c_52","mev-control-text-content":"_mev-control-text-content_1499c_56",mevControlTextContent:"_mev-control-text-content_1499c_56","mev-status":"_mev-status_1499c_60",mevStatus:"_mev-status_1499c_60","mev-status__text":"_mev-status__text_1499c_64",mevStatusText:"_mev-status__text_1499c_64","mev-status__text__active":"_mev-status__text__active_1499c_69",mevStatusTextActive:"_mev-status__text__active_1499c_69","mev-tooltip":"_mev-tooltip_1499c_72",mevTooltip:"_mev-tooltip_1499c_72"};var mn=({mevNodeList:e})=>{let t=(0,ae.useRef)(null),r=(0,ko.useSize)(t),n=l=>ae.default.createElement(Wt,{hovered:!1,icon:{size:ve.SIZE.lg,src:l.vendorIcon||kt,type:ve.TYPE.image},className:P["list-item"]},ae.default.createElement(h.FlexBox,{direction:h.DIRECTION.vertical},ae.default.createElement(h.FlexBox,{align:h.ALIGN.center},ae.default.createElement(O.Text,{className:P["list-item-text"]},l.name))));return e.length?ae.default.createElement("div",{ref:t,className:P["list-content"]},ae.default.createElement(zt,{itemKey:"id",height:r?.height??408,searchable:!1,dataSource:e,renderItem:n,className:P["list-wrap"]})):null},Lo=mn;var So="mevOperated",Bo="mevToggle",pn=2e3,un=({isMev:e,needTooltip:t=!0,isShowBlockSwapMevTooltip:r,onMevChange:n,serverMevInfo:l,className:v="",children:s})=>{let{mevNodeList:p,openMev:d,gas:c,priorityRate:x}=l,[u,{setFalse:f,setTrue:m}]=(0,ue.useBoolean)(!1),[F,{toggle:T}]=(0,ue.useBoolean)(!1),[E,w]=(0,y.useState)(""),N=(0,y.useMemo)(()=>p?.length?p.map(b=>b.supplier):[],[p]),_={gas:c,mevSuppliers:N,priorityRate:x};(0,y.useEffect)(()=>{let b=!e&&r,B=!e&&be.get(So)===void 0,k=()=>{f()},W=()=>{be.set(So,1)};return b?(w("wallet_extension_trade_tooltip_enable_mev"),m(),document.addEventListener("click",k,!1)):B&&(w("wallet_extension_mev_pop_turnon_mev"),m(),document.addEventListener("click",k,!1),document.addEventListener("click",W,!1)),()=>{document.removeEventListener("click",k,!1),document.removeEventListener("click",W,!1)}},[]);let g=(0,ue.useMemoizedFn)(()=>{let b=!e;typeof n=="function"&&n(b,_),be.set(Bo,b),gt({mev:b}),w(e?"wallet_extension_mev_pop_mev_off":"wallet_extension_mev_pop_mev_on"),T(),m(),setTimeout(()=>{f()},pn)});(0,ue.useMount)(async()=>{if(typeof n=="function"){if(!ye(e)){n(e,_);return}let b=be.get(Bo);if(!ye(b)){n(b,_);return}n(d,_)}});let G=Dt({dark:"/cdn/assets/imgs/245/127CAD27DF691613.png",light:"/cdn/assets/imgs/2311/700F36AE20EC394E.png"});return y.default.createElement(y.default.Fragment,null,y.default.createElement("div",{className:(0,Re.default)(P["mev-status"],v),onClick:T},y.default.createElement(St,{show:u,title:t&&o(E),placement:yt.DIRECTION.bottomRight},s||y.default.createElement(to,{clickable:!0,title:o("wallet_extension_mev_subtitle_protection")},y.default.createElement(O.Text,{className:(0,Re.default)(P["mev-status__text"],{[P["mev-status__text__active"]]:e})},o(e?"wallet_extension_mev_desc_open":"wallet_extension_mev_desc_closed"))))),y.default.createElement(J.Action,{visible:F,onClose:T,onCancel:T,title:y.default.createElement(y.default.Fragment,null),isFull:!0,noContentPadding:!0,noMargin:!0,onConfirm:g,confirmBtnProps:e?{size:A.SIZE.lg,type:A.TYPE.primary,category:A.CATEGORY.outline}:{size:A.SIZE.lg,type:A.TYPE.highlight,category:A.CATEGORY.fill},confirmText:e?o("wallet_extension_mev_btn_disable_mev"):o("wallet_extension_mev_btn_activate_protection")},y.default.createElement(h.Box,{className:P["mev-control-content"]},y.default.createElement(h.FlexBox,{justify:"space-between",align:h.ALIGN.center},y.default.createElement(h.Space,{direction:h.DIRECTION.vertical,space:12},y.default.createElement(O.Text,{className:P["mev-control-title"]},o("wallet_extension_mev_grouptitle_mev_protection")),y.default.createElement(O.Text,{style:{color:e?"var(--okd-color-semantic-positive)":"var(--okd-color-content-primary)"},className:P["mev-control-sub-title"]},o(e?"wallet_extension_mev_label_enabled":"wallet_extension_mev_label_disabled"))),y.default.createElement(ft,{className:P["mev-control-picture"],src:G})),y.default.createElement(je,{className:P["mev-control-divider"],style:{marginTop:24}}),y.default.createElement(h.Space,{className:P["mev-control-text-content"],direction:h.DIRECTION.vertical,space:24},y.default.createElement(h.Box,null,y.default.createElement(O.Text,{className:P["mev-control-content-title"]},o("wallet_extension_mev_title_provider")),y.default.createElement(Lo,{mevNodeList:p})),y.default.createElement(je,{className:P["mev-control-divider"]}),y.default.createElement(h.Box,null,y.default.createElement(O.Text,{className:P["mev-control-content-title"]},o("wallet_extension_mev_title_mev_meaning")),y.default.createElement(O.Text,{className:P["mev-control-content-desc"]},o("wallet_extension_mev_desc_mev_meaning"))),y.default.createElement(h.Box,null,y.default.createElement(O.Text,{className:P["mev-control-content-title"]},o("wallet_extension_mev_title_mev_avoid")),y.default.createElement(O.Text,{className:P["mev-control-content-desc"]},o("wallet_extension_mev_desc_mev_avoid"))),y.default.createElement(h.Box,null,y.default.createElement(O.Text,{className:P["mev-control-content-title"]},o("wallet_extension_mev_title_why_attack")),y.default.createElement(O.Text,{className:P["mev-control-content-desc"]},o("wallet_extension_mev_desc_why_attack")))))))},Go=un;a();i();var C=M(ee()),ie=M(Fe()),Mo=M(Ve());te();ke();a();i();var S={root:"_root_4gxf5_1",icon:"_icon_4gxf5_1",editApproveAmountModal:"_editApproveAmountModal_4gxf5_10",content:"_content_4gxf5_22",txTypeInfo:"_txTypeInfo_4gxf5_25",editArea:"_editArea_4gxf5_28",unlimitedText:"_unlimitedText_4gxf5_33",unlimitedSymbol:"_unlimitedSymbol_4gxf5_43",symbolClassName:"_symbolClassName_4gxf5_60",quickHandler:"_quickHandler_4gxf5_63",balanceWrap:"_balanceWrap_4gxf5_70",balance:"_balance_4gxf5_70",maxBalance:"_maxBalance_4gxf5_92",unlimited:"_unlimited_4gxf5_33",text:"_text_4gxf5_105",authQuantityWarnTip:"_authQuantityWarnTip_4gxf5_112",danger:"_danger_4gxf5_119",info:"_info_4gxf5_122",approveTip:"_approveTip_4gxf5_125",footerActions:"_footerActions_4gxf5_133"};var Do=V.toPlainString(10**40),dn=e=>{typeof e!="string"&&(e=e.toString());let t=e?.length;return t<=9?36:t>=10&&t<12?32:t===12?30:t>=13&&t<=15?24:t>=16&&t<=18?20:t>=19&&t<=24?16:12},Oo=({address:e,coins:t,baseCoinId:r})=>{if(Array.isArray(t))return t.find(n=>n?.baseCoinId===r&&Mt(n?.address,e,{baseCoinId:r})||Oo({address:e,baseCoinId:r,coins:n?.childrenCoin}))},_n=({txTypeInfo:e,walletAccount:t,approve:r,baseCoin:n,onAuthTokenAmountChange:l,updateApproveInfo:v})=>{let{walletId:s}=t,{tokenInfo:p,id:d,amount:c,authQuantity:x}=r||{},{autoEdit:u,defaultAmount:f,warnTip:m}=x||{},{address:F,decimals:T,symbol:E}=p,w=yo(E,12),[N,_]=(0,C.useState)(!1),[g,G]=(0,C.useState)(!1),[b,B]=(0,C.useState)(0),k=(0,ie.useMemoizedFn)((L=c)=>{G(Qe(L)),B(po(L,T)),_(!0)}),W=(0,ie.useMemoizedFn)(()=>{G(L=>!L),B(0)}),D=(0,ie.useMemoizedFn)(()=>{G(!0),B(0)}),z=(0,C.useMemo)(()=>m?{type:S.info,text:m}:g&&!Qe(f)?{type:S.danger,text:o("wallet_extension_approve_alert_high_risk_unlimited")}:!g&&V.eq(b||0,0)?{type:S.info,text:o("wallet_extension_approve_cannot_zero")}:null,[m,g,f,b]),{chainId:Y}=n||{},{coinId:$}=Te(void 0,void 0,{chainId:Y,address:F})||{},U=De($,s)?.coinAmount,q=V.thousandFormat(U),re=(0,ie.useMemoizedFn)(()=>{G(!1),B(U)}),X=(0,C.useMemo)(()=>!(g||V.gt(`${b||0}`,0)),[g,b]),R=(0,ie.useMemoizedFn)(()=>{let L=g?It:uo(b,T);l(L),v(d,{amount:L}),_(!1)}),oe=To(),ne=Vt({},s),se=(0,C.useMemo)(()=>ne?.find(L=>L.localType===n?.localType),[n?.localType,ne?.length]),me=(0,ie.useMemoizedFn)(async(L=0)=>{if(!Oo({address:F,coins:oe,baseCoinId:n?.coinId}))try{let we=await Ot({contractAddress:F,chainInfo:se});await Ht(we)}catch(we){++L<3?me(L):vt.error({title:we?.msg||o("wallet_home_toast_network_error")})}});return(0,ie.useMount)(()=>{u&&k(f),me()}),C.default.createElement(h.Box,{className:S.root},C.default.createElement(h.Box,{className:S.icon,onClick:()=>{k()}},C.default.createElement(dt,{className:"okx-wallet-plugin-draw-20"})),C.default.createElement(J.Action,{hideCloseBtn:!0,noContentPadding:!0,visible:N},C.default.createElement(h.Box,{className:S.editApproveAmountModal},C.default.createElement(h.Box,{className:S.content},C.default.createElement(xo,{bordered:!1,txTypeInfo:e,className:S.txTypeInfo}),C.default.createElement(h.Box,{className:S.editArea},g?C.default.createElement(O.Text,{onClick:W,className:S.unlimitedText},o("wallet_extension_transfer_title_unlimited_amount",{token:C.default.createElement(O.Text,{className:S.unlimitedSymbol},w)})):C.default.createElement(Jt,{symbol:w,autoSize:dn,placeholder:"0",max:Do,decimals:T,value:b,onChange:L=>{mt(L,Do)&&B(L)},style:{fontWeight:700,height:"42px"},symbolClassName:S.symbolClassName})),C.default.createElement(h.Box,{className:S.quickHandler},!!Number(U)&&C.default.createElement(h.Box,{className:S.balanceWrap},C.default.createElement(O.Text,{className:S.balance,ellipsis:{tooltip:q}},o("wallet_extension_approve_label_balance",{amount:q})),C.default.createElement(h.Box,{className:S.maxBalance,onClick:re},o("commonall_enterfield_btn_max"))),C.default.createElement(h.Box,{onClick:D,className:S.unlimited},C.default.createElement(h.Box,{className:S.text},o("wallet_extension_transfer_dialog_checkbox_set_to_unlimited")))),!!z&&C.default.createElement(h.Box,{className:(0,Mo.default)(S.authQuantityWarnTip,z.type)},z.text)),C.default.createElement(h.Box,{className:S.approveTip},o("wallet_extension_approve_desc_dapp_right")),C.default.createElement(Ut,{affixStyle:{position:"none"},placeholder:!1,className:S.footerActions},C.default.createElement(A,{block:!0,disabled:X,category:A.CATEGORY.fill,type:A.TYPE.primary,size:A.SIZE.lg,onClick:R},o("wallet_extension_approve_btn_amount_confirmation"))))))},Ho=_n;a();i();var He=M(ee()),Wo=M(Fe());en();Xo();var fn=({coinId:e,txParams:t,networkFee:r,modifiedData:n,mevInfo:l,isMev:v,gasReturnActivity:s})=>({coinId:e,toAddr:t?.to,fromAddr:t?.from,txSource:ht.DAPP,coinAmount:(Be(t?.value)?Z(t?.value):t?.value)||0,serviceCharge:r,inputData:n,mevSuppliers:v?l?.mevSuppliers:[],activityId:s?.activityId}),yn=({mergedParams:e,gasType:t})=>JSON.stringify({to:e?.to,gasType:t,from:e?.from,value:Be(e?.value)?Z(e?.value):e?.value,nonce:Be(e?.nonce)?Z(e?.nonce):e?.nonce,data:e?.data,gas:e?.gasLimit,oldTxHash:"",gasPrice:e?.supportEip1559?e?.maxFeePerGas:e?.gasPrice,repeatTxType:Ct.CONFIRMING,priorityFee:e?.supportEip1559?e.maxPriorityFeePerGas:0}),xn=({loading:e,isBalanceLoading:t})=>e||t,vn=({coinId:e,txType:t,txParams:r,isMev:n,mevInfo:l,localType:v,modifiedData:s,walletAccount:p,customGasInfo:d,gasReturnActivity:c,modifiedDataError:x,isSufficientGas:u,isSufficientBalance:f,reportGasReturnActivityDataInConfirm:m,canConfirm:F,silentLoading:T,onCancel:E,onConfirm:w,onConfirmReplace:N,isBalanceLoadError:_,isBalanceLoading:g})=>{let{walletId:G}=p||{},b=No(),{networkFee:B,gasType:k,gasPrice:W}=d||{},D=co({coinId:e,walletId:G,localType:v,fromAddr:r?.from}),z=Kt(fn({coinId:e,txParams:r,networkFee:B,modifiedData:s,mevInfo:l,isMev:n,gasReturnActivity:c})),Y=(0,He.useMemo)(()=>d?.isNetworkFeeLoading||Ge(d,t)||_||x||T||F===!1||!u||!f,[T,d,t,x,F,u,f,_]),$=(0,Wo.useMemoizedFn)(async()=>{if(N&&typeof w=="function")return w({isMev:n,coinId:e,mevInfo:l,txParams:r,customGasInfo:d,modifiedData:s,gasReturnActivity:c,reportGasReturnActivityDataInConfirm:m});let{nonce:ne,updateGasInfo:se}=await b({to:r?.to,from:r?.from,coinId:e,gasPrice:W,userGasInfo:d,amount:Z(r?.value)||0,baseCoinAmountUse:Z(r?.value||0)});m();let me={...r,...d,...se||{},nonce:ne,data:s};try{let L=await D(me),Ce=await jt(lt,L);return await z(L,{txHash:Ce,extJson:yn({mergedParams:me,gasType:k})}),w?.({txHash:Ce})}catch(L){return w?.({error:L})}}),{loading:U,onClick:q}=$e($),re=(0,He.useMemo)(()=>({disabled:Y,loading:xn({loading:U,isBalanceLoading:g}),actionType:Ke.ACTION_TYPE.CONFIRM,onClick:q}),[Y,q,U,g]),{loading:X,onClick:R}=$e(E);return[(0,He.useMemo)(()=>({loading:X,onClick:R,actionType:Ke.ACTION_TYPE.CANCEL}),[X,R]),re]},Uo=vn;a();i();var We=M(ee());te();var Tn=e=>{let[t,r]=(0,We.useState)({isNetworkFeeLoading:!0,gasLimit:"0",gasPrice:"0",maxFeePerGas:"0",maxPriorityFeePerGas:"0",supportEip1559:!1,gasType:Q.STANDARD}),{gasLimitInfo:n={},gasLimit:l,gasPrice:v,maxFeePerGas:s,gasType:p,supportEip1559:d,customConfirmed:c,isGasLimitLoading:x,isNetworkFeeLoading:u,networkFee:f,maxPriorityFeePerGas:m,gasPriceInfo:F,extFee:T,useDefaultGas:E}=t,{minGasFee:w}=Xt({gasLimit:l,gasPrice:v,maxPriorityFeePerGas:m,maxFeePerGas:s,supportEip1559:d,extFee:T,gasPriceInfo:F,gasLimitInfo:n,gasType:p}),N=(0,We.useMemo)(()=>p===Q.CUSTOM&&!c&&!E?o("extension_send_mid_text_dapps_suggested_fee"):p||Q.STANDARD,[c,p,E]),_=Ge(t,e),g=u&&x&&!n?.gasLimit;return{level:N,estimateFailed:_,customGasInfo:t,loading:u,networkFee:g?void 0:w,maxNetworkFee:g?void 0:f,onCustomGasInfoChange:r}},zo=Tn;a();i();var he=M(ee());Ro();ke();var gn=({txType:e,walletId:t,coinId:r,txParams:n,customGasInfo:l,preExecuteLoading:v})=>{let[s,p]=(0,he.useState)(""),d=Te(r),{from:c,to:x}=n||{},[u,f]=(0,he.useState)("");(0,he.useEffect)(()=>{v||(Xe(e)||_o(e)?(p(Je.approval),f(Xe(e)?"approve":"revoke_approve")):(p(Je.dapp),f("Contract interaction")))},[v,e]);let m=Qt({walletId:t,coinId:r,fromAddress:c,toAddress:x,txType:s,fee:pt(l?.networkFee),disabled:!x,unavailable:l.gasType===Q.CUSTOM&&l.customConfirmed}),{status:F,activity:T,activityId:E,tip:w,clear:N}=m,_=()=>{ut({activityId:E,activity:T,status:F,tip:w,walletId:t,address:c})},g=T?.errorCode;return(0,he.useEffect)(()=>{!u||g===0&&Tt({wallet_address:c,interactive_address:x,chain_id:d?.chainId,transaction_type:u})},[g,u,c,x,d?.chainId]),{gasReturnActivity:m,clearGasReturnInfo:N,reportGasReturnActivityDataInConfirm:_}},Yo=gn;a();i();ke();var hn=e=>{let{txParams:t={}}=e,{gasPrice:r,maxFeePerGas:n,maxPriorityFeePerGas:l}=t,v=t.gas||t.gasLimit,s=Q.STANDARD,p,d,c,x=Z(v),u=Z(r),f=Z(n),m=Z(l);return xe(u,0)&&(s=Q.CUSTOM,p=u),xe(f,0)&&xe(m,0)&&xe(f,m)&&(s=Q.CUSTOM,d=f,c=m),xe(x,0)&&(s=Q.CUSTOM),!t.to&&t.data&&(s=Q.CUSTOM),{initialGasType:s,initialCustomMaxPriorityFee:c,initialCustomGasLimit:x,initialCustomGasPrice:p,initialCustomMaxBaseFee:Pe(d,c)}},Zo=hn;a();i();var et={"data-input":"_data-input_1k4cq_1",dataInput:"_data-input_1k4cq_1","data-input-error-tip":"_data-input-error-tip_1k4cq_5",dataInputErrorTip:"_data-input-error-tip_1k4cq_5"};var Cn=e=>Number(e)===Le.INCREASE_ALLOWANCE?Po:[],wn=e=>{let{txId:t,chainId:r,walletId:n,txParams:l,dappInfo:v={},needMev:s=!1,openMev:p,coinId:d,isShowBlockSwapMevTooltip:c,onMevChange:x,onConfirm:u,onConfirmReplace:f,onCancel:m}=e||{},[F,T]=(0,de.useSetState)({mevInfo:{},isMev:p}),[E,{toggle:w}]=(0,de.useBoolean)(!1),{from:N,to:_,value:g="0x0",data:G}=l||{},[b,B]=(0,H.useState)(""),k=Te(d,void 0,{chainId:r}),W=k?.coinId,[D,z]=(0,H.useState)({}),Y=D.loading,$=(0,H.useMemo)(()=>!_&&G?Nt.DEPLOY_CONTRACT:D?.approveInfoList?.[0]?.spender?.approvalType||"",[_,G,D]),U=Yt(k?.localType,n),q=Z(g),re=Zo({txParams:l}),X=mo(U.walletId),R=(0,H.useMemo)(()=>Io(b),[b]),{isMev:oe,mevInfo:ne}=F,se=b||G||"",me=(0,H.useMemo)(()=>({dappData:JSON.stringify({to:_,from:N,value:g,data:se}),from:N,dappInfo:v,chainIndex:k?.chainId,method:bt.SIGN_TRANSACTION}),[k?.chainId,N,se,_,g]),L=(0,de.useMemoizedFn)((le,fe)=>{T({isMev:le,mevInfo:fe}),x?.(le,fe)}),{level:Ce,networkFee:we,maxNetworkFee:Ae,customGasInfo:tt,estimateFailed:ot,loading:Vo,onCustomGasInfoChange:qo}=zo($),{gasReturnActivity:nt,reportGasReturnActivityDataInConfirm:Qo}=Yo({txType:$,coinId:W,txParams:l,customGasInfo:tt,preExecuteLoading:Y,walletId:U.walletId}),at=De(W,n),{coinAmountInt:_e,isBalanceLoadError:jo,isBalanceLoading:Jo}=at,it=(0,H.useMemo)(()=>(ye(_e)||V.gte(_e,Ae))&&D?.needFillUp!==!0,[_e,Ae,D?.needFillUp]),rt=(0,H.useMemo)(()=>!V.eq(q,0)&&!ye(_e)?V.lte(q,V.sub(_e,Ae)):!0,[_e,Ae,q]),Ko=Uo({coinId:W,txType:$,txParams:l,isMev:oe,mevInfo:ne,isBalanceLoadError:jo,isBalanceLoading:Jo,canConfirm:D?.canConfirm,silentLoading:D?.silentLoading,isSufficientGas:it,isSufficientBalance:rt,walletAccount:U,customGasInfo:tt,gasReturnActivity:nt,modifiedDataError:R,localType:k?.localType,modifiedData:se,walletId:U?.walletId,reportGasReturnActivityDataInConfirm:Qo,onCancel:m,onConfirm:u,onConfirmReplace:f}),$o=(0,de.useMemoizedFn)(le=>{let fe=Cn($),Ie=At(l?.data,fe);if(Ie){let Ue=fo(l?.data,{approveAmount:le},Ie);B(Ue)}});return H.default.createElement(H.default.Fragment,null,H.default.createElement(vo,{handleCancel:m,preExecParams:me,walletAccount:U,buttonGroup:Ko,onUpdatePreExecInfo:z,txState:{txId:t,baseCoin:k,estimateFailed:ot,isSufficientBalance:rt,isSufficientGas:it,coinWithBalance:at},localType:k?.localType,slot:{mev:!!s&&D?.mevInfo?.supportMev&&H.default.createElement(Go,{isMev:oe,needTooltip:!1,onMevChange:L,isShowBlockSwapMevTooltip:c,serverMevInfo:D.mevInfo}),networkFeeEntry:H.default.createElement(no,{level:Ce,coinId:W,networkFee:we,loading:Vo,estimateFailed:ot,onClick:()=>{w(),X({trade:"contract_interaction",all_confirmation:"network_fee"})}}),interactWith:!!_&&H.default.createElement(oo,{address:_,title:o("wallet_extension_popup_text_interact_with")}),advancedEntry:!G&&H.default.createElement(Ao,{value:b,error:R,onChange:B,className:et["data-input"],errorTipClass:et["data-input-error-tip"]})},renderEditApproveAmount:(le,fe)=>{let Ie=le?.authQuantity?.canEdit,Ue=le?.spender?.approvalType;return[Le.INCREASE_ALLOWANCE,Le.AUTHORIZATION].includes(Ue)&&Ie?H.default.createElement(Ho,{txTypeInfo:D?.txTypeInfo,walletAccount:U,approve:le,baseCoin:k,onAuthTokenAmountChange:$o,updateApproveInfo:fe}):null}}),H.default.createElement(Rt,{visible:E,coinId:W,address:N,inputData:se,tokenAddress:_,value:Z(g),onBack:w,onClose:null,initialGasData:re,onGasChange:qo,minimumGasLimit:oe?ne.gas:0,isMev:oe,mevInfo:ne,gasReturn:nt,gasLimitOptions:{disabled:R}}))},Fs=wn;export{No as a,Ao as b,Io as c,Go as d,Fs as e};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-DOWV6C3B.js.map
