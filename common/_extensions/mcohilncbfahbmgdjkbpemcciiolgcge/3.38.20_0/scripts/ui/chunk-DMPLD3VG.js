import{a as g}from"./chunk-WWUOPI5T.js";import{c as O,d as V}from"./chunk-HVADQEJS.js";import{a as z,b as Z}from"./chunk-A52XYJMT.js";import{d as pe}from"./chunk-BCT5GPKT.js";import{b as M}from"./chunk-WD7752PC.js";import{b as L,c as v}from"./chunk-SLWKMGPD.js";import{e as b,h as G}from"./chunk-GTSNHSPT.js";import{b as F,c as D}from"./chunk-3OMHZBKM.js";import{o as De}from"./chunk-A3FIPWG3.js";import{F as Fe,Fb as _,ac as $,zb as me}from"./chunk-NTISK7TT.js";import{na as ce,oa as Be}from"./chunk-KSCBZ3RY.js";import{d as w,f as _e}from"./chunk-37O7OMRA.js";import{Gb as Y,Hb as se,Ib as x,Oc as Se,Uc as ue,Wc as Re,Xc as le,Yc as Ie,Za as I,Zb as ae,fc as H,wb as Pe,zc as ie}from"./chunk-YILNSICT.js";import{A as R,G as U,pa as q,q as re}from"./chunk-LBCQTFOD.js";import{a as k}from"./chunk-B75PPTYD.js";import{f as A,m as l,o as m}from"./chunk-UGZFXKPB.js";l();m();l();m();var fe=A($());var de=A(k());var Le=e=>{let[o]=D(F.showNftAmount),t=G(e),n=O(),s=L(),r=v(s),c=(0,fe.useSelector)(_);return(0,de.useMemo)(()=>{let{walletAccountsWidthBalance:i}=V({walletAccounts:[t],showNftAmount:o,rpcData:null,selectedCurrency:r,assetsMap:n,hiddenSmallAsset:c});return i[0]},[t,o,r,n])},ve=Le;l();m();var te=A(k()),ne=A($());q();l();m();var B=A(k()),d=A($()),E=A(De()),ee=A(Fe());q();l();m();var Ae=A(k());l();m();var J={},Oe=async e=>{let o=(await import("./web3.min-74RHLRUB.js")).default,t=new o(new o.providers.HttpProvider(e));return J[e]=t,t},he=async e=>J[e]?J[e]:Oe(e);var N=(e="",o=null)=>{let{extensionConfig:t}=g("rpc_info"),n=o||t;return(0,Ae.useCallback)(async()=>{let s=e||n?.rpcUrl;return s?await he(s):{}},[e,n])};l();m();var Ce=A(k());function K(e,o,t){let n=Ce.default.useRef({});return(!("value"in n.current)||t(n.current.condition,o))&&(n.current.value=e(),n.current.condition=o),n.current.value}Se();Pe();Ie();Re();H();l();m();H();var Ke=6,Te=(e,o=Ke)=>{if(!Number(e))return"0";let t=e?.toString();return(e.split(".")[1]||"")?.length>o?ae(t,o&&Number(o)):t},Ee=(e,o)=>{let{rpcUrl:t,chainId:n,account:s,existAccounts:r,isDeleted:c}=o;return Array.isArray(e)?e.filter(i=>{let a=!0;return n&&(a=a&&i.chainId===n),s&&(a=a&&i.account===s),Array.isArray(r)&&!!r?.length&&(a=a&&r?.includes(i.account)),c!==void 0&&(a=a&&(i.isDeleted||!1)===c),i.address||(a=a&&i.rpcUrl===t),a}):[]},We=(e,o={})=>{let{symbol:t,usdToThisRate:n,chainTokenPrice:s,chainTokenBalance:r}=o;return Array.isArray(e)?e.map(c=>{let i,a,{chainId:u,decimals:p}=c,T=t;c.address?(i=s?.[u]?.[c.address]||0,a=r?.[c.account]?.[u]?.[c.address]||0):(i=s?.[u]?.price||0,a=r?.[c.account]?.[u]?.balance||0),a=Te(a&&se(a,10**p));let f=Te(Y(a,Y(i,n)));return{price:i,balance:a,...c,moneySymbol:T,marketValue:f}}):[]};l();m();Be();_e();l();m();q();l();m();var ye="rpc",P={MANAGE_NET:"manageNet",EVM:"evm"},ke={[P.MANAGE_NET]:"ManageNet",[P.EVM]:"Evm"};var xe=re((e,o)=>{let t=ke[e];if(!t)throw new Error("rpc type must in maps");if(!(typeof o=="string"&&/^[0-9a-zA-Z]+$/g.test(o)))throw new Error("scope name is invalid");return`${ye}${t}${o}`}),_t=xe(P.MANAGE_NET),we=xe(P.EVM),Ft={"MNEMONIC WALLET":"seed_phrase","PRIVATE KEY WALLET":"private_key","MPC WALLET":"mpc","HARDWARE WALLET":"hardware"};var Ue="Token",qe=we(Ue),Ye={chainTokens:[],chainTokenPrice:{},chainTokenBalance:{}},Q=e=>e.metamask.rpcEvmChainTokens||[],ge=e=>e.metamask.rpcEvmChainTokenPrice||{},be=e=>e.metamask.rpcEvmChainTokenBalance||{},He=ce({name:qe,initialState:Ye,reducers:{}}),{reducer:$e}=He,Me=e=>async()=>{await w().addChainToken(e)},X=e=>async()=>{await w().updateChainToken(e)},Ne=e=>async()=>{await w().updateChainTokenPrice(e)},j=e=>async()=>{await w().updateChainTokenBalance(e)},Ut=$e;var W=(e,o,t=!0,n=null)=>{let{extensionConfig:s}=g("rpc_info"),r=n||s,{chainId:c,rpcUrl:i}=r,a=(0,d.useSelector)(Q),u=(0,d.useSelector)(ge),p=(0,d.useSelector)(be),{symbol:T,usdToThisRate:f}=(0,d.useSelector)(me),h=z(),S=Z(void 0,I),y=(0,B.useMemo)(()=>Ee(a,{chainId:c,rpcUrl:i,existAccounts:S,account:t?h:void 0,isDeleted:o?void 0:!1}),[c,h,S,a]);return(0,B.useMemo)(()=>e?y:We(y,{symbol:T,usdToThisRate:f,chainTokenPrice:u,chainTokenBalance:p}),[T,y,f,u,p,e])},un=(e,o,t)=>{let n=W(o,void 0,void 0,t);return(0,B.useMemo)(()=>n.find(s=>s.address===(e||void 0))||{},[e,n])};var Ge=(e,o)=>{let t=N(e,o);return(0,E.useMemoizedFn)(async n=>{let s=await t(),r=new s.eth.Contract(ee.default,n),c=await r.methods.symbol().call(),i=await r.methods.decimals().call();return{name:await r.methods.name().call(),symbol:c,decimals:i}},[t])},ze=e=>{let o=N(void 0,e),t=M();return(0,E.useMemoizedFn)(async(n,s,r)=>{let c,i=r||await o(),a=s||t;return n?c=await new i.eth.Contract(ee.default,n).methods.balanceOf(a).call():c=await i.eth.getBalance(a,"latest"),c},[o,t])},Ze=()=>(0,E.useMemoizedFn)(async(e,o)=>{let t=o;typeof o=="string"&&(t=[o]);try{let{data:n}=await ue(le.getCoinPrice,{tokenAddresses:t,chainId:typeof e=="string"?Number.parseInt(e,16):e});return n}catch{return[]}},[]),ln=()=>{let e=N(),o=(0,d.useDispatch)();return(0,E.useMemoizedFn)(async({chainId:t,injectWeb3:n,wallets:s=[]})=>{let r=n||await e(),c=new r.BatchRequest;s.forEach(i=>{c.add(r.eth.getBalance.request(i,"latest",(a,u)=>{a||o(j({chainId:t,balance:u,account:i}))}))}),c.execute()})},Je=()=>{let e=(0,d.useDispatch)(),o=M(),t=Ze(),n=ze();return(0,E.useMemoizedFn)(async({chainId:s,address:r,injectAccount:c,injectWeb3:i})=>{let[a,u]=await Promise.all([t(s,r),n(r,c,i)]);return a?.length&&e(Ne({chainId:s,price:a[0].price})),e(j({chainId:s,balance:u,address:r,account:c||o})),!0},[n,o])},mn=e=>{let o=M(),{extensionConfig:t}=g("rpc_info"),n=e||t,{chainId:s}=n,r=W(!0,!1,!1,e);return K(()=>({chainId:s,chainTokens:r}),{chainId:s,account:o,needPollChainTokens:r},(c,i)=>!U(c,i))},Qe=18,Xe=()=>{let e=(0,d.useDispatch)(),o=(0,d.useSelector)(Q),t=M();return(0,E.useMemoizedFn)((n,s,r)=>{if(!n&&!t&&!r?.account)return!1;let{rpcUrl:c}=r,i=o.find(u=>{let p=u.chainId===n&&u.address===s&&u.account===(r?.account||t);return s||(p=p&&u.rpcUrl===c),p});if(i){if(i.isDeleted===!0){let u={...i,...r,chainId:n,address:s,isDeleted:!1};return e(X(u)),!0}return!1}let a={chainId:n,address:s,isDeleted:!1,account:t,decimals:Qe};return r&&typeof r=="object"&&Object.assign(a,r),e(Me(a)),!0},[o,t])},pn=e=>{let o=N(e),t=Xe(),n=Ge(e),s=Je();return async(r,c)=>{let i=await n(c);if(t(r,c,i)){let u=await o();await s(r,c,u)}}},je=(e={})=>{let o=b(e);return K(()=>o.reduce((t,n)=>{if(n.keyringIdentityType===ie.MNEMONIC)t.push(n);else{let s=n.walletIdentities.filter(r=>Boolean(r.account[I]));s.length&&t.push({...n,walletIdentities:s})}return t},[]),o,(t,n)=>!U(t,n))},fn=(e={})=>{let o=je(e),t=W(!1,!1,!1);return(0,B.useMemo)(()=>{let n=R(t||[],"account");return o?.map(s=>{let r="",c=s.walletIdentities?.map(a=>{let u=a?.account?.[I],{balance:p,symbol:T}=n[u]?.filter(({address:f})=>!f)[0]||{};return r=T,{...a,balance:p,symbol:T}}),i=c.reduce((a,u)=>x(a,u.balance),0);return{...s,marketValue:i,marketValueSymbol:r,walletIdentities:c}})||[]},[t,o])},dn=()=>{let e=(0,d.useDispatch)(),o=W(!0,!1,!1);return t=>{o?.filter(({chainId:n,rpcUrl:s,address:r})=>!r&&n===t.chainId&&s===t.rpcUrl)?.forEach(({chainId:n,account:s})=>{e(X({chainId:n,account:s,...t}))})}};H();var et=e=>{let o=b(e),[t]=D(F.showNftAmount),n=L(),s=v(n),{isRpcMode:r}=(0,ne.useSelector)(pe),c=W(!1,!1,!1),i=R(c||[],"account"),a=(0,ne.useSelector)(_),u=O(),p=(0,te.useMemo)(()=>o.map(f=>{let{walletIdentities:h}=f,{walletAccountsWidthBalance:S,walletAsset:y,platformAsset:oe}=V({walletAccounts:h,showNftAmount:t,rpcData:r?{chainTokensAccountMap:i}:null,selectedCurrency:s,assetsMap:u,hiddenSmallAsset:a});return{...f,walletAsset:y,platformAsset:oe,walletIdentities:S}}),[o,t,i,r,s,u]);return[(0,te.useMemo)(()=>p?.reduce((f,h)=>({walletAsset:x(f.walletAsset,h.walletAsset==="--"?"0":h.walletAsset),platformAsset:x(f.platformAsset,h.platformAsset==="--"?"0":h.platformAsset),rpcModeCoinSymbol:f.rpcModeCoinSymbol||h?.rpcModeCoinSymbol}),{walletAsset:"0",platformAsset:"0",rpcModeCoinSymbol:""}),[p]),p]},tt=et;export{_t as a,we as b,Ft as c,qe as d,Q as e,X as f,Ne as g,j as h,Ut as i,ve as j,Oe as k,he as l,N as m,K as n,W as o,un as p,Ge as q,ze as r,Ze as s,ln as t,Je as u,mn as v,Xe as w,pn as x,je as y,fn as z,dn as A,tt as B};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-DMPLD3VG.js.map
