import{a as Me}from"./chunk-6NIK3NYT.js";import{a as We,c as W,d as U}from"./chunk-4MFRD43G.js";import{a as Re}from"./chunk-Q2BK5I52.js";import{b as we,c as H,d as z,e as ve,f as ye,g as xe,h as Ie,i as be,j as Ee,k as Ne,l as $,m as O,n as j,o as ke,p as G,q as K,r as Ce,s as Te,t as Se,u as Ue}from"./chunk-NOSZQ6WM.js";import{A as Be}from"./chunk-DMPLD3VG.js";import{a as Ae}from"./chunk-WWUOPI5T.js";import"./chunk-HVADQEJS.js";import"./chunk-A52XYJMT.js";import{b as ie}from"./chunk-BCT5GPKT.js";import"./chunk-WD7752PC.js";import"./chunk-SLWKMGPD.js";import"./chunk-UC77E3WD.js";import"./chunk-GTSNHSPT.js";import"./chunk-LVPRDSPO.js";import{a as ze}from"./chunk-RJO5LUBF.js";import{a as $e}from"./chunk-UEENMIFU.js";import"./chunk-3OMHZBKM.js";import"./chunk-A264YTOP.js";import"./chunk-LRVKM4IV.js";import{R as he,a as ue,wa as ge}from"./chunk-PVSNAFN3.js";import{b as ne}from"./chunk-JYKQJVIF.js";import"./chunk-GBQG32PI.js";import"./chunk-Q6XXIWBJ.js";import"./chunk-VWYA3Z7M.js";import{o as Le}from"./chunk-A3FIPWG3.js";import{ac as A}from"./chunk-NTISK7TT.js";import"./chunk-MXRUZQZ7.js";import"./chunk-CU7RFE6B.js";import"./chunk-J4UWPXXS.js";import{a as Pe}from"./chunk-QZUNX5I4.js";import{b as V}from"./chunk-IVA2TTR4.js";import{i as De}from"./chunk-OG3IV3YP.js";import"./chunk-45FKVGCF.js";import"./chunk-KSCBZ3RY.js";import"./chunk-37O7OMRA.js";import"./chunk-5PGNMLJO.js";import"./chunk-35FUKWV2.js";import"./chunk-DHNKVM4B.js";import"./chunk-VL5VJIZ7.js";import"./chunk-TU7CE5HJ.js";import"./chunk-2NE2FMGV.js";import{Rc as ce,Tc as fe,Wc as de,Xc as _e,Yc as lr,ob as me,wb as sr}from"./chunk-YILNSICT.js";import"./chunk-ORQMOT6Z.js";import{A as oe,c as te,q as y}from"./chunk-L4N7WJIQ.js";import"./chunk-LBCQTFOD.js";import{N as L,w as t}from"./chunk-V63HWKAL.js";import"./chunk-ZZ2UZY4M.js";import"./chunk-XFAFBXWC.js";import"./chunk-7EEPBGCR.js";import"./chunk-CY6DCOJP.js";import{H as ar,T as pe,Z as C,ca as T}from"./chunk-2EJYCNYZ.js";import"./chunk-V2K75WCG.js";import{a as P}from"./chunk-B75PPTYD.js";import"./chunk-2AWSM2JA.js";import"./chunk-QXPU36HD.js";import"./chunk-QI5O5UGB.js";import"./chunk-2OGSVQVK.js";import"./chunk-Y5BBPTSN.js";import"./chunk-LQWZRQFF.js";import"./chunk-VGOLUGG3.js";import"./chunk-6SIBAM5N.js";import"./chunk-42IJDSSW.js";import"./chunk-BMKS7XLD.js";import"./chunk-MTFM4GGW.js";import{c as nr,f as v,m as u,n as E,o as h}from"./chunk-UGZFXKPB.js";var se=nr((hr,qe)=>{u();h();(function(o){"use strict";o.exports.is_uri=c,o.exports.is_http_uri=r,o.exports.is_https_uri=i,o.exports.is_web_uri=w,o.exports.isUri=c,o.exports.isHttpUri=r,o.exports.isHttpsUri=i,o.exports.isWebUri=w;var s=function(a){var e=a.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/);return e};function c(a){if(!!a&&!/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(a)&&!/%[^0-9a-f]/i.test(a)&&!/%[0-9a-f](:?[^0-9a-f]|$)/i.test(a)){var e=[],n="",f="",l="",_="",d="",p="";if(e=s(a),n=e[1],f=e[2],l=e[3],_=e[4],d=e[5],!!(n&&n.length&&l.length>=0)){if(f&&f.length){if(!(l.length===0||/^\//.test(l)))return}else if(/^\/\//.test(l))return;if(!!/^[a-z][a-z0-9\+\-\.]*$/.test(n.toLowerCase()))return p+=n+":",f&&f.length&&(p+="//"+f),p+=l,_&&_.length&&(p+="?"+_),d&&d.length&&(p+="#"+d),p}}}function r(a,e){if(!!c(a)){var n=[],f="",l="",_="",d="",p="",b="",m="";if(n=s(a),f=n[1],l=n[2],_=n[3],p=n[4],b=n[5],!!f){if(e){if(f.toLowerCase()!="https")return}else if(f.toLowerCase()!="http")return;if(!!l)return/:(\d+)$/.test(l)&&(d=l.match(/:(\d+)$/)[0],l=l.replace(/:\d+$/,"")),m+=f+":",m+="//"+l,d&&(m+=d),m+=_,p&&p.length&&(m+="?"+p),b&&b.length&&(m+="#"+b),m}}}function i(a){return r(a,!0)}function w(a){return r(a)||i(a)}})(qe)});u();h();var g=v(P()),er=v(A()),rr=v(Pe()),tr=v(Le()),or=v(ar());L();u();h();var M=v(P()),Q=v(A());L();var Ze=(0,M.memo)(o=>{let{disabled:s}=o,c=(0,Q.useDispatch)(),r=({target:{value:n}})=>{c(be(n))},{name:i,nameErr:w}=(0,Q.useSelector)(we),a=()=>{c(Ee(t(i?"":"developer_mode_network_errortip_cannotspace")))},e=t("extension_wallet_addnetwork_placeholder_network");return M.default.createElement("div",{className:"net-form__wrap-input"},M.default.createElement(y,{value:i,onBlur:a,disabled:s,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:w,onChange:r,placeholder:e,label:t("wallet_transaction_history_subtitle_network_name")}))});u();h();var B=v(P()),Z=v(A()),Ye=v(se());L();u();h();u();h();de();async function Fe(o,s,c=[]){let r=o,i={"Content-Type":"application/json"},{origin:w,pathname:a,username:e,password:n,search:f}=new URL(o);if(e&&n){let p=E.Buffer.from(`${e}:${n}`).toString("base64");i.Authorization=`Basic ${p}`,r=`${w}${a}${f}`}let{data:l}=await fe(r,{id:Date.now().toString(),jsonrpc:"2.0",method:s,params:c},{timeout:3e4,cache:"default",headers:i});if(!l||Array.isArray(l)||typeof l!="object")throw new Error(`RPC endpoint ${o} returned non-object response.`);let{error:_,result:d}=l;if(_)throw new Error(_?.message||_);return d}var X=o=>{try{let s=new URL(o);return s.protocol==="http:"||s.protocol==="https:"}catch{return!1}},J=((o={})=>s=>new Promise((c,r)=>o[s]?c(o[s]):Fe(s,"eth_chainId").then(i=>{o[s]=i,c(i)}).catch(i=>{r(i)})))();var He=B.default.memo(o=>{let{disabled:s,modify:c}=o,r=(0,Z.useDispatch)(),[i,w]=(0,B.useState)(!1),a=({target:{value:p}})=>{r(Ne(p.trim()))},{rpcUrl:e,rpcUrlErr:n}=(0,Z.useSelector)(H),{rpcNetworks:f}=U(),{chainId:l}=(0,Z.useSelector)(z),_=()=>{if(!e)return r($(t("developer_mode_network_errortip_cannotspace")));if(!X(e))return r($(t("developer_mode_infor_errortip_https")));if(!Ye.default.isWebUri(e))return r($(t("developer_mode_infor_errortip_rpcurl")));let b=f.find(m=>m.rpcUrl===e);return b&&!c?r($(t("developer_mode_infor_errortip_used_network",{network:b.name}))):(w(!0),J(e).then(m=>{try{m=parseInt(m,16).toString(10),c?m!==l&&r(j({err:t("developer_mode_infor_errortip_chainid",{chainID:m}),validChainId:l})):r(O(m))}catch{}w(!1),r($(""))}).catch(()=>{r($(t("developer_mode_infor_errortip_rpcurl"))),w(!1)}))},d=t("extension_wallet_addnetwork_placeholder_prcurl");return B.default.createElement("div",{className:"net-form__wrap-input"},B.default.createElement(y,{value:e,onBlur:_,disabled:s,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:n,onChange:a,placeholder:d,label:t("developer_mode_network_title_rpcurl"),suffix:i&&B.default.createElement(C.Circle,{size:C.SIZE.sm})}))});u();h();var D=v(P()),q=v(A()),Oe=v(Le());L();lr();de();var mr=async o=>{let{data:s}=await ce(_e.getRpcNetworkByChainId,{chainIds:[o]});return s?.[0]?.nativeCurrency?.symbol},je=D.default.memo(o=>{let{disabled:s,modify:c}=o,r=(0,q.useDispatch)(),i=({target:{value:m}})=>{r(G(m.trim()))},{symbol:w,symbolErr:a,symbolTip:e}=(0,q.useSelector)(ve),[n,f]=(0,D.useState)(!1),{chainId:l}=(0,q.useSelector)(z),[_,d]=(0,D.useState)(!0),p=()=>{let m="";if(!l){r(K(m));return}w||(m=t("developer_mode_network_errortip_cannotspace"),r(K(m))),r(K(m))};(0,Oe.useDebounceEffect)(()=>{(async()=>{if(!l||c)return;let m;f(!0);try{r(G("")),m=await mr(l),r(G(m))}catch{}finally{d(m),f(!1)}})()},[l],{wait:500});let b=t("extension_wallet_addnetwork_placeholder_symbol");return D.default.createElement("div",{className:"net-form__wrap-input"},D.default.createElement(y,{value:w,disabled:s||c||_,onBlur:p,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:a,tips:e,onChange:i,suffix:n&&D.default.createElement(C.Circle,{size:C.SIZE.sm}),placeholder:b,label:t("developer_mode_network_title_tokenname")}))});u();h();var N=v(P()),F=v(A());L();u();h();sr();function Ge(o){return Number.isSafeInteger(o)&&o>0&&o<=me}var Ke=N.default.memo(o=>{let{disabled:s,modify:c}=o,r=(0,F.useDispatch)(),i=({target:{value:x}})=>{r(O(x.trim()))},[w,a]=(0,N.useState)(!1),{chainId:e,chainIdErr:n,chainIdTip:f,fieldUpdated:l}=(0,F.useSelector)(z),{rpcUrl:_}=(0,F.useSelector)(H),{rpcNetworks:d}=U(),p=(x,I,k=e)=>{r(j({err:x,validChainId:k})),r(ke({tip:I,validChainId:k}))},b=()=>{let x="",I="";if(!e)return x=t("developer_mode_network_errortip_cannotspace"),p(x,I);let k=e,ae=10;if(!k.startsWith("0x"))try{k=`0x${V(k)}`}catch{x=t("developer_mode_infor_errortip_errorchainid")}let[le]=d.filter(S=>S.chainId===k&&S.rpcUrl!==_);if(le?I=t("developer_mode_infor_errortip_network",{network:le.name}):e.startsWith("0x")?(ae=16,/^0x[0-9a-f]+$/iu.test(e)||(x=t("developer_mode_infor_errortip_errornum"))):/^[0-9]+$/u.test(e)?e.startsWith("0")?x=t("developer_mode_infor_errortip_errornum"):Ge(parseInt(e,ae))||(x=t("developer_mode_infor_errortip_errorchainid")):x=t("developer_mode_infor_errortip_errornum"),!_||w||x)return p(x,I);a(!0),J(_).then(S=>{if(k!==S){if(!e.startsWith("0x"))try{S=parseInt(S,16).toString(10)}catch(ir){console.log(ir)}x=t("developer_mode_infor_errortip_chainid",{chainID:S})}p(x,I,e),a(!1)}).catch(()=>{I=t("developer_mode_infor_errortip_rpcurl_confirm"),a(!1),p(x,I,e)})},m=t("extension_wallet_addnetwork_placeholder_chainid");return N.default.createElement("div",{className:"net-form__wrap-input"},N.default.createElement(y,{value:e,disabled:s||!!c,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:n,onBlur:b,tips:f,onChange:i,suffix:w&&l&&N.default.createElement(C.Circle,{size:C.SIZE.sm}),placeholder:m,label:N.default.createElement(N.default.Fragment,null,t("developer_mode_network_title_chainid"),N.default.createElement(oe,{title:t("developer_mode_network_tooltip_display_decimal"),placement:oe.DIRECTION.topRight},N.default.createElement(pe,{className:"okx-wallet-plugin-information-circle"})))}))});u();h();var R=v(P()),Y=v(A()),Ve=v(Pe());L();u();h();var Qe=o=>{let{modify:s,uniqueId:c,onDeleteNet:r}=o,i=(0,Ve.useHistory)(),w=(0,Y.useSelector)(Ie),a=Be(),{rpcNetworks:e,updateRpcNetwork:n,addRpcNetwork:f}=U(),{extensionConfig:l,setExtensionConfig:_}=Ae("rpc_info"),d=(0,Y.useDispatch)(),p=(0,Y.useSelector)(xe),b=e.find(I=>W(I,{uniqueId:c}))||{},m=(0,R.useRef)(!1),x=async()=>{if(!m.current){if(m.current=!0,s){let I=await n({...b,...p});W(I,l)&&await _(I);let k={...p,chainId:`0x${V(p.chainId)}`};a(k),i.replace(`${he}?tab=2`)}else{let I=await f(p);await d(ie("isRpcMode",!0)),await d(ie("currentNetworkUniqueId",I?.uniqueId)),await _(I),i.replace(ge)}m.current=!1}};return R.default.createElement($e.FooterActions,{usePortal:!0},s&&R.default.createElement(T,{category:T.CATEGORY.outline,type:T.TYPE.primary,size:T.SIZE.lg,onClick:r,className:"net-form__footer-delete-btn",contentClassName:"net-form__footer-delete-btn__text"},t("commonall_resultpage_btn_delete")),R.default.createElement(T,{disabled:w,category:T.CATEGORY.fill,type:T.TYPE.highlight,size:T.SIZE.lg,onClick:x},t("developer_mode_bot_btn_save")))};u();h();var ee=v(P()),re=v(A()),Xe=v(se());L();var Je=ee.default.memo(o=>{let{disabled:s}=o,c=(0,re.useDispatch)(),r=({target:{value:n}})=>{c(Ce(n.trim()))},{explorerUrl:i,explorerUrlErr:w}=(0,re.useSelector)(ye),a=()=>{let n="";i&&(Xe.default.isWebUri(i)||(X(i)?n=t("developer_mode_infor_errortip_invalidurl"):n=t("developer_mode_infor_errortip_https1"))),c(Te(n))},e=t("extension_wallet_addnetwork_placeholder_blockchain");return ee.default.createElement("div",{className:"net-form__wrap-input"},ee.default.createElement(y,{value:i,onBlur:a,disabled:s,size:y.SIZE.xl,errorType:y.TIP_TYPE.always,error:w,onChange:r,placeholder:e,label:t("developer_mode_network_title_blockchain_explorer")}))});var Vt=()=>{let o=(0,er.useDispatch)(),s=(0,rr.useHistory)(),c=Re(),r=c.get("modify"),i=r===We.CANT,w=decodeURIComponent(c.get("id")),{rpcNetworks:a}=U(),e=a.find(d=>W(d,{uniqueId:w}))||{};(0,g.useEffect)(()=>{let d={...e};d.chainId&&(d.chainId=`${Number.parseInt(d.chainId,16)}`),o(Se(d))},[e]),(0,tr.useUnmount)(()=>{o(Ue())});let n=(0,g.useCallback)(()=>{s.action==="POP"?s.replace(ue):s.goBack()},[s]),f=Me(),l=(0,g.useCallback)(()=>{f({editRpcInfo:e,onDeleted:n})},[f,n,e]),_=(0,g.useMemo)(()=>g.default.createElement("div",{className:"net-form__title"},e.name?g.default.createElement(g.default.Fragment,null,g.default.createElement(ne,{size:ne.SIZE.md,src:e.icon,text:e.name,className:"net-form__title-icon",defaultIcon:De}),g.default.createElement("div",{className:"net-form__title-text net-form__title-text-top"},e.name)):g.default.createElement("div",{className:"net-form__title-text"},t("wallet_extension_settings_header_custom_network"))),[e]);return g.default.createElement("div",{className:(0,or.default)("net-form",{disabled:i})},g.default.createElement(ze,{onBack:n,closeable:!1}),i||r?null:g.default.createElement(te,{className:"net-form__warn",desc:t("developer_mode_network_errortip_trust_network"),type:te.TYPE.warn,closable:!1}),_,g.default.createElement("div",{className:"net-form__wrap"},g.default.createElement(Ze,{disabled:i}),g.default.createElement(He,{disabled:i,modify:r}),g.default.createElement(Ke,{disabled:i,modify:r}),g.default.createElement(je,{disabled:i,modify:r}),g.default.createElement(Je,{disabled:i}),!i&&g.default.createElement(Qe,{modify:r,uniqueId:w,onDeleteNet:l})))};export{Vt as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=Form-QF3OL7HF.js.map
