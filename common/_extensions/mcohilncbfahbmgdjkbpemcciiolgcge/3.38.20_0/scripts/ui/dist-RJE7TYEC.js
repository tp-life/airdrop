import{b as dS}from"./chunk-3P7MWLN4.js";import"./chunk-PTKQOYRE.js";import"./chunk-IFPA53E4.js";import{a as uS}from"./chunk-2PNMH542.js";import{a as go}from"./chunk-RTOXOPRM.js";import"./chunk-6ZXPBMA4.js";import{a as ag,b as og,c as fg,d as cg,e as ug,f as dg,g as hg,h as lg}from"./chunk-LLWJFPQV.js";import{a as xu,b as sg}from"./chunk-XYCKE5Q7.js";import"./chunk-PJE3AWUO.js";import"./chunk-U5KK4TZK.js";import"./chunk-HQ74Q4WH.js";import{a as ig}from"./chunk-BMKS7XLD.js";import{B as Qb,E as eg,G as tg,H as rg,K as yu,L as ng,d as Zb,e as Yb,f as Jb,g as bo}from"./chunk-MTFM4GGW.js";import{b as fS,c as U,d as cS,g as b0,m as H,n as j,o as k}from"./chunk-UGZFXKPB.js";var zs=U(we=>{"use strict";H();k();Object.defineProperty(we,"__esModule",{value:!0});we.bytes=we.stringToBytes=we.str=we.bytesToString=we.hex=we.utf8=we.bech32m=we.bech32=we.base58check=we.base58xmr=we.base58xrp=we.base58flickr=we.base58=we.base64url=we.base64=we.base32crockford=we.base32hex=we.base32=we.base16=we.utils=we.assertNumber=void 0;function Vs(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}we.assertNumber=Vs;function mi(...e){let t=(i,s)=>o=>i(s(o)),r=Array.from(e).reverse().reduce((i,s)=>i?t(i,s.encode):s.encode,void 0),n=e.reduce((i,s)=>i?t(i,s.decode):s.decode,void 0);return{encode:r,decode:n}}function ji(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(r=>{if(Vs(r),r<0||r>=e.length)throw new Error(`Digit index outside alphabet: ${r} (alphabet: ${e.length})`);return e[r]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(r=>{if(typeof r!="string")throw new Error(`alphabet.decode: not string element=${r}`);let n=e.indexOf(r);if(n===-1)throw new Error(`Unknown letter: "${r}". Allowed: ${e}`);return n})}}}function Li(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let r of t)if(typeof r!="string")throw new Error(`join.encode: non-string input=${r}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function Zf(e,t="="){if(Vs(e),typeof t!="string")throw new Error("padding chr should be string");return{encode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let n of r)if(typeof n!="string")throw new Error(`padding.encode: non-string input=${n}`);for(;r.length*e%8;)r.push(t);return r},decode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let i of r)if(typeof i!="string")throw new Error(`padding.decode: non-string input=${i}`);let n=r.length;if(n*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--)if(!((n-1)*e%8))throw new Error("Invalid padding: string has too much padding");return r.slice(0,n)}}}function xg(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function pg(e,t,r){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let n=0,i=[],s=Array.from(e);for(s.forEach(o=>{if(Vs(o),o<0||o>=t)throw new Error(`Wrong integer: ${o}`)});;){let o=0,a=!0;for(let f=n;f<s.length;f++){let l=s[f],v=t*o+l;if(!Number.isSafeInteger(v)||t*o/t!==o||v-l!==t*o)throw new Error("convertRadix: carry overflow");if(o=v%r,s[f]=Math.floor(v/r),!Number.isSafeInteger(s[f])||s[f]*r+o!==v)throw new Error("convertRadix: carry overflow");if(a)s[f]?a=!1:n=f;else continue}if(i.push(o),a)break}for(let o=0;o<e.length-1&&e[o]===0;o++)i.push(0);return i.reverse()}var mg=(e,t)=>t?mg(t,e%t):e,mu=(e,t)=>e+(t-mg(e,t));function V1(e,t,r,n){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(mu(t,r)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${mu(t,r)}`);let i=0,s=0,o=2**r-1,a=[];for(let f of e){if(Vs(f),f>=2**t)throw new Error(`convertRadix2: invalid data word=${f} from=${t}`);if(i=i<<t|f,s+t>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${t}`);for(s+=t;s>=r;s-=r)a.push((i>>s-r&o)>>>0);i&=2**s-1}if(i=i<<r-s&o,!n&&s>=t)throw new Error("Excess padding");if(!n&&i)throw new Error(`Non-zero padding: ${i}`);return n&&s>0&&a.push(i>>>0),a}function wg(e){return Vs(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return pg(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(pg(t,e,2**8))}}}function Bs(e,t=!1){if(Vs(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(mu(8,e)>32||mu(e,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!(r instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return V1(Array.from(r),8,e,!t)},decode:r=>{if(!Array.isArray(r)||r.length&&typeof r[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(V1(r,e,8,t))}}}function vg(e){if(typeof e!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch{}}}function Sg(e,t){if(Vs(e),typeof t!="function")throw new Error("checksum fn should be function");return{encode(r){if(!(r instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");let n=t(r).slice(0,e),i=new Uint8Array(r.length+e);return i.set(r),i.set(n,r.length),i},decode(r){if(!(r instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");let n=r.slice(0,-e),i=t(n).slice(0,e),s=r.slice(-e);for(let o=0;o<e;o++)if(i[o]!==s[o])throw new Error("Invalid checksum");return n}}}we.utils={alphabet:ji,chain:mi,checksum:Sg,radix:wg,radix2:Bs,join:Li,padding:Zf};we.base16=mi(Bs(4),ji("0123456789ABCDEF"),Li(""));we.base32=mi(Bs(5),ji("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Zf(5),Li(""));we.base32hex=mi(Bs(5),ji("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Zf(5),Li(""));we.base32crockford=mi(Bs(5),ji("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Li(""),xg(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));we.base64=mi(Bs(6),ji("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Zf(6),Li(""));we.base64url=mi(Bs(6),ji("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Zf(6),Li(""));var W1=e=>mi(wg(58),ji(e),Li(""));we.base58=W1("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");we.base58flickr=W1("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");we.base58xrp=W1("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");var bg=[0,2,3,5,6,7,9,10,11];we.base58xmr={encode(e){let t="";for(let r=0;r<e.length;r+=8){let n=e.subarray(r,r+8);t+=we.base58.encode(n).padStart(bg[n.length],"1")}return t},decode(e){let t=[];for(let r=0;r<e.length;r+=11){let n=e.slice(r,r+11),i=bg.indexOf(n.length),s=we.base58.decode(n);for(let o=0;o<s.length-i;o++)if(s[o]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(s.slice(s.length-i)))}return Uint8Array.from(t)}};var hS=e=>mi(Sg(4,t=>e(e(t))),we.base58);we.base58check=hS;var z1=mi(ji("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Li("")),gg=[996825010,642813549,513874426,1027748829,705979059];function Gf(e){let t=e>>25,r=(e&33554431)<<5;for(let n=0;n<gg.length;n++)(t>>n&1)===1&&(r^=gg[n]);return r}function yg(e,t,r=1){let n=e.length,i=1;for(let s=0;s<n;s++){let o=e.charCodeAt(s);if(o<33||o>126)throw new Error(`Invalid prefix (${e})`);i=Gf(i)^o>>5}i=Gf(i);for(let s=0;s<n;s++)i=Gf(i)^e.charCodeAt(s)&31;for(let s of t)i=Gf(i)^s;for(let s=0;s<6;s++)i=Gf(i);return i^=r,z1.encode(V1([i%2**30],30,5,!1))}function Eg(e){let t=e==="bech32"?1:734539939,r=Bs(5),n=r.decode,i=r.encode,s=vg(n);function o(v,p,u=90){if(typeof v!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof v}`);if(!Array.isArray(p)||p.length&&typeof p[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof p}`);let h=v.length+7+p.length;if(u!==!1&&h>u)throw new TypeError(`Length ${h} exceeds limit ${u}`);return v=v.toLowerCase(),`${v}1${z1.encode(p)}${yg(v,p,t)}`}function a(v,p=90){if(typeof v!="string")throw new Error(`bech32.decode input should be string, not ${typeof v}`);if(v.length<8||p!==!1&&v.length>p)throw new TypeError(`Wrong string length: ${v.length} (${v}). Expected (8..${p})`);let u=v.toLowerCase();if(v!==u&&v!==v.toUpperCase())throw new Error("String must be lowercase or uppercase");v=u;let h=v.lastIndexOf("1");if(h===0||h===-1)throw new Error('Letter "1" must be present between prefix and data only');let[b,d]=[v.slice(0,h),v.slice(h+1)];if(d.length<6)throw new Error("Data must be at least 6 characters long");let y=z1.decode(d).slice(0,-6),w=yg(b,y,t);if(!d.endsWith(w))throw new Error(`Invalid checksum in ${v}: expected "${w}"`);return{prefix:b,words:y}}let f=vg(a);function l(v){let{prefix:p,words:u}=a(v,!1);return{prefix:p,words:u,bytes:n(u)}}return{encode:o,decode:a,decodeToBytes:l,decodeUnsafe:f,fromWords:n,fromWordsUnsafe:s,toWords:i}}we.bech32=Eg("bech32");we.bech32m=Eg("bech32m");we.utf8={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)};we.hex=mi(Bs(4),ji("0123456789abcdef"),Li(""),xg(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}));var Xf={utf8:we.utf8,hex:we.hex,base16:we.base16,base32:we.base32,base64:we.base64,base64url:we.base64url,base58:we.base58,base58xmr:we.base58xmr},_g=`Invalid encoding type. Available types: ${Object.keys(Xf).join(", ")}`,lS=(e,t)=>{if(typeof e!="string"||!Xf.hasOwnProperty(e))throw new TypeError(_g);if(!(t instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return Xf[e].encode(t)};we.bytesToString=lS;we.str=we.bytesToString;var pS=(e,t)=>{if(!Xf.hasOwnProperty(e))throw new TypeError(_g);if(typeof t!="string")throw new TypeError("stringToBytes() expects string");return Xf[e].decode(t)};we.stringToBytes=pS;we.bytes=we.stringToBytes});var Ag=U(Ws=>{"use strict";H();k();Object.defineProperty(Ws,"__esModule",{value:!0});Ws.base58=Ws.fromBase58=Ws.toBase58=void 0;var $1=zs();Object.defineProperty(Ws,"base58",{enumerable:!0,get:function(){return $1.base58}});function vS(e){let t=j.Buffer.from(e);return $1.base58.encode(Uint8Array.from(t))}Ws.toBase58=vS;function bS(e){return $1.base58.decode(e)}Ws.fromBase58=bS});var Bg=U(wu=>{"use strict";H();k();Object.defineProperty(wu,"__esModule",{value:!0});wu.crypto=void 0;wu.crypto={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0}});var $r=U((He,Yf)=>{"use strict";H();k();Object.defineProperty(He,"__esModule",{value:!0});He.randomBytes=He.wrapConstructorWithOpts=He.wrapConstructor=He.checkOpts=He.Hash=He.assertHash=He.assertBytes=He.assertBool=He.assertNumber=He.concatBytes=He.toBytes=He.utf8ToBytes=He.asyncLoop=He.nextTick=He.hexToBytes=He.bytesToHex=He.isLE=He.rotr=He.createView=He.u32=He.u8=void 0;var Su=Bg(),gS=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);He.u8=gS;var yS=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));He.u32=yS;var xS=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);He.createView=xS;var mS=(e,t)=>e<<32-t|e>>>t;He.rotr=mS;He.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!He.isLE)throw new Error("Non little-endian hardware is not supported");var wS=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function SS(e){let t="";for(let r=0;r<e.length;r++)t+=wS[e[r]];return t}He.bytesToHex=SS;function ES(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s))throw new Error("Invalid byte sequence");t[r]=s}return t}He.hexToBytes=ES;He.nextTick=(()=>{let e=typeof Yf<"u"&&typeof Yf.require=="function"&&Yf.require.bind(Yf);try{if(e){let{setImmediate:t}=e("timers");return()=>new Promise(r=>t(r))}}catch{}return()=>new Promise(t=>setTimeout(t,0))})();async function _S(e,t,r){let n=Date.now();for(let i=0;i<e;i++){r(i);let s=Date.now()-n;s>=0&&s<t||(await(0,He.nextTick)(),n+=s)}}He.asyncLoop=_S;function Pg(e){if(typeof e!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}He.utf8ToBytes=Pg;function Z1(e){if(typeof e=="string"&&(e=Pg(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}He.toBytes=Z1;function AS(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}He.concatBytes=AS;function G1(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}He.assertNumber=G1;function BS(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}He.assertBool=BS;function PS(e,...t){if(!(e instanceof Uint8Array&&(!t.length||t.includes(e.length))))throw new TypeError(`Expected ${t} bytes, not ${typeof e} with length=${e.length}`)}He.assertBytes=PS;function IS(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");G1(e.outputLen),G1(e.blockLen)}He.assertHash=IS;var X1=class{clone(){return this._cloneInto()}};He.Hash=X1;var MS=e=>Object.prototype.toString.call(e)==="[object Object]"&&e.constructor===Object;function CS(e,t){if(t!==void 0&&(typeof t!="object"||!MS(t)))throw new TypeError("Options should be object or undefined");return Object.assign(e,t)}He.checkOpts=CS;function FS(e){let t=n=>e().update(Z1(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}He.wrapConstructor=FS;function NS(e){let t=(n,i)=>e(i).update(Z1(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}He.wrapConstructorWithOpts=NS;function RS(e=32){if(Su.crypto.web)return Su.crypto.web.getRandomValues(new Uint8Array(e));if(Su.crypto.node)return new Uint8Array(Su.crypto.node.randomBytes(e).buffer);throw new Error("The environment doesn't have randomBytes function")}He.randomBytes=RS});var _u=U(Eu=>{"use strict";H();k();Object.defineProperty(Eu,"__esModule",{value:!0});Eu.SHA2=void 0;var Jf=$r();function OS(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),f=n?4:0,l=n?0:4;e.setUint32(t+f,o,n),e.setUint32(t+l,a,n)}var Y1=class extends Jf.Hash{constructor(t,r,n,i){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,Jf.createView)(this.buffer)}update(t){if(this.destroyed)throw new Error("instance is destroyed");let{view:r,buffer:n,blockLen:i,finished:s}=this;if(s)throw new Error("digest() was already called");t=(0,Jf.toBytes)(t);let o=t.length;for(let a=0;a<o;){let f=Math.min(i-this.pos,o-a);if(f===i){let l=(0,Jf.createView)(t);for(;i<=o-a;a+=i)this.process(l,a);continue}n.set(t.subarray(a,a+f),this.pos),this.pos+=f,a+=f,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){if(this.destroyed)throw new Error("instance is destroyed");if(!(t instanceof Uint8Array)||t.length<this.outputLen)throw new Error("_Sha2: Invalid output buffer");if(this.finished)throw new Error("digest() was already called");this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let f=o;f<i;f++)r[f]=0;OS(n,i-8,BigInt(this.length*8),s),this.process(n,0);let a=(0,Jf.createView)(t);this.get().forEach((f,l)=>a.setUint32(4*l,f,s))}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return t.length=i,t.pos=a,t.finished=s,t.destroyed=o,i%r&&t.buffer.set(n),t}};Eu.SHA2=Y1});var yo=U(Au=>{"use strict";H();k();Object.defineProperty(Au,"__esModule",{value:!0});Au.sha256=void 0;var DS=_u(),wi=$r(),TS=(e,t,r)=>e&t^~e&r,qS=(e,t,r)=>e&t^e&r^t&r,HS=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),$s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Gs=new Uint32Array(64),J1=class extends DS.SHA2{constructor(){super(64,32,8,!1),this.A=$s[0]|0,this.B=$s[1]|0,this.C=$s[2]|0,this.D=$s[3]|0,this.E=$s[4]|0,this.F=$s[5]|0,this.G=$s[6]|0,this.H=$s[7]|0}get(){let{A:t,B:r,C:n,D:i,E:s,F:o,G:a,H:f}=this;return[t,r,n,i,s,o,a,f]}set(t,r,n,i,s,o,a,f){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=f|0}process(t,r){for(let p=0;p<16;p++,r+=4)Gs[p]=t.getUint32(r,!1);for(let p=16;p<64;p++){let u=Gs[p-15],h=Gs[p-2],b=(0,wi.rotr)(u,7)^(0,wi.rotr)(u,18)^u>>>3,d=(0,wi.rotr)(h,17)^(0,wi.rotr)(h,19)^h>>>10;Gs[p]=d+Gs[p-7]+b+Gs[p-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:f,G:l,H:v}=this;for(let p=0;p<64;p++){let u=(0,wi.rotr)(a,6)^(0,wi.rotr)(a,11)^(0,wi.rotr)(a,25),h=v+u+TS(a,f,l)+HS[p]+Gs[p]|0,d=((0,wi.rotr)(n,2)^(0,wi.rotr)(n,13)^(0,wi.rotr)(n,22))+qS(n,i,s)|0;v=l,l=f,f=a,a=o+h|0,o=s,s=i,i=n,n=h+d|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,f=f+this.F|0,l=l+this.G|0,v=v+this.H|0,this.set(n,i,s,o,a,f,l,v)}roundClean(){Gs.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};Au.sha256=(0,wi.wrapConstructor)(()=>new J1)});var xo=U(ke=>{"use strict";H();k();Object.defineProperty(ke,"__esModule",{value:!0});ke.add5H=ke.add5L=ke.add4H=ke.add4L=ke.add3H=ke.add3L=ke.add=ke.rotlBL=ke.rotlBH=ke.rotlSL=ke.rotlSH=ke.rotr32L=ke.rotr32H=ke.rotrBL=ke.rotrBH=ke.rotrSL=ke.rotrSH=ke.shrSL=ke.shrSH=ke.toBig=ke.split=ke.fromBig=void 0;var Bu=BigInt(2**32-1),Q1=BigInt(32);function Ig(e,t=!1){return t?{h:Number(e&Bu),l:Number(e>>Q1&Bu)}:{h:Number(e>>Q1&Bu)|0,l:Number(e&Bu)|0}}ke.fromBig=Ig;function kS(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){let{h:s,l:o}=Ig(e[i],t);[r[i],n[i]]=[s,o]}return[r,n]}ke.split=kS;var jS=(e,t)=>BigInt(e>>>0)<<Q1|BigInt(t>>>0);ke.toBig=jS;var LS=(e,t,r)=>e>>>r;ke.shrSH=LS;var KS=(e,t,r)=>e<<32-r|t>>>r;ke.shrSL=KS;var US=(e,t,r)=>e>>>r|t<<32-r;ke.rotrSH=US;var VS=(e,t,r)=>e<<32-r|t>>>r;ke.rotrSL=VS;var zS=(e,t,r)=>e<<64-r|t>>>r-32;ke.rotrBH=zS;var WS=(e,t,r)=>e>>>r-32|t<<64-r;ke.rotrBL=WS;var $S=(e,t)=>t;ke.rotr32H=$S;var GS=(e,t)=>e;ke.rotr32L=GS;var XS=(e,t,r)=>e<<r|t>>>32-r;ke.rotlSH=XS;var ZS=(e,t,r)=>t<<r|e>>>32-r;ke.rotlSL=ZS;var YS=(e,t,r)=>t<<r-32|e>>>64-r;ke.rotlBH=YS;var JS=(e,t,r)=>e<<r-32|t>>>64-r;ke.rotlBL=JS;function QS(e,t,r,n){let i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}ke.add=QS;var eE=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);ke.add3L=eE;var tE=(e,t,r,n)=>t+r+n+(e/2**32|0)|0;ke.add3H=tE;var rE=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0);ke.add4L=rE;var nE=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0;ke.add4H=nE;var iE=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0);ke.add5L=iE;var sE=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0;ke.add5H=sE});var Pu=U(en=>{"use strict";H();k();var aE=en&&en.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),oE=en&&en.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),fE=en&&en.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&aE(t,e,r);return oE(t,e),t};Object.defineProperty(en,"__esModule",{value:!0});en.sha384=en.sha512_256=en.sha512=en.SHA512=void 0;var cE=_u(),at=fE(xo()),r2=$r(),[uE,dE]=at.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Xs=new Uint32Array(80),Zs=new Uint32Array(80),mo=class extends cE.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:f,Eh:l,El:v,Fh:p,Fl:u,Gh:h,Gl:b,Hh:d,Hl:y}=this;return[t,r,n,i,s,o,a,f,l,v,p,u,h,b,d,y]}set(t,r,n,i,s,o,a,f,l,v,p,u,h,b,d,y){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=f|0,this.Eh=l|0,this.El=v|0,this.Fh=p|0,this.Fl=u|0,this.Gh=h|0,this.Gl=b|0,this.Hh=d|0,this.Hl=y|0}process(t,r){for(let I=0;I<16;I++,r+=4)Xs[I]=t.getUint32(r),Zs[I]=t.getUint32(r+=4);for(let I=16;I<80;I++){let N=Xs[I-15]|0,F=Zs[I-15]|0,O=at.rotrSH(N,F,1)^at.rotrSH(N,F,8)^at.shrSH(N,F,7),q=at.rotrSL(N,F,1)^at.rotrSL(N,F,8)^at.shrSL(N,F,7),P=Xs[I-2]|0,D=Zs[I-2]|0,A=at.rotrSH(P,D,19)^at.rotrBH(P,D,61)^at.shrSH(P,D,6),c=at.rotrSL(P,D,19)^at.rotrBL(P,D,61)^at.shrSL(P,D,6),m=at.add4L(q,c,Zs[I-7],Zs[I-16]),S=at.add4H(m,O,A,Xs[I-7],Xs[I-16]);Xs[I]=S|0,Zs[I]=m|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:f,Dh:l,Dl:v,Eh:p,El:u,Fh:h,Fl:b,Gh:d,Gl:y,Hh:w,Hl:_}=this;for(let I=0;I<80;I++){let N=at.rotrSH(p,u,14)^at.rotrSH(p,u,18)^at.rotrBH(p,u,41),F=at.rotrSL(p,u,14)^at.rotrSL(p,u,18)^at.rotrBL(p,u,41),O=p&h^~p&d,q=u&b^~u&y,P=at.add5L(_,F,q,dE[I],Zs[I]),D=at.add5H(P,w,N,O,uE[I],Xs[I]),A=P|0,c=at.rotrSH(n,i,28)^at.rotrBH(n,i,34)^at.rotrBH(n,i,39),m=at.rotrSL(n,i,28)^at.rotrBL(n,i,34)^at.rotrBL(n,i,39),S=n&s^n&a^s&a,g=i&o^i&f^o&f;w=d|0,_=y|0,d=h|0,y=b|0,h=p|0,b=u|0,{h:p,l:u}=at.add(l|0,v|0,D|0,A|0),l=a|0,v=f|0,a=s|0,f=o|0,s=n|0,o=i|0;let E=at.add3L(A,m,g);n=at.add3H(E,D,c,S),i=E|0}({h:n,l:i}=at.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=at.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:f}=at.add(this.Ch|0,this.Cl|0,a|0,f|0),{h:l,l:v}=at.add(this.Dh|0,this.Dl|0,l|0,v|0),{h:p,l:u}=at.add(this.Eh|0,this.El|0,p|0,u|0),{h,l:b}=at.add(this.Fh|0,this.Fl|0,h|0,b|0),{h:d,l:y}=at.add(this.Gh|0,this.Gl|0,d|0,y|0),{h:w,l:_}=at.add(this.Hh|0,this.Hl|0,w|0,_|0),this.set(n,i,s,o,a,f,l,v,p,u,h,b,d,y,w,_)}roundClean(){Xs.fill(0),Zs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};en.SHA512=mo;var e2=class extends mo{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},t2=class extends mo{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};en.sha512=(0,r2.wrapConstructor)(()=>new mo);en.sha512_256=(0,r2.wrapConstructor)(()=>new e2);en.sha384=(0,r2.wrapConstructor)(()=>new t2)});var s2=U(wo=>{"use strict";H();k();Object.defineProperty(wo,"__esModule",{value:!0});wo.ripemd160=wo.RIPEMD160=void 0;var hE=_u(),lE=$r(),pE=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Cg=Uint8Array.from({length:16},(e,t)=>t),vE=Cg.map(e=>(9*e+5)%16),n2=[Cg],i2=[vE];for(let e=0;e<4;e++)for(let t of[n2,i2])t.push(t[e].map(r=>pE[r]));var Fg=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>new Uint8Array(e)),bE=n2.map((e,t)=>e.map(r=>Fg[t][r])),gE=i2.map((e,t)=>e.map(r=>Fg[t][r])),yE=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),xE=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),Iu=(e,t)=>e<<t|e>>>32-t;function Mg(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}var Mu=new Uint32Array(16),Cu=class extends hE.SHA2{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:t,h1:r,h2:n,h3:i,h4:s}=this;return[t,r,n,i,s]}set(t,r,n,i,s){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=i|0,this.h4=s|0}process(t,r){for(let h=0;h<16;h++,r+=4)Mu[h]=t.getUint32(r,!0);let n=this.h0|0,i=n,s=this.h1|0,o=s,a=this.h2|0,f=a,l=this.h3|0,v=l,p=this.h4|0,u=p;for(let h=0;h<5;h++){let b=4-h,d=yE[h],y=xE[h],w=n2[h],_=i2[h],I=bE[h],N=gE[h];for(let F=0;F<16;F++){let O=Iu(n+Mg(h,s,a,l)+Mu[w[F]]+d,I[F])+p|0;n=p,p=l,l=Iu(a,10)|0,a=s,s=O}for(let F=0;F<16;F++){let O=Iu(i+Mg(b,o,f,v)+Mu[_[F]]+y,N[F])+u|0;i=u,u=v,v=Iu(f,10)|0,f=o,o=O}}this.set(this.h1+a+v|0,this.h2+l+u|0,this.h3+p+i|0,this.h4+n+o|0,this.h0+s+f|0)}roundClean(){Mu.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}};wo.RIPEMD160=Cu;wo.ripemd160=(0,lE.wrapConstructor)(()=>new Cu)});var Fu=U(mt=>{"use strict";H();k();var mE=mt&&mt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),wE=mt&&mt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),SE=mt&&mt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&mE(t,e,r);return wE(t,e),t};Object.defineProperty(mt,"__esModule",{value:!0});mt.shake256=mt.shake128=mt.keccak_512=mt.keccak_384=mt.keccak_256=mt.keccak_224=mt.sha3_512=mt.sha3_384=mt.sha3_256=mt.sha3_224=mt.Keccak=mt.keccakP=void 0;var ec=SE(xo()),g0=$r(),[Og,Dg,Tg]=[[],[],[]],EE=BigInt(0),Qf=BigInt(1),_E=BigInt(2),AE=BigInt(7),BE=BigInt(256),PE=BigInt(113);for(let e=0,t=Qf,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],Og.push(2*(5*n+r)),Dg.push((e+1)*(e+2)/2%64);let i=EE;for(let s=0;s<7;s++)t=(t<<Qf^(t>>AE)*PE)%BE,t&_E&&(i^=Qf<<(Qf<<BigInt(s))-Qf);Tg.push(i)}var[IE,ME]=ec.split(Tg,!0),Ng=(e,t,r)=>r>32?ec.rotlBH(e,t,r):ec.rotlSH(e,t,r),Rg=(e,t,r)=>r>32?ec.rotlBL(e,t,r):ec.rotlSL(e,t,r);function qg(e,t=24){let r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let o=0;o<10;o++)r[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){let a=(o+8)%10,f=(o+2)%10,l=r[f],v=r[f+1],p=Ng(l,v,1)^r[a],u=Rg(l,v,1)^r[a+1];for(let h=0;h<50;h+=10)e[o+h]^=p,e[o+h+1]^=u}let i=e[2],s=e[3];for(let o=0;o<24;o++){let a=Dg[o],f=Ng(i,s,a),l=Rg(i,s,a),v=Og[o];i=e[v],s=e[v+1],e[v]=f,e[v+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}e[0]^=IE[n],e[1]^=ME[n]}r.fill(0)}mt.keccakP=qg;var y0=class extends g0.Hash{constructor(t,r,n,i=!1,s=24){if(super(),this.blockLen=t,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,g0.assertNumber)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,g0.u32)(this.state)}keccak(){qg(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){if(this.destroyed)throw new Error("instance is destroyed");if(this.finished)throw new Error("digest() was already called");let{blockLen:r,state:n}=this;t=(0,g0.toBytes)(t);let i=t.length;for(let s=0;s<i;){let o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=t[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:r,pos:n,blockLen:i}=this;t[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){if(this.destroyed)throw new Error("instance is destroyed");if(!(t instanceof Uint8Array))throw new Error("Keccak: invalid output buffer");this.finish();for(let r=0,n=t.length;r<n;){this.posOut>=this.blockLen&&this.keccak();let i=Math.min(this.blockLen-this.posOut,n-r);t.set(this.state.subarray(this.posOut,this.posOut+i),r),this.posOut+=i,r+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,g0.assertNumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(t.length<this.outputLen)throw new Error("Keccak: invalid output buffer");if(this.finished)throw new Error("digest() was already called");return this.finish(),this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return t||(t=new y0(r,n,i,o,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=n,t.outputLen=i,t.enableXOF=o,t.destroyed=this.destroyed,t}};mt.Keccak=y0;var Ys=(e,t,r)=>(0,g0.wrapConstructor)(()=>new y0(t,e,r));mt.sha3_224=Ys(6,144,224/8);mt.sha3_256=Ys(6,136,256/8);mt.sha3_384=Ys(6,104,384/8);mt.sha3_512=Ys(6,72,512/8);mt.keccak_224=Ys(1,144,224/8);mt.keccak_256=Ys(1,136,256/8);mt.keccak_384=Ys(1,104,384/8);mt.keccak_512=Ys(1,72,512/8);var Hg=(e,t,r)=>(0,g0.wrapConstructorWithOpts)((n={})=>new y0(t,e,n.dkLen!==void 0?n.dkLen:r,!0));mt.shake128=Hg(31,168,128/8);mt.shake256=Hg(31,136,256/8)});var Nu=U(So=>{"use strict";H();k();Object.defineProperty(So,"__esModule",{value:!0});So.BLAKE2=So.SIGMA=void 0;var x0=$r();So.SIGMA=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3]);var a2=class extends x0.Hash{constructor(t,r,n={},i,s,o){if(super(),this.blockLen=t,this.outputLen=r,this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,(0,x0.assertNumber)(t),(0,x0.assertNumber)(r),(0,x0.assertNumber)(i),r<0||r>i)throw new Error("Blake2: outputLen bigger than keyLen");if(n.key!==void 0&&(n.key.length<1||n.key.length>i))throw new Error(`Key should be up 1..${i} byte long or undefined`);if(n.salt!==void 0&&n.salt.length!==s)throw new Error(`Salt should be ${s} byte long or undefined`);if(n.personalization!==void 0&&n.personalization.length!==o)throw new Error(`Personalization should be ${o} byte long or undefined`);this.buffer32=(0,x0.u32)(this.buffer=new Uint8Array(t))}update(t){if(this.destroyed)throw new Error("instance is destroyed");let{finished:r,blockLen:n,buffer:i,buffer32:s}=this;if(r)throw new Error("digest() was already called");t=(0,x0.toBytes)(t);let o=t.length;for(let a=0;a<o;){this.pos===n&&(this.compress(s,0,!1),this.pos=0);let f=Math.min(n-this.pos,o-a),l=t.byteOffset+a;if(f===n&&!(l%4)&&a+f<o){let v=new Uint32Array(t.buffer,l,Math.floor((o-a)/4));for(let p=0;a+n<o;p+=s.length,a+=n)this.length+=n,this.compress(v,p,!1);continue}i.set(t.subarray(a,a+f),this.pos),this.pos+=f,this.length+=f,a+=f}return this}digestInto(t){if(this.destroyed)throw new Error("instance is destroyed");if(!(t instanceof Uint8Array)||t.length<this.outputLen)throw new Error("_Blake2: Invalid output buffer");let{finished:r,pos:n,buffer32:i}=this;if(r)throw new Error("digest() was already called");this.finished=!0,this.buffer.subarray(n).fill(0),this.compress(i,0,!0);let s=(0,x0.u32)(t);this.get().forEach((o,a)=>s[a]=o)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){let{buffer:r,length:n,finished:i,destroyed:s,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.length=n,t.finished=i,t.destroyed=s,t.outputLen=o,t.buffer.set(r),t.pos=a,t}};So.BLAKE2=a2});var f2=U(Ki=>{"use strict";H();k();var CE=Ki&&Ki.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),FE=Ki&&Ki.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),jg=Ki&&Ki.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&CE(t,e,r);return FE(t,e),t};Object.defineProperty(Ki,"__esModule",{value:!0});Ki.blake2b=void 0;var kg=jg(Nu()),wn=jg(xo()),Eo=$r(),mr=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),fe=new Uint32Array(32);function Js(e,t,r,n,i,s){let o=i[s],a=i[s+1],f=fe[2*e],l=fe[2*e+1],v=fe[2*t],p=fe[2*t+1],u=fe[2*r],h=fe[2*r+1],b=fe[2*n],d=fe[2*n+1],y=wn.add3L(f,v,o);l=wn.add3H(y,l,p,a),f=y|0,{Dh:d,Dl:b}={Dh:d^l,Dl:b^f},{Dh:d,Dl:b}={Dh:wn.rotr32H(d,b),Dl:wn.rotr32L(d,b)},{h,l:u}=wn.add(h,u,d,b),{Bh:p,Bl:v}={Bh:p^h,Bl:v^u},{Bh:p,Bl:v}={Bh:wn.rotrSH(p,v,24),Bl:wn.rotrSL(p,v,24)},fe[2*e]=f,fe[2*e+1]=l,fe[2*t]=v,fe[2*t+1]=p,fe[2*r]=u,fe[2*r+1]=h,fe[2*n]=b,fe[2*n+1]=d}function Qs(e,t,r,n,i,s){let o=i[s],a=i[s+1],f=fe[2*e],l=fe[2*e+1],v=fe[2*t],p=fe[2*t+1],u=fe[2*r],h=fe[2*r+1],b=fe[2*n],d=fe[2*n+1],y=wn.add3L(f,v,o);l=wn.add3H(y,l,p,a),f=y|0,{Dh:d,Dl:b}={Dh:d^l,Dl:b^f},{Dh:d,Dl:b}={Dh:wn.rotrSH(d,b,16),Dl:wn.rotrSL(d,b,16)},{h,l:u}=wn.add(h,u,d,b),{Bh:p,Bl:v}={Bh:p^h,Bl:v^u},{Bh:p,Bl:v}={Bh:wn.rotrBH(p,v,63),Bl:wn.rotrBL(p,v,63)},fe[2*e]=f,fe[2*e+1]=l,fe[2*t]=v,fe[2*t+1]=p,fe[2*r]=u,fe[2*r+1]=h,fe[2*n]=b,fe[2*n+1]=d}var o2=class extends kg.BLAKE2{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=mr[0]|0,this.v0h=mr[1]|0,this.v1l=mr[2]|0,this.v1h=mr[3]|0,this.v2l=mr[4]|0,this.v2h=mr[5]|0,this.v3l=mr[6]|0,this.v3h=mr[7]|0,this.v4l=mr[8]|0,this.v4h=mr[9]|0,this.v5l=mr[10]|0,this.v5h=mr[11]|0,this.v6l=mr[12]|0,this.v6h=mr[13]|0,this.v7l=mr[14]|0,this.v7h=mr[15]|0;let r=t.key?t.key.length:0;if(this.v0l^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,Eo.u32)((0,Eo.toBytes)(t.salt));this.v4l^=n[0],this.v4h^=n[1],this.v5l^=n[2],this.v5h^=n[3]}if(t.personalization){let n=(0,Eo.u32)((0,Eo.toBytes)(t.personalization));this.v6l^=n[0],this.v6h^=n[1],this.v7l^=n[2],this.v7h^=n[3]}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,Eo.toBytes)(t.key)),this.update(n)}}get(){let{v0l:t,v0h:r,v1l:n,v1h:i,v2l:s,v2h:o,v3l:a,v3h:f,v4l:l,v4h:v,v5l:p,v5h:u,v6l:h,v6h:b,v7l:d,v7h:y}=this;return[t,r,n,i,s,o,a,f,l,v,p,u,h,b,d,y]}set(t,r,n,i,s,o,a,f,l,v,p,u,h,b,d,y){this.v0l=t|0,this.v0h=r|0,this.v1l=n|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=a|0,this.v3h=f|0,this.v4l=l|0,this.v4h=v|0,this.v5l=p|0,this.v5h=u|0,this.v6l=h|0,this.v6h=b|0,this.v7l=d|0,this.v7h=y|0}compress(t,r,n){this.get().forEach((f,l)=>fe[l]=f),fe.set(mr,16);let{h:i,l:s}=wn.fromBig(BigInt(this.length));fe[24]=mr[8]^s,fe[25]=mr[9]^i,n&&(fe[28]=~fe[28],fe[29]=~fe[29]);let o=0,a=kg.SIGMA;for(let f=0;f<12;f++)Js(0,4,8,12,t,r+2*a[o++]),Qs(0,4,8,12,t,r+2*a[o++]),Js(1,5,9,13,t,r+2*a[o++]),Qs(1,5,9,13,t,r+2*a[o++]),Js(2,6,10,14,t,r+2*a[o++]),Qs(2,6,10,14,t,r+2*a[o++]),Js(3,7,11,15,t,r+2*a[o++]),Qs(3,7,11,15,t,r+2*a[o++]),Js(0,5,10,15,t,r+2*a[o++]),Qs(0,5,10,15,t,r+2*a[o++]),Js(1,6,11,12,t,r+2*a[o++]),Qs(1,6,11,12,t,r+2*a[o++]),Js(2,7,8,13,t,r+2*a[o++]),Qs(2,7,8,13,t,r+2*a[o++]),Js(3,4,9,14,t,r+2*a[o++]),Qs(3,4,9,14,t,r+2*a[o++]);this.v0l^=fe[0]^fe[16],this.v0h^=fe[1]^fe[17],this.v1l^=fe[2]^fe[18],this.v1h^=fe[3]^fe[19],this.v2l^=fe[4]^fe[20],this.v2h^=fe[5]^fe[21],this.v3l^=fe[6]^fe[22],this.v3h^=fe[7]^fe[23],this.v4l^=fe[8]^fe[24],this.v4h^=fe[9]^fe[25],this.v5l^=fe[10]^fe[26],this.v5h^=fe[11]^fe[27],this.v6l^=fe[12]^fe[28],this.v6h^=fe[13]^fe[29],this.v7l^=fe[14]^fe[30],this.v7h^=fe[15]^fe[31],fe.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};Ki.blake2b=(0,Eo.wrapConstructorWithOpts)(e=>new o2(e))});var tc=U(Jt=>{"use strict";H();k();Object.defineProperty(Jt,"__esModule",{value:!0});Jt.sha3_512=Jt.sha3_256=Jt.ripemd160=Jt.sha512=Jt.sha256=Jt.blake2=Jt.keccak256=Jt.keccak=Jt.hash160=Jt.doubleSha256=void 0;var Ru=yo();Object.defineProperty(Jt,"sha256",{enumerable:!0,get:function(){return Ru.sha256}});var NE=Pu();Object.defineProperty(Jt,"sha512",{enumerable:!0,get:function(){return NE.sha512}});var Lg=s2();Object.defineProperty(Jt,"ripemd160",{enumerable:!0,get:function(){return Lg.ripemd160}});var _o=Fu();Object.defineProperty(Jt,"sha3_256",{enumerable:!0,get:function(){return _o.sha3_256}});Object.defineProperty(Jt,"sha3_512",{enumerable:!0,get:function(){return _o.sha3_512}});var RE=f2();function OE(e){let t=(0,Ru.sha256)(e);return(0,Ru.sha256)(t)}Jt.doubleSha256=OE;function DE(e){let t=(0,Ru.sha256)(e);return(0,Lg.ripemd160)(t)}Jt.hash160=DE;var TE=function(e,t=256){let r=j.Buffer.from(e);switch(t){case 224:return j.Buffer.from((0,_o.keccak_224)(r));case 256:return j.Buffer.from((0,_o.keccak_256)(r));case 384:return j.Buffer.from((0,_o.keccak_384)(r));case 512:return j.Buffer.from((0,_o.keccak_512)(r));default:throw new Error(`Invald algorithm: keccak${t}`)}};Jt.keccak=TE;var qE=function(e){return(0,Jt.keccak)(e)};Jt.keccak256=qE;function HE(e,t,r){let n=Math.ceil(t/8);return(0,RE.blake2b)(e,{dkLen:n,key:r})}Jt.blake2=HE});var Vg=U(Ao=>{"use strict";H();k();Object.defineProperty(Ao,"__esModule",{value:!0});Ao.fromBase58Check=Ao.toBase58Check=void 0;var Kg=tc(),GU=Qb(),Ug=zs();function kE(e){return(0,Ug.base58check)(Kg.sha256).encode(j.Buffer.from(e))}Ao.toBase58Check=kE;function jE(e){let t=(0,Ug.base58check)(Kg.sha256);return j.Buffer.from(t.decode(e))}Ao.fromBase58Check=jE});var zg=U(Bo=>{"use strict";H();k();Object.defineProperty(Bo,"__esModule",{value:!0});Bo.fromBech32=Bo.toBech32=void 0;var Ou=zs();function LE(e,t,r){let n=j.Buffer.from(t),i=Ou.bech32.toWords(Uint8Array.from(n));return Ou.bech32.encode(e,i,r)}Bo.toBech32=LE;function KE(e,t){let r=Ou.bech32.decode(e,t),n=Ou.bech32.fromWords(r.words);return[r.prefix,j.Buffer.from(n)]}Bo.fromBech32=KE});var Wg=U(Ui=>{"use strict";H();k();Object.defineProperty(Ui,"__esModule",{value:!0});Ui.isHexPrefixed=Ui.stripHexPrefix=Ui.fromHex=Ui.toHex=void 0;function UE(e,t=!1){let r=j.Buffer.from(e);return t?"0x"+r.toString("hex"):r.toString("hex")}Ui.toHex=UE;function VE(e){return e.startsWith("0x")&&(e=e.substring(2)),j.Buffer.from(e,"hex")}Ui.fromHex=VE;function zE(e){return e.startsWith("0x")?e.substring(2):e}Ui.stripHexPrefix=zE;function WE(e){return e.startsWith("0x")}Ui.isHexPrefixed=WE});var Gg=U(Po=>{"use strict";H();k();Object.defineProperty(Po,"__esModule",{value:!0});Po.fromBase64=Po.toBase64=void 0;var $g=zs();function $E(e){let t=j.Buffer.from(e);return $g.base64.encode(Uint8Array.from(t))}Po.toBase64=$E;function GE(e){return $g.base64.decode(e)}Po.fromBase64=GE});var nc=U(rc=>{"use strict";H();k();Object.defineProperty(rc,"__esModule",{value:!0});rc.hmac=void 0;var Du=$r(),Tu=class extends Du.Hash{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,(0,Du.assertHash)(t);let n=(0,Du.toBytes)(r);if(this.iHash=t.create(),!(this.iHash instanceof Du.Hash))throw new TypeError("Expected instance of class which extends utils.Hash");let i=this.blockLen=this.iHash.blockLen;this.outputLen=this.iHash.outputLen;let s=new Uint8Array(i);s.set(n.length>this.iHash.blockLen?t.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(t){if(this.destroyed)throw new Error("instance is destroyed");return this.iHash.update(t),this}digestInto(t){if(this.destroyed)throw new Error("instance is destroyed");if(!(t instanceof Uint8Array)||t.length!==this.outputLen)throw new Error("HMAC: Invalid output buffer");if(this.finished)throw new Error("digest() was already called");this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},XE=(e,t,r)=>new Tu(e,t).update(r).digest();rc.hmac=XE;rc.hmac.create=(e,t)=>new Tu(e,t)});var Yg=U(Io=>{"use strict";H();k();Object.defineProperty(Io,"__esModule",{value:!0});Io.hmacSHA512=Io.hmacSHA256=void 0;var Xg=nc(),Zg=tc();function ZE(e,t){return j.Buffer.from((0,Xg.hmac)(Zg.sha256,e,t))}Io.hmacSHA256=ZE;function YE(e,t){return j.Buffer.from((0,Xg.hmac)(Zg.sha512,e,t))}Io.hmacSHA512=YE});var Jg=U(Mo=>{"use strict";H();k();Object.defineProperty(Mo,"__esModule",{value:!0});Mo.fromUtf8=Mo.toUtf8=void 0;function JE(e){return new TextEncoder().encode(e)}Mo.toUtf8=JE;function QE(e){return new TextDecoder("utf-8",{fatal:!0}).decode(e)}Mo.fromUtf8=QE});var u2=U(ea=>{"use strict";H();k();Object.defineProperty(ea,"__esModule",{value:!0});ea.checkIsUndefined=ea.checkIsDefined=ea.check=void 0;var c2=(e,t)=>{if(!e)throw t=t||"Invalid statement",t=t instanceof Error?t:new Error(t),t};ea.check=c2;var e_=(e,t)=>(c2(typeof e<"u",t||"Expect defined but actually undefined"),e);ea.checkIsDefined=e_;var t_=(e,t)=>{c2(typeof e>"u",t||`Expect undefined but actually ${e}`)};ea.checkIsUndefined=t_});var e3=U(Vi=>{"use strict";H();k();Object.defineProperty(Vi,"__esModule",{value:!0});Vi.string2BigNumber=Vi.bigNumber2String=Vi.fromBigIntHex=Vi.toBigIntHex=void 0;var Qg=ta(),r_=u2(),n_=e=>{let t=e.integerValue().toString(16);return t="0x"+t,t};Vi.toBigIntHex=n_;var i_=e=>((0,r_.check)(e&&e.startsWith("0x"),`Invalid hex string. value: ${e}`),new Qg.BigNumber(e).integerValue());Vi.fromBigIntHex=i_;var s_=(e,t)=>e.integerValue().toString(t);Vi.bigNumber2String=s_;var a_=(e,t)=>new Qg.BigNumber(e,t);Vi.string2BigNumber=a_});var wr=U((t3,d2)=>{H();k();(function(e,t){"use strict";function r(A,c){if(!A)throw new Error(c||"Assertion failed")}function n(A,c){A.super_=c;var m=function(){};m.prototype=c.prototype,A.prototype=new m,A.prototype.constructor=A}function i(A,c,m){if(i.isBN(A))return A;this.negative=0,this.words=null,this.length=0,this.red=null,A!==null&&((c==="le"||c==="be")&&(m=c,c=10),this._init(A||0,c||10,m||"be"))}typeof e=="object"?e.exports=i:t.BN=i,i.BN=i,i.wordSize=26;var s;try{typeof window<"u"&&typeof window.Buffer<"u"?s=window.Buffer:s=Zb().Buffer}catch{}i.isBN=function(c){return c instanceof i?!0:c!==null&&typeof c=="object"&&c.constructor.wordSize===i.wordSize&&Array.isArray(c.words)},i.max=function(c,m){return c.cmp(m)>0?c:m},i.min=function(c,m){return c.cmp(m)<0?c:m},i.prototype._init=function(c,m,S){if(typeof c=="number")return this._initNumber(c,m,S);if(typeof c=="object")return this._initArray(c,m,S);m==="hex"&&(m=16),r(m===(m|0)&&m>=2&&m<=36),c=c.toString().replace(/\s+/g,"");var g=0;c[0]==="-"&&(g++,this.negative=1),g<c.length&&(m===16?this._parseHex(c,g,S):(this._parseBase(c,m,g),S==="le"&&this._initArray(this.toArray(),m,S)))},i.prototype._initNumber=function(c,m,S){c<0&&(this.negative=1,c=-c),c<67108864?(this.words=[c&67108863],this.length=1):c<4503599627370496?(this.words=[c&67108863,c/67108864&67108863],this.length=2):(r(c<9007199254740992),this.words=[c&67108863,c/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),m,S)},i.prototype._initArray=function(c,m,S){if(r(typeof c.length=="number"),c.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(c.length/3),this.words=new Array(this.length);for(var g=0;g<this.length;g++)this.words[g]=0;var E,M,T=0;if(S==="be")for(g=c.length-1,E=0;g>=0;g-=3)M=c[g]|c[g-1]<<8|c[g-2]<<16,this.words[E]|=M<<T&67108863,this.words[E+1]=M>>>26-T&67108863,T+=24,T>=26&&(T-=26,E++);else if(S==="le")for(g=0,E=0;g<c.length;g+=3)M=c[g]|c[g+1]<<8|c[g+2]<<16,this.words[E]|=M<<T&67108863,this.words[E+1]=M>>>26-T&67108863,T+=24,T>=26&&(T-=26,E++);return this.strip()};function o(A,c){var m=A.charCodeAt(c);return m>=65&&m<=70?m-55:m>=97&&m<=102?m-87:m-48&15}function a(A,c,m){var S=o(A,m);return m-1>=c&&(S|=o(A,m-1)<<4),S}i.prototype._parseHex=function(c,m,S){this.length=Math.ceil((c.length-m)/6),this.words=new Array(this.length);for(var g=0;g<this.length;g++)this.words[g]=0;var E=0,M=0,T;if(S==="be")for(g=c.length-1;g>=m;g-=2)T=a(c,m,g)<<E,this.words[M]|=T&67108863,E>=18?(E-=18,M+=1,this.words[M]|=T>>>26):E+=8;else{var R=c.length-m;for(g=R%2===0?m+1:m;g<c.length;g+=2)T=a(c,m,g)<<E,this.words[M]|=T&67108863,E>=18?(E-=18,M+=1,this.words[M]|=T>>>26):E+=8}this.strip()};function f(A,c,m,S){for(var g=0,E=Math.min(A.length,m),M=c;M<E;M++){var T=A.charCodeAt(M)-48;g*=S,T>=49?g+=T-49+10:T>=17?g+=T-17+10:g+=T}return g}i.prototype._parseBase=function(c,m,S){this.words=[0],this.length=1;for(var g=0,E=1;E<=67108863;E*=m)g++;g--,E=E/m|0;for(var M=c.length-S,T=M%g,R=Math.min(M,M-T)+S,x=0,C=S;C<R;C+=g)x=f(c,C,C+g,m),this.imuln(E),this.words[0]+x<67108864?this.words[0]+=x:this._iaddn(x);if(T!==0){var K=1;for(x=f(c,C,c.length,m),C=0;C<T;C++)K*=m;this.imuln(K),this.words[0]+x<67108864?this.words[0]+=x:this._iaddn(x)}this.strip()},i.prototype.copy=function(c){c.words=new Array(this.length);for(var m=0;m<this.length;m++)c.words[m]=this.words[m];c.length=this.length,c.negative=this.negative,c.red=this.red},i.prototype.clone=function(){var c=new i(null);return this.copy(c),c},i.prototype._expand=function(c){for(;this.length<c;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(c,m){c=c||10,m=m|0||1;var S;if(c===16||c==="hex"){S="";for(var g=0,E=0,M=0;M<this.length;M++){var T=this.words[M],R=((T<<g|E)&16777215).toString(16);E=T>>>24-g&16777215,E!==0||M!==this.length-1?S=l[6-R.length]+R+S:S=R+S,g+=2,g>=26&&(g-=26,M--)}for(E!==0&&(S=E.toString(16)+S);S.length%m!==0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(c===(c|0)&&c>=2&&c<=36){var x=v[c],C=p[c];S="";var K=this.clone();for(K.negative=0;!K.isZero();){var L=K.modn(C).toString(c);K=K.idivn(C),K.isZero()?S=L+S:S=l[x-L.length]+L+S}for(this.isZero()&&(S="0"+S);S.length%m!==0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var c=this.words[0];return this.length===2?c+=this.words[1]*67108864:this.length===3&&this.words[2]===1?c+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-c:c},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(c,m){return r(typeof s<"u"),this.toArrayLike(s,c,m)},i.prototype.toArray=function(c,m){return this.toArrayLike(Array,c,m)},i.prototype.toArrayLike=function(c,m,S){var g=this.byteLength(),E=S||Math.max(1,g);r(g<=E,"byte array longer than desired length"),r(E>0,"Requested array length <= 0"),this.strip();var M=m==="le",T=new c(E),R,x,C=this.clone();if(M){for(x=0;!C.isZero();x++)R=C.andln(255),C.iushrn(8),T[x]=R;for(;x<E;x++)T[x]=0}else{for(x=0;x<E-g;x++)T[x]=0;for(x=0;!C.isZero();x++)R=C.andln(255),C.iushrn(8),T[E-x-1]=R}return T},Math.clz32?i.prototype._countBits=function(c){return 32-Math.clz32(c)}:i.prototype._countBits=function(c){var m=c,S=0;return m>=4096&&(S+=13,m>>>=13),m>=64&&(S+=7,m>>>=7),m>=8&&(S+=4,m>>>=4),m>=2&&(S+=2,m>>>=2),S+m},i.prototype._zeroBits=function(c){if(c===0)return 26;var m=c,S=0;return(m&8191)===0&&(S+=13,m>>>=13),(m&127)===0&&(S+=7,m>>>=7),(m&15)===0&&(S+=4,m>>>=4),(m&3)===0&&(S+=2,m>>>=2),(m&1)===0&&S++,S},i.prototype.bitLength=function(){var c=this.words[this.length-1],m=this._countBits(c);return(this.length-1)*26+m};function u(A){for(var c=new Array(A.bitLength()),m=0;m<c.length;m++){var S=m/26|0,g=m%26;c[m]=(A.words[S]&1<<g)>>>g}return c}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var c=0,m=0;m<this.length;m++){var S=this._zeroBits(this.words[m]);if(c+=S,S!==26)break}return c},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(c){return this.negative!==0?this.abs().inotn(c).iaddn(1):this.clone()},i.prototype.fromTwos=function(c){return this.testn(c-1)?this.notn(c).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(c){for(;this.length<c.length;)this.words[this.length++]=0;for(var m=0;m<c.length;m++)this.words[m]=this.words[m]|c.words[m];return this.strip()},i.prototype.ior=function(c){return r((this.negative|c.negative)===0),this.iuor(c)},i.prototype.or=function(c){return this.length>c.length?this.clone().ior(c):c.clone().ior(this)},i.prototype.uor=function(c){return this.length>c.length?this.clone().iuor(c):c.clone().iuor(this)},i.prototype.iuand=function(c){var m;this.length>c.length?m=c:m=this;for(var S=0;S<m.length;S++)this.words[S]=this.words[S]&c.words[S];return this.length=m.length,this.strip()},i.prototype.iand=function(c){return r((this.negative|c.negative)===0),this.iuand(c)},i.prototype.and=function(c){return this.length>c.length?this.clone().iand(c):c.clone().iand(this)},i.prototype.uand=function(c){return this.length>c.length?this.clone().iuand(c):c.clone().iuand(this)},i.prototype.iuxor=function(c){var m,S;this.length>c.length?(m=this,S=c):(m=c,S=this);for(var g=0;g<S.length;g++)this.words[g]=m.words[g]^S.words[g];if(this!==m)for(;g<m.length;g++)this.words[g]=m.words[g];return this.length=m.length,this.strip()},i.prototype.ixor=function(c){return r((this.negative|c.negative)===0),this.iuxor(c)},i.prototype.xor=function(c){return this.length>c.length?this.clone().ixor(c):c.clone().ixor(this)},i.prototype.uxor=function(c){return this.length>c.length?this.clone().iuxor(c):c.clone().iuxor(this)},i.prototype.inotn=function(c){r(typeof c=="number"&&c>=0);var m=Math.ceil(c/26)|0,S=c%26;this._expand(m),S>0&&m--;for(var g=0;g<m;g++)this.words[g]=~this.words[g]&67108863;return S>0&&(this.words[g]=~this.words[g]&67108863>>26-S),this.strip()},i.prototype.notn=function(c){return this.clone().inotn(c)},i.prototype.setn=function(c,m){r(typeof c=="number"&&c>=0);var S=c/26|0,g=c%26;return this._expand(S+1),m?this.words[S]=this.words[S]|1<<g:this.words[S]=this.words[S]&~(1<<g),this.strip()},i.prototype.iadd=function(c){var m;if(this.negative!==0&&c.negative===0)return this.negative=0,m=this.isub(c),this.negative^=1,this._normSign();if(this.negative===0&&c.negative!==0)return c.negative=0,m=this.isub(c),c.negative=1,m._normSign();var S,g;this.length>c.length?(S=this,g=c):(S=c,g=this);for(var E=0,M=0;M<g.length;M++)m=(S.words[M]|0)+(g.words[M]|0)+E,this.words[M]=m&67108863,E=m>>>26;for(;E!==0&&M<S.length;M++)m=(S.words[M]|0)+E,this.words[M]=m&67108863,E=m>>>26;if(this.length=S.length,E!==0)this.words[this.length]=E,this.length++;else if(S!==this)for(;M<S.length;M++)this.words[M]=S.words[M];return this},i.prototype.add=function(c){var m;return c.negative!==0&&this.negative===0?(c.negative=0,m=this.sub(c),c.negative^=1,m):c.negative===0&&this.negative!==0?(this.negative=0,m=c.sub(this),this.negative=1,m):this.length>c.length?this.clone().iadd(c):c.clone().iadd(this)},i.prototype.isub=function(c){if(c.negative!==0){c.negative=0;var m=this.iadd(c);return c.negative=1,m._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(c),this.negative=1,this._normSign();var S=this.cmp(c);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;var g,E;S>0?(g=this,E=c):(g=c,E=this);for(var M=0,T=0;T<E.length;T++)m=(g.words[T]|0)-(E.words[T]|0)+M,M=m>>26,this.words[T]=m&67108863;for(;M!==0&&T<g.length;T++)m=(g.words[T]|0)+M,M=m>>26,this.words[T]=m&67108863;if(M===0&&T<g.length&&g!==this)for(;T<g.length;T++)this.words[T]=g.words[T];return this.length=Math.max(this.length,T),g!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(c){return this.clone().isub(c)};function h(A,c,m){m.negative=c.negative^A.negative;var S=A.length+c.length|0;m.length=S,S=S-1|0;var g=A.words[0]|0,E=c.words[0]|0,M=g*E,T=M&67108863,R=M/67108864|0;m.words[0]=T;for(var x=1;x<S;x++){for(var C=R>>>26,K=R&67108863,L=Math.min(x,c.length-1),V=Math.max(0,x-A.length+1);V<=L;V++){var z=x-V|0;g=A.words[z]|0,E=c.words[V]|0,M=g*E+K,C+=M/67108864|0,K=M&67108863}m.words[x]=K|0,R=C|0}return R!==0?m.words[x]=R|0:m.length--,m.strip()}var b=function(c,m,S){var g=c.words,E=m.words,M=S.words,T=0,R,x,C,K=g[0]|0,L=K&8191,V=K>>>13,z=g[1]|0,G=z&8191,$=z>>>13,oe=g[2]|0,Q=oe&8191,te=oe>>>13,ve=g[3]|0,J=ve&8191,Z=ve>>>13,Ce=g[4]|0,se=Ce&8191,re=Ce>>>13,ft=g[5]|0,_e=ft&8191,be=ft>>>13,Bt=g[6]|0,ge=Bt&8191,pe=Bt>>>13,Pt=g[7]|0,Fe=Pt&8191,ie=Pt>>>13,Rt=g[8]|0,ae=Rt&8191,Ee=Rt>>>13,bi=g[9]|0,Ae=bi&8191,Ie=bi>>>13,ws=E[0]|0,Ne=ws&8191,Re=ws>>>13,Ss=E[1]|0,Ve=Ss&8191,Oe=Ss>>>13,Es=E[2]|0,De=Es&8191,ze=Es>>>13,gi=E[3]|0,We=gi&8191,$e=gi>>>13,_s=E[4]|0,Te=_s&8191,Ge=_s>>>13,As=E[5]|0,qe=As&8191,Xe=As>>>13,yi=E[6]|0,ue=yi&8191,me=yi>>>13,xi=E[7]|0,Ze=xi&8191,Qe=xi>>>13,Wf=E[8]|0,et=Wf&8191,tt=Wf>>>13,$f=E[9]|0,rt=$f&8191,nt=$f>>>13;S.negative=c.negative^m.negative,S.length=19,R=Math.imul(L,Ne),x=Math.imul(L,Re),x=x+Math.imul(V,Ne)|0,C=Math.imul(V,Re);var Ya=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(Ya>>>26)|0,Ya&=67108863,R=Math.imul(G,Ne),x=Math.imul(G,Re),x=x+Math.imul($,Ne)|0,C=Math.imul($,Re),R=R+Math.imul(L,Ve)|0,x=x+Math.imul(L,Oe)|0,x=x+Math.imul(V,Ve)|0,C=C+Math.imul(V,Oe)|0;var Ja=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(Ja>>>26)|0,Ja&=67108863,R=Math.imul(Q,Ne),x=Math.imul(Q,Re),x=x+Math.imul(te,Ne)|0,C=Math.imul(te,Re),R=R+Math.imul(G,Ve)|0,x=x+Math.imul(G,Oe)|0,x=x+Math.imul($,Ve)|0,C=C+Math.imul($,Oe)|0,R=R+Math.imul(L,De)|0,x=x+Math.imul(L,ze)|0,x=x+Math.imul(V,De)|0,C=C+Math.imul(V,ze)|0;var Qa=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(Qa>>>26)|0,Qa&=67108863,R=Math.imul(J,Ne),x=Math.imul(J,Re),x=x+Math.imul(Z,Ne)|0,C=Math.imul(Z,Re),R=R+Math.imul(Q,Ve)|0,x=x+Math.imul(Q,Oe)|0,x=x+Math.imul(te,Ve)|0,C=C+Math.imul(te,Oe)|0,R=R+Math.imul(G,De)|0,x=x+Math.imul(G,ze)|0,x=x+Math.imul($,De)|0,C=C+Math.imul($,ze)|0,R=R+Math.imul(L,We)|0,x=x+Math.imul(L,$e)|0,x=x+Math.imul(V,We)|0,C=C+Math.imul(V,$e)|0;var e0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(e0>>>26)|0,e0&=67108863,R=Math.imul(se,Ne),x=Math.imul(se,Re),x=x+Math.imul(re,Ne)|0,C=Math.imul(re,Re),R=R+Math.imul(J,Ve)|0,x=x+Math.imul(J,Oe)|0,x=x+Math.imul(Z,Ve)|0,C=C+Math.imul(Z,Oe)|0,R=R+Math.imul(Q,De)|0,x=x+Math.imul(Q,ze)|0,x=x+Math.imul(te,De)|0,C=C+Math.imul(te,ze)|0,R=R+Math.imul(G,We)|0,x=x+Math.imul(G,$e)|0,x=x+Math.imul($,We)|0,C=C+Math.imul($,$e)|0,R=R+Math.imul(L,Te)|0,x=x+Math.imul(L,Ge)|0,x=x+Math.imul(V,Te)|0,C=C+Math.imul(V,Ge)|0;var t0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(t0>>>26)|0,t0&=67108863,R=Math.imul(_e,Ne),x=Math.imul(_e,Re),x=x+Math.imul(be,Ne)|0,C=Math.imul(be,Re),R=R+Math.imul(se,Ve)|0,x=x+Math.imul(se,Oe)|0,x=x+Math.imul(re,Ve)|0,C=C+Math.imul(re,Oe)|0,R=R+Math.imul(J,De)|0,x=x+Math.imul(J,ze)|0,x=x+Math.imul(Z,De)|0,C=C+Math.imul(Z,ze)|0,R=R+Math.imul(Q,We)|0,x=x+Math.imul(Q,$e)|0,x=x+Math.imul(te,We)|0,C=C+Math.imul(te,$e)|0,R=R+Math.imul(G,Te)|0,x=x+Math.imul(G,Ge)|0,x=x+Math.imul($,Te)|0,C=C+Math.imul($,Ge)|0,R=R+Math.imul(L,qe)|0,x=x+Math.imul(L,Xe)|0,x=x+Math.imul(V,qe)|0,C=C+Math.imul(V,Xe)|0;var r0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(r0>>>26)|0,r0&=67108863,R=Math.imul(ge,Ne),x=Math.imul(ge,Re),x=x+Math.imul(pe,Ne)|0,C=Math.imul(pe,Re),R=R+Math.imul(_e,Ve)|0,x=x+Math.imul(_e,Oe)|0,x=x+Math.imul(be,Ve)|0,C=C+Math.imul(be,Oe)|0,R=R+Math.imul(se,De)|0,x=x+Math.imul(se,ze)|0,x=x+Math.imul(re,De)|0,C=C+Math.imul(re,ze)|0,R=R+Math.imul(J,We)|0,x=x+Math.imul(J,$e)|0,x=x+Math.imul(Z,We)|0,C=C+Math.imul(Z,$e)|0,R=R+Math.imul(Q,Te)|0,x=x+Math.imul(Q,Ge)|0,x=x+Math.imul(te,Te)|0,C=C+Math.imul(te,Ge)|0,R=R+Math.imul(G,qe)|0,x=x+Math.imul(G,Xe)|0,x=x+Math.imul($,qe)|0,C=C+Math.imul($,Xe)|0,R=R+Math.imul(L,ue)|0,x=x+Math.imul(L,me)|0,x=x+Math.imul(V,ue)|0,C=C+Math.imul(V,me)|0;var n0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(n0>>>26)|0,n0&=67108863,R=Math.imul(Fe,Ne),x=Math.imul(Fe,Re),x=x+Math.imul(ie,Ne)|0,C=Math.imul(ie,Re),R=R+Math.imul(ge,Ve)|0,x=x+Math.imul(ge,Oe)|0,x=x+Math.imul(pe,Ve)|0,C=C+Math.imul(pe,Oe)|0,R=R+Math.imul(_e,De)|0,x=x+Math.imul(_e,ze)|0,x=x+Math.imul(be,De)|0,C=C+Math.imul(be,ze)|0,R=R+Math.imul(se,We)|0,x=x+Math.imul(se,$e)|0,x=x+Math.imul(re,We)|0,C=C+Math.imul(re,$e)|0,R=R+Math.imul(J,Te)|0,x=x+Math.imul(J,Ge)|0,x=x+Math.imul(Z,Te)|0,C=C+Math.imul(Z,Ge)|0,R=R+Math.imul(Q,qe)|0,x=x+Math.imul(Q,Xe)|0,x=x+Math.imul(te,qe)|0,C=C+Math.imul(te,Xe)|0,R=R+Math.imul(G,ue)|0,x=x+Math.imul(G,me)|0,x=x+Math.imul($,ue)|0,C=C+Math.imul($,me)|0,R=R+Math.imul(L,Ze)|0,x=x+Math.imul(L,Qe)|0,x=x+Math.imul(V,Ze)|0,C=C+Math.imul(V,Qe)|0;var i0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(i0>>>26)|0,i0&=67108863,R=Math.imul(ae,Ne),x=Math.imul(ae,Re),x=x+Math.imul(Ee,Ne)|0,C=Math.imul(Ee,Re),R=R+Math.imul(Fe,Ve)|0,x=x+Math.imul(Fe,Oe)|0,x=x+Math.imul(ie,Ve)|0,C=C+Math.imul(ie,Oe)|0,R=R+Math.imul(ge,De)|0,x=x+Math.imul(ge,ze)|0,x=x+Math.imul(pe,De)|0,C=C+Math.imul(pe,ze)|0,R=R+Math.imul(_e,We)|0,x=x+Math.imul(_e,$e)|0,x=x+Math.imul(be,We)|0,C=C+Math.imul(be,$e)|0,R=R+Math.imul(se,Te)|0,x=x+Math.imul(se,Ge)|0,x=x+Math.imul(re,Te)|0,C=C+Math.imul(re,Ge)|0,R=R+Math.imul(J,qe)|0,x=x+Math.imul(J,Xe)|0,x=x+Math.imul(Z,qe)|0,C=C+Math.imul(Z,Xe)|0,R=R+Math.imul(Q,ue)|0,x=x+Math.imul(Q,me)|0,x=x+Math.imul(te,ue)|0,C=C+Math.imul(te,me)|0,R=R+Math.imul(G,Ze)|0,x=x+Math.imul(G,Qe)|0,x=x+Math.imul($,Ze)|0,C=C+Math.imul($,Qe)|0,R=R+Math.imul(L,et)|0,x=x+Math.imul(L,tt)|0,x=x+Math.imul(V,et)|0,C=C+Math.imul(V,tt)|0;var s0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(s0>>>26)|0,s0&=67108863,R=Math.imul(Ae,Ne),x=Math.imul(Ae,Re),x=x+Math.imul(Ie,Ne)|0,C=Math.imul(Ie,Re),R=R+Math.imul(ae,Ve)|0,x=x+Math.imul(ae,Oe)|0,x=x+Math.imul(Ee,Ve)|0,C=C+Math.imul(Ee,Oe)|0,R=R+Math.imul(Fe,De)|0,x=x+Math.imul(Fe,ze)|0,x=x+Math.imul(ie,De)|0,C=C+Math.imul(ie,ze)|0,R=R+Math.imul(ge,We)|0,x=x+Math.imul(ge,$e)|0,x=x+Math.imul(pe,We)|0,C=C+Math.imul(pe,$e)|0,R=R+Math.imul(_e,Te)|0,x=x+Math.imul(_e,Ge)|0,x=x+Math.imul(be,Te)|0,C=C+Math.imul(be,Ge)|0,R=R+Math.imul(se,qe)|0,x=x+Math.imul(se,Xe)|0,x=x+Math.imul(re,qe)|0,C=C+Math.imul(re,Xe)|0,R=R+Math.imul(J,ue)|0,x=x+Math.imul(J,me)|0,x=x+Math.imul(Z,ue)|0,C=C+Math.imul(Z,me)|0,R=R+Math.imul(Q,Ze)|0,x=x+Math.imul(Q,Qe)|0,x=x+Math.imul(te,Ze)|0,C=C+Math.imul(te,Qe)|0,R=R+Math.imul(G,et)|0,x=x+Math.imul(G,tt)|0,x=x+Math.imul($,et)|0,C=C+Math.imul($,tt)|0,R=R+Math.imul(L,rt)|0,x=x+Math.imul(L,nt)|0,x=x+Math.imul(V,rt)|0,C=C+Math.imul(V,nt)|0;var a0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(a0>>>26)|0,a0&=67108863,R=Math.imul(Ae,Ve),x=Math.imul(Ae,Oe),x=x+Math.imul(Ie,Ve)|0,C=Math.imul(Ie,Oe),R=R+Math.imul(ae,De)|0,x=x+Math.imul(ae,ze)|0,x=x+Math.imul(Ee,De)|0,C=C+Math.imul(Ee,ze)|0,R=R+Math.imul(Fe,We)|0,x=x+Math.imul(Fe,$e)|0,x=x+Math.imul(ie,We)|0,C=C+Math.imul(ie,$e)|0,R=R+Math.imul(ge,Te)|0,x=x+Math.imul(ge,Ge)|0,x=x+Math.imul(pe,Te)|0,C=C+Math.imul(pe,Ge)|0,R=R+Math.imul(_e,qe)|0,x=x+Math.imul(_e,Xe)|0,x=x+Math.imul(be,qe)|0,C=C+Math.imul(be,Xe)|0,R=R+Math.imul(se,ue)|0,x=x+Math.imul(se,me)|0,x=x+Math.imul(re,ue)|0,C=C+Math.imul(re,me)|0,R=R+Math.imul(J,Ze)|0,x=x+Math.imul(J,Qe)|0,x=x+Math.imul(Z,Ze)|0,C=C+Math.imul(Z,Qe)|0,R=R+Math.imul(Q,et)|0,x=x+Math.imul(Q,tt)|0,x=x+Math.imul(te,et)|0,C=C+Math.imul(te,tt)|0,R=R+Math.imul(G,rt)|0,x=x+Math.imul(G,nt)|0,x=x+Math.imul($,rt)|0,C=C+Math.imul($,nt)|0;var o0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(o0>>>26)|0,o0&=67108863,R=Math.imul(Ae,De),x=Math.imul(Ae,ze),x=x+Math.imul(Ie,De)|0,C=Math.imul(Ie,ze),R=R+Math.imul(ae,We)|0,x=x+Math.imul(ae,$e)|0,x=x+Math.imul(Ee,We)|0,C=C+Math.imul(Ee,$e)|0,R=R+Math.imul(Fe,Te)|0,x=x+Math.imul(Fe,Ge)|0,x=x+Math.imul(ie,Te)|0,C=C+Math.imul(ie,Ge)|0,R=R+Math.imul(ge,qe)|0,x=x+Math.imul(ge,Xe)|0,x=x+Math.imul(pe,qe)|0,C=C+Math.imul(pe,Xe)|0,R=R+Math.imul(_e,ue)|0,x=x+Math.imul(_e,me)|0,x=x+Math.imul(be,ue)|0,C=C+Math.imul(be,me)|0,R=R+Math.imul(se,Ze)|0,x=x+Math.imul(se,Qe)|0,x=x+Math.imul(re,Ze)|0,C=C+Math.imul(re,Qe)|0,R=R+Math.imul(J,et)|0,x=x+Math.imul(J,tt)|0,x=x+Math.imul(Z,et)|0,C=C+Math.imul(Z,tt)|0,R=R+Math.imul(Q,rt)|0,x=x+Math.imul(Q,nt)|0,x=x+Math.imul(te,rt)|0,C=C+Math.imul(te,nt)|0;var f0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(f0>>>26)|0,f0&=67108863,R=Math.imul(Ae,We),x=Math.imul(Ae,$e),x=x+Math.imul(Ie,We)|0,C=Math.imul(Ie,$e),R=R+Math.imul(ae,Te)|0,x=x+Math.imul(ae,Ge)|0,x=x+Math.imul(Ee,Te)|0,C=C+Math.imul(Ee,Ge)|0,R=R+Math.imul(Fe,qe)|0,x=x+Math.imul(Fe,Xe)|0,x=x+Math.imul(ie,qe)|0,C=C+Math.imul(ie,Xe)|0,R=R+Math.imul(ge,ue)|0,x=x+Math.imul(ge,me)|0,x=x+Math.imul(pe,ue)|0,C=C+Math.imul(pe,me)|0,R=R+Math.imul(_e,Ze)|0,x=x+Math.imul(_e,Qe)|0,x=x+Math.imul(be,Ze)|0,C=C+Math.imul(be,Qe)|0,R=R+Math.imul(se,et)|0,x=x+Math.imul(se,tt)|0,x=x+Math.imul(re,et)|0,C=C+Math.imul(re,tt)|0,R=R+Math.imul(J,rt)|0,x=x+Math.imul(J,nt)|0,x=x+Math.imul(Z,rt)|0,C=C+Math.imul(Z,nt)|0;var c0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(c0>>>26)|0,c0&=67108863,R=Math.imul(Ae,Te),x=Math.imul(Ae,Ge),x=x+Math.imul(Ie,Te)|0,C=Math.imul(Ie,Ge),R=R+Math.imul(ae,qe)|0,x=x+Math.imul(ae,Xe)|0,x=x+Math.imul(Ee,qe)|0,C=C+Math.imul(Ee,Xe)|0,R=R+Math.imul(Fe,ue)|0,x=x+Math.imul(Fe,me)|0,x=x+Math.imul(ie,ue)|0,C=C+Math.imul(ie,me)|0,R=R+Math.imul(ge,Ze)|0,x=x+Math.imul(ge,Qe)|0,x=x+Math.imul(pe,Ze)|0,C=C+Math.imul(pe,Qe)|0,R=R+Math.imul(_e,et)|0,x=x+Math.imul(_e,tt)|0,x=x+Math.imul(be,et)|0,C=C+Math.imul(be,tt)|0,R=R+Math.imul(se,rt)|0,x=x+Math.imul(se,nt)|0,x=x+Math.imul(re,rt)|0,C=C+Math.imul(re,nt)|0;var u0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(u0>>>26)|0,u0&=67108863,R=Math.imul(Ae,qe),x=Math.imul(Ae,Xe),x=x+Math.imul(Ie,qe)|0,C=Math.imul(Ie,Xe),R=R+Math.imul(ae,ue)|0,x=x+Math.imul(ae,me)|0,x=x+Math.imul(Ee,ue)|0,C=C+Math.imul(Ee,me)|0,R=R+Math.imul(Fe,Ze)|0,x=x+Math.imul(Fe,Qe)|0,x=x+Math.imul(ie,Ze)|0,C=C+Math.imul(ie,Qe)|0,R=R+Math.imul(ge,et)|0,x=x+Math.imul(ge,tt)|0,x=x+Math.imul(pe,et)|0,C=C+Math.imul(pe,tt)|0,R=R+Math.imul(_e,rt)|0,x=x+Math.imul(_e,nt)|0,x=x+Math.imul(be,rt)|0,C=C+Math.imul(be,nt)|0;var d0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(d0>>>26)|0,d0&=67108863,R=Math.imul(Ae,ue),x=Math.imul(Ae,me),x=x+Math.imul(Ie,ue)|0,C=Math.imul(Ie,me),R=R+Math.imul(ae,Ze)|0,x=x+Math.imul(ae,Qe)|0,x=x+Math.imul(Ee,Ze)|0,C=C+Math.imul(Ee,Qe)|0,R=R+Math.imul(Fe,et)|0,x=x+Math.imul(Fe,tt)|0,x=x+Math.imul(ie,et)|0,C=C+Math.imul(ie,tt)|0,R=R+Math.imul(ge,rt)|0,x=x+Math.imul(ge,nt)|0,x=x+Math.imul(pe,rt)|0,C=C+Math.imul(pe,nt)|0;var h0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(h0>>>26)|0,h0&=67108863,R=Math.imul(Ae,Ze),x=Math.imul(Ae,Qe),x=x+Math.imul(Ie,Ze)|0,C=Math.imul(Ie,Qe),R=R+Math.imul(ae,et)|0,x=x+Math.imul(ae,tt)|0,x=x+Math.imul(Ee,et)|0,C=C+Math.imul(Ee,tt)|0,R=R+Math.imul(Fe,rt)|0,x=x+Math.imul(Fe,nt)|0,x=x+Math.imul(ie,rt)|0,C=C+Math.imul(ie,nt)|0;var l0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(l0>>>26)|0,l0&=67108863,R=Math.imul(Ae,et),x=Math.imul(Ae,tt),x=x+Math.imul(Ie,et)|0,C=Math.imul(Ie,tt),R=R+Math.imul(ae,rt)|0,x=x+Math.imul(ae,nt)|0,x=x+Math.imul(Ee,rt)|0,C=C+Math.imul(Ee,nt)|0;var p0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(p0>>>26)|0,p0&=67108863,R=Math.imul(Ae,rt),x=Math.imul(Ae,nt),x=x+Math.imul(Ie,rt)|0,C=Math.imul(Ie,nt);var v0=(T+R|0)+((x&8191)<<13)|0;return T=(C+(x>>>13)|0)+(v0>>>26)|0,v0&=67108863,M[0]=Ya,M[1]=Ja,M[2]=Qa,M[3]=e0,M[4]=t0,M[5]=r0,M[6]=n0,M[7]=i0,M[8]=s0,M[9]=a0,M[10]=o0,M[11]=f0,M[12]=c0,M[13]=u0,M[14]=d0,M[15]=h0,M[16]=l0,M[17]=p0,M[18]=v0,T!==0&&(M[19]=T,S.length++),S};Math.imul||(b=h);function d(A,c,m){m.negative=c.negative^A.negative,m.length=A.length+c.length;for(var S=0,g=0,E=0;E<m.length-1;E++){var M=g;g=0;for(var T=S&67108863,R=Math.min(E,c.length-1),x=Math.max(0,E-A.length+1);x<=R;x++){var C=E-x,K=A.words[C]|0,L=c.words[x]|0,V=K*L,z=V&67108863;M=M+(V/67108864|0)|0,z=z+T|0,T=z&67108863,M=M+(z>>>26)|0,g+=M>>>26,M&=67108863}m.words[E]=T,S=M,M=g}return S!==0?m.words[E]=S:m.length--,m.strip()}function y(A,c,m){var S=new w;return S.mulp(A,c,m)}i.prototype.mulTo=function(c,m){var S,g=this.length+c.length;return this.length===10&&c.length===10?S=b(this,c,m):g<63?S=h(this,c,m):g<1024?S=d(this,c,m):S=y(this,c,m),S};function w(A,c){this.x=A,this.y=c}w.prototype.makeRBT=function(c){for(var m=new Array(c),S=i.prototype._countBits(c)-1,g=0;g<c;g++)m[g]=this.revBin(g,S,c);return m},w.prototype.revBin=function(c,m,S){if(c===0||c===S-1)return c;for(var g=0,E=0;E<m;E++)g|=(c&1)<<m-E-1,c>>=1;return g},w.prototype.permute=function(c,m,S,g,E,M){for(var T=0;T<M;T++)g[T]=m[c[T]],E[T]=S[c[T]]},w.prototype.transform=function(c,m,S,g,E,M){this.permute(M,c,m,S,g,E);for(var T=1;T<E;T<<=1)for(var R=T<<1,x=Math.cos(2*Math.PI/R),C=Math.sin(2*Math.PI/R),K=0;K<E;K+=R)for(var L=x,V=C,z=0;z<T;z++){var G=S[K+z],$=g[K+z],oe=S[K+z+T],Q=g[K+z+T],te=L*oe-V*Q;Q=L*Q+V*oe,oe=te,S[K+z]=G+oe,g[K+z]=$+Q,S[K+z+T]=G-oe,g[K+z+T]=$-Q,z!==R&&(te=x*L-C*V,V=x*V+C*L,L=te)}},w.prototype.guessLen13b=function(c,m){var S=Math.max(m,c)|1,g=S&1,E=0;for(S=S/2|0;S;S=S>>>1)E++;return 1<<E+1+g},w.prototype.conjugate=function(c,m,S){if(!(S<=1))for(var g=0;g<S/2;g++){var E=c[g];c[g]=c[S-g-1],c[S-g-1]=E,E=m[g],m[g]=-m[S-g-1],m[S-g-1]=-E}},w.prototype.normalize13b=function(c,m){for(var S=0,g=0;g<m/2;g++){var E=Math.round(c[2*g+1]/m)*8192+Math.round(c[2*g]/m)+S;c[g]=E&67108863,E<67108864?S=0:S=E/67108864|0}return c},w.prototype.convert13b=function(c,m,S,g){for(var E=0,M=0;M<m;M++)E=E+(c[M]|0),S[2*M]=E&8191,E=E>>>13,S[2*M+1]=E&8191,E=E>>>13;for(M=2*m;M<g;++M)S[M]=0;r(E===0),r((E&-8192)===0)},w.prototype.stub=function(c){for(var m=new Array(c),S=0;S<c;S++)m[S]=0;return m},w.prototype.mulp=function(c,m,S){var g=2*this.guessLen13b(c.length,m.length),E=this.makeRBT(g),M=this.stub(g),T=new Array(g),R=new Array(g),x=new Array(g),C=new Array(g),K=new Array(g),L=new Array(g),V=S.words;V.length=g,this.convert13b(c.words,c.length,T,g),this.convert13b(m.words,m.length,C,g),this.transform(T,M,R,x,g,E),this.transform(C,M,K,L,g,E);for(var z=0;z<g;z++){var G=R[z]*K[z]-x[z]*L[z];x[z]=R[z]*L[z]+x[z]*K[z],R[z]=G}return this.conjugate(R,x,g),this.transform(R,x,V,M,g,E),this.conjugate(V,M,g),this.normalize13b(V,g),S.negative=c.negative^m.negative,S.length=c.length+m.length,S.strip()},i.prototype.mul=function(c){var m=new i(null);return m.words=new Array(this.length+c.length),this.mulTo(c,m)},i.prototype.mulf=function(c){var m=new i(null);return m.words=new Array(this.length+c.length),y(this,c,m)},i.prototype.imul=function(c){return this.clone().mulTo(c,this)},i.prototype.imuln=function(c){r(typeof c=="number"),r(c<67108864);for(var m=0,S=0;S<this.length;S++){var g=(this.words[S]|0)*c,E=(g&67108863)+(m&67108863);m>>=26,m+=g/67108864|0,m+=E>>>26,this.words[S]=E&67108863}return m!==0&&(this.words[S]=m,this.length++),this},i.prototype.muln=function(c){return this.clone().imuln(c)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(c){var m=u(c);if(m.length===0)return new i(1);for(var S=this,g=0;g<m.length&&m[g]===0;g++,S=S.sqr());if(++g<m.length)for(var E=S.sqr();g<m.length;g++,E=E.sqr())m[g]!==0&&(S=S.mul(E));return S},i.prototype.iushln=function(c){r(typeof c=="number"&&c>=0);var m=c%26,S=(c-m)/26,g=67108863>>>26-m<<26-m,E;if(m!==0){var M=0;for(E=0;E<this.length;E++){var T=this.words[E]&g,R=(this.words[E]|0)-T<<m;this.words[E]=R|M,M=T>>>26-m}M&&(this.words[E]=M,this.length++)}if(S!==0){for(E=this.length-1;E>=0;E--)this.words[E+S]=this.words[E];for(E=0;E<S;E++)this.words[E]=0;this.length+=S}return this.strip()},i.prototype.ishln=function(c){return r(this.negative===0),this.iushln(c)},i.prototype.iushrn=function(c,m,S){r(typeof c=="number"&&c>=0);var g;m?g=(m-m%26)/26:g=0;var E=c%26,M=Math.min((c-E)/26,this.length),T=67108863^67108863>>>E<<E,R=S;if(g-=M,g=Math.max(0,g),R){for(var x=0;x<M;x++)R.words[x]=this.words[x];R.length=M}if(M!==0)if(this.length>M)for(this.length-=M,x=0;x<this.length;x++)this.words[x]=this.words[x+M];else this.words[0]=0,this.length=1;var C=0;for(x=this.length-1;x>=0&&(C!==0||x>=g);x--){var K=this.words[x]|0;this.words[x]=C<<26-E|K>>>E,C=K&T}return R&&C!==0&&(R.words[R.length++]=C),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(c,m,S){return r(this.negative===0),this.iushrn(c,m,S)},i.prototype.shln=function(c){return this.clone().ishln(c)},i.prototype.ushln=function(c){return this.clone().iushln(c)},i.prototype.shrn=function(c){return this.clone().ishrn(c)},i.prototype.ushrn=function(c){return this.clone().iushrn(c)},i.prototype.testn=function(c){r(typeof c=="number"&&c>=0);var m=c%26,S=(c-m)/26,g=1<<m;if(this.length<=S)return!1;var E=this.words[S];return!!(E&g)},i.prototype.imaskn=function(c){r(typeof c=="number"&&c>=0);var m=c%26,S=(c-m)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(m!==0&&S++,this.length=Math.min(S,this.length),m!==0){var g=67108863^67108863>>>m<<m;this.words[this.length-1]&=g}return this.strip()},i.prototype.maskn=function(c){return this.clone().imaskn(c)},i.prototype.iaddn=function(c){return r(typeof c=="number"),r(c<67108864),c<0?this.isubn(-c):this.negative!==0?this.length===1&&(this.words[0]|0)<c?(this.words[0]=c-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(c),this.negative=1,this):this._iaddn(c)},i.prototype._iaddn=function(c){this.words[0]+=c;for(var m=0;m<this.length&&this.words[m]>=67108864;m++)this.words[m]-=67108864,m===this.length-1?this.words[m+1]=1:this.words[m+1]++;return this.length=Math.max(this.length,m+1),this},i.prototype.isubn=function(c){if(r(typeof c=="number"),r(c<67108864),c<0)return this.iaddn(-c);if(this.negative!==0)return this.negative=0,this.iaddn(c),this.negative=1,this;if(this.words[0]-=c,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var m=0;m<this.length&&this.words[m]<0;m++)this.words[m]+=67108864,this.words[m+1]-=1;return this.strip()},i.prototype.addn=function(c){return this.clone().iaddn(c)},i.prototype.subn=function(c){return this.clone().isubn(c)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(c,m,S){var g=c.length+S,E;this._expand(g);var M,T=0;for(E=0;E<c.length;E++){M=(this.words[E+S]|0)+T;var R=(c.words[E]|0)*m;M-=R&67108863,T=(M>>26)-(R/67108864|0),this.words[E+S]=M&67108863}for(;E<this.length-S;E++)M=(this.words[E+S]|0)+T,T=M>>26,this.words[E+S]=M&67108863;if(T===0)return this.strip();for(r(T===-1),T=0,E=0;E<this.length;E++)M=-(this.words[E]|0)+T,T=M>>26,this.words[E]=M&67108863;return this.negative=1,this.strip()},i.prototype._wordDiv=function(c,m){var S=this.length-c.length,g=this.clone(),E=c,M=E.words[E.length-1]|0,T=this._countBits(M);S=26-T,S!==0&&(E=E.ushln(S),g.iushln(S),M=E.words[E.length-1]|0);var R=g.length-E.length,x;if(m!=="mod"){x=new i(null),x.length=R+1,x.words=new Array(x.length);for(var C=0;C<x.length;C++)x.words[C]=0}var K=g.clone()._ishlnsubmul(E,1,R);K.negative===0&&(g=K,x&&(x.words[R]=1));for(var L=R-1;L>=0;L--){var V=(g.words[E.length+L]|0)*67108864+(g.words[E.length+L-1]|0);for(V=Math.min(V/M|0,67108863),g._ishlnsubmul(E,V,L);g.negative!==0;)V--,g.negative=0,g._ishlnsubmul(E,1,L),g.isZero()||(g.negative^=1);x&&(x.words[L]=V)}return x&&x.strip(),g.strip(),m!=="div"&&S!==0&&g.iushrn(S),{div:x||null,mod:g}},i.prototype.divmod=function(c,m,S){if(r(!c.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var g,E,M;return this.negative!==0&&c.negative===0?(M=this.neg().divmod(c,m),m!=="mod"&&(g=M.div.neg()),m!=="div"&&(E=M.mod.neg(),S&&E.negative!==0&&E.iadd(c)),{div:g,mod:E}):this.negative===0&&c.negative!==0?(M=this.divmod(c.neg(),m),m!=="mod"&&(g=M.div.neg()),{div:g,mod:M.mod}):(this.negative&c.negative)!==0?(M=this.neg().divmod(c.neg(),m),m!=="div"&&(E=M.mod.neg(),S&&E.negative!==0&&E.isub(c)),{div:M.div,mod:E}):c.length>this.length||this.cmp(c)<0?{div:new i(0),mod:this}:c.length===1?m==="div"?{div:this.divn(c.words[0]),mod:null}:m==="mod"?{div:null,mod:new i(this.modn(c.words[0]))}:{div:this.divn(c.words[0]),mod:new i(this.modn(c.words[0]))}:this._wordDiv(c,m)},i.prototype.div=function(c){return this.divmod(c,"div",!1).div},i.prototype.mod=function(c){return this.divmod(c,"mod",!1).mod},i.prototype.umod=function(c){return this.divmod(c,"mod",!0).mod},i.prototype.divRound=function(c){var m=this.divmod(c);if(m.mod.isZero())return m.div;var S=m.div.negative!==0?m.mod.isub(c):m.mod,g=c.ushrn(1),E=c.andln(1),M=S.cmp(g);return M<0||E===1&&M===0?m.div:m.div.negative!==0?m.div.isubn(1):m.div.iaddn(1)},i.prototype.modn=function(c){r(c<=67108863);for(var m=(1<<26)%c,S=0,g=this.length-1;g>=0;g--)S=(m*S+(this.words[g]|0))%c;return S},i.prototype.idivn=function(c){r(c<=67108863);for(var m=0,S=this.length-1;S>=0;S--){var g=(this.words[S]|0)+m*67108864;this.words[S]=g/c|0,m=g%c}return this.strip()},i.prototype.divn=function(c){return this.clone().idivn(c)},i.prototype.egcd=function(c){r(c.negative===0),r(!c.isZero());var m=this,S=c.clone();m.negative!==0?m=m.umod(c):m=m.clone();for(var g=new i(1),E=new i(0),M=new i(0),T=new i(1),R=0;m.isEven()&&S.isEven();)m.iushrn(1),S.iushrn(1),++R;for(var x=S.clone(),C=m.clone();!m.isZero();){for(var K=0,L=1;(m.words[0]&L)===0&&K<26;++K,L<<=1);if(K>0)for(m.iushrn(K);K-- >0;)(g.isOdd()||E.isOdd())&&(g.iadd(x),E.isub(C)),g.iushrn(1),E.iushrn(1);for(var V=0,z=1;(S.words[0]&z)===0&&V<26;++V,z<<=1);if(V>0)for(S.iushrn(V);V-- >0;)(M.isOdd()||T.isOdd())&&(M.iadd(x),T.isub(C)),M.iushrn(1),T.iushrn(1);m.cmp(S)>=0?(m.isub(S),g.isub(M),E.isub(T)):(S.isub(m),M.isub(g),T.isub(E))}return{a:M,b:T,gcd:S.iushln(R)}},i.prototype._invmp=function(c){r(c.negative===0),r(!c.isZero());var m=this,S=c.clone();m.negative!==0?m=m.umod(c):m=m.clone();for(var g=new i(1),E=new i(0),M=S.clone();m.cmpn(1)>0&&S.cmpn(1)>0;){for(var T=0,R=1;(m.words[0]&R)===0&&T<26;++T,R<<=1);if(T>0)for(m.iushrn(T);T-- >0;)g.isOdd()&&g.iadd(M),g.iushrn(1);for(var x=0,C=1;(S.words[0]&C)===0&&x<26;++x,C<<=1);if(x>0)for(S.iushrn(x);x-- >0;)E.isOdd()&&E.iadd(M),E.iushrn(1);m.cmp(S)>=0?(m.isub(S),g.isub(E)):(S.isub(m),E.isub(g))}var K;return m.cmpn(1)===0?K=g:K=E,K.cmpn(0)<0&&K.iadd(c),K},i.prototype.gcd=function(c){if(this.isZero())return c.abs();if(c.isZero())return this.abs();var m=this.clone(),S=c.clone();m.negative=0,S.negative=0;for(var g=0;m.isEven()&&S.isEven();g++)m.iushrn(1),S.iushrn(1);do{for(;m.isEven();)m.iushrn(1);for(;S.isEven();)S.iushrn(1);var E=m.cmp(S);if(E<0){var M=m;m=S,S=M}else if(E===0||S.cmpn(1)===0)break;m.isub(S)}while(!0);return S.iushln(g)},i.prototype.invm=function(c){return this.egcd(c).a.umod(c)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(c){return this.words[0]&c},i.prototype.bincn=function(c){r(typeof c=="number");var m=c%26,S=(c-m)/26,g=1<<m;if(this.length<=S)return this._expand(S+1),this.words[S]|=g,this;for(var E=g,M=S;E!==0&&M<this.length;M++){var T=this.words[M]|0;T+=E,E=T>>>26,T&=67108863,this.words[M]=T}return E!==0&&(this.words[M]=E,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(c){var m=c<0;if(this.negative!==0&&!m)return-1;if(this.negative===0&&m)return 1;this.strip();var S;if(this.length>1)S=1;else{m&&(c=-c),r(c<=67108863,"Number is too big");var g=this.words[0]|0;S=g===c?0:g<c?-1:1}return this.negative!==0?-S|0:S},i.prototype.cmp=function(c){if(this.negative!==0&&c.negative===0)return-1;if(this.negative===0&&c.negative!==0)return 1;var m=this.ucmp(c);return this.negative!==0?-m|0:m},i.prototype.ucmp=function(c){if(this.length>c.length)return 1;if(this.length<c.length)return-1;for(var m=0,S=this.length-1;S>=0;S--){var g=this.words[S]|0,E=c.words[S]|0;if(g!==E){g<E?m=-1:g>E&&(m=1);break}}return m},i.prototype.gtn=function(c){return this.cmpn(c)===1},i.prototype.gt=function(c){return this.cmp(c)===1},i.prototype.gten=function(c){return this.cmpn(c)>=0},i.prototype.gte=function(c){return this.cmp(c)>=0},i.prototype.ltn=function(c){return this.cmpn(c)===-1},i.prototype.lt=function(c){return this.cmp(c)===-1},i.prototype.lten=function(c){return this.cmpn(c)<=0},i.prototype.lte=function(c){return this.cmp(c)<=0},i.prototype.eqn=function(c){return this.cmpn(c)===0},i.prototype.eq=function(c){return this.cmp(c)===0},i.red=function(c){return new P(c)},i.prototype.toRed=function(c){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),c.convertTo(this)._forceRed(c)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(c){return this.red=c,this},i.prototype.forceRed=function(c){return r(!this.red,"Already a number in reduction context"),this._forceRed(c)},i.prototype.redAdd=function(c){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,c)},i.prototype.redIAdd=function(c){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,c)},i.prototype.redSub=function(c){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,c)},i.prototype.redISub=function(c){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,c)},i.prototype.redShl=function(c){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,c)},i.prototype.redMul=function(c){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.mul(this,c)},i.prototype.redIMul=function(c){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.imul(this,c)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(c){return r(this.red&&!c.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,c)};var _={k256:null,p224:null,p192:null,p25519:null};function I(A,c){this.name=A,this.p=new i(c,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}I.prototype._tmp=function(){var c=new i(null);return c.words=new Array(Math.ceil(this.n/13)),c},I.prototype.ireduce=function(c){var m=c,S;do this.split(m,this.tmp),m=this.imulK(m),m=m.iadd(this.tmp),S=m.bitLength();while(S>this.n);var g=S<this.n?-1:m.ucmp(this.p);return g===0?(m.words[0]=0,m.length=1):g>0?m.isub(this.p):m.strip!==void 0?m.strip():m._strip(),m},I.prototype.split=function(c,m){c.iushrn(this.n,0,m)},I.prototype.imulK=function(c){return c.imul(this.k)};function N(){I.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(N,I),N.prototype.split=function(c,m){for(var S=4194303,g=Math.min(c.length,9),E=0;E<g;E++)m.words[E]=c.words[E];if(m.length=g,c.length<=9){c.words[0]=0,c.length=1;return}var M=c.words[9];for(m.words[m.length++]=M&S,E=10;E<c.length;E++){var T=c.words[E]|0;c.words[E-10]=(T&S)<<4|M>>>22,M=T}M>>>=22,c.words[E-10]=M,M===0&&c.length>10?c.length-=10:c.length-=9},N.prototype.imulK=function(c){c.words[c.length]=0,c.words[c.length+1]=0,c.length+=2;for(var m=0,S=0;S<c.length;S++){var g=c.words[S]|0;m+=g*977,c.words[S]=m&67108863,m=g*64+(m/67108864|0)}return c.words[c.length-1]===0&&(c.length--,c.words[c.length-1]===0&&c.length--),c};function F(){I.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(F,I);function O(){I.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(O,I);function q(){I.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(q,I),q.prototype.imulK=function(c){for(var m=0,S=0;S<c.length;S++){var g=(c.words[S]|0)*19+m,E=g&67108863;g>>>=26,c.words[S]=E,m=g}return m!==0&&(c.words[c.length++]=m),c},i._prime=function(c){if(_[c])return _[c];var m;if(c==="k256")m=new N;else if(c==="p224")m=new F;else if(c==="p192")m=new O;else if(c==="p25519")m=new q;else throw new Error("Unknown prime "+c);return _[c]=m,m};function P(A){if(typeof A=="string"){var c=i._prime(A);this.m=c.p,this.prime=c}else r(A.gtn(1),"modulus must be greater than 1"),this.m=A,this.prime=null}P.prototype._verify1=function(c){r(c.negative===0,"red works only with positives"),r(c.red,"red works only with red numbers")},P.prototype._verify2=function(c,m){r((c.negative|m.negative)===0,"red works only with positives"),r(c.red&&c.red===m.red,"red works only with red numbers")},P.prototype.imod=function(c){return this.prime?this.prime.ireduce(c)._forceRed(this):c.umod(this.m)._forceRed(this)},P.prototype.neg=function(c){return c.isZero()?c.clone():this.m.sub(c)._forceRed(this)},P.prototype.add=function(c,m){this._verify2(c,m);var S=c.add(m);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},P.prototype.iadd=function(c,m){this._verify2(c,m);var S=c.iadd(m);return S.cmp(this.m)>=0&&S.isub(this.m),S},P.prototype.sub=function(c,m){this._verify2(c,m);var S=c.sub(m);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},P.prototype.isub=function(c,m){this._verify2(c,m);var S=c.isub(m);return S.cmpn(0)<0&&S.iadd(this.m),S},P.prototype.shl=function(c,m){return this._verify1(c),this.imod(c.ushln(m))},P.prototype.imul=function(c,m){return this._verify2(c,m),this.imod(c.imul(m))},P.prototype.mul=function(c,m){return this._verify2(c,m),this.imod(c.mul(m))},P.prototype.isqr=function(c){return this.imul(c,c.clone())},P.prototype.sqr=function(c){return this.mul(c,c)},P.prototype.sqrt=function(c){if(c.isZero())return c.clone();var m=this.m.andln(3);if(r(m%2===1),m===3){var S=this.m.add(new i(1)).iushrn(2);return this.pow(c,S)}for(var g=this.m.subn(1),E=0;!g.isZero()&&g.andln(1)===0;)E++,g.iushrn(1);r(!g.isZero());var M=new i(1).toRed(this),T=M.redNeg(),R=this.m.subn(1).iushrn(1),x=this.m.bitLength();for(x=new i(2*x*x).toRed(this);this.pow(x,R).cmp(T)!==0;)x.redIAdd(T);for(var C=this.pow(x,g),K=this.pow(c,g.addn(1).iushrn(1)),L=this.pow(c,g),V=E;L.cmp(M)!==0;){for(var z=L,G=0;z.cmp(M)!==0;G++)z=z.redSqr();r(G<V);var $=this.pow(C,new i(1).iushln(V-G-1));K=K.redMul($),C=$.redSqr(),L=L.redMul(C),V=G}return K},P.prototype.invm=function(c){var m=c._invmp(this.m);return m.negative!==0?(m.negative=0,this.imod(m).redNeg()):this.imod(m)},P.prototype.pow=function(c,m){if(m.isZero())return new i(1).toRed(this);if(m.cmpn(1)===0)return c.clone();var S=4,g=new Array(1<<S);g[0]=new i(1).toRed(this),g[1]=c;for(var E=2;E<g.length;E++)g[E]=this.mul(g[E-1],c);var M=g[0],T=0,R=0,x=m.bitLength()%26;for(x===0&&(x=26),E=m.length-1;E>=0;E--){for(var C=m.words[E],K=x-1;K>=0;K--){var L=C>>K&1;if(M!==g[0]&&(M=this.sqr(M)),L===0&&T===0){R=0;continue}T<<=1,T|=L,R++,!(R!==S&&(E!==0||K!==0))&&(M=this.mul(M,g[T]),R=0,T=0)}x=26}return M},P.prototype.convertTo=function(c){var m=c.umod(this.m);return m===c?m.clone():m},P.prototype.convertFrom=function(c){var m=c.clone();return m.red=null,m},i.mont=function(c){return new D(c)};function D(A){P.call(this,A),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(D,P),D.prototype.convertTo=function(c){return this.imod(c.ushln(this.shift))},D.prototype.convertFrom=function(c){var m=this.imod(c.mul(this.rinv));return m.red=null,m},D.prototype.imul=function(c,m){if(c.isZero()||m.isZero())return c.words[0]=0,c.length=1,c;var S=c.imul(m),g=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=S.isub(g).iushrn(this.shift),M=E;return E.cmp(this.m)>=0?M=E.isub(this.m):E.cmpn(0)<0&&(M=E.iadd(this.m)),M._forceRed(this)},D.prototype.mul=function(c,m){if(c.isZero()||m.isZero())return new i(0)._forceRed(this);var S=c.mul(m),g=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=S.isub(g).iushrn(this.shift),M=E;return E.cmp(this.m)>=0?M=E.isub(this.m):E.cmpn(0)<0&&(M=E.iadd(this.m)),M._forceRed(this)},D.prototype.invm=function(c){var m=this.imod(c._invmp(this.m).mul(this.r2));return m._forceRed(this)}})(typeof d2>"u"||d2,t3)});var s3=U(Bn=>{"use strict";H();k();var o_=Bn&&Bn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Bn,"__esModule",{value:!0});Bn.stripHexPrefix=Bn.isHexPrefixed=Bn.getLength=Bn.decode=Bn.encode=void 0;var f_=o_(wr());function n3(e){if(Array.isArray(e)){let t=[];for(let n=0;n<e.length;n++)t.push(n3(e[n]));let r=j.Buffer.concat(t);return j.Buffer.concat([r3(r.length,192),r])}else{let t=b2(e);return t.length===1&&t[0]<128?t:j.Buffer.concat([r3(t.length,128),t])}}Bn.encode=n3;function h2(e,t){if(e[0]==="0"&&e[1]==="0")throw new Error("invalid RLP: extra zeros");return parseInt(e,t)}function r3(e,t){if(e<56)return j.Buffer.from([e+t]);{let r=p2(e),n=r.length/2,i=p2(t+55+n);return j.Buffer.from(i+r,"hex")}}function c_(e,t=!1){if(!e||e.length===0)return j.Buffer.from([]);let r=b2(e),n=l2(r);if(t)return n;if(n.remainder.length!==0)throw new Error("invalid remainder");return n.data}Bn.decode=c_;function u_(e){if(!e||e.length===0)return j.Buffer.from([]);let t=b2(e),r=t[0];if(r<=127)return t.length;if(r<=183)return r-127;if(r<=191)return r-182;if(r<=247)return r-191;{let n=r-246,i=h2(t.slice(1,n).toString("hex"),16);return n+i}}Bn.getLength=u_;function l2(e){let t,r,n,i,s,o=[],a=e[0];if(a<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(a<=183){if(t=a-127,a===128?n=j.Buffer.from([]):n=e.slice(1,t),t===2&&n[0]<128)throw new Error("invalid rlp encoding: byte must be less 0x80");return{data:n,remainder:e.slice(t)}}else if(a<=191){if(r=a-182,e.length-1<r)throw new Error("invalid RLP: not enough bytes for string length");if(t=h2(e.slice(1,r).toString("hex"),16),t<=55)throw new Error("invalid RLP: expected string length to be greater than 55");if(n=e.slice(r,t+r),n.length<t)throw new Error("invalid RLP: not enough bytes for string");return{data:n,remainder:e.slice(t+r)}}else if(a<=247){for(t=a-191,i=e.slice(1,t);i.length;)s=l2(i),o.push(s.data),i=s.remainder;return{data:o,remainder:e.slice(t)}}else{r=a-246,t=h2(e.slice(1,r).toString("hex"),16);let f=r+t;if(f>e.length)throw new Error("invalid rlp: total length is larger than the data");if(i=e.slice(r,f),i.length===0)throw new Error("invalid rlp, List has a invalid length");for(;i.length;)s=l2(i),o.push(s.data),i=s.remainder;return{data:o,remainder:e.slice(f)}}}function v2(e){return e.slice(0,2)==="0x"}Bn.isHexPrefixed=v2;function i3(e){return v2(e)?e.slice(2):e}Bn.stripHexPrefix=i3;function p2(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");let t=e.toString(16);return t.length%2?`0${t}`:t}function d_(e){return e.length%2?`0${e}`:e}function h_(e){let t=p2(e);return j.Buffer.from(t,"hex")}function b2(e){if(!j.Buffer.isBuffer(e)){if(typeof e=="string")return v2(e)?j.Buffer.from(d_(i3(e)),"hex"):j.Buffer.from(e);if(typeof e=="number"||typeof e=="bigint")return e?h_(e):j.Buffer.from([]);if(e==null)return j.Buffer.from([]);if(e instanceof Uint8Array)return j.Buffer.from(e);if(f_.default.isBN(e))return j.Buffer.from(e.toArray());throw new Error("invalid type")}return e}});var a3=U(Co=>{"use strict";H();k();Object.defineProperty(Co,"__esModule",{value:!0});Co.validateHexString=Co.isHexString=void 0;function l_(e,t){return e.match(/^0x[0-9A-Fa-f]*$/)?!(t&&e.length!==2+2*t):!1}Co.isHexString=l_;function p_(e){if(!e)return!1;let t=e.toLowerCase().startsWith("0x")?e.substring(2).toLowerCase():e.toLowerCase();return!(t.length===0||t.length%2!==0||!t.match(/^[0-9A-Fa-f]*$/))}Co.validateHexString=p_});var o3=U(qu=>{"use strict";H();k();Object.defineProperty(qu,"__esModule",{value:!0});qu.encode=void 0;function v_(e){var t="0123456789abcdef";function r(F){var O,q="";for(O=0;O<=3;O++)q+=t.charAt(F>>O*8+4&15)+t.charAt(F>>O*8&15);return q}function n(F,O){var q=(F&65535)+(O&65535),P=(F>>16)+(O>>16)+(q>>16);return P<<16|q&65535}function i(F,O){return F<<O|F>>>32-O}function s(F,O,q,P,D,A){return n(i(n(n(O,F),n(P,A)),D),q)}function o(F,O,q,P,D,A,c){return s(O&q|~O&P,F,O,D,A,c)}function a(F,O,q,P,D,A,c){return s(O&P|q&~P,F,O,D,A,c)}function f(F,O,q,P,D,A,c){return s(O^q^P,F,O,D,A,c)}function l(F,O,q,P,D,A,c){return s(q^(O|~P),F,O,D,A,c)}function v(F){var O,q=(F.length+8>>6)+1,P=new Array(q*16);for(O=0;O<q*16;O++)P[O]=0;for(O=0;O<F.length;O++)P[O>>2]|=F.charCodeAt(O)<<O%4*8;return P[O>>2]|=128<<O%4*8,P[q*16-2]=F.length*8,P}var p,u=v(""+e),h=1732584193,b=-271733879,d=-1732584194,y=271733878,w,_,I,N;for(p=0;p<u.length;p+=16)w=h,_=b,I=d,N=y,h=o(h,b,d,y,u[p+0],7,-680876936),y=o(y,h,b,d,u[p+1],12,-389564586),d=o(d,y,h,b,u[p+2],17,606105819),b=o(b,d,y,h,u[p+3],22,-1044525330),h=o(h,b,d,y,u[p+4],7,-176418897),y=o(y,h,b,d,u[p+5],12,1200080426),d=o(d,y,h,b,u[p+6],17,-1473231341),b=o(b,d,y,h,u[p+7],22,-45705983),h=o(h,b,d,y,u[p+8],7,1770035416),y=o(y,h,b,d,u[p+9],12,-1958414417),d=o(d,y,h,b,u[p+10],17,-42063),b=o(b,d,y,h,u[p+11],22,-1990404162),h=o(h,b,d,y,u[p+12],7,1804603682),y=o(y,h,b,d,u[p+13],12,-40341101),d=o(d,y,h,b,u[p+14],17,-1502002290),b=o(b,d,y,h,u[p+15],22,1236535329),h=a(h,b,d,y,u[p+1],5,-165796510),y=a(y,h,b,d,u[p+6],9,-1069501632),d=a(d,y,h,b,u[p+11],14,643717713),b=a(b,d,y,h,u[p+0],20,-373897302),h=a(h,b,d,y,u[p+5],5,-701558691),y=a(y,h,b,d,u[p+10],9,38016083),d=a(d,y,h,b,u[p+15],14,-660478335),b=a(b,d,y,h,u[p+4],20,-405537848),h=a(h,b,d,y,u[p+9],5,568446438),y=a(y,h,b,d,u[p+14],9,-1019803690),d=a(d,y,h,b,u[p+3],14,-187363961),b=a(b,d,y,h,u[p+8],20,1163531501),h=a(h,b,d,y,u[p+13],5,-1444681467),y=a(y,h,b,d,u[p+2],9,-51403784),d=a(d,y,h,b,u[p+7],14,1735328473),b=a(b,d,y,h,u[p+12],20,-1926607734),h=f(h,b,d,y,u[p+5],4,-378558),y=f(y,h,b,d,u[p+8],11,-2022574463),d=f(d,y,h,b,u[p+11],16,1839030562),b=f(b,d,y,h,u[p+14],23,-35309556),h=f(h,b,d,y,u[p+1],4,-1530992060),y=f(y,h,b,d,u[p+4],11,1272893353),d=f(d,y,h,b,u[p+7],16,-155497632),b=f(b,d,y,h,u[p+10],23,-1094730640),h=f(h,b,d,y,u[p+13],4,681279174),y=f(y,h,b,d,u[p+0],11,-358537222),d=f(d,y,h,b,u[p+3],16,-722521979),b=f(b,d,y,h,u[p+6],23,76029189),h=f(h,b,d,y,u[p+9],4,-640364487),y=f(y,h,b,d,u[p+12],11,-421815835),d=f(d,y,h,b,u[p+15],16,530742520),b=f(b,d,y,h,u[p+2],23,-995338651),h=l(h,b,d,y,u[p+0],6,-198630844),y=l(y,h,b,d,u[p+7],10,1126891415),d=l(d,y,h,b,u[p+14],15,-1416354905),b=l(b,d,y,h,u[p+5],21,-57434055),h=l(h,b,d,y,u[p+12],6,1700485571),y=l(y,h,b,d,u[p+3],10,-1894986606),d=l(d,y,h,b,u[p+10],15,-1051523),b=l(b,d,y,h,u[p+1],21,-2054922799),h=l(h,b,d,y,u[p+8],6,1873313359),y=l(y,h,b,d,u[p+15],10,-30611744),d=l(d,y,h,b,u[p+6],15,-1560198380),b=l(b,d,y,h,u[p+13],21,1309151649),h=l(h,b,d,y,u[p+4],6,-145523070),y=l(y,h,b,d,u[p+11],10,-1120210379),d=l(d,y,h,b,u[p+2],15,718787259),b=l(b,d,y,h,u[p+9],21,-343485551),h=n(h,w),b=n(b,_),d=n(d,I),y=n(y,N);return r(h)+r(b)+r(d)+r(y)}qu.encode=v_});var y2=U(It=>{"use strict";H();k();var b_=It&&It.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),g_=It&&It.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c3=It&&It.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&b_(t,e,r);return g_(t,e),t};Object.defineProperty(It,"__esModule",{value:!0});It.blake2s=It.compress=It.IV=void 0;var y_=c3(xo()),f3=c3(Nu()),zi=$r();It.IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);function ra(e,t,r,n,i){return e=e+t+i|0,n=(0,zi.rotr)(n^e,16),r=r+n|0,t=(0,zi.rotr)(t^r,12),{a:e,b:t,c:r,d:n}}function na(e,t,r,n,i){return e=e+t+i|0,n=(0,zi.rotr)(n^e,8),r=r+n|0,t=(0,zi.rotr)(t^r,7),{a:e,b:t,c:r,d:n}}function u3(e,t,r,n,i,s,o,a,f,l,v,p,u,h,b,d,y,w,_,I){let N=0;for(let F=0;F<n;F++)({a:i,b:f,c:u,d:y}=ra(i,f,u,y,r[t+e[N++]])),{a:i,b:f,c:u,d:y}=na(i,f,u,y,r[t+e[N++]]),{a:s,b:l,c:h,d:w}=ra(s,l,h,w,r[t+e[N++]]),{a:s,b:l,c:h,d:w}=na(s,l,h,w,r[t+e[N++]]),{a:o,b:v,c:b,d:_}=ra(o,v,b,_,r[t+e[N++]]),{a:o,b:v,c:b,d:_}=na(o,v,b,_,r[t+e[N++]]),{a,b:p,c:d,d:I}=ra(a,p,d,I,r[t+e[N++]]),{a,b:p,c:d,d:I}=na(a,p,d,I,r[t+e[N++]]),{a:i,b:l,c:b,d:I}=ra(i,l,b,I,r[t+e[N++]]),{a:i,b:l,c:b,d:I}=na(i,l,b,I,r[t+e[N++]]),{a:s,b:v,c:d,d:y}=ra(s,v,d,y,r[t+e[N++]]),{a:s,b:v,c:d,d:y}=na(s,v,d,y,r[t+e[N++]]),{a:o,b:p,c:u,d:w}=ra(o,p,u,w,r[t+e[N++]]),{a:o,b:p,c:u,d:w}=na(o,p,u,w,r[t+e[N++]]),{a,b:f,c:h,d:_}=ra(a,f,h,_,r[t+e[N++]]),{a,b:f,c:h,d:_}=na(a,f,h,_,r[t+e[N++]]);return{v0:i,v1:s,v2:o,v3:a,v4:f,v5:l,v6:v,v7:p,v8:u,v9:h,v10:b,v11:d,v12:y,v13:w,v14:_,v15:I}}It.compress=u3;var g2=class extends f3.BLAKE2{constructor(t={}){super(64,t.dkLen===void 0?32:t.dkLen,t,32,8,8),this.v0=It.IV[0]|0,this.v1=It.IV[1]|0,this.v2=It.IV[2]|0,this.v3=It.IV[3]|0,this.v4=It.IV[4]|0,this.v5=It.IV[5]|0,this.v6=It.IV[6]|0,this.v7=It.IV[7]|0;let r=t.key?t.key.length:0;if(this.v0^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,zi.u32)((0,zi.toBytes)(t.salt));this.v4^=n[0],this.v5^=n[1]}if(t.personalization){let n=(0,zi.u32)((0,zi.toBytes)(t.personalization));this.v6^=n[0],this.v7^=n[1]}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,zi.toBytes)(t.key)),this.update(n)}}get(){let{v0:t,v1:r,v2:n,v3:i,v4:s,v5:o,v6:a,v7:f}=this;return[t,r,n,i,s,o,a,f]}set(t,r,n,i,s,o,a,f){this.v0=t|0,this.v1=r|0,this.v2=n|0,this.v3=i|0,this.v4=s|0,this.v5=o|0,this.v6=a|0,this.v7=f|0}compress(t,r,n){let{h:i,l:s}=y_.fromBig(BigInt(this.length)),{v0:o,v1:a,v2:f,v3:l,v4:v,v5:p,v6:u,v7:h,v8:b,v9:d,v10:y,v11:w,v12:_,v13:I,v14:N,v15:F}=u3(f3.SIGMA,r,t,10,this.v0,this.v1,this.v2,this.v3,this.v4,this.v5,this.v6,this.v7,It.IV[0],It.IV[1],It.IV[2],It.IV[3],s^It.IV[4],i^It.IV[5],n?~It.IV[6]:It.IV[6],It.IV[7]);this.v0^=o^b,this.v1^=a^d,this.v2^=f^y,this.v3^=l^w,this.v4^=v^_,this.v5^=p^I,this.v6^=u^N,this.v7^=h^F}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0)}};It.blake2s=(0,zi.wrapConstructorWithOpts)(e=>new g2(e))});var Hu=U(Fo=>{"use strict";H();k();Object.defineProperty(Fo,"__esModule",{value:!0});Fo.pbkdf2Async=Fo.pbkdf2=void 0;var x_=nc(),Wi=$r();function d3(e,t,r,n){(0,Wi.assertHash)(e);let i=(0,Wi.checkOpts)({dkLen:32,asyncTick:10},n),{c:s,dkLen:o,asyncTick:a}=i;if((0,Wi.assertNumber)(s),(0,Wi.assertNumber)(o),(0,Wi.assertNumber)(a),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let f=(0,Wi.toBytes)(t),l=(0,Wi.toBytes)(r),v=new Uint8Array(o),p=x_.hmac.create(e,f),u=p._cloneInto().update(l);return{c:s,dkLen:o,asyncTick:a,DK:v,PRF:p,PRFSalt:u}}function h3(e,t,r,n,i){return e.destroy(),t.destroy(),n&&n.destroy(),i.fill(0),r}function m_(e,t,r,n){let{c:i,dkLen:s,DK:o,PRF:a,PRFSalt:f}=d3(e,t,r,n),l,v=new Uint8Array(4),p=(0,Wi.createView)(v),u=new Uint8Array(a.outputLen);for(let h=1,b=0;b<s;h++,b+=a.outputLen){let d=o.subarray(b,b+a.outputLen);p.setInt32(0,h,!1),(l=f._cloneInto(l)).update(v).digestInto(u),d.set(u.subarray(0,d.length));for(let y=1;y<i;y++){a._cloneInto(l).update(u).digestInto(u);for(let w=0;w<d.length;w++)d[w]^=u[w]}}return h3(a,f,o,l,u)}Fo.pbkdf2=m_;async function w_(e,t,r,n){let{c:i,dkLen:s,asyncTick:o,DK:a,PRF:f,PRFSalt:l}=d3(e,t,r,n),v,p=new Uint8Array(4),u=(0,Wi.createView)(p),h=new Uint8Array(f.outputLen);for(let b=1,d=0;d<s;b++,d+=f.outputLen){let y=a.subarray(d,d+f.outputLen);u.setInt32(0,b,!1),(v=l._cloneInto(v)).update(p).digestInto(h),y.set(h.subarray(0,y.length)),await(0,Wi.asyncLoop)(i-1,o,w=>{f._cloneInto(v).update(h).digestInto(h);for(let _=0;_<y.length;_++)y[_]^=h[_]})}return h3(f,l,a,v,h)}Fo.pbkdf2Async=w_});var y3=U(Ro=>{"use strict";H();k();Object.defineProperty(Ro,"__esModule",{value:!0});Ro.scryptAsync=Ro.scrypt=void 0;var p3=yo(),v3=Hu(),Hn=$r(),wt=(e,t)=>e<<t|e>>>32-t;function l3(e,t,r,n,i,s){let o=e[t++]^r[n++],a=e[t++]^r[n++],f=e[t++]^r[n++],l=e[t++]^r[n++],v=e[t++]^r[n++],p=e[t++]^r[n++],u=e[t++]^r[n++],h=e[t++]^r[n++],b=e[t++]^r[n++],d=e[t++]^r[n++],y=e[t++]^r[n++],w=e[t++]^r[n++],_=e[t++]^r[n++],I=e[t++]^r[n++],N=e[t++]^r[n++],F=e[t++]^r[n++],O=o,q=a,P=f,D=l,A=v,c=p,m=u,S=h,g=b,E=d,M=y,T=w,R=_,x=I,C=N,K=F;for(let L=0;L<8;L+=2)A^=wt(O+R|0,7),g^=wt(A+O|0,9),R^=wt(g+A|0,13),O^=wt(R+g|0,18),E^=wt(c+q|0,7),x^=wt(E+c|0,9),q^=wt(x+E|0,13),c^=wt(q+x|0,18),C^=wt(M+m|0,7),P^=wt(C+M|0,9),m^=wt(P+C|0,13),M^=wt(m+P|0,18),D^=wt(K+T|0,7),S^=wt(D+K|0,9),T^=wt(S+D|0,13),K^=wt(T+S|0,18),q^=wt(O+D|0,7),P^=wt(q+O|0,9),D^=wt(P+q|0,13),O^=wt(D+P|0,18),m^=wt(c+A|0,7),S^=wt(m+c|0,9),A^=wt(S+m|0,13),c^=wt(A+S|0,18),T^=wt(M+E|0,7),g^=wt(T+M|0,9),E^=wt(g+T|0,13),M^=wt(E+g|0,18),R^=wt(K+C|0,7),x^=wt(R+K|0,9),C^=wt(x+R|0,13),K^=wt(C+x|0,18);i[s++]=o+O|0,i[s++]=a+q|0,i[s++]=f+P|0,i[s++]=l+D|0,i[s++]=v+A|0,i[s++]=p+c|0,i[s++]=u+m|0,i[s++]=h+S|0,i[s++]=b+g|0,i[s++]=d+E|0,i[s++]=y+M|0,i[s++]=w+T|0,i[s++]=_+R|0,i[s++]=I+x|0,i[s++]=N+C|0,i[s++]=F+K|0}function No(e,t,r,n,i){let s=n+0,o=n+16*i;for(let a=0;a<16;a++)r[o+a]=e[t+(2*i-1)*16+a];for(let a=0;a<i;a++,s+=16,t+=16)l3(r,o,e,t,r,s),a>0&&(o+=16),l3(r,s,e,t+=16,r,o)}function b3(e,t,r){let n=(0,Hn.checkOpts)({dkLen:32,asyncTick:10,maxmem:1073742848},r),{N:i,r:s,p:o,dkLen:a,asyncTick:f,maxmem:l,onProgress:v}=n;if((0,Hn.assertNumber)(i),(0,Hn.assertNumber)(s),(0,Hn.assertNumber)(o),(0,Hn.assertNumber)(a),(0,Hn.assertNumber)(f),(0,Hn.assertNumber)(l),v!==void 0&&typeof v!="function")throw new Error("progressCb should be function");let p=128*s,u=p/4;if(i<=1||(i&i-1)!==0||i>=2**(p/8)||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(o<0||o>(2**32-1)*32/p)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(a<0||a>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");let h=p*(i+o);if(h>l)throw new Error(`Scrypt: parameters too large, ${h} (128 * r * (N + p)) > ${l} (maxmem)`);let b=(0,v3.pbkdf2)(p3.sha256,e,t,{c:1,dkLen:p*o}),d=(0,Hn.u32)(b),y=(0,Hn.u32)(new Uint8Array(p*i)),w=(0,Hn.u32)(new Uint8Array(p)),_=()=>{};if(v){let I=2*i*o,N=Math.max(Math.floor(I/1e4),1),F=0;_=()=>{F++,v&&(!(F%N)||F===I)&&v(F/I)}}return{N:i,r:s,p:o,dkLen:a,blockSize32:u,V:y,B32:d,B:b,tmp:w,blockMixCb:_,asyncTick:f}}function g3(e,t,r,n,i){let s=(0,v3.pbkdf2)(p3.sha256,e,r,{c:1,dkLen:t});return r.fill(0),n.fill(0),i.fill(0),s}function S_(e,t,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:a,V:f,B32:l,B:v,tmp:p,blockMixCb:u}=b3(e,t,r);for(let h=0;h<s;h++){let b=a*h;for(let d=0;d<a;d++)f[d]=l[b+d];for(let d=0,y=0;d<n-1;d++)No(f,y,f,y+=a,i),u();No(f,(n-1)*a,l,b,i),u();for(let d=0;d<n;d++){let y=l[b+a-16]%n;for(let w=0;w<a;w++)p[w]=l[b+w]^f[y*a+w];No(p,0,l,b,i),u()}}return g3(e,o,v,f,p)}Ro.scrypt=S_;async function E_(e,t,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:a,V:f,B32:l,B:v,tmp:p,blockMixCb:u,asyncTick:h}=b3(e,t,r);for(let b=0;b<s;b++){let d=a*b;for(let w=0;w<a;w++)f[w]=l[d+w];let y=0;await(0,Hn.asyncLoop)(n-1,h,w=>{No(f,y,f,y+=a,i),u()}),No(f,(n-1)*a,l,d,i),u(),await(0,Hn.asyncLoop)(n,h,w=>{let _=l[d+a-16]%n;for(let I=0;I<a;I++)p[I]=l[d+I]^f[_*a+I];No(p,0,l,d,i),u()})}return g3(e,o,v,f,p)}Ro.scryptAsync=E_});var w3=U($i=>{"use strict";H();k();var __=$i&&$i.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),A_=$i&&$i.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),x2=$i&&$i.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&__(t,e,r);return A_(t,e),t};Object.defineProperty($i,"__esModule",{value:!0});$i.blake3=void 0;var x3=x2(xo()),B_=x2(Nu()),Si=x2(y2()),m0=$r(),kn;(function(e){e[e.CHUNK_START=1]="CHUNK_START",e[e.CHUNK_END=2]="CHUNK_END",e[e.PARENT=4]="PARENT",e[e.ROOT=8]="ROOT",e[e.KEYED_HASH=16]="KEYED_HASH",e[e.DERIVE_KEY_CONTEXT=32]="DERIVE_KEY_CONTEXT",e[e.DERIVE_KEY_MATERIAL=64]="DERIVE_KEY_MATERIAL"})(kn||(kn={}));var m3=(()=>{let e=Array.from({length:16},(n,i)=>i),t=n=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(i=>n[i]),r=[];for(let n=0,i=e;n<7;n++,i=t(i))r.push(...i);return Uint8Array.from(r)})(),ic=class extends B_.BLAKE2{constructor(t={},r=0){if(super(64,t.dkLen===void 0?32:t.dkLen,{},Number.MAX_SAFE_INTEGER,0,0),this.flags=0,this.chunkPos=0,this.chunksDone=0,this.stack=[],this.posOut=0,this.bufferOut32=new Uint32Array(16),this.chunkOut=0,this.enableXOF=!0,this.outputLen=t.dkLen===void 0?32:t.dkLen,(0,m0.assertNumber)(this.outputLen),t.key!==void 0&&t.context!==void 0)throw new Error("Blake3: only key or context can be specified at same time");if(t.key!==void 0){let n=(0,m0.toBytes)(t.key);if(n.length!==32)throw new Error("Blake3: key should be 32 byte");this.IV=(0,m0.u32)(n),this.flags=r|kn.KEYED_HASH}else if(t.context!==void 0){let n=new ic({dkLen:32},kn.DERIVE_KEY_CONTEXT).update(t.context).digest();this.IV=(0,m0.u32)(n),this.flags=r|kn.DERIVE_KEY_MATERIAL}else this.IV=Si.IV.slice(),this.flags=r;this.state=this.IV.slice(),this.bufferOut=(0,m0.u8)(this.bufferOut32)}get(){return[]}set(){}b2Compress(t,r,n,i=0){let{state:s,pos:o}=this,{h:a,l:f}=x3.fromBig(BigInt(t),!0),{v0:l,v1:v,v2:p,v3:u,v4:h,v5:b,v6:d,v7:y,v8:w,v9:_,v10:I,v11:N,v12:F,v13:O,v14:q,v15:P}=Si.compress(m3,i,n,7,s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],Si.IV[0],Si.IV[1],Si.IV[2],Si.IV[3],a,f,o,r);s[0]=l^w,s[1]=v^_,s[2]=p^I,s[3]=u^N,s[4]=h^F,s[5]=b^O,s[6]=d^q,s[7]=y^P}compress(t,r=0,n=!1){let i=this.flags;if(this.chunkPos||(i|=kn.CHUNK_START),(this.chunkPos===15||n)&&(i|=kn.CHUNK_END),n||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,i,t,r),this.chunkPos+=1,this.chunkPos===16||n){let s=this.state;this.state=this.IV.slice();for(let o,a=this.chunksDone+1;(n||!(a&1))&&(o=this.stack.pop());a>>=1)this.buffer32.set(o,0),this.buffer32.set(s,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|kn.PARENT,this.buffer32,0),s=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(s)}this.pos=0}_cloneInto(t){t=super._cloneInto(t);let{IV:r,flags:n,state:i,chunkPos:s,posOut:o,chunkOut:a,stack:f,chunksDone:l}=this;return t.state.set(i.slice()),t.stack=f.map(v=>Uint32Array.from(v)),t.IV.set(r),t.flags=n,t.chunkPos=s,t.chunksDone=l,t.posOut=o,t.chunkOut=a,t.enableXOF=this.enableXOF,t.bufferOut32.set(this.bufferOut32),t}destroy(){this.destroyed=!0,this.state.fill(0),this.buffer32.fill(0),this.IV.fill(0),this.bufferOut32.fill(0);for(let t of this.stack)t.fill(0)}b2CompressOut(){let{state:t,pos:r,flags:n,buffer32:i,bufferOut32:s}=this,{h:o,l:a}=x3.fromBig(BigInt(this.chunkOut++)),{v0:f,v1:l,v2:v,v3:p,v4:u,v5:h,v6:b,v7:d,v8:y,v9:w,v10:_,v11:I,v12:N,v13:F,v14:O,v15:q}=Si.compress(m3,0,i,7,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],Si.IV[0],Si.IV[1],Si.IV[2],Si.IV[3],a,o,r,n);s[0]=f^y,s[1]=l^w,s[2]=v^_,s[3]=p^I,s[4]=u^N,s[5]=h^F,s[6]=b^O,s[7]=d^q,s[8]=t[0]^y,s[9]=t[1]^w,s[10]=t[2]^_,s[11]=t[3]^I,s[12]=t[4]^N,s[13]=t[5]^F,s[14]=t[6]^O,s[15]=t[7]^q,this.posOut=0}finish(){if(this.finished)return;this.finished=!0,this.buffer.fill(0,this.pos);let t=this.flags|kn.ROOT;this.stack.length?(t|=kn.PARENT,this.compress(this.buffer32,0,!0),this.chunksDone=0,this.pos=this.blockLen):t|=(this.chunkPos?0:kn.CHUNK_START)|kn.CHUNK_END,this.flags=t,this.b2CompressOut()}writeInto(t){if(this.destroyed)throw new Error("instance is destroyed");if(!(t instanceof Uint8Array))throw new Error("Blake3: Invalid output buffer");this.finish();let{blockLen:r,bufferOut:n}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.b2CompressOut();let o=Math.min(this.blockLen-this.posOut,s-i);t.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF impossible after digest call");return this.writeInto(t)}xof(t){return(0,m0.assertNumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(t.length<this.outputLen)throw new Error("Blake3: Invalid output buffer");if(this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}};$i.blake3=(0,m0.wrapConstructorWithOpts)(e=>new ic(e))});var w0=U(Ye=>{"use strict";H();k();var S3=Ye&&Ye.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),P_=Ye&&Ye.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),rr=Ye&&Ye.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&S3(t,e,r)},m2=Ye&&Ye.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&S3(t,e,r);return P_(t,e),t};Object.defineProperty(Ye,"__esModule",{value:!0});Ye.randomBytes=Ye.concatBytes=Ye.reverseBuffer=Ye.md5=Ye.rlp=void 0;rr(Ag(),Ye);rr(Vg(),Ye);rr(zg(),Ye);rr(Wg(),Ye);rr(Gg(),Ye);rr(tc(),Ye);rr(Yg(),Ye);rr(Jg(),Ye);rr(e3(),Ye);rr(u2(),Ye);Ye.rlp=m2(s3());rr(a3(),Ye);Ye.md5=m2(o3());rr(zs(),Ye);rr(yo(),Ye);rr(nc(),Ye);rr(s2(),Ye);rr(Pu(),Ye);rr(Fu(),Ye);rr(f2(),Ye);rr(y2(),Ye);rr(Hu(),Ye);rr(y3(),Ye);rr(w3(),Ye);var I_=m2($r()),M_=Jb();function C_(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}Ye.reverseBuffer=C_;function F_(e,t){return I_.concatBytes(Uint8Array.from(e),Uint8Array.from(t))}Ye.concatBytes=F_;function N_(e){return M_(e)}Ye.randomBytes=N_});var On=U(E3=>{"use strict";H();k();var Ei=E3,R_=wr(),O_=eg(),ku=rg();Ei.assert=O_;Ei.toArray=ku.toArray;Ei.zero2=ku.zero2;Ei.toHex=ku.toHex;Ei.encode=ku.encode;function D_(e,t,r){var n=new Array(Math.max(e.bitLength(),r)+1);n.fill(0);for(var i=1<<t+1,s=e.clone(),o=0;o<n.length;o++){var a,f=s.andln(i-1);s.isOdd()?(f>(i>>1)-1?a=(i>>1)-f:a=f,s.isubn(a)):a=0,n[o]=a,s.iushrn(1)}return n}Ei.getNAF=D_;function T_(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n=0,i=0,s;e.cmpn(-n)>0||t.cmpn(-i)>0;){var o=e.andln(3)+n&3,a=t.andln(3)+i&3;o===3&&(o=-1),a===3&&(a=-1);var f;(o&1)===0?f=0:(s=e.andln(7)+n&7,(s===3||s===5)&&a===2?f=-o:f=o),r[0].push(f);var l;(a&1)===0?l=0:(s=t.andln(7)+i&7,(s===3||s===5)&&o===2?l=-a:l=a),r[1].push(l),2*n===f+1&&(n=1-n),2*i===l+1&&(i=1-i),e.iushrn(1),t.iushrn(1)}return r}Ei.getJSF=T_;function q_(e,t,r){var n="_"+t;e.prototype[t]=function(){return this[n]!==void 0?this[n]:this[n]=r.call(this)}}Ei.cachedProperty=q_;function H_(e){return typeof e=="string"?Ei.toArray(e,"hex"):e}Ei.parseBytes=H_;function k_(e){return new R_(e,"hex","le")}Ei.intFromLE=k_});var ac=U((YV,_3)=>{"use strict";H();k();var sc=On(),S0=wr(),ju=sc.getNAF,j_=sc.getJSF,Lu=sc.assert;function ia(e,t){this.type=e,this.p=new S0(t.p,16),this.red=t.prime?S0.red(t.prime):S0.mont(this.p),this.zero=new S0(0).toRed(this.red),this.one=new S0(1).toRed(this.red),this.two=new S0(2).toRed(this.red),this.n=t.n&&new S0(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}_3.exports=ia;ia.prototype.point=function(){throw new Error("Not implemented")};ia.prototype.validate=function(){throw new Error("Not implemented")};ia.prototype._fixedNafMul=function(t,r){Lu(t.precomputed);var n=t._getDoubles(),i=ju(r,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var o=[],a,f;for(a=0;a<i.length;a+=n.step){f=0;for(var l=a+n.step-1;l>=a;l--)f=(f<<1)+i[l];o.push(f)}for(var v=this.jpoint(null,null,null),p=this.jpoint(null,null,null),u=s;u>0;u--){for(a=0;a<o.length;a++)f=o[a],f===u?p=p.mixedAdd(n.points[a]):f===-u&&(p=p.mixedAdd(n.points[a].neg()));v=v.add(p)}return v.toP()};ia.prototype._wnafMul=function(t,r){var n=4,i=t._getNAFPoints(n);n=i.wnd;for(var s=i.points,o=ju(r,n,this._bitLength),a=this.jpoint(null,null,null),f=o.length-1;f>=0;f--){for(var l=0;f>=0&&o[f]===0;f--)l++;if(f>=0&&l++,a=a.dblp(l),f<0)break;var v=o[f];Lu(v!==0),t.type==="affine"?v>0?a=a.mixedAdd(s[v-1>>1]):a=a.mixedAdd(s[-v-1>>1].neg()):v>0?a=a.add(s[v-1>>1]):a=a.add(s[-v-1>>1].neg())}return t.type==="affine"?a.toP():a};ia.prototype._wnafMulAdd=function(t,r,n,i,s){var o=this._wnafT1,a=this._wnafT2,f=this._wnafT3,l=0,v,p,u;for(v=0;v<i;v++){u=r[v];var h=u._getNAFPoints(t);o[v]=h.wnd,a[v]=h.points}for(v=i-1;v>=1;v-=2){var b=v-1,d=v;if(o[b]!==1||o[d]!==1){f[b]=ju(n[b],o[b],this._bitLength),f[d]=ju(n[d],o[d],this._bitLength),l=Math.max(f[b].length,l),l=Math.max(f[d].length,l);continue}var y=[r[b],null,null,r[d]];r[b].y.cmp(r[d].y)===0?(y[1]=r[b].add(r[d]),y[2]=r[b].toJ().mixedAdd(r[d].neg())):r[b].y.cmp(r[d].y.redNeg())===0?(y[1]=r[b].toJ().mixedAdd(r[d]),y[2]=r[b].add(r[d].neg())):(y[1]=r[b].toJ().mixedAdd(r[d]),y[2]=r[b].toJ().mixedAdd(r[d].neg()));var w=[-3,-1,-5,-7,0,7,5,1,3],_=j_(n[b],n[d]);for(l=Math.max(_[0].length,l),f[b]=new Array(l),f[d]=new Array(l),p=0;p<l;p++){var I=_[0][p]|0,N=_[1][p]|0;f[b][p]=w[(I+1)*3+(N+1)],f[d][p]=0,a[b]=y}}var F=this.jpoint(null,null,null),O=this._wnafT4;for(v=l;v>=0;v--){for(var q=0;v>=0;){var P=!0;for(p=0;p<i;p++)O[p]=f[p][v]|0,O[p]!==0&&(P=!1);if(!P)break;q++,v--}if(v>=0&&q++,F=F.dblp(q),v<0)break;for(p=0;p<i;p++){var D=O[p];D!==0&&(D>0?u=a[p][D-1>>1]:D<0&&(u=a[p][-D-1>>1].neg()),u.type==="affine"?F=F.mixedAdd(u):F=F.add(u))}}for(v=0;v<i;v++)a[v]=null;return s?F:F.toP()};function jn(e,t){this.curve=e,this.type=t,this.precomputed=null}ia.BasePoint=jn;jn.prototype.eq=function(){throw new Error("Not implemented")};jn.prototype.validate=function(){return this.curve.validate(this)};ia.prototype.decodePoint=function(t,r){t=sc.toArray(t,r);var n=this.p.byteLength();if((t[0]===4||t[0]===6||t[0]===7)&&t.length-1===2*n){t[0]===6?Lu(t[t.length-1]%2===0):t[0]===7&&Lu(t[t.length-1]%2===1);var i=this.point(t.slice(1,1+n),t.slice(1+n,1+2*n));return i}else if((t[0]===2||t[0]===3)&&t.length-1===n)return this.pointFromX(t.slice(1,1+n),t[0]===3);throw new Error("Unknown point format")};jn.prototype.encodeCompressed=function(t){return this.encode(t,!0)};jn.prototype._encode=function(t){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return t?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))};jn.prototype.encode=function(t,r){return sc.encode(this._encode(r),t)};jn.prototype.precompute=function(t){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,t),r.beta=this._getBeta(),this.precomputed=r,this};jn.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((t.bitLength()+1)/r.step):!1};jn.prototype._getDoubles=function(t,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<r;s+=t){for(var o=0;o<t;o++)i=i.dbl();n.push(i)}return{step:t,points:n}};jn.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<t)-1,i=n===1?null:this.dbl(),s=1;s<n;s++)r[s]=r[s-1].add(i);return{wnd:t,points:r}};jn.prototype._getBeta=function(){return null};jn.prototype.dblp=function(t){for(var r=this,n=0;n<t;n++)r=r.dbl();return r}});var B3=U((ez,A3)=>{"use strict";H();k();var L_=On(),nr=wr(),w2=bo(),Oo=ac(),K_=L_.assert;function Ln(e){Oo.call(this,"short",e),this.a=new nr(e.a,16).toRed(this.red),this.b=new nr(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}w2(Ln,Oo);A3.exports=Ln;Ln.prototype._getEndomorphism=function(t){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(t.beta)r=new nr(t.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(t.lambda)n=new nr(t.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?n=s[0]:(n=s[1],K_(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var o;return t.basis?o=t.basis.map(function(a){return{a:new nr(a.a,16),b:new nr(a.b,16)}}):o=this._getEndoBasis(n),{beta:r,lambda:n,basis:o}}};Ln.prototype._getEndoRoots=function(t){var r=t===this.p?this.red:nr.mont(t),n=new nr(2).toRed(r).redInvm(),i=n.redNeg(),s=new nr(3).toRed(r).redNeg().redSqrt().redMul(n),o=i.redAdd(s).fromRed(),a=i.redSub(s).fromRed();return[o,a]};Ln.prototype._getEndoBasis=function(t){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=t,i=this.n.clone(),s=new nr(1),o=new nr(0),a=new nr(0),f=new nr(1),l,v,p,u,h,b,d,y=0,w,_;n.cmpn(0)!==0;){var I=i.div(n);w=i.sub(I.mul(n)),_=a.sub(I.mul(s));var N=f.sub(I.mul(o));if(!p&&w.cmp(r)<0)l=d.neg(),v=s,p=w.neg(),u=_;else if(p&&++y===2)break;d=w,i=n,n=w,a=s,s=_,f=o,o=N}h=w.neg(),b=_;var F=p.sqr().add(u.sqr()),O=h.sqr().add(b.sqr());return O.cmp(F)>=0&&(h=l,b=v),p.negative&&(p=p.neg(),u=u.neg()),h.negative&&(h=h.neg(),b=b.neg()),[{a:p,b:u},{a:h,b}]};Ln.prototype._endoSplit=function(t){var r=this.endo.basis,n=r[0],i=r[1],s=i.b.mul(t).divRound(this.n),o=n.b.neg().mul(t).divRound(this.n),a=s.mul(n.a),f=o.mul(i.a),l=s.mul(n.b),v=o.mul(i.b),p=t.sub(a).sub(f),u=l.add(v).neg();return{k1:p,k2:u}};Ln.prototype.pointFromX=function(t,r){t=new nr(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(r&&!s||!r&&s)&&(i=i.redNeg()),this.point(t,i)};Ln.prototype.validate=function(t){if(t.inf)return!0;var r=t.x,n=t.y,i=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0};Ln.prototype._endoWnafMulAdd=function(t,r,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,o=0;o<t.length;o++){var a=this._endoSplit(r[o]),f=t[o],l=f._getBeta();a.k1.negative&&(a.k1.ineg(),f=f.neg(!0)),a.k2.negative&&(a.k2.ineg(),l=l.neg(!0)),i[o*2]=f,i[o*2+1]=l,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var v=this._wnafMulAdd(1,i,s,o*2,n),p=0;p<o*2;p++)i[p]=null,s[p]=null;return v};function Fr(e,t,r,n){Oo.BasePoint.call(this,e,"affine"),t===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new nr(t,16),this.y=new nr(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}w2(Fr,Oo.BasePoint);Ln.prototype.point=function(t,r,n){return new Fr(this,t,r,n)};Ln.prototype.pointFromJSON=function(t,r){return Fr.fromJSON(this,t,r)};Fr.prototype._getBeta=function(){if(!!this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var n=this.curve,i=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};t.beta=r,r.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return r}};Fr.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Fr.fromJSON=function(t,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=t.point(r[0],r[1],n);if(!r[2])return i;function s(a){return t.point(a[0],a[1],n)}var o=r[2];return i.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[i].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[i].concat(o.naf.points.map(s))}},i};Fr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Fr.prototype.isInfinity=function(){return this.inf};Fr.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(this.x.cmp(t.x)===0)return this.curve.point(null,null);var r=this.y.redSub(t.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(t.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(t.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};Fr.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(t.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=t.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};Fr.prototype.getX=function(){return this.x.fromRed()};Fr.prototype.getY=function(){return this.y.fromRed()};Fr.prototype.mul=function(t){return t=new nr(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)};Fr.prototype.mulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)};Fr.prototype.jmulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)};Fr.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||this.x.cmp(t.x)===0&&this.y.cmp(t.y)===0)};Fr.prototype.neg=function(t){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var n=this.precomputed,i=function(s){return s.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r};Fr.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var t=this.curve.jpoint(this.x,this.y,this.curve.one);return t};function Gr(e,t,r,n){Oo.BasePoint.call(this,e,"jacobian"),t===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new nr(0)):(this.x=new nr(t,16),this.y=new nr(r,16),this.z=new nr(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}w2(Gr,Oo.BasePoint);Ln.prototype.jpoint=function(t,r,n){return new Gr(this,t,r,n)};Gr.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),r=t.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(t);return this.curve.point(n,i)};Gr.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Gr.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var r=t.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),s=t.x.redMul(n),o=this.y.redMul(r.redMul(t.z)),a=t.y.redMul(n.redMul(this.z)),f=i.redSub(s),l=o.redSub(a);if(f.cmpn(0)===0)return l.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var v=f.redSqr(),p=v.redMul(f),u=i.redMul(v),h=l.redSqr().redIAdd(p).redISub(u).redISub(u),b=l.redMul(u.redISub(h)).redISub(o.redMul(p)),d=this.z.redMul(t.z).redMul(f);return this.curve.jpoint(h,b,d)};Gr.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=t.x.redMul(r),s=this.y,o=t.y.redMul(r).redMul(this.z),a=n.redSub(i),f=s.redSub(o);if(a.cmpn(0)===0)return f.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=a.redSqr(),v=l.redMul(a),p=n.redMul(l),u=f.redSqr().redIAdd(v).redISub(p).redISub(p),h=f.redMul(p.redISub(u)).redISub(s.redMul(v)),b=this.z.redMul(a);return this.curve.jpoint(u,h,b)};Gr.prototype.dblp=function(t){if(t===0)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<t;r++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,f=this.z,l=f.redSqr().redSqr(),v=a.redAdd(a);for(r=0;r<t;r++){var p=o.redSqr(),u=v.redSqr(),h=u.redSqr(),b=p.redAdd(p).redIAdd(p).redIAdd(i.redMul(l)),d=o.redMul(u),y=b.redSqr().redISub(d.redAdd(d)),w=d.redISub(y),_=b.redMul(w);_=_.redIAdd(_).redISub(h);var I=v.redMul(f);r+1<t&&(l=l.redMul(h)),o=y,f=I,v=_}return this.curve.jpoint(o,v.redMul(s),f)};Gr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Gr.prototype._zeroDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var f=i.redAdd(i).redIAdd(i),l=f.redSqr().redISub(a).redISub(a),v=o.redIAdd(o);v=v.redIAdd(v),v=v.redIAdd(v),t=l,r=f.redMul(a.redISub(l)).redISub(v),n=this.y.redAdd(this.y)}else{var p=this.x.redSqr(),u=this.y.redSqr(),h=u.redSqr(),b=this.x.redAdd(u).redSqr().redISub(p).redISub(h);b=b.redIAdd(b);var d=p.redAdd(p).redIAdd(p),y=d.redSqr(),w=h.redIAdd(h);w=w.redIAdd(w),w=w.redIAdd(w),t=y.redISub(b).redISub(b),r=d.redMul(b.redISub(t)).redISub(w),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(t,r,n)};Gr.prototype._threeDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var f=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),l=f.redSqr().redISub(a).redISub(a);t=l;var v=o.redIAdd(o);v=v.redIAdd(v),v=v.redIAdd(v),r=f.redMul(a.redISub(l)).redISub(v),n=this.y.redAdd(this.y)}else{var p=this.z.redSqr(),u=this.y.redSqr(),h=this.x.redMul(u),b=this.x.redSub(p).redMul(this.x.redAdd(p));b=b.redAdd(b).redIAdd(b);var d=h.redIAdd(h);d=d.redIAdd(d);var y=d.redAdd(d);t=b.redSqr().redISub(y),n=this.y.redAdd(this.z).redSqr().redISub(u).redISub(p);var w=u.redSqr();w=w.redIAdd(w),w=w.redIAdd(w),w=w.redIAdd(w),r=b.redMul(d.redISub(t)).redISub(w)}return this.curve.jpoint(t,r,n)};Gr.prototype._dbl=function(){var t=this.curve.a,r=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),o=r.redSqr(),a=n.redSqr(),f=o.redAdd(o).redIAdd(o).redIAdd(t.redMul(s)),l=r.redAdd(r);l=l.redIAdd(l);var v=l.redMul(a),p=f.redSqr().redISub(v.redAdd(v)),u=v.redISub(p),h=a.redSqr();h=h.redIAdd(h),h=h.redIAdd(h),h=h.redIAdd(h);var b=f.redMul(u).redISub(h),d=n.redAdd(n).redMul(i);return this.curve.jpoint(p,b,d)};Gr.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),s=t.redAdd(t).redIAdd(t),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(t).redISub(i);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var f=a.redSqr(),l=i.redIAdd(i);l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var v=s.redIAdd(a).redSqr().redISub(o).redISub(f).redISub(l),p=r.redMul(v);p=p.redIAdd(p),p=p.redIAdd(p);var u=this.x.redMul(f).redISub(p);u=u.redIAdd(u),u=u.redIAdd(u);var h=this.y.redMul(v.redMul(l.redISub(v)).redISub(a.redMul(f)));h=h.redIAdd(h),h=h.redIAdd(h),h=h.redIAdd(h);var b=this.z.redAdd(a).redSqr().redISub(n).redISub(f);return this.curve.jpoint(u,h,b)};Gr.prototype.mul=function(t,r){return t=new nr(t,r),this.curve._wnafMul(this,t)};Gr.prototype.eq=function(t){if(t.type==="affine")return this.eq(t.toJ());if(this===t)return!0;var r=this.z.redSqr(),n=t.z.redSqr();if(this.x.redMul(n).redISub(t.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),s=n.redMul(t.z);return this.y.redMul(s).redISub(t.y.redMul(i)).cmpn(0)===0};Gr.prototype.eqXToP=function(t){var r=this.z.redSqr(),n=t.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=t.clone(),s=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}};Gr.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Gr.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var M3=U((nz,I3)=>{"use strict";H();k();var Do=wr(),P3=bo(),Ku=ac(),U_=On();function To(e){Ku.call(this,"mont",e),this.a=new Do(e.a,16).toRed(this.red),this.b=new Do(e.b,16).toRed(this.red),this.i4=new Do(4).toRed(this.red).redInvm(),this.two=new Do(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}P3(To,Ku);I3.exports=To;To.prototype.validate=function(t){var r=t.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),s=i.redSqrt();return s.redSqr().cmp(i)===0};function Nr(e,t,r){Ku.BasePoint.call(this,e,"projective"),t===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Do(t,16),this.z=new Do(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}P3(Nr,Ku.BasePoint);To.prototype.decodePoint=function(t,r){return this.point(U_.toArray(t,r),1)};To.prototype.point=function(t,r){return new Nr(this,t,r)};To.prototype.pointFromJSON=function(t){return Nr.fromJSON(this,t)};Nr.prototype.precompute=function(){};Nr.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Nr.fromJSON=function(t,r){return new Nr(t,r[0],r[1]||t.one)};Nr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Nr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Nr.prototype.dbl=function(){var t=this.x.redAdd(this.z),r=t.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),s=r.redSub(i),o=r.redMul(i),a=s.redMul(i.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)};Nr.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Nr.prototype.diffAdd=function(t,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=t.x.redAdd(t.z),o=t.x.redSub(t.z),a=o.redMul(n),f=s.redMul(i),l=r.z.redMul(a.redAdd(f).redSqr()),v=r.x.redMul(a.redISub(f).redSqr());return this.curve.point(l,v)};Nr.prototype.mul=function(t){for(var r=t.clone(),n=this,i=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(n=n.diffAdd(i,s),i=i.dbl()):(i=n.diffAdd(i,s),n=n.dbl());return i};Nr.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Nr.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Nr.prototype.eq=function(t){return this.getX().cmp(t.getX())===0};Nr.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Nr.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var N3=U((az,F3)=>{"use strict";H();k();var V_=On(),Ps=wr(),C3=bo(),Uu=ac(),z_=V_.assert;function Gi(e){this.twisted=(e.a|0)!==1,this.mOneA=this.twisted&&(e.a|0)===-1,this.extended=this.mOneA,Uu.call(this,"edwards",e),this.a=new Ps(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Ps(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Ps(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),z_(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(e.c|0)===1}C3(Gi,Uu);F3.exports=Gi;Gi.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)};Gi.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)};Gi.prototype.jpoint=function(t,r,n,i){return this.point(t,r,n,i)};Gi.prototype.pointFromX=function(t,r){t=new Ps(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),o=i.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var f=a.fromRed().isOdd();return(r&&!f||!r&&f)&&(a=a.redNeg()),this.point(t,a)};Gi.prototype.pointFromY=function(t,r){t=new Ps(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,t)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,t)};Gi.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var r=t.x.redSqr(),n=t.y.redSqr(),i=r.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(s)===0};function Dt(e,t,r,n,i){Uu.BasePoint.call(this,e,"projective"),t===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Ps(t,16),this.y=new Ps(r,16),this.z=n?new Ps(n,16):this.curve.one,this.t=i&&new Ps(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}C3(Dt,Uu.BasePoint);Gi.prototype.pointFromJSON=function(t){return Dt.fromJSON(this,t)};Gi.prototype.point=function(t,r,n,i){return new Dt(this,t,r,n,i)};Dt.fromJSON=function(t,r){return new Dt(t,r[0],r[1],r[2])};Dt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Dt.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Dt.prototype._extDbl=function(){var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(t),s=this.x.redAdd(this.y).redSqr().redISub(t).redISub(r),o=i.redAdd(r),a=o.redSub(n),f=i.redSub(r),l=s.redMul(a),v=o.redMul(f),p=s.redMul(f),u=a.redMul(o);return this.curve.point(l,v,u,p)};Dt.prototype._projDbl=function(){var t=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,s,o,a,f,l;if(this.curve.twisted){a=this.curve._mulA(r);var v=a.redAdd(n);this.zOne?(i=t.redSub(r).redSub(n).redMul(v.redSub(this.curve.two)),s=v.redMul(a.redSub(n)),o=v.redSqr().redSub(v).redSub(v)):(f=this.z.redSqr(),l=v.redSub(f).redISub(f),i=t.redSub(r).redISub(n).redMul(l),s=v.redMul(a.redSub(n)),o=v.redMul(l))}else a=r.redAdd(n),f=this.curve._mulC(this.z).redSqr(),l=a.redSub(f).redSub(f),i=this.curve._mulC(t.redISub(a)).redMul(l),s=this.curve._mulC(a).redMul(r.redISub(n)),o=a.redMul(l);return this.curve.point(i,s,o)};Dt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};Dt.prototype._extAdd=function(t){var r=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),n=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),s=this.z.redMul(t.z.redAdd(t.z)),o=n.redSub(r),a=s.redSub(i),f=s.redAdd(i),l=n.redAdd(r),v=o.redMul(a),p=f.redMul(l),u=o.redMul(l),h=a.redMul(f);return this.curve.point(v,p,h,u)};Dt.prototype._projAdd=function(t){var r=this.z.redMul(t.z),n=r.redSqr(),i=this.x.redMul(t.x),s=this.y.redMul(t.y),o=this.curve.d.redMul(i).redMul(s),a=n.redSub(o),f=n.redAdd(o),l=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(i).redISub(s),v=r.redMul(a).redMul(l),p,u;return this.curve.twisted?(p=r.redMul(f).redMul(s.redSub(this.curve._mulA(i))),u=a.redMul(f)):(p=r.redMul(f).redMul(s.redSub(i)),u=this.curve._mulC(a).redMul(f)),this.curve.point(v,p,u)};Dt.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)};Dt.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)};Dt.prototype.mulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!1)};Dt.prototype.jmulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!0)};Dt.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this};Dt.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Dt.prototype.getX=function(){return this.normalize(),this.x.fromRed()};Dt.prototype.getY=function(){return this.normalize(),this.y.fromRed()};Dt.prototype.eq=function(t){return this===t||this.getX().cmp(t.getX())===0&&this.getY().cmp(t.getY())===0};Dt.prototype.eqXToP=function(t){var r=t.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=t.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}};Dt.prototype.toP=Dt.prototype.normalize;Dt.prototype.mixedAdd=Dt.prototype.add});var S2=U(R3=>{"use strict";H();k();var Vu=R3;Vu.base=ac();Vu.short=B3();Vu.mont=M3();Vu.edwards=N3()});var D3=U((hz,O3)=>{"use strict";H();k();O3.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var zu=U(H3=>{"use strict";H();k();var _2=H3,sa=yu(),E2=S2(),W_=On(),T3=W_.assert;function q3(e){e.type==="short"?this.curve=new E2.short(e):e.type==="edwards"?this.curve=new E2.edwards(e):this.curve=new E2.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,T3(this.g.validate(),"Invalid curve"),T3(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}_2.PresetCurve=q3;function aa(e,t){Object.defineProperty(_2,e,{configurable:!0,enumerable:!0,get:function(){var r=new q3(t);return Object.defineProperty(_2,e,{configurable:!0,enumerable:!0,value:r}),r}})}aa("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:sa.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});aa("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:sa.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});aa("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:sa.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});aa("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:sa.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});aa("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:sa.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});aa("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:sa.sha256,gRed:!1,g:["9"]});aa("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:sa.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var A2;try{A2=D3()}catch{A2=void 0}aa("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:sa.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",A2]})});var j3=U((yz,k3)=>{"use strict";H();k();var $_=wr(),G_=On(),B2=G_.assert;function tn(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}k3.exports=tn;tn.fromPublic=function(t,r,n){return r instanceof tn?r:new tn(t,{pub:r,pubEnc:n})};tn.fromPrivate=function(t,r,n){return r instanceof tn?r:new tn(t,{priv:r,privEnc:n})};tn.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};tn.prototype.getPublic=function(t,r){return typeof t=="string"&&(r=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,t):this.pub};tn.prototype.getPrivate=function(t){return t==="hex"?this.priv.toString(16,2):this.priv};tn.prototype._importPrivate=function(t,r){this.priv=new $_(t,r||16),this.priv=this.priv.umod(this.ec.curve.n)};tn.prototype._importPublic=function(t,r){if(t.x||t.y){this.ec.curve.type==="mont"?B2(t.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&B2(t.x&&t.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(t.x,t.y);return}this.pub=this.ec.curve.decodePoint(t,r)};tn.prototype.derive=function(t){return t.validate()||B2(t.validate(),"public point not validated"),t.mul(this.priv).getX()};tn.prototype.sign=function(t,r,n){return this.ec.sign(t,this,r,n)};tn.prototype.verify=function(t,r){return this.ec.verify(t,r,this)};tn.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var U3=U((wz,K3)=>{"use strict";H();k();var Wu=wr(),M2=On(),X_=M2.assert;function oc(e,t,r){if(t instanceof oc)return t;this._importDER(t,r)||(X_(t.r&&t.s,"Signature without r or s"),this.r=new Wu(t.r,16),this.s=new Wu(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam,this.curve=e,this.byteLength=this.curve.n.byteLength())}K3.exports=oc;function Z_(){this.place=0}function P2(e,t){var r=e[t.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4)return!1;for(var i=0,s=0,o=t.place;s<n;s++,o++)i<<=8,i|=e[o],i>>>=0;return i<=127?!1:(t.place=o,i)}function L3(e){for(var t=0,r=e.length-1;!e[t]&&!(e[t+1]&128)&&t<r;)t++;return t===0?e:e.slice(t)}oc.prototype._importDER=function(t,r){t=M2.toArray(t,r);var n=new Z_;if(t[n.place++]!==48)return!1;var i=P2(t,n);if(i===!1||i+n.place!==t.length||t[n.place++]!==2)return!1;var s=P2(t,n);if(s===!1)return!1;var o=t.slice(n.place,s+n.place);if(n.place+=s,t[n.place++]!==2)return!1;var a=P2(t,n);if(a===!1||t.length!==a+n.place)return!1;var f=t.slice(n.place,a+n.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(f[0]===0)if(f[1]&128)f=f.slice(1);else return!1;return this.r=new Wu(o),this.s=new Wu(f),this.recoveryParam=null,!0};function I2(e,t){if(t<128){e.push(t);return}var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(r|128);--r;)e.push(t>>>(r<<3)&255);e.push(t)}oc.prototype.toDER=function(t){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=L3(r),n=L3(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];I2(i,r.length),i=i.concat(r),i.push(2),I2(i,n.length);var s=i.concat(n),o=[48];return I2(o,s.length),o=o.concat(s),M2.encode(o,t)};oc.prototype.toBytes=function(){let t=this.r.toArray("be",this.byteLength),r=this.s.toArray("be",this.byteLength);return t.concat(r)}});var $3=U((_z,W3)=>{"use strict";H();k();var E0=wr(),V3=ng(),Y_=On(),C2=zu(),J_=tg(),z3=Y_.assert,F2=j3(),$u=U3();function Kn(e){if(!(this instanceof Kn))return new Kn(e);typeof e=="string"&&(z3(Object.prototype.hasOwnProperty.call(C2,e),"Unknown curve "+e),e=C2[e]),e instanceof C2.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}W3.exports=Kn;Kn.prototype.keyPair=function(t){return new F2(this,t)};Kn.prototype.keyFromPrivate=function(t,r){return F2.fromPrivate(this,t,r)};Kn.prototype.keyFromPublic=function(t,r){return F2.fromPublic(this,t,r)};Kn.prototype.genKeyPair=function(t){t||(t={});for(var r=new V3({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||J_(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new E0(2));;){var s=new E0(r.generate(n));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Kn.prototype._truncateToN=function(t,r){var n=t.byteLength()*8-this.n.bitLength();return n>0&&(t=t.ushrn(n)),!r&&t.cmp(this.n)>=0?t.sub(this.n):t};Kn.prototype.sign=function(t,r,n,i){typeof n=="object"&&(i=n,n=null),i||(i={}),r=this.keyFromPrivate(r,n),t=this._truncateToN(new E0(t,16));for(var s=this.n.byteLength(),o=r.getPrivate().toArray("be",s),a=t.toArray("be",s),f=new V3({hash:this.hash,entropy:o,nonce:a,pers:i.pers,persEnc:i.persEnc||"utf8"}),l=this.n.sub(new E0(1)),v=0;;v++){var p=i.k?i.k(v):new E0(f.generate(this.n.byteLength()));if(p=this._truncateToN(p,!0),!(p.cmpn(1)<=0||p.cmp(l)>=0)){var u=this.g.mul(p);if(!u.isInfinity()){var h=u.getX(),b=h.umod(this.n);if(b.cmpn(0)!==0){var d=p.invm(this.n).mul(b.mul(r.getPrivate()).iadd(t));if(d=d.umod(this.n),d.cmpn(0)!==0){var y=(u.getY().isOdd()?1:0)|(h.cmp(b)!==0?2:0);return i.canonical&&d.cmp(this.nh)>0&&(d=this.n.sub(d),y^=1),new $u(this.curve,{r:b,s:d,recoveryParam:y})}}}}}};Kn.prototype.verify=function(t,r,n,i){t=this._truncateToN(new E0(t,16)),n=this.keyFromPublic(n,i),r=new $u(this.curve,r,"hex");var s=r.r,o=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),f=a.mul(t).umod(this.n),l=a.mul(s).umod(this.n),v;return this.curve._maxwellTrick?(v=this.g.jmulAdd(f,n.getPublic(),l),v.isInfinity()?!1:v.eqXToP(s)):(v=this.g.mulAdd(f,n.getPublic(),l),v.isInfinity()?!1:v.getX().umod(this.n).cmp(s)===0)};Kn.prototype.recoverPubKey=function(e,t,r,n){z3((3&r)===r,"The recovery param is more than two bits"),t=new $u(this.curve,t,n);var i=this.n,s=new E0(e),o=t.r,a=t.s,f=r&1,l=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");l?o=this.curve.pointFromX(o.add(this.curve.n),f):o=this.curve.pointFromX(o,f);var v=t.r.invm(i),p=i.sub(s).mul(v).umod(i),u=a.mul(v).umod(i);return this.g.mulAdd(p,o,u)};Kn.prototype.getKeyRecoveryParam=function(e,t,r,n){if(t=new $u(this.curve,t,n),t.recoveryParam!==null)return t.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,t,i)}catch{continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")}});var Y3=U((Pz,Z3)=>{"use strict";H();k();var fc=On(),X3=fc.assert,G3=fc.parseBytes,qo=fc.cachedProperty;function Rr(e,t){this.eddsa=e,this._secret=G3(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=G3(t.pub)}Rr.fromPublic=function(t,r){return r instanceof Rr?r:new Rr(t,{pub:r})};Rr.fromSecret=function(t,r){return r instanceof Rr?r:new Rr(t,{secret:r})};Rr.prototype.secret=function(){return this._secret};qo(Rr,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});qo(Rr,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});qo(Rr,"privBytes",function(){var t=this.eddsa,r=this.hash(),n=t.encodingLength-1,i=r.slice(0,t.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i});qo(Rr,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});qo(Rr,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});qo(Rr,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});Rr.prototype.sign=function(t){return X3(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)};Rr.prototype.verify=function(t,r){return this.eddsa.verify(t,r,this)};Rr.prototype.getSecret=function(t){return X3(this._secret,"KeyPair is public only"),fc.encode(this.secret(),t)};Rr.prototype.getPublic=function(t){return fc.encode(this.pubBytes(),t)};Z3.exports=Rr});var Q3=U((Cz,J3)=>{"use strict";H();k();var Q_=wr(),Gu=On(),eA=Gu.assert,Xu=Gu.cachedProperty,tA=Gu.parseBytes;function _0(e,t){this.eddsa=e,typeof t!="object"&&(t=tA(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),eA(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof Q_&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}Xu(_0,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Xu(_0,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Xu(_0,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Xu(_0,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});_0.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};_0.prototype.toHex=function(){return Gu.encode(this.toBytes(),"hex").toUpperCase()};J3.exports=_0});var i4=U((Rz,n4)=>{"use strict";H();k();var rA=yu(),nA=zu(),Ho=On(),iA=Ho.assert,t4=Ho.parseBytes,r4=Y3(),e4=Q3();function Pn(e){if(iA(e==="ed25519","only tested with ed25519 so far"),!(this instanceof Pn))return new Pn(e);e=nA[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=rA.sha512}n4.exports=Pn;Pn.prototype.sign=function(t,r){t=t4(t);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),t),s=this.g.mul(i),o=this.encodePoint(s),a=this.hashInt(o,n.pubBytes(),t).mul(n.priv()),f=i.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:f,Rencoded:o})};Pn.prototype.verify=function(t,r,n){t=t4(t),r=this.makeSignature(r);var i=this.keyFromPublic(n),s=this.hashInt(r.Rencoded(),i.pubBytes(),t),o=this.g.mul(r.S()),a=r.R().add(i.pub().mul(s));return a.eq(o)};Pn.prototype.hashInt=function(){for(var t=this.hash(),r=0;r<arguments.length;r++)t.update(arguments[r]);return Ho.intFromLE(t.digest()).umod(this.curve.n)};Pn.prototype.keyFromPublic=function(t){return r4.fromPublic(this,t)};Pn.prototype.keyFromSecret=function(t){return r4.fromSecret(this,t)};Pn.prototype.makeSignature=function(t){return t instanceof e4?t:new e4(this,t)};Pn.prototype.encodePoint=function(t){var r=t.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=t.getX().isOdd()?128:0,r};Pn.prototype.decodePoint=function(t){t=Ho.parseBytes(t);var r=t.length-1,n=t.slice(0,r).concat(t[r]&-129),i=(t[r]&128)!==0,s=Ho.intFromLE(n);return this.curve.pointFromY(s,i)};Pn.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)};Pn.prototype.decodeInt=function(t){return Ho.intFromLE(t)};Pn.prototype.isPoint=function(t){return t instanceof this.pointClass}});var ko=U(Un=>{"use strict";H();k();Object.defineProperty(Un,"__esModule",{value:!0});Un.utils=Un.curves=Un.curve=Un.eddsa=Un.ec=void 0;var sA=S2();Un.curve=sA;var aA=zu();Un.curves=aA;var oA=$3();Un.ec=oA;var fA=i4();Un.eddsa=fA;var cA=On();Un.utils=cA});var o4=U((s4,a4)=>{"use strict";H();k();Object.defineProperty(s4,"__esModule",{value:!0});var uA=ko(),Xi=new uA.ec("secp256k1"),ht=Xi.curve,Tt=wr();function dA(e,t){let r=new Tt(t);if(r.cmp(ht.p)>=0)return null;r=r.toRed(ht.red);let n=r.redSqr().redIMul(r).redIAdd(ht.b).redSqrt();e===3!==n.isOdd()&&(n=n.redNeg());let i=r.redSqr().redIMul(r);return n.redSqr().redISub(i.redIAdd(ht.b)).isZero()?Xi.keyPair({pub:{x:r,y:n}}):null}function hA(e,t,r){let n=new Tt(t),i=new Tt(r);if(n.cmp(ht.p)>=0||i.cmp(ht.p)>=0||(n=n.toRed(ht.red),i=i.toRed(ht.red),(e===6||e===7)&&i.isOdd()!==(e===7)))return null;let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(ht.b)).isZero()?Xi.keyPair({pub:{x:n,y:i}}):null}function oa(e){let t=e[0];switch(t){case 2:case 3:return e.length!==33?null:dA(t,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:hA(t,e.subarray(1,33),e.subarray(33,65));default:return null}}a4.exports={contextRandomize(){return 0},privateKeyVerify(e){let t=new Tt(e);return t.cmp(ht.n)<0&&!t.isZero()},privateKeyNegate(e){let t=new Tt(e);return j.Buffer.from(ht.n.sub(t).umod(ht.n).toArray("be",32))},privateKeyTweakAdd(e,t){let r=new Tt(t);return r.cmp(ht.n)>=0||(r.iadd(new Tt(e)),r.cmp(ht.n)>=0&&r.isub(ht.n),r.isZero())?null:j.Buffer.from(r.toArray("be",32))},privateKeyTweakMul(e,t){let r=new Tt(t);return r.cmp(ht.n)>=0||r.isZero()?1:(r.imul(new Tt(e)),r.cmp(ht.n)>=0&&(r=r.umod(ht.n)),j.Buffer.from(r.toArray("be",32)))},publicKeyVerify(e){let t=oa(e);return t==null?null:t.validate().result},publicKeyCreate(e,t){let r=new Tt(e);if(r.cmp(ht.n)>=0||r.isZero())return null;let n=Xi.keyFromPrivate(e,null).getPublic();return j.Buffer.from(n.encode(null,t))},publicKeyConvert(e,t){let n=oa(e).getPublic();return j.Buffer.from(n.encode(null,t))},publicKeyNegate(e,t){let r=oa(e);if(r===null)return 1;let n=r.getPublic();return n.y=n.y.redNeg(),j.Buffer.from(n.encode(null,t))},publicKeyCombine(e,t){let r=new Array(e.length);for(let i=0;i<e.length;++i)if(r[i]=oa(e[i]),r[i]===null)return null;let n=r[0].getPublic();for(let i=1;i<r.length;++i)n=n.add(r[i].pub);return n.isInfinity()?null:j.Buffer.from(n.encode(null,t))},publicKeyTweakAdd(e,t,r){let n=oa(e);if(n===null||new Tt(t).cmp(ht.n)>=0)return null;let s=n.getPublic().add(ht.g.mul(t));return s.isInfinity()?null:j.Buffer.from(s.encode(null,r))},publicKeyTweakMul(e,t,r){let n=oa(e);if(n===null)return null;let i=new Tt(t);if(i.cmp(ht.n)>=0||i.isZero())return null;let s=n.getPublic().mul(t);return j.Buffer.from(s.encode(null,r))},signatureNormalize(e){let t=new Tt(e.subarray(0,32)),r=new Tt(e.subarray(32,64));return t.cmp(ht.n)>=0||r.cmp(ht.n)>=0?null:(r.cmp(Xi.nh)===1&&e.set(ht.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(e,t){let r=t.subarray(0,32),n=t.subarray(32,64);if(new Tt(r).cmp(ht.n)>=0||new Tt(n).cmp(ht.n)>=0)return 1;let{output:i}=e,s=i.subarray(4,4+33);s[0]=0,s.set(r,1);let o=33,a=0;for(;o>1&&s[a]===0&&!(s[a+1]&128);--o,++a);if(s=s.subarray(a),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let f=i.subarray(6+33,6+33+33);f[0]=0,f.set(n,1);let l=33,v=0;for(;l>1&&f[v]===0&&!(f[v+1]&128);--l,++v);return f=f.subarray(v),f[0]&128||l>1&&f[0]===0&&!(f[1]&128)?1:(e.outputlen=6+o+l,i[0]=48,i[1]=e.outputlen-2,i[2]=2,i[3]=s.length,i.set(s,4),i[4+o]=2,i[5+o]=f.length,i.set(f,6+o),0)},signatureImport(e,t){if(t.length<8||t.length>72||t[0]!==48||t[1]!==t.length-2||t[2]!==2)return 1;let r=t[3];if(r===0||5+r>=t.length||t[4+r]!==2)return 1;let n=t[5+r];if(n===0||6+r+n!==t.length||t[4]&128||r>1&&t[4]===0&&!(t[5]&128)||t[r+6]&128||n>1&&t[r+6]===0&&!(t[r+7]&128))return 1;let i=t.subarray(4,4+r);if(i.length===33&&i[0]===0&&(i=i.subarray(1)),i.length>32)return 1;let s=t.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new Tt(i);o.cmp(ht.n)>=0&&(o=new Tt(0));let a=new Tt(t.subarray(6+r));return a.cmp(ht.n)>=0&&(a=new Tt(0)),e.set(o.toArrayLike(Uint8Array,"be",32),0),e.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(e,t){let r=new Tt(t);return r.cmp(ht.n)>=0||r.isZero()?null:Xi.sign(e,t,{canonical:!0}).toBytes()},ecdsaVerify(e,t,r){let n={r:e.subarray(0,32),s:e.subarray(32,64)},i=new Tt(n.r),s=new Tt(n.s);if(i.cmp(ht.n)>=0||s.cmp(ht.n)>=0)return 1;if(s.cmp(Xi.nh)===1||i.isZero()||s.isZero())return 3;let o=oa(r);if(o===null)return 2;let a=o.getPublic();return Xi.verify(t,n,a)},ecdsaRecover(e,t,r,n){let i={r:e.slice(0,32),s:e.slice(32,64)},s=new Tt(i.r),o=new Tt(i.s);if(s.cmp(ht.n)>=0||o.cmp(ht.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let a;try{a=Xi.recoverPubKey(r,i,t,null)}catch{return 2}return j.Buffer.from(a.encode(null,n))},ecdh(e,t,r,n,i,s,o){let a=oa(t);if(a===null)return 1;let f=new Tt(r);if(f.cmp(ht.n)>=0||f.isZero())return 2;let l=a.getPublic().mul(f);if(i===void 0){let v=l.encode(null,!0),p=Xi.hash().update(v).digest();for(let u=0;u<32;++u)e[u]=p[u]}else{s||(s=new Uint8Array(32));let v=l.getX().toArray("be",32);for(let b=0;b<32;++b)s[b]=v[b];o||(o=new Uint8Array(32));let p=l.getY().toArray("be",32);for(let b=0;b<32;++b)o[b]=p[b];let u=i(s,o,n);if(!(u instanceof Uint8Array&&u.length===e.length))return 2;e.set(u)}return 0}}});var h4=U(Or=>{"use strict";H();k();var lA=Or&&Or.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),pA=Or&&Or.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),vA=Or&&Or.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&lA(t,e,r);return pA(t,e),t};Object.defineProperty(Or,"__esModule",{value:!0});Or.fromSeed=Or.fromPublicKey=Or.fromPrivateKey=Or.fromBase58=Or.tinySecp256k1Interface=void 0;var N2=vA(w0()),bA=zs(),gA=tc(),c4=(0,bA.base58check)(gA.sha256),u4=o4(),Xr=xu(),yA=sg();function xA(e){return{isPoint:t=>e.publicKeyVerify(t),isPrivate:t=>e.privateKeyVerify(t),pointAddScalar:(t,r,n)=>e.publicKeyTweakAdd(t,r,n),pointFromScalar:(t,r)=>e.publicKeyCreate(t,r),privateAdd:(t,r)=>e.privateKeyTweakAdd(new Uint8Array(t),r),sign:(t,r)=>e.ecdsaSign(t,r),verify:(t,r,n)=>e.ecdsaVerify(n,t,r)}}function mA(e){return{isPoint:t=>e.publicKeyVerify(t),pointCompress:(t,r)=>Uint8Array.from(e.publicKeyConvert(t,r??!0)),isPrivate:t=>e.privateKeyVerify(t),pointFromScalar:(t,r)=>{let n=e.publicKeyCreate(t,r??!0);return n==null?null:Uint8Array.from(n)},sign:(t,r,n)=>Uint8Array.from(e.ecdsaSign(t,r)),verify:(t,r,n,i)=>e.ecdsaVerify(n,t,r)}}var fa=xA(u4);Or.tinySecp256k1Interface=mA(u4);var R2=Xr.BufferN(32),wA=Xr.compile({wif:Xr.UInt8,bip32:{public:Xr.UInt32,private:Xr.UInt32}}),Ju={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},f4=2147483648,SA=Math.pow(2,31)-1;function EA(e){return Xr.String(e)&&e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)!==null}function _A(e){return Xr.UInt32(e)&&e<=SA}var Zu=class{constructor(t,r,n,i,s=0,o=0,a=0){this.__D=t,this.__Q=r,this.chainCode=n,this.network=i,this.__DEPTH=s,this.__INDEX=o,this.__PARENT_FINGERPRINT=a,Xr(wA,i),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return this.__Q===void 0&&(this.__Q=j.Buffer.from(fa.pointFromScalar(this.__D,!0))),this.__Q}get privateKey(){return this.__D}get identifier(){return j.Buffer.from(N2.hash160(this.publicKey))}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return this.__D===void 0}neutered(){return Yu(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){let t=this.network,r=this.isNeutered()?t.bip32.public:t.bip32.private,n=j.Buffer.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),c4.encode(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return yA.encode(this.network.wif,this.privateKey,!0)}derive(t){Xr(Xr.UInt32,t);let r=t>=f4,n=j.Buffer.allocUnsafe(37);if(r){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");n[0]=0,this.privateKey.copy(n,1),n.writeUInt32BE(t,33)}else this.publicKey.copy(n,0),n.writeUInt32BE(t,33);let i=N2.hmacSHA512(this.chainCode,n),s=i.slice(0,32),o=i.slice(32);if(!fa.isPrivate(s))return this.derive(t+1);let a;if(this.isNeutered()){let f=fa.pointAddScalar(this.publicKey,s,!0);if(f===null)return this.derive(t+1);a=Yu(f,o,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}else{let f=fa.privateAdd(this.privateKey,s);if(f==null)return this.derive(t+1);a=O2(f,o,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}return a}deriveHardened(t){return Xr(_A,t),this.derive(t+f4)}derivePath(t){Xr(EA,t);let r=t.split("/");if(r[0]==="m"){if(this.parentFingerprint)throw new TypeError("Expected master, got child");r=r.slice(1)}return r.reduce((n,i)=>{let s;return i.slice(-1)==="'"?(s=parseInt(i.slice(0,-1),10),n.deriveHardened(s)):(s=parseInt(i,10),n.derive(s))},this)}sign(t){if(!this.privateKey)throw new Error("Missing private key");return fa.sign(t,this.privateKey)}verify(t,r){return fa.verify(t,this.publicKey,r)}};function AA(e,t){let r=j.Buffer.from(c4.decode(e));if(r.length!==78)throw new TypeError("Invalid buffer length");t=t||Ju;let n=r.readUInt32BE(0);if(n!==t.bip32.private&&n!==t.bip32.public)throw new TypeError("Invalid network version");let i=r[4],s=r.readUInt32BE(5);if(i===0&&s!==0)throw new TypeError("Invalid parent fingerprint");let o=r.readUInt32BE(9);if(i===0&&o!==0)throw new TypeError("Invalid index");let a=r.slice(13,45),f;if(n===t.bip32.private){if(r.readUInt8(45)!==0)throw new TypeError("Invalid private key");let l=r.slice(46,78);f=O2(l,a,t,i,o,s)}else{let l=r.slice(45,78);f=Yu(l,a,t,i,o,s)}return f}Or.fromBase58=AA;function d4(e,t,r){return O2(e,t,r)}Or.fromPrivateKey=d4;function O2(e,t,r,n,i,s){if(Xr({privateKey:R2,chainCode:R2},{privateKey:e,chainCode:t}),r=r||Ju,!fa.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return new Zu(e,void 0,t,r,n,i,s)}function BA(e,t,r){return Yu(e,t,r)}Or.fromPublicKey=BA;function Yu(e,t,r,n,i,s){if(Xr({publicKey:Xr.BufferN(33),chainCode:R2},{publicKey:e,chainCode:t}),r=r||Ju,!fa.isPoint(e))throw new TypeError("Point is not on the curve");return new Zu(void 0,e,t,r,n,i,s)}function PA(e,t){if(Xr(Xr.Buffer,e),e.length<16)throw new TypeError("Seed should be at least 128 bits");if(e.length>64)throw new TypeError("Seed should be at most 512 bits");t=t||Ju;let r=N2.hmacSHA512(j.Buffer.from("Bitcoin seed","utf8"),e),n=r.slice(0,32),i=r.slice(32);return d4(n,i,t)}Or.fromSeed=PA});var l4=U(Vn=>{"use strict";H();k();Object.defineProperty(Vn,"__esModule",{value:!0});Vn.fromPrivateKey=Vn.fromPublicKey=Vn.fromBase58=Vn.fromSeed=Vn.tinySecp256k1Interface=void 0;var cc=h4();Object.defineProperty(Vn,"tinySecp256k1Interface",{enumerable:!0,get:function(){return cc.tinySecp256k1Interface}});Object.defineProperty(Vn,"fromSeed",{enumerable:!0,get:function(){return cc.fromSeed}});Object.defineProperty(Vn,"fromBase58",{enumerable:!0,get:function(){return cc.fromBase58}});Object.defineProperty(Vn,"fromPublicKey",{enumerable:!0,get:function(){return cc.fromPublicKey}});Object.defineProperty(Vn,"fromPrivateKey",{enumerable:!0,get:function(){return cc.fromPrivateKey}})});var p4=U(($z,IA)=>{IA.exports=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]});var T2=U(A0=>{"use strict";H();k();Object.defineProperty(A0,"__esModule",{value:!0});A0._default=A0.wordlists=void 0;var D2={};A0.wordlists=D2;var Qu;A0._default=Qu;try{A0._default=Qu=p4(),D2.english=Qu,D2.EN=Qu}catch{}});var P4=U(hr=>{"use strict";H();k();Object.defineProperty(hr,"__esModule",{value:!0});hr.wordlists=hr.getDefaultWordlist=hr.setDefaultWordlist=hr.validateMnemonic=hr.generateMnemonic=hr.entropyToMnemonic=hr.mnemonicToEntropy=hr.mnemonicToSeed=hr.mnemonicToSeedSync=void 0;var b4=w0(),g4=Hu(),ed=T2(),y4=Pu(),uc=ed._default,v4="Invalid mnemonic",B0="Invalid entropy",MA="Invalid mnemonic checksum",x4=`A wordlist is required but a default could not be found.
Please pass a 2048 word array explicitly.`;function CA(e,t,r,n,i){let s=(0,g4.pbkdf2)(y4.sha512,e,t,{c:r,dkLen:n});return Promise.resolve(j.Buffer.from(s))}function dc(e){return(e||"").normalize("NFKD")}function m4(e,t,r){for(;e.length<r;)e=t+e;return e}function w4(e){return parseInt(e,2)}function S4(e){return e.map(t=>m4(t.toString(2),"0",8)).join("")}function E4(e){let r=e.length*8/32,n=(0,b4.sha256)(e);return S4(Array.from(n)).slice(0,r)}function _4(e){return"mnemonic"+(e||"")}function FA(e,t){let r=j.Buffer.from(dc(e),"utf8"),n=j.Buffer.from(_4(dc(t)),"utf8"),i=(0,g4.pbkdf2)(y4.sha512,r,n,{c:2048,dkLen:64});return j.Buffer.from(i)}hr.mnemonicToSeedSync=FA;function NA(e,t){return Promise.resolve().then(()=>{let r=j.Buffer.from(dc(e),"utf8"),n=j.Buffer.from(_4(dc(t)),"utf8");return CA(r,n,2048,64,"sha512")})}hr.mnemonicToSeed=NA;function A4(e,t){if(t=t||uc,!t)throw new Error(x4);let r=dc(e).split(" ");if(r.length%3!==0)throw new Error(v4);let n=r.map(v=>{let p=t.indexOf(v);if(p===-1)throw new Error(v4);return m4(p.toString(2),"0",11)}).join(""),i=Math.floor(n.length/33)*32,s=n.slice(0,i),o=n.slice(i),a=s.match(/(.{1,8})/g).map(w4);if(a.length<16)throw new Error(B0);if(a.length>32)throw new Error(B0);if(a.length%4!==0)throw new Error(B0);let f=j.Buffer.from(a);if(E4(f)!==o)throw new Error(MA);return f.toString("hex")}hr.mnemonicToEntropy=A4;function B4(e,t){if(j.Buffer.isBuffer(e)||(e=j.Buffer.from(e,"hex")),t=t||uc,!t)throw new Error(x4);if(e.length<16)throw new TypeError(B0);if(e.length>32)throw new TypeError(B0);if(e.length%4!==0)throw new TypeError(B0);let r=S4(Array.from(e)),n=E4(e),o=(r+n).match(/(.{1,11})/g).map(a=>{let f=w4(a);return t[f]});return t[0]==="\u3042\u3044\u3053\u304F\u3057\u3093"?o.join("\u3000"):o.join(" ")}hr.entropyToMnemonic=B4;function RA(e,t,r){if(e=e||128,e%32!==0)throw new TypeError(B0);return t=t||b4.randomBytes,B4(t(e/8),r)}hr.generateMnemonic=RA;function OA(e,t){try{A4(e,t)}catch{return!1}return!0}hr.validateMnemonic=OA;function DA(e){let t=ed.wordlists[e];if(t)uc=t;else throw new Error('Could not find wordlist for language "'+e+'"')}hr.setDefaultWordlist=DA;function TA(){if(!uc)throw new Error("No Default Wordlist set");return Object.keys(ed.wordlists).filter(e=>e==="JA"||e==="EN"?!1:ed.wordlists[e].every((t,r)=>t===uc[r]))[0]}hr.getDefaultWordlist=TA;var qA=T2();Object.defineProperty(hr,"wordlists",{enumerable:!0,get:function(){return qA.wordlists}})});var M4=U(rn=>{"use strict";H();k();Object.defineProperty(rn,"__esModule",{value:!0});rn.unpadBuffer=rn.stripZeros=rn.setLengthRight=rn.setLengthLeft=rn.zeros=rn.assertIsBuffer=void 0;var HA=function(e){if(!j.Buffer.isBuffer(e)){let t=`This method only supports Buffer but input was: ${e}`;throw new Error(t)}};rn.assertIsBuffer=HA;var kA=function(e){return j.Buffer.allocUnsafe(e).fill(0)};rn.zeros=kA;var I4=function(e,t,r){let n=(0,rn.zeros)(t);return r?e.length<t?(e.copy(n),n):e.slice(0,t):e.length<t?(e.copy(n,t-e.length),n):e.slice(-t)},jA=function(e,t){return j.Buffer.isBuffer(e)||(e=j.Buffer.from(e)),I4(e,t,!1)};rn.setLengthLeft=jA;var LA=function(e,t){return j.Buffer.isBuffer(e)||(e=j.Buffer.from(e)),I4(e,t,!0)};rn.setLengthRight=LA;var KA=function(e){let t=e[0];for(;e.length>0&&t.toString()==="0";)e=e.slice(1),t=e[0];return e};rn.stripZeros=KA;var UA=function(e){return j.Buffer.isBuffer(e)||(e=j.Buffer.from(e)),(0,rn.stripZeros)(e)};rn.unpadBuffer=UA});var td=U(ir=>{"use strict";H();k();Object.defineProperty(ir,"__esModule",{value:!0});ir.isHexString=ir.getKeys=ir.fromAscii=ir.fromUtf8=ir.toAscii=ir.arrayContainsArray=ir.getBinarySize=ir.padToEven=ir.stripHexPrefix=ir.isHexPrefixed=void 0;function C4(e){if(typeof e!="string")throw new Error(`[isHexPrefixed] input must be type 'string', received type ${typeof e}`);return e[0]==="0"&&e[1]==="x"}ir.isHexPrefixed=C4;var VA=e=>{if(typeof e!="string")throw new Error(`[stripHexPrefix] input must be type 'string', received ${typeof e}`);return C4(e)?e.slice(2):e};ir.stripHexPrefix=VA;function F4(e){let t=e;if(typeof t!="string")throw new Error(`[padToEven] value must be type 'string', received ${typeof t}`);return t.length%2&&(t=`0${t}`),t}ir.padToEven=F4;function zA(e){if(typeof e!="string")throw new Error(`[getBinarySize] method requires input type 'string', received ${typeof e}`);return j.Buffer.byteLength(e,"utf8")}ir.getBinarySize=zA;function WA(e,t,r){if(Array.isArray(e)!==!0)throw new Error(`[arrayContainsArray] method requires input 'superset' to be an array, got type '${typeof e}'`);if(Array.isArray(t)!==!0)throw new Error(`[arrayContainsArray] method requires input 'subset' to be an array, got type '${typeof t}'`);return t[r===!0?"some":"every"](n=>e.indexOf(n)>=0)}ir.arrayContainsArray=WA;function $A(e){let t="",r=0,n=e.length;for(e.substring(0,2)==="0x"&&(r=2);r<n;r+=2){let i=parseInt(e.substr(r,2),16);t+=String.fromCharCode(i)}return t}ir.toAscii=$A;function GA(e){let t=j.Buffer.from(e,"utf8");return`0x${F4(t.toString("hex")).replace(/^0+|0+$/g,"")}`}ir.fromUtf8=GA;function XA(e){let t="";for(let r=0;r<e.length;r++){let i=e.charCodeAt(r).toString(16);t+=i.length<2?`0${i}`:i}return`0x${t}`}ir.fromAscii=XA;function ZA(e,t,r){if(!Array.isArray(e))throw new Error(`[getKeys] method expects input 'params' to be an array, got ${typeof e}`);if(typeof t!="string")throw new Error(`[getKeys] method expects input 'key' to be type 'string', got ${typeof e}`);let n=[];for(let i=0;i<e.length;i++){let s=e[i][t];if(r===!0&&!s)s="";else if(typeof s!="string")throw new Error(`invalid abi - expected type 'string', received ${typeof s}`);n.push(s)}return n}ir.getKeys=ZA;function YA(e,t){return!(typeof e!="string"||!e.match(/^0x[0-9A-Fa-f]*$/)||typeof t<"u"&&t>0&&e.length!==2+2*t)}ir.isHexString=YA});var N4=U(Zi=>{"use strict";H();k();Object.defineProperty(Zi,"__esModule",{value:!0});Zi.assertIsString=Zi.assertIsArray=Zi.assertIsBuffer=Zi.assertIsHexString=void 0;var JA=td(),QA=function(e){if(!(0,JA.isHexString)(e)){let t=`This method only supports 0x-prefixed hex strings but input was: ${e}`;throw new Error(t)}};Zi.assertIsHexString=QA;var eB=function(e){if(!j.Buffer.isBuffer(e)){let t=`This method only supports Buffer but input was: ${e}`;throw new Error(t)}};Zi.assertIsBuffer=eB;var tB=function(e){if(!Array.isArray(e)){let t=`This method only supports number arrays but input was: ${e}`;throw new Error(t)}};Zi.assertIsArray=tB;var rB=function(e){if(typeof e!="string"){let t=`This method only supports strings but input was: ${e}`;throw new Error(t)}};Zi.assertIsString=rB});var T4=U(ye=>{"use strict";H();k();Object.defineProperty(ye,"__esModule",{value:!0});ye.intToUnpaddedBuffer=ye.bigIntToUnpaddedBuffer=ye.bigIntToHex=ye.bufArrToArr=ye.arrToBufArr=ye.validateNoLeadingZeroes=ye.baToJSON=ye.toUtf8=ye.short=ye.addHexPrefix=ye.toUnsigned=ye.fromSigned=ye.bufferToInt=ye.bigIntToBuffer=ye.bufferToBigInt=ye.bufferToHex=ye.toBuffer=ye.unpadHexString=ye.unpadArray=ye.unpadBuffer=ye.setLengthRight=ye.setLengthLeft=ye.zeros=ye.intToBuffer=ye.intToHex=void 0;var hc=N4(),P0=td(),nB=function(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Received an invalid integer type: ${e}`);return`0x${e.toString(16)}`};ye.intToHex=nB;var iB=function(e){let t=(0,ye.intToHex)(e);return j.Buffer.from((0,P0.padToEven)(t.slice(2)),"hex")};ye.intToBuffer=iB;var sB=function(e){return j.Buffer.allocUnsafe(e).fill(0)};ye.zeros=sB;var R4=function(e,t,r){let n=(0,ye.zeros)(t);return r?e.length<t?(e.copy(n),n):e.slice(0,t):e.length<t?(e.copy(n,t-e.length),n):e.slice(-t)},aB=function(e,t){return(0,hc.assertIsBuffer)(e),R4(e,t,!1)};ye.setLengthLeft=aB;var oB=function(e,t){return(0,hc.assertIsBuffer)(e),R4(e,t,!0)};ye.setLengthRight=oB;var q2=function(e){let t=e[0];for(;e.length>0&&t.toString()==="0";)e=e.slice(1),t=e[0];return e},fB=function(e){return(0,hc.assertIsBuffer)(e),q2(e)};ye.unpadBuffer=fB;var cB=function(e){return(0,hc.assertIsArray)(e),q2(e)};ye.unpadArray=cB;var uB=function(e){return(0,hc.assertIsHexString)(e),e=(0,P0.stripHexPrefix)(e),"0x"+q2(e)};ye.unpadHexString=uB;var dB=function(e){if(e==null)return j.Buffer.allocUnsafe(0);if(j.Buffer.isBuffer(e))return j.Buffer.from(e);if(Array.isArray(e)||e instanceof Uint8Array)return j.Buffer.from(e);if(typeof e=="string"){if(!(0,P0.isHexString)(e))throw new Error(`Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ${e}`);return j.Buffer.from((0,P0.padToEven)((0,P0.stripHexPrefix)(e)),"hex")}if(typeof e=="number")return(0,ye.intToBuffer)(e);if(typeof e=="bigint"){if(e<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${e}`);let t=e.toString(16);return t.length%2&&(t="0"+t),j.Buffer.from(t,"hex")}if(e.toArray)return j.Buffer.from(e.toArray());if(e.toBuffer)return j.Buffer.from(e.toBuffer());throw new Error("invalid type")};ye.toBuffer=dB;var hB=function(e){return e=(0,ye.toBuffer)(e),"0x"+e.toString("hex")};ye.bufferToHex=hB;function H2(e){let t=(0,ye.bufferToHex)(e);return BigInt(t==="0x"?0:t)}ye.bufferToBigInt=H2;function k2(e){return(0,ye.toBuffer)("0x"+e.toString(16))}ye.bigIntToBuffer=k2;var lB=function(e){let t=Number(H2(e));if(!Number.isSafeInteger(t))throw new Error("Number exceeds 53 bits");return t};ye.bufferToInt=lB;var pB=function(e){return BigInt.asIntN(256,H2(e))};ye.fromSigned=pB;var vB=function(e){return k2(BigInt.asUintN(256,e))};ye.toUnsigned=vB;var bB=function(e){return typeof e!="string"||(0,P0.isHexPrefixed)(e)?e:"0x"+e};ye.addHexPrefix=bB;function gB(e,t=50){let r=j.Buffer.isBuffer(e)?e.toString("hex"):e;return r.length<=t?r:r.slice(0,t)+"\u2026"}ye.short=gB;var yB=function(e){let t=/^(00)+|(00)+$/g;if(e=(0,P0.stripHexPrefix)(e),e.length%2!==0)throw new Error("Invalid non-even hex string input for toUtf8() provided");return j.Buffer.from(e.replace(t,""),"hex").toString("utf8")};ye.toUtf8=yB;var xB=function(e){if(j.Buffer.isBuffer(e))return`0x${e.toString("hex")}`;if(e instanceof Array){let t=[];for(let r=0;r<e.length;r++)t.push((0,ye.baToJSON)(e[r]));return t}};ye.baToJSON=xB;var mB=function(e){for(let[t,r]of Object.entries(e))if(r!==void 0&&r.length>0&&r[0]===0)throw new Error(`${t} cannot have leading zeroes, received: ${r.toString("hex")}`)};ye.validateNoLeadingZeroes=mB;function O4(e){return Array.isArray(e)?e.map(t=>O4(t)):j.Buffer.from(e)}ye.arrToBufArr=O4;function D4(e){return Array.isArray(e)?e.map(t=>D4(t)):Uint8Array.from(e??[])}ye.bufArrToArr=D4;var wB=e=>"0x"+e.toString(16);ye.bigIntToHex=wB;function SB(e){return(0,ye.unpadBuffer)(k2(e))}ye.bigIntToUnpaddedBuffer=SB;function EB(e){return(0,ye.unpadBuffer)((0,ye.intToBuffer)(e))}ye.intToUnpaddedBuffer=EB});var j4=U((hW,k4)=>{"use strict";H();k();var rd=M4(),jo=w0(),In=wr(),{isHexString:_B,stripHexPrefix:AB,padToEven:BB}=td(),{intToBuffer:PB,addHexPrefix:IB,bufferToHex:MB}=T4(),$t=function(){};function nd(e){return e.startsWith("int[")?"int256"+e.slice(3):e==="int"?"int256":e.startsWith("uint[")?"uint256"+e.slice(4):e==="uint"?"uint256":e.startsWith("fixed[")?"fixed128x128"+e.slice(5):e==="fixed"?"fixed128x128":e.startsWith("ufixed[")?"ufixed128x128"+e.slice(6):e==="ufixed"?"ufixed128x128":e}function j2(e){if(e==null)return j.Buffer.allocUnsafe(0);if(j.Buffer.isBuffer(e))return j.Buffer.from(e);if(Array.isArray(e)||e instanceof Uint8Array)return j.Buffer.from(e);if(typeof e=="string"){if(!_B(e))throw new Error(`Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ${e}`);return j.Buffer.from(BB(AB(e)),"hex")}if(typeof e=="number")return PB(e);if(typeof e=="bigint"){if(e<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${e}`);let t=e.toString(16);return t.length%2&&(t="0"+t),j.Buffer.from(t,"hex")}if(e.toArray)return j.Buffer.from(e.toArray());if(e.toBuffer)return j.Buffer.from(e.toBuffer());throw new Error("invalid type")}function CB(e){if(!!e){if(typeof e=="number"){if(e<0)return"0x";let t=j2(e);e=MB(t)}if(typeof e!="string"){let t="eth-sig-util.normalize() requires hex string or integer input.";throw t+=` received ${typeof e}: ${e}`,new Error(t)}return IB(e.toLowerCase())}}$t.eventID=function(e,t){var r=e+"("+t.map(nd).join(",")+")";return jo.keccak256(j.Buffer.from(r))};$t.methodID=function(e,t){return $t.eventID(e,t).slice(0,4)};function ca(e){return parseInt(/^\D+(\d+)$/.exec(e)[1],10)}function L2(e){var t=/^\D+(\d+)x(\d+)$/.exec(e);return[parseInt(t[1],10),parseInt(t[2],10)]}function pc(e){var t=e.match(/(.*)\[(.*?)\]$/);return t?t[2]===""?"dynamic":parseInt(t[2],10):null}function I0(e){var t=typeof e;if(t==="string")return jo.isHexPrefixed(e)?new In(jo.stripHexPrefix(e),16):new In(e,10);if(t==="number")return new In(e);if(e.toArray)return e;throw new Error("Argument is not a number")}function H4(e){var t=/^(\w+)\((.*)\)$/.exec(e);if(t.length!==3)throw new Error("Invalid method signature");var r=/^(.+)\):\((.+)$/.exec(t[2]);if(r!==null&&r.length===3)return{method:t[1],args:r[1].split(","),retargs:r[2].split(",")};var n=t[2].split(",");return n.length===1&&n[0]===""&&(n=[]),{method:t[1],args:n}}function Yi(e,t){var r,n,i,s;if(e==="address")return Yi("uint160",I0(t));if(e==="bool")return Yi("uint8",t?1:0);if(e==="string")return Yi("bytes",j.Buffer.from(t,"utf8"));if(lc(e)){if(typeof t.length>"u")throw new Error("Not an array?");if(r=pc(e),r!=="dynamic"&&r!==0&&t.length>r)throw new Error("Elements exceed array size: "+r);i=[],e=e.slice(0,e.lastIndexOf("[")),typeof t=="string"&&(t=JSON.parse(t));for(s in t)i.push(Yi(e,t[s]));if(r==="dynamic"){var o=Yi("uint256",t.length);i.unshift(o)}return j.Buffer.concat(i)}else{if(e==="bytes")return t=j.Buffer.from(t),i=j.Buffer.concat([Yi("uint256",t.length),t]),t.length%32!==0&&(i=j.Buffer.concat([i,rd.zeros(32-t.length%32)])),i;if(e.startsWith("bytes")){if(r=ca(e),r<1||r>32)throw new Error("Invalid bytes<N> width: "+r);return rd.setLengthRight(t,32)}else if(e.startsWith("uint")){if(r=ca(e),r%8||r<8||r>256)throw new Error("Invalid uint<N> width: "+r);if(n=I0(t),n.bitLength()>r)throw new Error("Supplied uint exceeds width: "+r+" vs "+n.bitLength());if(n<0)throw new Error("Supplied uint is negative");return n.toArrayLike(j.Buffer,"be",32)}else if(e.startsWith("int")){if(r=ca(e),r%8||r<8||r>256)throw new Error("Invalid int<N> width: "+r);if(n=I0(t),n.bitLength()>r)throw new Error("Supplied int exceeds width: "+r+" vs "+n.bitLength());return n.toTwos(256).toArrayLike(j.Buffer,"be",32)}else if(e.startsWith("ufixed")){if(r=L2(e),n=I0(t),n<0)throw new Error("Supplied ufixed is negative");return Yi("uint256",n.mul(new In(2).pow(new In(r[1]))))}else if(e.startsWith("fixed"))return r=L2(e),Yi("int256",I0(t).mul(new In(2).pow(new In(r[1]))))}throw new Error("Unsupported or invalid type: "+e)}function _i(e,t,r){typeof e=="string"&&(e=K2(e));var n,i,s,o;if(e.name==="address")return _i(e.rawType,t,r).toArrayLike(j.Buffer,"be",20).toString("hex");if(e.name==="bool")return _i(e.rawType,t,r).toString()===new In(1).toString();if(e.name==="string"){var a=_i(e.rawType,t,r);return j.Buffer.from(a,"utf8").toString()}else if(e.isArray){for(s=[],n=e.size,e.size==="dynamic"&&(r=_i("uint256",t,r).toNumber(),n=_i("uint256",t,r).toNumber(),r=r+32),o=0;o<n;o++){var f=_i(e.subArray,t,r);s.push(f),r+=e.subArray.memoryUsage}return s}else{if(e.name==="bytes")return r=_i("uint256",t,r).toNumber(),n=_i("uint256",t,r).toNumber(),t.slice(r+32,r+32+n);if(e.name.startsWith("bytes"))return t.slice(r,r+e.size);if(e.name.startsWith("uint")){if(i=new In(t.slice(r,r+32),16,"be"),i.bitLength()>e.size)throw new Error("Decoded int exceeds width: "+e.size+" vs "+i.bitLength());return i}else if(e.name.startsWith("int")){if(i=new In(t.slice(r,r+32),16,"be").fromTwos(256),i.bitLength()>e.size)throw new Error("Decoded uint exceeds width: "+e.size+" vs "+i.bitLength());return i}else if(e.name.startsWith("ufixed")){if(n=new In(2).pow(new In(e.size[1])),i=_i("uint256",t,r),!i.mod(n).isZero())throw new Error("Decimals not supported yet");return i.div(n)}else if(e.name.startsWith("fixed")){if(n=new In(2).pow(new In(e.size[1])),i=_i("int256",t,r),!i.mod(n).isZero())throw new Error("Decimals not supported yet");return i.div(n)}}throw new Error("Unsupported or invalid type: "+e.name)}function K2(e){var t,r;if(lc(e)){t=pc(e);var n=e.slice(0,e.lastIndexOf("["));return n=K2(n),r={isArray:!0,name:e,size:t,memoryUsage:t==="dynamic"?32:n.memoryUsage*t,subArray:n},r}else{var i;switch(e){case"address":i="uint160";break;case"bool":i="uint8";break;case"string":i="bytes";break}if(r={rawType:i,name:e,memoryUsage:32},e.startsWith("bytes")&&e!=="bytes"||e.startsWith("uint")||e.startsWith("int")?r.size=ca(e):(e.startsWith("ufixed")||e.startsWith("fixed"))&&(r.size=L2(e)),e.startsWith("bytes")&&e!=="bytes"&&(r.size<1||r.size>32))throw new Error("Invalid bytes<N> width: "+r.size);if((e.startsWith("uint")||e.startsWith("int"))&&(r.size%8||r.size<8||r.size>256))throw new Error("Invalid int/uint<N> width: "+r.size);return r}}function FB(e){return e==="string"||e==="bytes"||pc(e)==="dynamic"}function lc(e){return e.lastIndexOf("]")===e.length-1}$t.rawEncode=function(e,t){var r=[],n=[],i=0;e.forEach(function(l){if(lc(l)){var v=pc(l);v!=="dynamic"?i+=32*v:i+=32}else i+=32});for(var s=0;s<e.length;s++){var o=nd(e[s]),a=t[s],f=Yi(o,a);FB(o)?(r.push(Yi("uint256",i)),n.push(f),i+=f.length):r.push(f)}return j.Buffer.concat(r.concat(n))};$t.rawDecode=function(e,t){var r=[];t=j.Buffer.from(t);for(var n=0,i=0;i<e.length;i++){var s=nd(e[i]),o=K2(s,t,n),a=_i(o,t,n);n+=o.memoryUsage,r.push(a)}return r};$t.simpleEncode=function(e){var t=Array.prototype.slice.call(arguments).slice(1),r=H4(e);if(t.length!==r.args.length)throw new Error("Argument count mismatch");return j.Buffer.concat([$t.methodID(r.method,r.args),$t.rawEncode(r.args,t)])};$t.simpleDecode=function(e,t){var r=H4(e);if(!r.retargs)throw new Error("No return values in method");return $t.rawDecode(r.retargs,t)};function q4(e,t){return e.startsWith("address")||e.startsWith("bytes")?"0x"+t.toString("hex"):t.toString()}$t.stringify=function(e,t){var r=[];for(var n in e){var i=e[n],s=t[n];/^[^\[]+\[.*\]$/.test(i)?s=s.map(function(o){return q4(i,o)}).join(", "):s=q4(i,s),r.push(s)}return r};$t.solidityHexValue=function(e,t,r){var n,i;if(lc(e)){var s=e.replace(/\[.*?\]/,"");if(!lc(s)){var o=pc(e);if(o!=="dynamic"&&o!==0&&t.length>o)throw new Error("Elements exceed array size: "+o)}var a=t.map(function(v){return $t.solidityHexValue(s,v,256)});return j.Buffer.concat(a)}else{if(e==="bytes")return t;if(e==="string")return j.Buffer.from(t,"utf8");if(e==="bool"){r=r||8;var f=Array(r/4).join("0");return j.Buffer.from(t?f+"1":f+"0","hex")}else if(e==="address"){var l=20;return r&&(l=r/8),rd.setLengthLeft(j2(t),l)}else if(e.startsWith("bytes")){if(n=ca(e),n<1||n>32)throw new Error("Invalid bytes<N> width: "+n);return typeof t=="number"&&(t=CB(t)),rd.setLengthRight(j2(t),n)}else if(e.startsWith("uint")){if(n=ca(e),n%8||n<8||n>256)throw new Error("Invalid uint<N> width: "+n);if(i=I0(t),i.bitLength()>n)throw new Error("Supplied uint exceeds width: "+n+" vs "+i.bitLength());return r=r||n,i.toArrayLike(j.Buffer,"be",r/8)}else if(e.startsWith("int")){if(n=ca(e),n%8||n<8||n>256)throw new Error("Invalid int<N> width: "+n);if(i=I0(t),i.bitLength()>n)throw new Error("Supplied int exceeds width: "+n+" vs "+i.bitLength());return r=r||n,i.toTwos(n).toArrayLike(j.Buffer,"be",r/8)}else throw new Error("Unsupported or invalid type: "+e)}};$t.solidityPack=function(e,t){if(e.length!==t.length)throw new Error("Number of types are not matching the values");for(var r=[],n=0;n<e.length;n++){var i=nd(e[n]),s=t[n];r.push($t.solidityHexValue(i,s,null))}return j.Buffer.concat(r)};$t.soliditySHA3=function(e,t){return jo.keccak256($t.solidityPack(e,t))};$t.soliditySHA256=function(e,t){return jo.sha256($t.solidityPack(e,t))};$t.solidityRIPEMD160=function(e,t){return jo.ripemd160($t.solidityPack(e,t),!0)};function NB(e){return e>="0"&&e<="9"}$t.fromSerpent=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(n==="s")t.push("bytes");else if(n==="b"){for(var i="bytes",s=r+1;s<e.length&&NB(e[s]);)i+=e[s]-"0",s++;r=s-1,t.push(i)}else if(n==="i")t.push("int256");else if(n==="a")t.push("int256[]");else throw new Error("Unsupported or invalid type: "+n)}return t};$t.toSerpent=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(n==="bytes")t.push("s");else if(n.startsWith("bytes"))t.push("b"+ca(n));else if(n==="int256")t.push("i");else if(n==="int256[]")t.push("a");else throw new Error("Unsupported or invalid type: "+n)}return t.join("")};k4.exports=$t});var L4=U(ua=>{"use strict";H();k();Object.defineProperty(ua,"__esModule",{value:!0});ua.SoliditySHA3=ua.RawEncode=ua.ABI=void 0;var U2=j4();ua.ABI=U2;function RB(e,t){return U2.rawEncode(e,t)}ua.RawEncode=RB;function OB(e,t){return U2.soliditySHA3(e,t)}ua.SoliditySHA3=OB});var $4=U(bt=>{"use strict";H();k();var DB=bt&&bt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),TB=bt&&bt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),qB=bt&&bt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&DB(t,e,r);return TB(t,e),t},HB=bt&&bt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bt,"__esModule",{value:!0});bt.loadUncompressedPublicKey=bt.loadCompressedPublicKey=bt.publicKeyConvert=bt.publicKeyCreate=bt.publicKeyVerify=bt.privateKeyVerify=bt.loadPublicKey=bt.recover=bt.verifyWithNoRecovery=bt.verify=bt.getV=bt.sign=void 0;var kB=qB(ko()),Sr=new kB.ec("secp256k1"),K4=w0(),Lo=HB(wr());function jB(e,t,r=!0){let n=Sr.sign(Array.from(e),j.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}bt.sign=jB;function LB(e,t,r,n,i=!0){let s=vc(n);if(s==null)throw new Error("pubkey error");let o=Sr.keyPair({pub:{x:s.x,y:s.y}}).getPublic();return Sr.getKeyRecoveryParam(e,{r:t,s:r},o,i)}bt.getV=LB;function KB(e,t,r,n){let i=U4(t,r,e,!0);if(i==null)return!1;let s=V4(n,!0);return s==null?!1:i.equals(s)}bt.verify=KB;function UB(e,t,r){let n=vc(r);if(n==null)throw new Error("pubkey error");let i=Sr.keyPair({pub:{x:n.x,y:n.y}}),s={r:(0,K4.toHex)(t.slice(0,32)),s:(0,K4.toHex)(t.slice(32,64))};return i.verify(e,s)}bt.verifyWithNoRecovery=UB;function U4(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new Lo.default(i.r),o=new Lo.default(i.s);if(s.cmp(Sr.curve.n)>=0||o.cmp(Sr.curve.n)>=0||s.isZero()||o.isZero())return null;let a;try{a=Sr.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return j.Buffer.from(a.encode(null,n))}bt.recover=U4;function vc(e){let t=j.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:z4(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:W4(r,t.subarray(1,33),t.subarray(33,65));default:return null}}bt.loadPublicKey=vc;function VB(e){let t=new Lo.default(Array.from(e));return t.cmp(Sr.curve.n)<0&&!t.isZero()}bt.privateKeyVerify=VB;function zB(e){return vc(e)!==null}bt.publicKeyVerify=zB;function WB(e,t){let r=Sr.keyFromPrivate(Array.from(e),"bytes").getPublic();return j.Buffer.from(r.encode(null,t))}bt.publicKeyCreate=WB;function V4(e,t){let r=vc(e);if(r==null)return null;let n=Sr.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return j.Buffer.from(n.encode(null,t))}bt.publicKeyConvert=V4;function z4(e,t){let r=new Lo.default(Array.from(t));if(r.cmp(Sr.curve.p)>=0)return null;let n=r.toRed(Sr.curve.red),i=n.redSqr().redIMul(n).redIAdd(Sr.curve.b).redSqrt();e===3!==i.isOdd()&&(i=i.redNeg());let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(Sr.curve.b)).isZero()?{x:n,y:i}:null}bt.loadCompressedPublicKey=z4;function W4(e,t,r){let n=new Lo.default(Array.from(t)),i=new Lo.default(Array.from(r));if(n.cmp(Sr.curve.p)>=0||i.cmp(Sr.curve.p)>=0)return null;let s=n.toRed(Sr.curve.red),o=i.toRed(Sr.curve.red);if((e===6||e===7)&&o.isOdd()!==(e===7))return null;let a=s.redSqr().redIMul(s);return o.redSqr().redISub(a.redIAdd(Sr.curve.b)).isZero()?{x:s,y:o}:null}bt.loadUncompressedPublicKey=W4});var Z4=U(qt=>{"use strict";H();k();var $B=qt&&qt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),GB=qt&&qt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),XB=qt&&qt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&$B(t,e,r);return GB(t,e),t},ZB=qt&&qt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qt,"__esModule",{value:!0});qt.fromSecret=qt.fromSeed=qt.privateKeyVerify=qt.publicKeyVerify=qt.publicKeyCreate=qt.verify=qt.sign=qt.ed25519MulBase=void 0;var G4=XB(ko()),YB=w0(),JB=ZB(wr()),Is=new G4.eddsa("ed25519"),X4=Is.curve;function QB(e){let t=Is.curve.g;return Is.encodePoint(t.mul(G4.utils.intFromLE(e)))}qt.ed25519MulBase=QB;function eP(e,t){let r=t;r.length==64&&(r=r.slice(0,32));let i=Is.keyFromSecret(Array.from(r)).sign(Array.from(e)).toBytes();return Uint8Array.from(i)}qt.sign=eP;function tP(e,t,r){return Is.keyFromPublic(Array.from(r)).verify(Array.from(e),Array.from(t))}qt.verify=tP;function rP(e){let t=e;t.length==64&&(t=t.slice(0,32));let r=Is.keyFromSecret(Array.from(t));return Uint8Array.from(r.getPublic())}qt.publicKeyCreate=rP;function nP(e){let t=Is.decodePoint(Array.from(e));return X4.validate(t)}qt.publicKeyVerify=nP;function iP(e){let t=new JB.default(Array.from(e));return t.cmp(X4.n)<0&&!t.isZero()}qt.privateKeyVerify=iP;function sP(e){let t=Is.keyFromSecret(Array.from(e)),r=Uint8Array.from(t.getPublic());return{publicKey:r,secretKey:(0,YB.concatBytes)(e,r)}}qt.fromSeed=sP;function aP(e){let t=e.slice(0,32),r=Is.keyFromSecret(Array.from(t));return{publicKey:Uint8Array.from(r.getPublic()),secretKey:Uint8Array.from(t)}}qt.fromSecret=aP});var e8=U(Ct=>{"use strict";H();k();var oP=Ct&&Ct.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),fP=Ct&&Ct.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),cP=Ct&&Ct.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&oP(t,e,r);return fP(t,e),t},uP=Ct&&Ct.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.loadUncompressedPublicKey=Ct.loadCompressedPublicKey=Ct.publicKeyConvert=Ct.publicKeyCreate=Ct.publicKeyVerify=Ct.privateKeyVerify=Ct.loadPublicKey=Ct.recover=Ct.verify=Ct.sign=void 0;var dP=cP(ko()),Sn=new dP.ec("p256"),Ko=uP(wr());function hP(e,t,r=!0){let n=Sn.sign(Array.from(e),j.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}Ct.sign=hP;function lP(e,t,r,n){let i=Y4(t,r,e,!1);return i==null?!1:i.equals(n)}Ct.verify=lP;function Y4(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new Ko.default(i.r),o=new Ko.default(i.s);if(s.cmp(Sn.curve.n)>=0||o.cmp(Sn.curve.n)>=0||s.isZero()||o.isZero())return null;let a;try{a=Sn.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return j.Buffer.from(a.encode(null,n))}Ct.recover=Y4;function V2(e){let t=j.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:J4(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:Q4(r,t.subarray(1,33),t.subarray(33,65));default:return null}}Ct.loadPublicKey=V2;function pP(e){let t=new Ko.default(Array.from(e));return t.cmp(Sn.curve.n)<0&&!t.isZero()}Ct.privateKeyVerify=pP;function vP(e){return V2(e)!==null}Ct.publicKeyVerify=vP;function bP(e,t){let r=Sn.keyFromPrivate(Array.from(e),"bytes").getPublic();return j.Buffer.from(r.encode(null,t))}Ct.publicKeyCreate=bP;function gP(e,t){let r=V2(e);if(r==null)return null;let n=Sn.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return j.Buffer.from(n.encode(null,t))}Ct.publicKeyConvert=gP;function J4(e,t){let r=new Ko.default(Array.from(t));if(r.cmp(Sn.curve.p)>=0)return null;let n=r.toRed(Sn.curve.red),i=n.redSqr().redIMul(n).redIAdd(Sn.curve.b).redSqrt();return e===3!==i.isOdd()&&(i=i.redNeg()),{x:n,y:i}}Ct.loadCompressedPublicKey=J4;function Q4(e,t,r){let n=new Ko.default(Array.from(t)),i=new Ko.default(Array.from(r));if(n.cmp(Sn.curve.p)>=0||i.cmp(Sn.curve.p)>=0)return null;let s=n.toRed(Sn.curve.red),o=i.toRed(Sn.curve.red);if((e===6||e===7)&&o.isOdd()!==(e===7))return null;let a=s.redSqr().redIMul(s);return o.redSqr().redISub(a.redIAdd(Sn.curve.b)).isZero()?{x:s,y:o}:null}Ct.loadUncompressedPublicKey=Q4});var Ms=U(it=>{"use strict";H();k();Object.defineProperty(it,"__esModule",{value:!0});it.validateObject=it.createHmacDrbg=it.bitMask=it.bitSet=it.bitGet=it.bitLen=it.utf8ToBytes=it.equalBytes=it.concatBytes=it.ensureBytes=it.numberToVarBytesBE=it.numberToBytesLE=it.numberToBytesBE=it.bytesToNumberLE=it.bytesToNumberBE=it.hexToBytes=it.hexToNumber=it.numberToHexUnpadded=it.bytesToHex=void 0;var r8=BigInt(0),id=BigInt(1),yP=BigInt(2),sd=e=>e instanceof Uint8Array,xP=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function W2(e){if(!sd(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=xP[e[r]];return t}it.bytesToHex=W2;function n8(e){let t=e.toString(16);return t.length&1?`0${t}`:t}it.numberToHexUnpadded=n8;function $2(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}it.hexToNumber=$2;function ad(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(e.length%2)throw new Error("hex string is invalid: unpadded "+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("invalid byte sequence");t[r]=s}return t}it.hexToBytes=ad;function mP(e){return $2(W2(e))}it.bytesToNumberBE=mP;function wP(e){if(!sd(e))throw new Error("Uint8Array expected");return $2(W2(Uint8Array.from(e).reverse()))}it.bytesToNumberLE=wP;var SP=(e,t)=>ad(e.toString(16).padStart(t*2,"0"));it.numberToBytesBE=SP;var EP=(e,t)=>(0,it.numberToBytesBE)(e,t).reverse();it.numberToBytesLE=EP;var _P=e=>ad(n8(e));it.numberToVarBytesBE=_P;function AP(e,t,r){let n;if(typeof t=="string")try{n=ad(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(sd(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${e} expected ${r} bytes, got ${i}`);return n}it.ensureBytes=AP;function i8(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!sd(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}it.concatBytes=i8;function BP(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}it.equalBytes=BP;function PP(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}it.utf8ToBytes=PP;function IP(e){let t;for(t=0;e>r8;e>>=id,t+=1);return t}it.bitLen=IP;var MP=(e,t)=>e>>BigInt(t)&id;it.bitGet=MP;var CP=(e,t,r)=>e|(r?id:r8)<<BigInt(t);it.bitSet=CP;var FP=e=>(yP<<BigInt(e-1))-id;it.bitMask=FP;var z2=e=>new Uint8Array(e),t8=e=>Uint8Array.from(e);function NP(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=z2(e),i=z2(e),s=0,o=()=>{n.fill(1),i.fill(0),s=0},a=(...p)=>r(i,n,...p),f=(p=z2())=>{i=a(t8([0]),p),n=a(),p.length!==0&&(i=a(t8([1]),p),n=a())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let p=0,u=[];for(;p<t;){n=a();let h=n.slice();u.push(h),p+=n.length}return i8(...u)};return(p,u)=>{o(),f(p);let h;for(;!(h=u(l()));)f();return o(),h}}it.createHmacDrbg=NP;var RP={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function OP(e,t,r={}){let n=(i,s,o)=>{let a=RP[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);let f=e[i];if(!(o&&f===void 0)&&!a(f,e))throw new Error(`Invalid param ${String(i)}=${f} (${typeof f}), expected ${s}`)};for(let[i,s]of Object.entries(t))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return e}it.validateObject=OP});var M0=U(ut=>{"use strict";H();k();Object.defineProperty(ut,"__esModule",{value:!0});ut.hashToPrivateScalar=ut.FpSqrtEven=ut.FpSqrtOdd=ut.Field=ut.nLength=ut.FpIsSquare=ut.FpDiv=ut.FpInvertBatch=ut.FpPow=ut.validateField=ut.isNegativeLE=ut.FpSqrt=ut.tonelliShanks=ut.invert=ut.pow2=ut.pow=ut.mod=void 0;var Cs=Ms(),Er=BigInt(0),Kt=BigInt(1),da=BigInt(2),DP=BigInt(3),G2=BigInt(4),s8=BigInt(5),a8=BigInt(8),TP=BigInt(9),qP=BigInt(16);function zn(e,t){let r=e%t;return r>=Er?r:t+r}ut.mod=zn;function o8(e,t,r){if(r<=Er||t<Er)throw new Error("Expected power/modulo > 0");if(r===Kt)return Er;let n=Kt;for(;t>Er;)t&Kt&&(n=n*e%r),e=e*e%r,t>>=Kt;return n}ut.pow=o8;function HP(e,t,r){let n=e;for(;t-- >Er;)n*=n,n%=r;return n}ut.pow2=HP;function od(e,t){if(e===Er||t<=Er)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=zn(e,t),n=t,i=Er,s=Kt,o=Kt,a=Er;for(;r!==Er;){let l=n/r,v=n%r,p=i-o*l,u=s-a*l;n=r,r=v,i=o,s=a,o=p,a=u}if(n!==Kt)throw new Error("invert: does not exist");return zn(i,t)}ut.invert=od;function f8(e){let t=(e-Kt)/da,r,n,i;for(r=e-Kt,n=0;r%da===Er;r/=da,n++);for(i=da;i<e&&o8(i,t,e)!==e-Kt;i++);if(n===1){let o=(e+Kt)/G2;return function(f,l){let v=f.pow(l,o);if(!f.eql(f.sqr(v),l))throw new Error("Cannot find square root");return v}}let s=(r+Kt)/da;return function(a,f){if(a.pow(f,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=n,v=a.pow(a.mul(a.ONE,i),r),p=a.pow(f,s),u=a.pow(f,r);for(;!a.eql(u,a.ONE);){if(a.eql(u,a.ZERO))return a.ZERO;let h=1;for(let d=a.sqr(u);h<l&&!a.eql(d,a.ONE);h++)d=a.sqr(d);let b=a.pow(v,Kt<<BigInt(l-h-1));v=a.sqr(b),p=a.mul(p,b),u=a.mul(u,v),l=h}return p}}ut.tonelliShanks=f8;function c8(e){if(e%G2===DP){let t=(e+Kt)/G2;return function(n,i){let s=n.pow(i,t);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(e%a8===s8){let t=(e-s8)/a8;return function(n,i){let s=n.mul(i,da),o=n.pow(s,t),a=n.mul(i,o),f=n.mul(n.mul(a,da),o),l=n.mul(a,n.sub(f,n.ONE));if(!n.eql(n.sqr(l),i))throw new Error("Cannot find square root");return l}}return e%qP,f8(e)}ut.FpSqrt=c8;var kP=(e,t)=>(zn(e,t)&Kt)===Kt;ut.isNegativeLE=kP;var jP=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function LP(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=jP.reduce((n,i)=>(n[i]="function",n),t);return(0,Cs.validateObject)(e,r)}ut.validateField=LP;function u8(e,t,r){if(r<Er)throw new Error("Expected power > 0");if(r===Er)return e.ONE;if(r===Kt)return t;let n=e.ONE,i=t;for(;r>Er;)r&Kt&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Kt;return n}ut.FpPow=u8;function d8(e,t){let r=new Array(t.length),n=t.reduce((s,o,a)=>e.is0(o)?s:(r[a]=s,e.mul(s,o)),e.ONE),i=e.inv(n);return t.reduceRight((s,o,a)=>e.is0(o)?s:(r[a]=e.mul(s,r[a]),e.mul(s,o)),i),r}ut.FpInvertBatch=d8;function KP(e,t,r){return e.mul(t,typeof r=="bigint"?od(r,e.ORDER):e.inv(r))}ut.FpDiv=KP;function UP(e){let t=(e.ORDER-Kt)/da;return r=>{let n=e.pow(r,t);return e.eql(n,e.ZERO)||e.eql(n,e.ONE)}}ut.FpIsSquare=UP;function X2(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}ut.nLength=X2;function VP(e,t,r=!1,n={}){if(e<=Er)throw new Error(`Expected Fp ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:s}=X2(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=c8(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:s,MASK:(0,Cs.bitMask)(i),ZERO:Er,ONE:Kt,create:f=>zn(f,e),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return Er<=f&&f<e},is0:f=>f===Er,isOdd:f=>(f&Kt)===Kt,neg:f=>zn(-f,e),eql:(f,l)=>f===l,sqr:f=>zn(f*f,e),add:(f,l)=>zn(f+l,e),sub:(f,l)=>zn(f-l,e),mul:(f,l)=>zn(f*l,e),pow:(f,l)=>u8(a,f,l),div:(f,l)=>zn(f*od(l,e),e),sqrN:f=>f*f,addN:(f,l)=>f+l,subN:(f,l)=>f-l,mulN:(f,l)=>f*l,inv:f=>od(f,e),sqrt:n.sqrt||(f=>o(a,f)),invertBatch:f=>d8(a,f),cmov:(f,l,v)=>v?l:f,toBytes:f=>r?(0,Cs.numberToBytesLE)(f,s):(0,Cs.numberToBytesBE)(f,s),fromBytes:f=>{if(f.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${f.length}`);return r?(0,Cs.bytesToNumberLE)(f):(0,Cs.bytesToNumberBE)(f)}});return Object.freeze(a)}ut.Field=VP;function zP(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)}ut.FpSqrtOdd=zP;function WP(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}ut.FpSqrtEven=WP;function $P(e,t,r=!1){e=(0,Cs.ensureBytes)("privateHash",e);let n=e.length,i=X2(t).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let s=r?(0,Cs.bytesToNumberLE)(e):(0,Cs.bytesToNumberBE)(e);return zn(s,t-Kt)+Kt}ut.hashToPrivateScalar=$P});var l8=U(Uo=>{"use strict";H();k();Object.defineProperty(Uo,"__esModule",{value:!0});Uo.validateBasic=Uo.wNAF=void 0;var h8=M0(),GP=Ms(),XP=BigInt(0),Z2=BigInt(1);function ZP(e,t){let r=(i,s)=>{let o=s.negate();return i?o:s},n=i=>{let s=Math.ceil(t/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:r,unsafeLadder(i,s){let o=e.ZERO,a=i;for(;s>XP;)s&Z2&&(o=o.add(a)),a=a.double(),s>>=Z2;return o},precomputeWindow(i,s){let{windows:o,windowSize:a}=n(s),f=[],l=i,v=l;for(let p=0;p<o;p++){v=l,f.push(v);for(let u=1;u<a;u++)v=v.add(l),f.push(v);l=v.double()}return f},wNAF(i,s,o){let{windows:a,windowSize:f}=n(i),l=e.ZERO,v=e.BASE,p=BigInt(2**i-1),u=2**i,h=BigInt(i);for(let b=0;b<a;b++){let d=b*f,y=Number(o&p);o>>=h,y>f&&(y-=u,o+=Z2);let w=d,_=d+Math.abs(y)-1,I=b%2!==0,N=y<0;y===0?v=v.add(r(I,s[w])):l=l.add(r(N,s[_]))}return{p:l,f:v}},wNAFCached(i,s,o,a){let f=i._WINDOW_SIZE||1,l=s.get(i);return l||(l=this.precomputeWindow(i,f),f!==1&&s.set(i,a(l))),this.wNAF(f,l,o)}}}Uo.wNAF=ZP;function YP(e){return(0,h8.validateField)(e.Fp),(0,GP.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,h8.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}Uo.validateBasic=YP});var cd=U(Ut=>{"use strict";H();k();var JP=Ut&&Ut.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),QP=Ut&&Ut.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),v8=Ut&&Ut.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&JP(t,e,r);return QP(t,e),t};Object.defineProperty(Ut,"__esModule",{value:!0});Ut.mapToCurveSimpleSWU=Ut.SWUFpSqrtRatio=Ut.weierstrass=Ut.weierstrassPoints=Ut.DER=void 0;var bc=v8(M0()),lr=v8(Ms()),Ji=Ms(),Y2=l8();function eI(e){let t=(0,Y2.validateBasic)(e);lr.validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:tI,hexToBytes:rI}=lr;Ut.DER={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=Ut.DER;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:tI(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=Ut.DER,r=typeof e=="string"?rI(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:i,l:s}=Ut.DER._parseInt(r.subarray(2)),{d:o,l:a}=Ut.DER._parseInt(s);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(e){let t=l=>Number.parseInt(l[0],16)&8?"00"+l:l,r=l=>{let v=l.toString(16);return v.length&1?`0${v}`:v},n=t(r(e.s)),i=t(r(e.r)),s=n.length/2,o=i.length/2,a=r(s),f=r(o);return`30${r(o+s+4)}02${f}${i}02${a}${n}`}};var Ai=BigInt(0),sr=BigInt(1),ha=BigInt(2),fd=BigInt(3),p8=BigInt(4);function b8(e){let t=eI(e),{Fp:r}=t,n=t.toBytes||((b,d,y)=>{let w=d.toAffine();return lr.concatBytes(Uint8Array.from([4]),r.toBytes(w.x),r.toBytes(w.y))}),i=t.fromBytes||(b=>{let d=b.subarray(1),y=r.fromBytes(d.subarray(0,r.BYTES)),w=r.fromBytes(d.subarray(r.BYTES,2*r.BYTES));return{x:y,y:w}});function s(b){let{a:d,b:y}=t,w=r.sqr(b),_=r.mul(w,b);return r.add(r.add(_,r.mul(b,d)),y)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function o(b){return typeof b=="bigint"&&Ai<b&&b<t.n}function a(b){if(!o(b))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(b){let{allowedPrivateKeyLengths:d,nByteLength:y,wrapPrivateKey:w,n:_}=t;if(d&&typeof b!="bigint"){if(b instanceof Uint8Array&&(b=lr.bytesToHex(b)),typeof b!="string"||!d.includes(b.length))throw new Error("Invalid key");b=b.padStart(y*2,"0")}let I;try{I=typeof b=="bigint"?b:lr.bytesToNumberBE((0,Ji.ensureBytes)("private key",b,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof b}`)}return w&&(I=bc.mod(I,_)),a(I),I}let l=new Map;function v(b){if(!(b instanceof p))throw new Error("ProjectivePoint expected")}class p{constructor(d,y,w){if(this.px=d,this.py=y,this.pz=w,d==null||!r.isValid(d))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(w==null||!r.isValid(w))throw new Error("z required")}static fromAffine(d){let{x:y,y:w}=d||{};if(!d||!r.isValid(y)||!r.isValid(w))throw new Error("invalid affine point");if(d instanceof p)throw new Error("projective point not allowed");let _=I=>r.eql(I,r.ZERO);return _(y)&&_(w)?p.ZERO:new p(y,w,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){let y=r.invertBatch(d.map(w=>w.pz));return d.map((w,_)=>w.toAffine(y[_])).map(p.fromAffine)}static fromHex(d){let y=p.fromAffine(i((0,Ji.ensureBytes)("pointHex",d)));return y.assertValidity(),y}static fromPrivateKey(d){return p.BASE.multiply(f(d))}_setWindowSize(d){this._WINDOW_SIZE=d,l.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}let{x:d,y}=this.toAffine();if(!r.isValid(d)||!r.isValid(y))throw new Error("bad point: x or y not FE");let w=r.sqr(y),_=s(d);if(!r.eql(w,_))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:d}=this.toAffine();if(r.isOdd)return!r.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){v(d);let{px:y,py:w,pz:_}=this,{px:I,py:N,pz:F}=d,O=r.eql(r.mul(y,F),r.mul(I,_)),q=r.eql(r.mul(w,F),r.mul(N,_));return O&&q}negate(){return new p(this.px,r.neg(this.py),this.pz)}double(){let{a:d,b:y}=t,w=r.mul(y,fd),{px:_,py:I,pz:N}=this,F=r.ZERO,O=r.ZERO,q=r.ZERO,P=r.mul(_,_),D=r.mul(I,I),A=r.mul(N,N),c=r.mul(_,I);return c=r.add(c,c),q=r.mul(_,N),q=r.add(q,q),F=r.mul(d,q),O=r.mul(w,A),O=r.add(F,O),F=r.sub(D,O),O=r.add(D,O),O=r.mul(F,O),F=r.mul(c,F),q=r.mul(w,q),A=r.mul(d,A),c=r.sub(P,A),c=r.mul(d,c),c=r.add(c,q),q=r.add(P,P),P=r.add(q,P),P=r.add(P,A),P=r.mul(P,c),O=r.add(O,P),A=r.mul(I,N),A=r.add(A,A),P=r.mul(A,c),F=r.sub(F,P),q=r.mul(A,D),q=r.add(q,q),q=r.add(q,q),new p(F,O,q)}add(d){v(d);let{px:y,py:w,pz:_}=this,{px:I,py:N,pz:F}=d,O=r.ZERO,q=r.ZERO,P=r.ZERO,D=t.a,A=r.mul(t.b,fd),c=r.mul(y,I),m=r.mul(w,N),S=r.mul(_,F),g=r.add(y,w),E=r.add(I,N);g=r.mul(g,E),E=r.add(c,m),g=r.sub(g,E),E=r.add(y,_);let M=r.add(I,F);return E=r.mul(E,M),M=r.add(c,S),E=r.sub(E,M),M=r.add(w,_),O=r.add(N,F),M=r.mul(M,O),O=r.add(m,S),M=r.sub(M,O),P=r.mul(D,E),O=r.mul(A,S),P=r.add(O,P),O=r.sub(m,P),P=r.add(m,P),q=r.mul(O,P),m=r.add(c,c),m=r.add(m,c),S=r.mul(D,S),E=r.mul(A,E),m=r.add(m,S),S=r.sub(c,S),S=r.mul(D,S),E=r.add(E,S),c=r.mul(m,E),q=r.add(q,c),c=r.mul(M,E),O=r.mul(g,O),O=r.sub(O,c),c=r.mul(g,m),P=r.mul(M,P),P=r.add(P,c),new p(O,q,P)}subtract(d){return this.add(d.negate())}is0(){return this.equals(p.ZERO)}wNAF(d){return h.wNAFCached(this,l,d,y=>{let w=r.invertBatch(y.map(_=>_.pz));return y.map((_,I)=>_.toAffine(w[I])).map(p.fromAffine)})}multiplyUnsafe(d){let y=p.ZERO;if(d===Ai)return y;if(a(d),d===sr)return this;let{endo:w}=t;if(!w)return h.unsafeLadder(this,d);let{k1neg:_,k1:I,k2neg:N,k2:F}=w.splitScalar(d),O=y,q=y,P=this;for(;I>Ai||F>Ai;)I&sr&&(O=O.add(P)),F&sr&&(q=q.add(P)),P=P.double(),I>>=sr,F>>=sr;return _&&(O=O.negate()),N&&(q=q.negate()),q=new p(r.mul(q.px,w.beta),q.py,q.pz),O.add(q)}multiply(d){a(d);let y=d,w,_,{endo:I}=t;if(I){let{k1neg:N,k1:F,k2neg:O,k2:q}=I.splitScalar(y),{p:P,f:D}=this.wNAF(F),{p:A,f:c}=this.wNAF(q);P=h.constTimeNegate(N,P),A=h.constTimeNegate(O,A),A=new p(r.mul(A.px,I.beta),A.py,A.pz),w=P.add(A),_=D.add(c)}else{let{p:N,f:F}=this.wNAF(y);w=N,_=F}return p.normalizeZ([w,_])[0]}multiplyAndAddUnsafe(d,y,w){let _=p.BASE,I=(F,O)=>O===Ai||O===sr||!F.equals(_)?F.multiplyUnsafe(O):F.multiply(O),N=I(this,y).add(I(d,w));return N.is0()?void 0:N}toAffine(d){let{px:y,py:w,pz:_}=this,I=this.is0();d==null&&(d=I?r.ONE:r.inv(_));let N=r.mul(y,d),F=r.mul(w,d),O=r.mul(_,d);if(I)return{x:r.ZERO,y:r.ZERO};if(!r.eql(O,r.ONE))throw new Error("invZ was invalid");return{x:N,y:F}}isTorsionFree(){let{h:d,isTorsionFree:y}=t;if(d===sr)return!0;if(y)return y(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:d,clearCofactor:y}=t;return d===sr?this:y?y(p,this):this.multiplyUnsafe(t.h)}toRawBytes(d=!0){return this.assertValidity(),n(p,this,d)}toHex(d=!0){return lr.bytesToHex(this.toRawBytes(d))}}p.BASE=new p(t.Gx,t.Gy,r.ONE),p.ZERO=new p(r.ZERO,r.ONE,r.ZERO);let u=t.nBitLength,h=(0,Y2.wNAF)(p,t.endo?Math.ceil(u/2):u);return{CURVE:t,ProjectivePoint:p,normPrivateKeyToScalar:f,weierstrassEquation:s,isWithinCurveOrder:o}}Ut.weierstrassPoints=b8;function nI(e){let t=(0,Y2.validateBasic)(e);return lr.validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function iI(e){let t=nI(e),{Fp:r,n}=t,i=r.BYTES+1,s=2*r.BYTES+1;function o(E){return Ai<E&&E<r.ORDER}function a(E){return bc.mod(E,n)}function f(E){return bc.invert(E,n)}let{ProjectivePoint:l,normPrivateKeyToScalar:v,weierstrassEquation:p,isWithinCurveOrder:u}=b8({...t,toBytes(E,M,T){let R=M.toAffine(),x=r.toBytes(R.x),C=lr.concatBytes;return T?C(Uint8Array.from([M.hasEvenY()?2:3]),x):C(Uint8Array.from([4]),x,r.toBytes(R.y))},fromBytes(E){let M=E.length,T=E[0],R=E.subarray(1);if(M===i&&(T===2||T===3)){let x=lr.bytesToNumberBE(R);if(!o(x))throw new Error("Point is not on curve");let C=p(x),K=r.sqrt(C),L=(K&sr)===sr;return(T&1)===1!==L&&(K=r.neg(K)),{x,y:K}}else if(M===s&&T===4){let x=r.fromBytes(R.subarray(0,r.BYTES)),C=r.fromBytes(R.subarray(r.BYTES,2*r.BYTES));return{x,y:C}}else throw new Error(`Point of length ${M} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),h=E=>lr.bytesToHex(lr.numberToBytesBE(E,t.nByteLength));function b(E){let M=n>>sr;return E>M}function d(E){return b(E)?a(-E):E}let y=(E,M,T)=>lr.bytesToNumberBE(E.slice(M,T));class w{constructor(M,T,R){this.r=M,this.s=T,this.recovery=R,this.assertValidity()}static fromCompact(M){let T=t.nByteLength;return M=(0,Ji.ensureBytes)("compactSignature",M,T*2),new w(y(M,0,T),y(M,T,2*T))}static fromDER(M){let{r:T,s:R}=Ut.DER.toSig((0,Ji.ensureBytes)("DER",M));return new w(T,R)}assertValidity(){if(!u(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!u(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(M){return new w(this.r,this.s,M)}recoverPublicKey(M){let{r:T,s:R,recovery:x}=this,C=q((0,Ji.ensureBytes)("msgHash",M));if(x==null||![0,1,2,3].includes(x))throw new Error("recovery id invalid");let K=x===2||x===3?T+t.n:T;if(K>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let L=(x&1)===0?"02":"03",V=l.fromHex(L+h(K)),z=f(K),G=a(-C*z),$=a(R*z),oe=l.BASE.multiplyAndAddUnsafe(V,G,$);if(!oe)throw new Error("point at infinify");return oe.assertValidity(),oe}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return lr.hexToBytes(this.toDERHex())}toDERHex(){return Ut.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return lr.hexToBytes(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}let _={isValidPrivateKey(E){try{return v(E),!0}catch{return!1}},normPrivateKeyToScalar:v,randomPrivateKey:()=>{let E=t.randomBytes(r.BYTES+8),M=bc.hashToPrivateScalar(E,n);return lr.numberToBytesBE(M,t.nByteLength)},precompute(E=8,M=l.BASE){return M._setWindowSize(E),M.multiply(BigInt(3)),M}};function I(E,M=!0){return l.fromPrivateKey(E).toRawBytes(M)}function N(E){let M=E instanceof Uint8Array,T=typeof E=="string",R=(M||T)&&E.length;return M?R===i||R===s:T?R===2*i||R===2*s:E instanceof l}function F(E,M,T=!0){if(N(E))throw new Error("first arg must be private key");if(!N(M))throw new Error("second arg must be public key");return l.fromHex(M).multiply(v(E)).toRawBytes(T)}let O=t.bits2int||function(E){let M=lr.bytesToNumberBE(E),T=E.length*8-t.nBitLength;return T>0?M>>BigInt(T):M},q=t.bits2int_modN||function(E){return a(O(E))},P=lr.bitMask(t.nBitLength);function D(E){if(typeof E!="bigint")throw new Error("bigint expected");if(!(Ai<=E&&E<P))throw new Error(`bigint expected < 2^${t.nBitLength}`);return lr.numberToBytesBE(E,t.nByteLength)}function A(E,M,T=c){if(["recovered","canonical"].some(te=>te in T))throw new Error("sign() legacy options not supported");let{hash:R,randomBytes:x}=t,{lowS:C,prehash:K,extraEntropy:L}=T;C==null&&(C=!0),E=(0,Ji.ensureBytes)("msgHash",E),K&&(E=(0,Ji.ensureBytes)("prehashed msgHash",R(E)));let V=q(E),z=v(M),G=[D(z),D(V)];if(L!=null){let te=L===!0?x(r.BYTES):L;G.push((0,Ji.ensureBytes)("extraEntropy",te,r.BYTES))}let $=lr.concatBytes(...G),oe=V;function Q(te){let ve=O(te);if(!u(ve))return;let J=f(ve),Z=l.BASE.multiply(ve).toAffine(),Ce=a(Z.x);if(Ce===Ai)return;let se=a(J*a(oe+Ce*z));if(se===Ai)return;let re=(Z.x===Ce?0:2)|Number(Z.y&sr),ft=se;return C&&b(se)&&(ft=d(se),re^=1),new w(Ce,ft,re)}return{seed:$,k2sig:Q}}let c={lowS:t.lowS,prehash:!1},m={lowS:t.lowS,prehash:!1};function S(E,M,T=c){let{seed:R,k2sig:x}=A(E,M,T),C=t;return lr.createHmacDrbg(C.hash.outputLen,C.nByteLength,C.hmac)(R,x)}l.BASE._setWindowSize(8);function g(E,M,T,R=m){let x=E;if(M=(0,Ji.ensureBytes)("msgHash",M),T=(0,Ji.ensureBytes)("publicKey",T),"strict"in R)throw new Error("options.strict was renamed to lowS");let{lowS:C,prehash:K}=R,L,V;try{if(typeof x=="string"||x instanceof Uint8Array)try{L=w.fromDER(x)}catch(Z){if(!(Z instanceof Ut.DER.Err))throw Z;L=w.fromCompact(x)}else if(typeof x=="object"&&typeof x.r=="bigint"&&typeof x.s=="bigint"){let{r:Z,s:Ce}=x;L=new w(Z,Ce)}else throw new Error("PARSE");V=l.fromHex(T)}catch(Z){if(Z.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(C&&L.hasHighS())return!1;K&&(M=t.hash(M));let{r:z,s:G}=L,$=q(M),oe=f(G),Q=a($*oe),te=a(z*oe),ve=l.BASE.multiplyAndAddUnsafe(V,Q,te)?.toAffine();return ve?a(ve.x)===z:!1}return{CURVE:t,getPublicKey:I,getSharedSecret:F,sign:S,verify:g,ProjectivePoint:l,Signature:w,utils:_}}Ut.weierstrass=iI;function g8(e,t){let r=e.ORDER,n=Ai;for(let b=r-sr;b%ha===Ai;b/=ha)n+=sr;let i=n,s=ha<<i-sr-sr,o=s*ha,a=(r-sr)/o,f=(a-sr)/ha,l=o-sr,v=s,p=e.pow(t,a),u=e.pow(t,(a+sr)/ha),h=(b,d)=>{let y=p,w=e.pow(d,l),_=e.sqr(w);_=e.mul(_,d);let I=e.mul(b,_);I=e.pow(I,f),I=e.mul(I,w),w=e.mul(I,d),_=e.mul(I,b);let N=e.mul(_,w);I=e.pow(N,v);let F=e.eql(I,e.ONE);w=e.mul(_,u),I=e.mul(N,y),_=e.cmov(w,_,F),N=e.cmov(I,N,F);for(let O=i;O>sr;O--){let q=O-ha;q=ha<<q-sr;let P=e.pow(N,q),D=e.eql(P,e.ONE);w=e.mul(_,y),y=e.mul(y,y),P=e.mul(N,y),_=e.cmov(w,_,D),N=e.cmov(P,N,D)}return{isValid:F,value:_}};if(e.ORDER%p8===fd){let b=(e.ORDER-fd)/p8,d=e.sqrt(e.neg(t));h=(y,w)=>{let _=e.sqr(w),I=e.mul(y,w);_=e.mul(_,I);let N=e.pow(_,b);N=e.mul(N,I);let F=e.mul(N,d),O=e.mul(e.sqr(N),w),q=e.eql(O,y),P=e.cmov(F,N,q);return{isValid:q,value:P}}}return h}Ut.SWUFpSqrtRatio=g8;function sI(e,t){if(bc.validateField(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let r=g8(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,o,a,f,l,v,p;i=e.sqr(n),i=e.mul(i,t.Z),s=e.sqr(i),s=e.add(s,i),o=e.add(s,e.ONE),o=e.mul(o,t.B),a=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),a=e.mul(a,t.A),s=e.sqr(o),l=e.sqr(a),f=e.mul(l,t.A),s=e.add(s,f),s=e.mul(s,o),l=e.mul(l,a),f=e.mul(l,t.B),s=e.add(s,f),v=e.mul(i,o);let{isValid:u,value:h}=r(s,l);p=e.mul(i,n),p=e.mul(p,h),v=e.cmov(v,o,u),p=e.cmov(p,h,u);let b=e.isOdd(n)===e.isOdd(p);return p=e.cmov(e.neg(p),p,b),v=e.div(v,a),{x:v,y:p}}}Ut.mapToCurveSimpleSWU=sI});var m8=U(Wn=>{"use strict";H();k();Object.defineProperty(Wn,"__esModule",{value:!0});Wn.createHasher=Wn.isogenyMap=Wn.hash_to_field=Wn.expand_message_xof=Wn.expand_message_xmd=void 0;var aI=M0(),Bi=Ms();function oI(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")return(0,Bi.utf8ToBytes)(e);throw new Error("DST must be Uint8Array or string")}var fI=Bi.bytesToNumberBE;function la(e,t){if(e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);let r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=e&255,e>>>=8;return new Uint8Array(r)}function cI(e,t){let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}function gc(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected")}function Q2(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function y8(e,t,r,n){gc(e),gc(t),Q2(r),t.length>255&&(t=n((0,Bi.concatBytes)((0,Bi.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:i,blockLen:s}=n,o=Math.ceil(r/i);if(o>255)throw new Error("Invalid xmd length");let a=(0,Bi.concatBytes)(t,la(t.length,1)),f=la(0,s),l=la(r,2),v=new Array(o),p=n((0,Bi.concatBytes)(f,e,l,la(0,1),a));v[0]=n((0,Bi.concatBytes)(p,la(1,1),a));for(let h=1;h<=o;h++){let b=[cI(p,v[h-1]),la(h+1,1),a];v[h]=n((0,Bi.concatBytes)(...b))}return(0,Bi.concatBytes)(...v).slice(0,r)}Wn.expand_message_xmd=y8;function x8(e,t,r,n,i){if(gc(e),gc(t),Q2(r),t.length>255){let s=Math.ceil(2*n/8);t=i.create({dkLen:s}).update((0,Bi.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(e).update(la(r,2)).update(t).update(la(t.length,1)).digest()}Wn.expand_message_xof=x8;function J2(e,t,r){(0,Bi.validateObject)(r,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:i,m:s,hash:o,expand:a,DST:f}=r;gc(e),Q2(t);let l=oI(f),v=n.toString(2).length,p=Math.ceil((v+i)/8),u=t*s*p,h;if(a==="xmd")h=y8(e,l,u,o);else if(a==="xof")h=x8(e,l,u,i,o);else if(a==="_internal_pass")h=e;else throw new Error('expand must be "xmd" or "xof"');let b=new Array(t);for(let d=0;d<t;d++){let y=new Array(s);for(let w=0;w<s;w++){let _=p*(w+d*s),I=h.subarray(_,_+p);y[w]=(0,aI.mod)(fI(I),n)}b[d]=y}return b}Wn.hash_to_field=J2;function uI(e,t){let r=t.map(n=>Array.from(n).reverse());return(n,i)=>{let[s,o,a,f]=r.map(l=>l.reduce((v,p)=>e.add(e.mul(v,n),p)));return n=e.div(s,o),i=e.mul(i,e.div(a,f)),{x:n,y:i}}}Wn.isogenyMap=uI;function dI(e,t,r){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){let s=J2(n,2,{...r,DST:r.DST,...i}),o=e.fromAffine(t(s[0])),a=e.fromAffine(t(s[1])),f=o.add(a).clearCofactor();return f.assertValidity(),f},encodeToCurve(n,i){let s=J2(n,1,{...r,DST:r.encodeDST,...i}),o=e.fromAffine(t(s[0])).clearCofactor();return o.assertValidity(),o}}}Wn.createHasher=dI});var ep=U(Vo=>{"use strict";H();k();Object.defineProperty(Vo,"__esModule",{value:!0});Vo.createCurve=Vo.getHash=void 0;var hI=nc(),w8=$r(),lI=cd();function S8(e){return{hash:e,hmac:(t,...r)=>(0,hI.hmac)(e,t,(0,w8.concatBytes)(...r)),randomBytes:w8.randomBytes}}Vo.getHash=S8;function pI(e,t){let r=n=>(0,lI.weierstrass)({...e,...S8(n)});return Object.freeze({...r(t),create:r})}Vo.createCurve=pI});var N8=U(pr=>{"use strict";H();k();var vI=pr&&pr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),bI=pr&&pr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),gI=pr&&pr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&vI(t,e,r);return bI(t,e),t},tp;Object.defineProperty(pr,"__esModule",{value:!0});pr.encodeToCurve=pr.hashToCurve=pr.schnorr=pr.secp256k1=void 0;var ud=yo(),yI=$r(),Dr=M0(),xI=cd(),nn=Ms(),A8=gI(m8()),mI=ep(),pd=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),dd=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),B8=BigInt(1),hd=BigInt(2),E8=(e,t)=>(e+t/hd)/t;function P8(e){let t=pd,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),f=BigInt(88),l=e*e*e%t,v=l*l*e%t,p=(0,Dr.pow2)(v,r,t)*v%t,u=(0,Dr.pow2)(p,r,t)*v%t,h=(0,Dr.pow2)(u,hd,t)*l%t,b=(0,Dr.pow2)(h,i,t)*h%t,d=(0,Dr.pow2)(b,s,t)*b%t,y=(0,Dr.pow2)(d,a,t)*d%t,w=(0,Dr.pow2)(y,f,t)*y%t,_=(0,Dr.pow2)(w,a,t)*d%t,I=(0,Dr.pow2)(_,r,t)*v%t,N=(0,Dr.pow2)(I,o,t)*b%t,F=(0,Dr.pow2)(N,n,t)*l%t,O=(0,Dr.pow2)(F,hd,t);if(!pa.eql(pa.sqr(O),e))throw new Error("Cannot find square root");return O}var pa=(0,Dr.Field)(pd,void 0,void 0,{sqrt:P8});pr.secp256k1=(0,mI.createCurve)({a:BigInt(0),b:BigInt(7),Fp:pa,n:dd,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=dd,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-B8*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=E8(s*e,t),f=E8(-n*e,t),l=(0,Dr.mod)(e-a*r-f*i,t),v=(0,Dr.mod)(-a*n-f*s,t),p=l>o,u=v>o;if(p&&(l=t-l),u&&(v=t-v),l>o||v>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:p,k1:l,k2neg:u,k2:v}}}},ud.sha256);var vd=BigInt(0),I8=e=>typeof e=="bigint"&&vd<e&&e<pd,wI=e=>typeof e=="bigint"&&vd<e&&e<dd,_8={};function ld(e,...t){let r=_8[e];if(r===void 0){let n=(0,ud.sha256)(Uint8Array.from(e,i=>i.charCodeAt(0)));r=(0,nn.concatBytes)(n,n),_8[e]=r}return(0,ud.sha256)((0,nn.concatBytes)(r,...t))}var sp=e=>e.toRawBytes(!0).slice(1),np=e=>(0,nn.numberToBytesBE)(e,32),rp=e=>(0,Dr.mod)(e,pd),yc=e=>(0,Dr.mod)(e,dd),ap=pr.secp256k1.ProjectivePoint,SI=(e,t,r)=>ap.BASE.multiplyAndAddUnsafe(e,t,r);function ip(e){let t=pr.secp256k1.utils.normPrivateKeyToScalar(e),r=ap.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:yc(-t),bytes:sp(r)}}function M8(e){if(!I8(e))throw new Error("bad x: need 0 < x < p");let t=rp(e*e),r=rp(t*e+BigInt(7)),n=P8(r);n%hd!==vd&&(n=rp(-n));let i=new ap(e,n,B8);return i.assertValidity(),i}function C8(...e){return yc((0,nn.bytesToNumberBE)(ld("BIP0340/challenge",...e)))}function EI(e){return ip(e).bytes}function _I(e,t,r=(0,yI.randomBytes)(32)){let n=(0,nn.ensureBytes)("message",e),{bytes:i,scalar:s}=ip(t),o=(0,nn.ensureBytes)("auxRand",r,32),a=np(s^(0,nn.bytesToNumberBE)(ld("BIP0340/aux",o))),f=ld("BIP0340/nonce",a,i,n),l=yc((0,nn.bytesToNumberBE)(f));if(l===vd)throw new Error("sign failed: k is zero");let{bytes:v,scalar:p}=ip(l),u=C8(v,i,n),h=new Uint8Array(64);if(h.set(v,0),h.set(np(yc(p+u*s)),32),!F8(h,n,i))throw new Error("sign: Invalid signature produced");return h}function F8(e,t,r){let n=(0,nn.ensureBytes)("signature",e,64),i=(0,nn.ensureBytes)("message",t),s=(0,nn.ensureBytes)("publicKey",r,32);try{let o=M8((0,nn.bytesToNumberBE)(s)),a=(0,nn.bytesToNumberBE)(n.subarray(0,32));if(!I8(a))return!1;let f=(0,nn.bytesToNumberBE)(n.subarray(32,64));if(!wI(f))return!1;let l=C8(np(a),sp(o),i),v=SI(o,f,yc(-l));return!(!v||!v.hasEvenY()||v.toAffine().x!==a)}catch{return!1}}pr.schnorr={getPublicKey:EI,sign:_I,verify:F8,utils:{randomPrivateKey:pr.secp256k1.utils.randomPrivateKey,lift_x:M8,pointToBytes:sp,numberToBytesBE:nn.numberToBytesBE,bytesToNumberBE:nn.bytesToNumberBE,taggedHash:ld,mod:Dr.mod}};var AI=A8.isogenyMap(pa,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),BI=(0,xI.mapToCurveSimpleSWU)(pa,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:pa.create(BigInt("-11"))});tp=A8.createHasher(pr.secp256k1.ProjectivePoint,e=>{let{x:t,y:r}=BI(pa.create(e[0]));return AI(t,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:pa.ORDER,m:1,k:128,expand:"xmd",hash:ud.sha256}),pr.hashToCurve=tp.hashToCurve,pr.encodeToCurve=tp.encodeToCurve});var D8=U(va=>{"use strict";H();k();Object.defineProperty(va,"__esModule",{value:!0});va.poseidon=va.splitConstants=va.validateOpts=void 0;var R8=M0();function O8(e){let{Fp:t}=e;(0,R8.validateField)(t);for(let f of["t","roundsFull","roundsPartial"])if(typeof e[f]!="number"||!Number.isSafeInteger(e[f]))throw new Error(`Poseidon: invalid param ${f}=${e[f]} (${typeof e[f]})`);if(e.reversePartialPowIdx!==void 0&&typeof e.reversePartialPowIdx!="boolean")throw new Error(`Poseidon: invalid param reversePartialPowIdx=${e.reversePartialPowIdx}`);let r=e.sboxPower;if(r===void 0&&(r=5),typeof r!="number"||!Number.isSafeInteger(r))throw new Error(`Poseidon wrong sboxPower=${r}`);let n=BigInt(r),i=f=>(0,R8.FpPow)(t,f,n);if(r===3?i=f=>t.mul(t.sqrN(f),f):r===5&&(i=f=>t.mul(t.sqrN(t.sqrN(f)),f)),e.roundsFull%2!==0)throw new Error(`Poseidon roundsFull is not even: ${e.roundsFull}`);let s=e.roundsFull+e.roundsPartial;if(!Array.isArray(e.roundConstants)||e.roundConstants.length!==s)throw new Error("Poseidon: wrong round constants");let o=e.roundConstants.map(f=>{if(!Array.isArray(f)||f.length!==e.t)throw new Error(`Poseidon wrong round constants: ${f}`);return f.map(l=>{if(typeof l!="bigint"||!t.isValid(l))throw new Error(`Poseidon wrong round constant=${l}`);return t.create(l)})});if(!Array.isArray(e.mds)||e.mds.length!==e.t)throw new Error("Poseidon: wrong MDS matrix");let a=e.mds.map(f=>{if(!Array.isArray(f)||f.length!==e.t)throw new Error(`Poseidon MDS matrix row: ${f}`);return f.map(l=>{if(typeof l!="bigint")throw new Error(`Poseidon MDS matrix value=${l}`);return t.create(l)})});return Object.freeze({...e,rounds:s,sboxFn:i,roundConstants:o,mds:a})}va.validateOpts=O8;function PI(e,t){if(typeof t!="number")throw new Error("poseidonSplitConstants: wrong t");if(!Array.isArray(e)||e.length%t)throw new Error("poseidonSplitConstants: wrong rc");let r=[],n=[];for(let i=0;i<e.length;i++)n.push(e[i]),n.length===t&&(r.push(n),n=[]);return r}va.splitConstants=PI;function II(e){let{t,Fp:r,rounds:n,sboxFn:i,reversePartialPowIdx:s}=O8(e),o=Math.floor(e.roundsFull/2),a=s?t-1:0,f=(v,p,u)=>(v=v.map((h,b)=>r.add(h,e.roundConstants[u][b])),p?v=v.map(h=>i(h)):v[a]=i(v[a]),v=e.mds.map(h=>h.reduce((b,d,y)=>r.add(b,r.mulN(d,v[y])),r.ZERO)),v),l=function(p){if(!Array.isArray(p)||p.length!==t)throw new Error(`Poseidon: wrong values (expected array of bigints with length ${t})`);p=p.map(h=>{if(typeof h!="bigint")throw new Error(`Poseidon: wrong value=${h} (${typeof h})`);return r.create(h)});let u=0;for(let h=0;h<o;h++)p=f(p,!0,u++);for(let h=0;h<e.roundsPartial;h++)p=f(p,!1,u++);for(let h=0;h<o;h++)p=f(p,!0,u++);if(u!==n)throw new Error(`Poseidon: wrong number of rounds: last round=${u}, total=${n}`);return p};return l.roundConstants=e.roundConstants,l}va.poseidon=II});var G8=U(de=>{"use strict";H();k();var MI=de&&de.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),CI=de&&de.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),FI=de&&de.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&MI(t,e,r);return CI(t,e),t};Object.defineProperty(de,"__esModule",{value:!0});de.poseidonHashMany=de.poseidonHashSingle=de.poseidonHashFunc=de.poseidonHash=de.poseidonSmall=de.poseidonCreate=de.poseidonBasic=de._poseidonMDS=de.Fp251=de.Fp253=de.keccak=de.computeHashOnElements=de.hashChain=de.pedersen=de.getAccountPath=de.ethSigToPrivate=de.getStarkKey=de.grindKey=de.utils=de.Signature=de.ProjectivePoint=de.CURVE=de.verify=de.sign=de.getSharedSecret=de.getPublicKey=de._starkCurve=void 0;var NI=Fu(),cp=yo(),RI=$r(),F0=M0(),OI=D8(),DI=cd(),sn=FI(Ms()),TI=ep(),gd=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),H8=252;function T8(e){for(;e[0]===0;)e=e.subarray(1);let t=e.length*8-H8,r=sn.bytesToNumberBE(e);return t>0?r>>BigInt(t):r}function k8(e){return typeof e=="string"&&(e=dp(e),e.length&1&&(e="0"+e)),sn.hexToBytes(e)}var N0=(0,DI.weierstrass)({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:(0,F0.Field)(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:gd,nBitLength:H8,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...(0,TI.getHash)(cp.sha256),bits2int:T8,bits2int_modN:e=>{let t=sn.bytesToNumberBE(e).toString(16);return t.length===63&&(e=k8(t+"0")),(0,F0.mod)(T8(e),gd)}});de._starkCurve=N0;function C0(e){return sn.ensureBytes("",typeof e=="string"?k8(e):e)}function up(e){return sn.bytesToHex(C0(e)).padStart(64,"0")}function j8(e,t=!1){return N0.getPublicKey(up(e),t)}de.getPublicKey=j8;function qI(e,t){return N0.getSharedSecret(up(e),t)}de.getSharedSecret=qI;function HI(e,t,r){return N0.sign(C0(e),up(t),r)}de.sign=HI;function kI(e,t,r){let n=e instanceof L8?e:C0(e);return N0.verify(n,C0(t),C0(r))}de.verify=kI;var{CURVE:jI,ProjectivePoint:zo,Signature:L8,utils:LI}=N0;de.CURVE=jI;de.ProjectivePoint=zo;de.Signature=L8;de.utils=LI;function K8(e){return`0x${sn.bytesToHex(e.subarray(1)).replace(/^0+/gm,"")}`}function dp(e){return e.replace(/^0x/i,"")}function KI(e){return`0x${e.toString(16)}`}function U8(e){let t=C0(e),r=2n**256n,n=r-(0,F0.mod)(r,gd);for(let i=0;;i++){let s=op(sn.concatBytes(t,sn.numberToVarBytesBE(BigInt(i))));if(s<n)return(0,F0.mod)(s,gd).toString(16);if(i===1e5)throw new Error("grindKey is broken: tried 100k vals")}}de.grindKey=U8;function UI(e){return K8(j8(e,!0))}de.getStarkKey=UI;function VI(e){if(e=dp(e),e.length!==130)throw new Error("Wrong ethereum signature");return U8(e.substring(0,64))}de.ethSigToPrivate=VI;var zI=2n**31n-1n,bd=e=>Number(e&zI);function WI(e,t,r,n){let i=bd(op(e)),s=bd(op(t)),o=sn.hexToNumber(dp(r));return`m/2645'/${i}'/${s}'/${bd(o)}'/${bd(o>>31n)}'/${n}`}de.getAccountPath=WI;var xc=[new zo(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new zo(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new zo(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new zo(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new zo(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function V8(e,t){let r=[],n=e;for(let i=0;i<248;i++)r.push(n),n=n.double();n=t;for(let i=0;i<4;i++)r.push(n),n=n.double();return r}var $I=V8(xc[1],xc[2]),GI=V8(xc[3],xc[4]);function z8(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"){if(!Number.isSafeInteger(e))throw new Error(`Invalid pedersenArg: ${e}`);t=BigInt(e)}else t=sn.bytesToNumberBE(C0(e));if(!(0n<=t&&t<N0.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${t}`);return t}function q8(e,t,r){let n=z8(t);for(let i=0;i<252;i++){let s=r[i];if(s.equals(e))throw new Error("Same point");(n&1n)!==0n&&(e=e.add(s)),n>>=1n}return e}function hp(e,t){let r=xc[0];return r=q8(r,e,$I),r=q8(r,t,GI),K8(r.toRawBytes(!0))}de.pedersen=hp;function XI(e,t=hp){if(!Array.isArray(e)||e.length<1)throw new Error("data should be array of at least 1 element");return e.length===1?KI(z8(e[0])):Array.from(e).reverse().reduce((r,n)=>t(n,r))}de.hashChain=XI;var ZI=(e,t=hp)=>[0,...e,e.length].reduce((r,n)=>t(r,n));de.computeHashOnElements=ZI;var YI=sn.bitMask(250),JI=e=>sn.bytesToNumberBE((0,NI.keccak_256)(e))&YI;de.keccak=JI;var op=e=>sn.bytesToNumberBE((0,cp.sha256)(e));de.Fp253=(0,F0.Field)(BigInt("14474011154664525231415395255581126252639794253786371766033694892385558855681"));de.Fp251=(0,F0.Field)(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));function fp(e,t,r){let n=e.fromBytes((0,cp.sha256)((0,RI.utf8ToBytes)(`${t}${r}`)));return e.create(n)}function W8(e,t,r,n=0){let i=[],s=[];for(let o=0;o<r;o++)i.push(fp(e,`${t}x`,n*r+o)),s.push(fp(e,`${t}y`,n*r+o));if(new Set([...i,...s]).size!==2*r)throw new Error("X and Y values are not distinct");return i.map(o=>s.map(a=>e.inv(e.sub(o,a))))}de._poseidonMDS=W8;var QI=[[3,1,1],[1,-1,1],[1,1,-2]].map(e=>e.map(BigInt));function lp(e,t){if((0,F0.validateField)(e.Fp),!Number.isSafeInteger(e.rate)||!Number.isSafeInteger(e.capacity))throw new Error(`Wrong poseidon opts: ${e}`);let r=e.rate+e.capacity,n=e.roundsFull+e.roundsPartial,i=[];for(let o=0;o<n;o++){let a=[];for(let f=0;f<r;f++)a.push(fp(e.Fp,"Hades",r*o+f));i.push(a)}let s=(0,OI.poseidon)({...e,t:r,sboxPower:3,reversePartialPowIdx:!0,mds:t,roundConstants:i});return s.m=r,s.rate=e.rate,s.capacity=e.capacity,s}de.poseidonBasic=lp;function eM(e,t=0){let r=e.rate+e.capacity;if(!Number.isSafeInteger(t))throw new Error(`Wrong mdsAttempt=${t}`);return lp(e,W8(e.Fp,"HadesMDS",r,t))}de.poseidonCreate=eM;de.poseidonSmall=lp({Fp:de.Fp251,rate:2,capacity:1,roundsFull:8,roundsPartial:83},QI);function $8(e,t,r=de.poseidonSmall){return r([e,t,2n])[0]}de.poseidonHash=$8;function tM(e,t,r=de.poseidonSmall){return sn.numberToVarBytesBE($8(sn.bytesToNumberBE(e),sn.bytesToNumberBE(t),r))}de.poseidonHashFunc=tM;function rM(e,t=de.poseidonSmall){return t([e,0n,1n])[0]}de.poseidonHashSingle=rM;function nM(e,t=de.poseidonSmall){let{m:r,rate:n}=t;if(!Array.isArray(e))throw new Error("bigint array expected in values");let i=Array.from(e);for(i.push(1n);i.length%n!==0;)i.push(0n);let s=new Array(r).fill(0n);for(let o=0;o<i.length;o+=n){for(let a=0;a<n;a++)s[a]+=i[o+a];s=t(s)}return s[0]}de.poseidonHashMany=nM});var Y8=U(an=>{"use strict";H();k();var iM=an&&an.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),sM=an&&an.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),X8=an&&an.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&iM(t,e,r);return sM(t,e),t};Object.defineProperty(an,"__esModule",{value:!0});an.bytesToHex=an.hexToBytes=an.stark=an.secp256k1=void 0;an.secp256k1=X8(N8());an.stark=X8(G8());var Z8=Ms();Object.defineProperty(an,"hexToBytes",{enumerable:!0,get:function(){return Z8.hexToBytes}});Object.defineProperty(an,"bytesToHex",{enumerable:!0,get:function(){return Z8.bytesToHex}})});var J8=U(on=>{"use strict";H();k();var aM=on&&on.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),oM=on&&on.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),yd=on&&on.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&aM(t,e,r);return oM(t,e),t};Object.defineProperty(on,"__esModule",{value:!0});on.schnorr=on.p256=on.ed25519=on.secp256k1=void 0;on.secp256k1=yd($4());on.ed25519=yd(Z4());on.p256=yd(e8());on.schnorr=yd(Y8())});var e6=U(Wo=>{"use strict";H();k();var fM=Wo&&Wo.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Wo,"__esModule",{value:!0});Wo.Decimal=void 0;var R0=fM(wr()),Q8=100,vr=class{static fromUserInput(t,r){vr.verifyFractionalDigits(r);let n=t.match(/[^0-9.]/);if(n)throw new Error(`Invalid character at position ${n.index+1}`);let i,s;if(t.search(/\./)===-1)i=t,s="";else{let a=t.split(".");switch(a.length){case 0:case 1:throw new Error("Fewer than two elements in split result. This must not happen here.");case 2:if(!a[1])throw new Error("Fractional part missing");i=a[0],s=a[1].replace(/0+$/,"");break;default:throw new Error("More than one separator found")}}if(s.length>r)throw new Error("Got more fractional digits than supported");let o=`${i}${s.padEnd(r,"0")}`;return new vr(o,r)}static fromAtomics(t,r){return vr.verifyFractionalDigits(r),new vr(t,r)}static zero(t){return vr.verifyFractionalDigits(t),new vr("0",t)}static one(t){return vr.verifyFractionalDigits(t),new vr("1"+"0".repeat(t),t)}static verifyFractionalDigits(t){if(!Number.isInteger(t))throw new Error("Fractional digits is not an integer");if(t<0)throw new Error("Fractional digits must not be negative");if(t>Q8)throw new Error(`Fractional digits must not exceed ${Q8}`)}static compare(t,r){if(t.fractionalDigits!==r.fractionalDigits)throw new Error("Fractional digits do not match");return t.data.atomics.cmp(new R0.default(r.atomics))}get atomics(){return this.data.atomics.toString()}get fractionalDigits(){return this.data.fractionalDigits}constructor(t,r){this.data={atomics:new R0.default(t),fractionalDigits:r}}toString(){let t=new R0.default(10).pow(new R0.default(this.data.fractionalDigits)),r=this.data.atomics.div(t),n=this.data.atomics.mod(t);if(n.isZero())return r.toString();{let s=n.toString().padStart(this.data.fractionalDigits,"0").replace(/0+$/,"");return`${r.toString()}.${s}`}}toFloatApproximation(){let t=Number(this.toString());if(Number.isNaN(t))throw new Error("Conversion to number failed");return t}plus(t){if(this.fractionalDigits!==t.fractionalDigits)throw new Error("Fractional digits do not match");let r=this.data.atomics.add(new R0.default(t.atomics));return new vr(r.toString(),this.fractionalDigits)}minus(t){if(this.fractionalDigits!==t.fractionalDigits)throw new Error("Fractional digits do not match");let r=this.data.atomics.sub(new R0.default(t.atomics));if(r.ltn(0))throw new Error("Difference must not be negative");return new vr(r.toString(),this.fractionalDigits)}multiply(t){let r=this.data.atomics.mul(new R0.default(t.toString()));return new vr(r.toString(),this.fractionalDigits)}equals(t){return vr.compare(this,t)===0}isLessThan(t){return vr.compare(this,t)<0}isLessThanOrEqual(t){return vr.compare(this,t)<=0}isGreaterThan(t){return vr.compare(this,t)>0}isGreaterThanOrEqual(t){return vr.compare(this,t)>=0}};Wo.Decimal=vr});var t6=U($n=>{"use strict";H();k();var cM=$n&&$n.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($n,"__esModule",{value:!0});$n.Uint64=$n.Uint53=$n.Int53=$n.Uint32=void 0;var xd=cM(wr()),uM=new xd.default("18446744073709551615",10,"be"),O0=class{static fromBigEndianBytes(t){return O0.fromBytes(t)}static fromBytes(t,r="be"){if(t.length!==4)throw new Error("Invalid input length. Expected 4 bytes.");for(let i=0;i<t.length;++i)if(!Number.isInteger(t[i])||t[i]>255||t[i]<0)throw new Error("Invalid value in byte. Found: "+t[i]);let n=r==="be"?t:Array.from(t).reverse();return new O0(n[0]*2**24+n[1]*2**16+n[2]*2**8+n[3])}static fromString(t){if(!t.match(/^[0-9]+$/))throw new Error("Invalid string format");return new O0(Number.parseInt(t,10))}constructor(t){if(Number.isNaN(t))throw new Error("Input is not a number");if(!Number.isInteger(t))throw new Error("Input is not an integer");if(t<0||t>4294967295)throw new Error("Input not in uint32 range: "+t.toString());this.data=t}toBytesBigEndian(){return new Uint8Array([Math.floor(this.data/2**24)&255,Math.floor(this.data/2**16)&255,Math.floor(this.data/2**8)&255,Math.floor(this.data/2**0)&255])}toBytesLittleEndian(){return new Uint8Array([Math.floor(this.data/2**0)&255,Math.floor(this.data/2**8)&255,Math.floor(this.data/2**16)&255,Math.floor(this.data/2**24)&255])}toNumber(){return this.data}toString(){return this.data.toString()}};$n.Uint32=O0;var D0=class{static fromString(t){if(!t.match(/^-?[0-9]+$/))throw new Error("Invalid string format");return new D0(Number.parseInt(t,10))}constructor(t){if(Number.isNaN(t))throw new Error("Input is not a number");if(!Number.isInteger(t))throw new Error("Input is not an integer");if(t<Number.MIN_SAFE_INTEGER||t>Number.MAX_SAFE_INTEGER)throw new Error("Input not in int53 range: "+t.toString());this.data=t}toNumber(){return this.data}toString(){return this.data.toString()}};$n.Int53=D0;var mc=class{static fromString(t){let r=D0.fromString(t);return new mc(r.toNumber())}constructor(t){let r=new D0(t);if(r.toNumber()<0)throw new Error("Input is negative");this.data=r}toNumber(){return this.data.toNumber()}toString(){return this.data.toString()}};$n.Uint53=mc;var ba=class{static fromBytesBigEndian(t){return ba.fromBytes(t)}static fromBytes(t,r="be"){if(t.length!==8)throw new Error("Invalid input length. Expected 8 bytes.");for(let i=0;i<t.length;++i)if(!Number.isInteger(t[i])||t[i]>255||t[i]<0)throw new Error("Invalid value in byte. Found: "+t[i]);let n=r==="be"?Array.from(t):Array.from(t).reverse();return new ba(new xd.default(n))}static fromString(t){if(!t.match(/^[0-9]+$/))throw new Error("Invalid string format");return new ba(new xd.default(t,10,"be"))}static fromNumber(t){if(Number.isNaN(t))throw new Error("Input is not a number");if(!Number.isInteger(t))throw new Error("Input is not an integer");let r;try{r=new xd.default(t)}catch{throw new Error("Input is not a safe integer")}return new ba(r)}constructor(t){if(t.isNeg())throw new Error("Input is negative");if(t.gt(uM))throw new Error("Input exceeds uint64 range");this.data=t}toBytesBigEndian(){return Uint8Array.from(this.data.toArray("be",8))}toBytesLittleEndian(){return Uint8Array.from(this.data.toArray("le",8))}toString(){return this.data.toString(10)}toNumber(){return this.data.toNumber()}};$n.Uint64=ba});var r6=U(Gn=>{"use strict";H();k();Object.defineProperty(Gn,"__esModule",{value:!0});Gn.Uint64=Gn.Uint53=Gn.Uint32=Gn.Int53=Gn.Decimal=void 0;var dM=e6();Object.defineProperty(Gn,"Decimal",{enumerable:!0,get:function(){return dM.Decimal}});var md=t6();Object.defineProperty(Gn,"Int53",{enumerable:!0,get:function(){return md.Int53}});Object.defineProperty(Gn,"Uint32",{enumerable:!0,get:function(){return md.Uint32}});Object.defineProperty(Gn,"Uint53",{enumerable:!0,get:function(){return md.Uint53}});Object.defineProperty(Gn,"Uint64",{enumerable:!0,get:function(){return md.Uint64}})});var s6=U((i6,pp)=>{H();k();var n6=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function r(S,g,E){this.low=S|0,this.high=g|0,this.unsigned=!!E}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0});function n(S){return(S&&S.__isLong__)===!0}function i(S){var g=Math.clz32(S&-S);return S?31-g:g}r.isLong=n;var s={},o={};function a(S,g){var E,M,T;return g?(S>>>=0,(T=0<=S&&S<256)&&(M=o[S],M)?M:(E=l(S,0,!0),T&&(o[S]=E),E)):(S|=0,(T=-128<=S&&S<128)&&(M=s[S],M)?M:(E=l(S,S<0?-1:0,!1),T&&(s[S]=E),E))}r.fromInt=a;function f(S,g){if(isNaN(S))return g?N:I;if(g){if(S<0)return N;if(S>=y)return D}else{if(S<=-w)return A;if(S+1>=w)return P}return S<0?f(-S,g).neg():l(S%d|0,S/d|0,g)}r.fromNumber=f;function l(S,g,E){return new r(S,g,E)}r.fromBits=l;var v=Math.pow;function p(S,g,E){if(S.length===0)throw Error("empty string");if(typeof g=="number"?(E=g,g=!1):g=!!g,S==="NaN"||S==="Infinity"||S==="+Infinity"||S==="-Infinity")return g?N:I;if(E=E||10,E<2||36<E)throw RangeError("radix");var M;if((M=S.indexOf("-"))>0)throw Error("interior hyphen");if(M===0)return p(S.substring(1),g,E).neg();for(var T=f(v(E,8)),R=I,x=0;x<S.length;x+=8){var C=Math.min(8,S.length-x),K=parseInt(S.substring(x,x+C),E);if(C<8){var L=f(v(E,C));R=R.mul(L).add(f(K))}else R=R.mul(T),R=R.add(f(K))}return R.unsigned=g,R}r.fromString=p;function u(S,g){return typeof S=="number"?f(S,g):typeof S=="string"?p(S,g):l(S.low,S.high,typeof g=="boolean"?g:S.unsigned)}r.fromValue=u;var h=1<<16,b=1<<24,d=h*h,y=d*d,w=y/2,_=a(b),I=a(0);r.ZERO=I;var N=a(0,!0);r.UZERO=N;var F=a(1);r.ONE=F;var O=a(1,!0);r.UONE=O;var q=a(-1);r.NEG_ONE=q;var P=l(-1,2147483647,!1);r.MAX_VALUE=P;var D=l(-1,-1,!0);r.MAX_UNSIGNED_VALUE=D;var A=l(0,-2147483648,!1);r.MIN_VALUE=A;var c=r.prototype;c.toInt=function(){return this.unsigned?this.low>>>0:this.low},c.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},c.toString=function(g){if(g=g||10,g<2||36<g)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(A)){var E=f(g),M=this.div(E),T=M.mul(E).sub(this);return M.toString(g)+T.toInt().toString(g)}else return"-"+this.neg().toString(g);for(var R=f(v(g,6),this.unsigned),x=this,C="";;){var K=x.div(R),L=x.sub(K.mul(R)).toInt()>>>0,V=L.toString(g);if(x=K,x.isZero())return V+C;for(;V.length<6;)V="0"+V;C=""+V+C}},c.getHighBits=function(){return this.high},c.getHighBitsUnsigned=function(){return this.high>>>0},c.getLowBits=function(){return this.low},c.getLowBitsUnsigned=function(){return this.low>>>0},c.getNumBitsAbs=function(){if(this.isNegative())return this.eq(A)?64:this.neg().getNumBitsAbs();for(var g=this.high!=0?this.high:this.low,E=31;E>0&&(g&1<<E)==0;E--);return this.high!=0?E+33:E+1},c.isZero=function(){return this.high===0&&this.low===0},c.eqz=c.isZero,c.isNegative=function(){return!this.unsigned&&this.high<0},c.isPositive=function(){return this.unsigned||this.high>=0},c.isOdd=function(){return(this.low&1)===1},c.isEven=function(){return(this.low&1)===0},c.equals=function(g){return n(g)||(g=u(g)),this.unsigned!==g.unsigned&&this.high>>>31===1&&g.high>>>31===1?!1:this.high===g.high&&this.low===g.low},c.eq=c.equals,c.notEquals=function(g){return!this.eq(g)},c.neq=c.notEquals,c.ne=c.notEquals,c.lessThan=function(g){return this.comp(g)<0},c.lt=c.lessThan,c.lessThanOrEqual=function(g){return this.comp(g)<=0},c.lte=c.lessThanOrEqual,c.le=c.lessThanOrEqual,c.greaterThan=function(g){return this.comp(g)>0},c.gt=c.greaterThan,c.greaterThanOrEqual=function(g){return this.comp(g)>=0},c.gte=c.greaterThanOrEqual,c.ge=c.greaterThanOrEqual,c.compare=function(g){if(n(g)||(g=u(g)),this.eq(g))return 0;var E=this.isNegative(),M=g.isNegative();return E&&!M?-1:!E&&M?1:this.unsigned?g.high>>>0>this.high>>>0||g.high===this.high&&g.low>>>0>this.low>>>0?-1:1:this.sub(g).isNegative()?-1:1},c.comp=c.compare,c.negate=function(){return!this.unsigned&&this.eq(A)?A:this.not().add(F)},c.neg=c.negate,c.add=function(g){n(g)||(g=u(g));var E=this.high>>>16,M=this.high&65535,T=this.low>>>16,R=this.low&65535,x=g.high>>>16,C=g.high&65535,K=g.low>>>16,L=g.low&65535,V=0,z=0,G=0,$=0;return $+=R+L,G+=$>>>16,$&=65535,G+=T+K,z+=G>>>16,G&=65535,z+=M+C,V+=z>>>16,z&=65535,V+=E+x,V&=65535,l(G<<16|$,V<<16|z,this.unsigned)},c.subtract=function(g){return n(g)||(g=u(g)),this.add(g.neg())},c.sub=c.subtract,c.multiply=function(g){if(this.isZero())return this;if(n(g)||(g=u(g)),t){var E=t.mul(this.low,this.high,g.low,g.high);return l(E,t.get_high(),this.unsigned)}if(g.isZero())return this.unsigned?N:I;if(this.eq(A))return g.isOdd()?A:I;if(g.eq(A))return this.isOdd()?A:I;if(this.isNegative())return g.isNegative()?this.neg().mul(g.neg()):this.neg().mul(g).neg();if(g.isNegative())return this.mul(g.neg()).neg();if(this.lt(_)&&g.lt(_))return f(this.toNumber()*g.toNumber(),this.unsigned);var M=this.high>>>16,T=this.high&65535,R=this.low>>>16,x=this.low&65535,C=g.high>>>16,K=g.high&65535,L=g.low>>>16,V=g.low&65535,z=0,G=0,$=0,oe=0;return oe+=x*V,$+=oe>>>16,oe&=65535,$+=R*V,G+=$>>>16,$&=65535,$+=x*L,G+=$>>>16,$&=65535,G+=T*V,z+=G>>>16,G&=65535,G+=R*L,z+=G>>>16,G&=65535,G+=x*K,z+=G>>>16,G&=65535,z+=M*V+T*L+R*K+x*C,z&=65535,l($<<16|oe,z<<16|G,this.unsigned)},c.mul=c.multiply,c.divide=function(g){if(n(g)||(g=u(g)),g.isZero())throw Error("division by zero");if(t){if(!this.unsigned&&this.high===-2147483648&&g.low===-1&&g.high===-1)return this;var E=(this.unsigned?t.div_u:t.div_s)(this.low,this.high,g.low,g.high);return l(E,t.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?N:I;var M,T,R;if(this.unsigned){if(g.unsigned||(g=g.toUnsigned()),g.gt(this))return N;if(g.gt(this.shru(1)))return O;R=N}else{if(this.eq(A)){if(g.eq(F)||g.eq(q))return A;if(g.eq(A))return F;var x=this.shr(1);return M=x.div(g).shl(1),M.eq(I)?g.isNegative()?F:q:(T=this.sub(g.mul(M)),R=M.add(T.div(g)),R)}else if(g.eq(A))return this.unsigned?N:I;if(this.isNegative())return g.isNegative()?this.neg().div(g.neg()):this.neg().div(g).neg();if(g.isNegative())return this.div(g.neg()).neg();R=I}for(T=this;T.gte(g);){M=Math.max(1,Math.floor(T.toNumber()/g.toNumber()));for(var C=Math.ceil(Math.log(M)/Math.LN2),K=C<=48?1:v(2,C-48),L=f(M),V=L.mul(g);V.isNegative()||V.gt(T);)M-=K,L=f(M,this.unsigned),V=L.mul(g);L.isZero()&&(L=F),R=R.add(L),T=T.sub(V)}return R},c.div=c.divide,c.modulo=function(g){if(n(g)||(g=u(g)),t){var E=(this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,g.low,g.high);return l(E,t.get_high(),this.unsigned)}return this.sub(this.div(g).mul(g))},c.mod=c.modulo,c.rem=c.modulo,c.not=function(){return l(~this.low,~this.high,this.unsigned)},c.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},c.clz=c.countLeadingZeros,c.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},c.ctz=c.countTrailingZeros,c.and=function(g){return n(g)||(g=u(g)),l(this.low&g.low,this.high&g.high,this.unsigned)},c.or=function(g){return n(g)||(g=u(g)),l(this.low|g.low,this.high|g.high,this.unsigned)},c.xor=function(g){return n(g)||(g=u(g)),l(this.low^g.low,this.high^g.high,this.unsigned)},c.shiftLeft=function(g){return n(g)&&(g=g.toInt()),(g&=63)===0?this:g<32?l(this.low<<g,this.high<<g|this.low>>>32-g,this.unsigned):l(0,this.low<<g-32,this.unsigned)},c.shl=c.shiftLeft,c.shiftRight=function(g){return n(g)&&(g=g.toInt()),(g&=63)===0?this:g<32?l(this.low>>>g|this.high<<32-g,this.high>>g,this.unsigned):l(this.high>>g-32,this.high>=0?0:-1,this.unsigned)},c.shr=c.shiftRight,c.shiftRightUnsigned=function(g){return n(g)&&(g=g.toInt()),(g&=63)===0?this:g<32?l(this.low>>>g|this.high<<32-g,this.high>>>g,this.unsigned):g===32?l(this.high,0,this.unsigned):l(this.high>>>g-32,0,this.unsigned)},c.shru=c.shiftRightUnsigned,c.shr_u=c.shiftRightUnsigned,c.rotateLeft=function(g){var E;return n(g)&&(g=g.toInt()),(g&=63)===0?this:g===32?l(this.high,this.low,this.unsigned):g<32?(E=32-g,l(this.low<<g|this.high>>>E,this.high<<g|this.low>>>E,this.unsigned)):(g-=32,E=32-g,l(this.high<<g|this.low>>>E,this.low<<g|this.high>>>E,this.unsigned))},c.rotl=c.rotateLeft,c.rotateRight=function(g){var E;return n(g)&&(g=g.toInt()),(g&=63)===0?this:g===32?l(this.high,this.low,this.unsigned):g<32?(E=32-g,l(this.high<<E|this.low>>>g,this.low<<E|this.high>>>g,this.unsigned)):(g-=32,E=32-g,l(this.low<<E|this.high>>>g,this.high<<E|this.low>>>g,this.unsigned))},c.rotr=c.rotateRight,c.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},c.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},c.toBytes=function(g){return g?this.toBytesLE():this.toBytesBE()},c.toBytesLE=function(){var g=this.high,E=this.low;return[E&255,E>>>8&255,E>>>16&255,E>>>24,g&255,g>>>8&255,g>>>16&255,g>>>24]},c.toBytesBE=function(){var g=this.high,E=this.low;return[g>>>24,g>>>16&255,g>>>8&255,g&255,E>>>24,E>>>16&255,E>>>8&255,E&255]},r.fromBytes=function(g,E,M){return M?r.fromBytesLE(g,E):r.fromBytesBE(g,E)},r.fromBytesLE=function(g,E){return new r(g[0]|g[1]<<8|g[2]<<16|g[3]<<24,g[4]|g[5]<<8|g[6]<<16|g[7]<<24,E)},r.fromBytesBE=function(g,E){return new r(g[4]<<24|g[5]<<16|g[6]<<8|g[7],g[0]<<24|g[1]<<16|g[2]<<8|g[3],E)};var m=r;return e.default=m,"default"in e?e.default:e}({});typeof define=="function"&&define.amd?define([],function(){return n6}):typeof pp=="object"&&typeof i6=="object"&&(pp.exports=n6)});var ta=U(je=>{"use strict";H();k();var a6=je&&je.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),hM=je&&je.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Pi=je&&je.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&a6(t,e,r);return hM(t,e),t},o6=je&&je.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&a6(t,e,r)},wd=je&&je.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(je,"__esModule",{value:!0});je.secp256k1=je.ed25519=je.Long=je._m0=je.protobuf=je.typeforce=je.safeBuffer=je.BigNumber=je.BN=je.math=je.signUtil=je.abi=je.elliptic=je.bip39=je.bip32=je.base=void 0;je.base=Pi(w0());je.bip32=Pi(l4());je.bip39=Pi(P4());je.elliptic=Pi(ko());je.abi=Pi(L4());je.signUtil=Pi(J8());je.math=Pi(r6());var lM=wd(wr());je.BN=lM.default;var pM=wd(ig());je.BigNumber=pM.default;var vM=wd(Yb());je.safeBuffer=vM.default;var bM=xu();je.typeforce=bM;je.protobuf=Pi(ag());je._m0=Pi(og());var gM=wd(s6());je.Long=gM.default;je.ed25519=Pi(fg());je.secp256k1=Pi(cg());o6((dg(),b0(ug)),je);o6((lg(),b0(hg)),je)});var Sd=U(Be=>{"use strict";H();k();Object.defineProperty(Be,"__esModule",{value:!0});Be.estimateFee=Be.validSignedTransaction=Be.getRawTransaction=Be.hardwareDerivePubKey=Be.calcTxHash=Be.getHardWareMessageHash=Be.getHardWareSignedTransaction=Be.getHardWareRawTransaction=Be.getMPCSignedMessage=Be.getMPCRawMessage=Be.getMPCTransaction=Be.getMPCRawTransaction=Be.getAddressByPublicKey=Be.getDerivedPath=Be.signTransaction=Be.ecRecover=Be.verifyMessage=Be.signMessage=Be.validPrivateKey=Be.validAddress=Be.getNewAddress=Be.getDerivedPrivateKey=Be.getRandomPrivateKey=Be.getMnemonic=Be.unRegister=Be.register=void 0;var Gt=go(),$o=ta(),Xt=new Map;function yM(e,t){Xt.set(e,t)}Be.register=yM;function xM(e,t){Xt.delete(e)}Be.unRegister=xM;async function mM(e){try{let t=$o.bip39.generateMnemonic(e);return Promise.resolve(t)}catch{return Promise.reject(Gt.GenMnemonicError)}}Be.getMnemonic=mM;async function wM(e){let t=Xt.get(e);return t!=null?await t.getRandomPrivateKey():Promise.reject(Gt.NotImplementedError)}Be.getRandomPrivateKey=wM;async function SM(e,t){let r=Xt.get(e);return r!=null?await r.getDerivedPrivateKey(t):Promise.reject(Gt.NotImplementedError)}Be.getDerivedPrivateKey=SM;async function EM(e,t){let r=Xt.get(e);if(r!=null){if(!await r.validPrivateKey({privateKey:t.privateKey}))throw Be.InvalidPrivateKeyError;return await r.getNewAddress(t)}return Promise.reject(Gt.NotImplementedError)}Be.getNewAddress=EM;async function _M(e,t){let r=Xt.get(e);return r!=null?await r.validAddress(t):Promise.reject(Gt.NotImplementedError)}Be.validAddress=_M;async function AM(e,t){let r=Xt.get(e);return r!=null?await r.validPrivateKey(t):Promise.reject(Gt.NotImplementedError)}Be.validPrivateKey=AM;async function BM(e,t){let r=Xt.get(e);return r!=null?await r.signMessage(t):Promise.reject(Gt.NotImplementedError)}Be.signMessage=BM;async function PM(e,t){let r=Xt.get(e);return r!=null?await r.verifyMessage(t):Promise.reject(Gt.NotImplementedError)}Be.verifyMessage=PM;async function IM(e,t){let r=Xt.get(e);if(r!=null){let n=t.signature,i=t.data;return await r.ecRecover(i,n)}return Promise.reject(Gt.NotImplementedError)}Be.ecRecover=IM;async function MM(e,t){let r=Xt.get(e);return r!=null?await r.signTransaction(t):Promise.reject(Gt.NotImplementedError)}Be.signTransaction=MM;async function CM(e,t){let r=Xt.get(e);return r!=null?await r.getDerivedPath(t):Promise.reject(Gt.NotImplementedError)}Be.getDerivedPath=CM;async function FM(e,t){let r=Xt.get(e);return r!=null?await r.getAddressByPublicKey(t):Promise.reject(Gt.NotImplementedError)}Be.getAddressByPublicKey=FM;async function NM(e,t){let r=Xt.get(e);return r!=null?await r.getMPCRawTransaction(t):Promise.reject(Gt.NotImplementedError)}Be.getMPCRawTransaction=NM;async function RM(e,t){let r=Xt.get(e);return r!=null?await r.getMPCTransaction(t):Promise.reject(Gt.NotImplementedError)}Be.getMPCTransaction=RM;async function OM(e,t){let r=Xt.get(e);return r!=null?await r.getMPCRawMessage(t):Promise.reject(Gt.NotImplementedError)}Be.getMPCRawMessage=OM;async function DM(e,t){let r=Xt.get(e);return r!=null?await r.getMPCSignedMessage(t):Promise.reject(Gt.NotImplementedError)}Be.getMPCSignedMessage=DM;async function TM(e,t){let r=Xt.get(e);return r!=null?await r.getHardWareRawTransaction(t):Promise.reject(Gt.NotImplementedError)}Be.getHardWareRawTransaction=TM;async function qM(e,t){let r=Xt.get(e);return r!=null?await r.getHardWareSignedTransaction(t):Promise.reject(Gt.NotImplementedError)}Be.getHardWareSignedTransaction=qM;async function HM(e,t){let r=Xt.get(e);return r!=null?await r.getHardWareMessageHash(t):Promise.reject(Gt.NotImplementedError)}Be.getHardWareMessageHash=HM;async function kM(e,t){let r=Xt.get(e);return r!=null?await r.calcTxHash(t):Promise.reject(Gt.NotImplementedError)}Be.calcTxHash=kM;async function jM(e,t){try{if(e.slice(0,4)!=="xpub"){let s=$o.base.fromBase58Check(e).slice(4);s=j.Buffer.concat([$o.base.fromHex("0488b21e"),s]),e=$o.base.toBase58Check(s)}let n=$o.bip32.fromBase58(e).derivePath(t);return Promise.resolve($o.base.toHex(n.publicKey))}catch{return Promise.reject(Gt.HardwareDerivePubKeyError)}}Be.hardwareDerivePubKey=jM;async function LM(e,t){let r=Xt.get(e);return r!=null?await r.getRawTransaction(t):Promise.reject(Gt.NotImplementedError)}Be.getRawTransaction=LM;async function KM(e,t){let r=Xt.get(e);return r!=null?await r.validSignedTransaction(t):Promise.reject(Gt.NotImplementedError)}Be.validSignedTransaction=KM;async function UM(e,t){let r=Xt.get(e);return r!=null?await r.estimateFee(t):Promise.reject(Gt.NotImplementedError)}Be.estimateFee=UM});var T0=U(Se=>{"use strict";H();k();Object.defineProperty(Se,"__esModule",{value:!0});Se.bytes=Se.stringToBytes=Se.str=Se.bytesToString=Se.hex=Se.utf8=Se.bech32m=Se.bech32=Se.base58check=Se.base58xmr=Se.base58xrp=Se.base58flickr=Se.base58=Se.base64url=Se.base64=Se.base32crockford=Se.base32hex=Se.base32=Se.base16=Se.utils=Se.assertNumber=void 0;function ga(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}Se.assertNumber=ga;function Ii(...e){let t=(i,s)=>o=>i(s(o)),r=Array.from(e).reverse().reduce((i,s)=>i?t(i,s.encode):s.encode,void 0),n=e.reduce((i,s)=>i?t(i,s.decode):s.decode,void 0);return{encode:r,decode:n}}function Qi(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(r=>{if(ga(r),r<0||r>=e.length)throw new Error(`Digit index outside alphabet: ${r} (alphabet: ${e.length})`);return e[r]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(r=>{if(typeof r!="string")throw new Error(`alphabet.decode: not string element=${r}`);let n=e.indexOf(r);if(n===-1)throw new Error(`Unknown letter: "${r}". Allowed: ${e}`);return n})}}}function es(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let r of t)if(typeof r!="string")throw new Error(`join.encode: non-string input=${r}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function Ec(e,t="="){if(ga(e),typeof t!="string")throw new Error("padding chr should be string");return{encode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let n of r)if(typeof n!="string")throw new Error(`padding.encode: non-string input=${n}`);for(;r.length*e%8;)r.push(t);return r},decode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let i of r)if(typeof i!="string")throw new Error(`padding.decode: non-string input=${i}`);let n=r.length;if(n*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--)if(!((n-1)*e%8))throw new Error("Invalid padding: string has too much padding");return r.slice(0,n)}}}function l6(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function f6(e,t,r){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let n=0,i=[],s=Array.from(e);for(s.forEach(o=>{if(ga(o),o<0||o>=t)throw new Error(`Wrong integer: ${o}`)});;){let o=0,a=!0;for(let f=n;f<s.length;f++){let l=s[f],v=t*o+l;if(!Number.isSafeInteger(v)||t*o/t!==o||v-l!==t*o)throw new Error("convertRadix: carry overflow");if(o=v%r,s[f]=Math.floor(v/r),!Number.isSafeInteger(s[f])||s[f]*r+o!==v)throw new Error("convertRadix: carry overflow");if(a)s[f]?a=!1:n=f;else continue}if(i.push(o),a)break}for(let o=0;o<e.length-1&&e[o]===0;o++)i.push(0);return i.reverse()}var p6=(e,t)=>t?p6(t,e%t):e,Ed=(e,t)=>e+(t-p6(e,t));function vp(e,t,r,n){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(Ed(t,r)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${Ed(t,r)}`);let i=0,s=0,o=2**r-1,a=[];for(let f of e){if(ga(f),f>=2**t)throw new Error(`convertRadix2: invalid data word=${f} from=${t}`);if(i=i<<t|f,s+t>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${t}`);for(s+=t;s>=r;s-=r)a.push((i>>s-r&o)>>>0);i&=2**s-1}if(i=i<<r-s&o,!n&&s>=t)throw new Error("Excess padding");if(!n&&i)throw new Error(`Non-zero padding: ${i}`);return n&&s>0&&a.push(i>>>0),a}function v6(e){return ga(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return f6(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(f6(t,e,2**8))}}}function Fs(e,t=!1){if(ga(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Ed(8,e)>32||Ed(e,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!(r instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return vp(Array.from(r),8,e,!t)},decode:r=>{if(!Array.isArray(r)||r.length&&typeof r[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(vp(r,e,8,t))}}}function c6(e){if(typeof e!="function")throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch{}}}function b6(e,t){if(ga(e),typeof t!="function")throw new Error("checksum fn should be function");return{encode(r){if(!(r instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");let n=t(r).slice(0,e),i=new Uint8Array(r.length+e);return i.set(r),i.set(n,r.length),i},decode(r){if(!(r instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");let n=r.slice(0,-e),i=t(n).slice(0,e),s=r.slice(-e);for(let o=0;o<e;o++)if(i[o]!==s[o])throw new Error("Invalid checksum");return n}}}Se.utils={alphabet:Qi,chain:Ii,checksum:b6,radix:v6,radix2:Fs,join:es,padding:Ec};Se.base16=Ii(Fs(4),Qi("0123456789ABCDEF"),es(""));Se.base32=Ii(Fs(5),Qi("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Ec(5),es(""));Se.base32hex=Ii(Fs(5),Qi("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Ec(5),es(""));Se.base32crockford=Ii(Fs(5),Qi("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),es(""),l6(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));Se.base64=Ii(Fs(6),Qi("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Ec(6),es(""));Se.base64url=Ii(Fs(6),Qi("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Ec(6),es(""));var gp=e=>Ii(v6(58),Qi(e),es(""));Se.base58=gp("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");Se.base58flickr=gp("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");Se.base58xrp=gp("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");var u6=[0,2,3,5,6,7,9,10,11];Se.base58xmr={encode(e){let t="";for(let r=0;r<e.length;r+=8){let n=e.subarray(r,r+8);t+=Se.base58.encode(n).padStart(u6[n.length],"1")}return t},decode(e){let t=[];for(let r=0;r<e.length;r+=11){let n=e.slice(r,r+11),i=u6.indexOf(n.length),s=Se.base58.decode(n);for(let o=0;o<s.length-i;o++)if(s[o]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(s.slice(s.length-i)))}return Uint8Array.from(t)}};var VM=e=>Ii(b6(4,t=>e(e(t))),Se.base58);Se.base58check=VM;var bp=Ii(Qi("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),es("")),d6=[996825010,642813549,513874426,1027748829,705979059];function wc(e){let t=e>>25,r=(e&33554431)<<5;for(let n=0;n<d6.length;n++)(t>>n&1)===1&&(r^=d6[n]);return r}function h6(e,t,r=1){let n=e.length,i=1;for(let s=0;s<n;s++){let o=e.charCodeAt(s);if(o<33||o>126)throw new Error(`Invalid prefix (${e})`);i=wc(i)^o>>5}i=wc(i);for(let s=0;s<n;s++)i=wc(i)^e.charCodeAt(s)&31;for(let s of t)i=wc(i)^s;for(let s=0;s<6;s++)i=wc(i);return i^=r,bp.encode(vp([i%2**30],30,5,!1))}function g6(e){let t=e==="bech32"?1:734539939,r=Fs(5),n=r.decode,i=r.encode,s=c6(n);function o(v,p,u=90){if(typeof v!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof v}`);if(!Array.isArray(p)||p.length&&typeof p[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof p}`);let h=v.length+7+p.length;if(u!==!1&&h>u)throw new TypeError(`Length ${h} exceeds limit ${u}`);return v=v.toLowerCase(),`${v}1${bp.encode(p)}${h6(v,p,t)}`}function a(v,p=90){if(typeof v!="string")throw new Error(`bech32.decode input should be string, not ${typeof v}`);if(v.length<8||p!==!1&&v.length>p)throw new TypeError(`Wrong string length: ${v.length} (${v}). Expected (8..${p})`);let u=v.toLowerCase();if(v!==u&&v!==v.toUpperCase())throw new Error("String must be lowercase or uppercase");v=u;let h=v.lastIndexOf("1");if(h===0||h===-1)throw new Error('Letter "1" must be present between prefix and data only');let[b,d]=[v.slice(0,h),v.slice(h+1)];if(d.length<6)throw new Error("Data must be at least 6 characters long");let y=bp.decode(d).slice(0,-6),w=h6(b,y,t);if(!d.endsWith(w))throw new Error(`Invalid checksum in ${v}: expected "${w}"`);return{prefix:b,words:y}}let f=c6(a);function l(v){let{prefix:p,words:u}=a(v,!1);return{prefix:p,words:u,bytes:n(u)}}return{encode:o,decode:a,decodeToBytes:l,decodeUnsafe:f,fromWords:n,fromWordsUnsafe:s,toWords:i}}Se.bech32=g6("bech32");Se.bech32m=g6("bech32m");Se.utf8={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)};Se.hex=Ii(Fs(4),Qi("0123456789abcdef"),es(""),l6(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}));var Sc={utf8:Se.utf8,hex:Se.hex,base16:Se.base16,base32:Se.base32,base64:Se.base64,base64url:Se.base64url,base58:Se.base58,base58xmr:Se.base58xmr},y6=`Invalid encoding type. Available types: ${Object.keys(Sc).join(", ")}`,zM=(e,t)=>{if(typeof e!="string"||!Sc.hasOwnProperty(e))throw new TypeError(y6);if(!(t instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return Sc[e].encode(t)};Se.bytesToString=zM;Se.str=Se.bytesToString;var WM=(e,t)=>{if(!Sc.hasOwnProperty(e))throw new TypeError(y6);if(typeof t!="string")throw new TypeError("stringToBytes() expects string");return Sc[e].decode(t)};Se.stringToBytes=WM;Se.bytes=Se.stringToBytes});var x6=U(ya=>{"use strict";H();k();Object.defineProperty(ya,"__esModule",{value:!0});ya.base58=ya.fromBase58=ya.toBase58=void 0;var yp=T0();Object.defineProperty(ya,"base58",{enumerable:!0,get:function(){return yp.base58}});function $M(e){let t=j.Buffer.from(e);return yp.base58.encode(Uint8Array.from(t))}ya.toBase58=$M;function GM(e){return yp.base58.decode(e)}ya.fromBase58=GM});var m6=U(_d=>{"use strict";H();k();Object.defineProperty(_d,"__esModule",{value:!0});_d.crypto=void 0;_d.crypto={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0}});var Zr=U((Le,_c)=>{"use strict";H();k();Object.defineProperty(Le,"__esModule",{value:!0});Le.randomBytes=Le.wrapConstructorWithOpts=Le.wrapConstructor=Le.checkOpts=Le.Hash=Le.assertHash=Le.assertBytes=Le.assertBool=Le.assertNumber=Le.concatBytes=Le.toBytes=Le.utf8ToBytes=Le.asyncLoop=Le.nextTick=Le.hexToBytes=Le.bytesToHex=Le.isLE=Le.rotr=Le.createView=Le.u32=Le.u8=void 0;var Ad=m6(),XM=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);Le.u8=XM;var ZM=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));Le.u32=ZM;var YM=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);Le.createView=YM;var JM=(e,t)=>e<<32-t|e>>>t;Le.rotr=JM;Le.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Le.isLE)throw new Error("Non little-endian hardware is not supported");var QM=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function eC(e){let t="";for(let r=0;r<e.length;r++)t+=QM[e[r]];return t}Le.bytesToHex=eC;function tC(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s))throw new Error("Invalid byte sequence");t[r]=s}return t}Le.hexToBytes=tC;Le.nextTick=(()=>{let e=typeof _c<"u"&&typeof _c.require=="function"&&_c.require.bind(_c);try{if(e){let{setImmediate:t}=e("timers");return()=>new Promise(r=>t(r))}}catch{}return()=>new Promise(t=>setTimeout(t,0))})();async function rC(e,t,r){let n=Date.now();for(let i=0;i<e;i++){r(i);let s=Date.now()-n;s>=0&&s<t||(await(0,Le.nextTick)(),n+=s)}}Le.asyncLoop=rC;function w6(e){if(typeof e!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}Le.utf8ToBytes=w6;function wp(e){if(typeof e=="string"&&(e=w6(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}Le.toBytes=wp;function nC(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}Le.concatBytes=nC;function xp(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}Le.assertNumber=xp;function iC(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}Le.assertBool=iC;function sC(e,...t){if(!(e instanceof Uint8Array&&(!t.length||t.includes(e.length))))throw new TypeError(`Expected ${t} bytes, not ${typeof e} with length=${e.length}`)}Le.assertBytes=sC;function aC(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");xp(e.outputLen),xp(e.blockLen)}Le.assertHash=aC;var mp=class{clone(){return this._cloneInto()}};Le.Hash=mp;var oC=e=>Object.prototype.toString.call(e)==="[object Object]"&&e.constructor===Object;function fC(e,t){if(t!==void 0&&(typeof t!="object"||!oC(t)))throw new TypeError("Options should be object or undefined");return Object.assign(e,t)}Le.checkOpts=fC;function cC(e){let t=n=>e().update(wp(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}Le.wrapConstructor=cC;function uC(e){let t=(n,i)=>e(i).update(wp(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}Le.wrapConstructorWithOpts=uC;function dC(e=32){if(Ad.crypto.web)return Ad.crypto.web.getRandomValues(new Uint8Array(e));if(Ad.crypto.node)return new Uint8Array(Ad.crypto.node.randomBytes(e).buffer);throw new Error("The environment doesn't have randomBytes function")}Le.randomBytes=dC});var Pd=U(Bd=>{"use strict";H();k();Object.defineProperty(Bd,"__esModule",{value:!0});Bd.SHA2=void 0;var Ac=Zr();function hC(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),f=n?4:0,l=n?0:4;e.setUint32(t+f,o,n),e.setUint32(t+l,a,n)}var Sp=class extends Ac.Hash{constructor(t,r,n,i){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,Ac.createView)(this.buffer)}update(t){if(this.destroyed)throw new Error("instance is destroyed");let{view:r,buffer:n,blockLen:i,finished:s}=this;if(s)throw new Error("digest() was already called");t=(0,Ac.toBytes)(t);let o=t.length;for(let a=0;a<o;){let f=Math.min(i-this.pos,o-a);if(f===i){let l=(0,Ac.createView)(t);for(;i<=o-a;a+=i)this.process(l,a);continue}n.set(t.subarray(a,a+f),this.pos),this.pos+=f,a+=f,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){if(this.destroyed)throw new Error("instance is destroyed");if(!(t instanceof Uint8Array)||t.length<this.outputLen)throw new Error("_Sha2: Invalid output buffer");if(this.finished)throw new Error("digest() was already called");this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:s}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(n,0),o=0);for(let f=o;f<i;f++)r[f]=0;hC(n,i-8,BigInt(this.length*8),s),this.process(n,0);let a=(0,Ac.createView)(t);this.get().forEach((f,l)=>a.setUint32(4*l,f,s))}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:s,destroyed:o,pos:a}=this;return t.length=i,t.pos=a,t.finished=s,t.destroyed=o,i%r&&t.buffer.set(n),t}};Bd.SHA2=Sp});var Go=U(Id=>{"use strict";H();k();Object.defineProperty(Id,"__esModule",{value:!0});Id.sha256=void 0;var lC=Pd(),Mi=Zr(),pC=(e,t,r)=>e&t^~e&r,vC=(e,t,r)=>e&t^e&r^t&r,bC=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),xa=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ma=new Uint32Array(64),Ep=class extends lC.SHA2{constructor(){super(64,32,8,!1),this.A=xa[0]|0,this.B=xa[1]|0,this.C=xa[2]|0,this.D=xa[3]|0,this.E=xa[4]|0,this.F=xa[5]|0,this.G=xa[6]|0,this.H=xa[7]|0}get(){let{A:t,B:r,C:n,D:i,E:s,F:o,G:a,H:f}=this;return[t,r,n,i,s,o,a,f]}set(t,r,n,i,s,o,a,f){this.A=t|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=f|0}process(t,r){for(let p=0;p<16;p++,r+=4)ma[p]=t.getUint32(r,!1);for(let p=16;p<64;p++){let u=ma[p-15],h=ma[p-2],b=(0,Mi.rotr)(u,7)^(0,Mi.rotr)(u,18)^u>>>3,d=(0,Mi.rotr)(h,17)^(0,Mi.rotr)(h,19)^h>>>10;ma[p]=d+ma[p-7]+b+ma[p-16]|0}let{A:n,B:i,C:s,D:o,E:a,F:f,G:l,H:v}=this;for(let p=0;p<64;p++){let u=(0,Mi.rotr)(a,6)^(0,Mi.rotr)(a,11)^(0,Mi.rotr)(a,25),h=v+u+pC(a,f,l)+bC[p]+ma[p]|0,d=((0,Mi.rotr)(n,2)^(0,Mi.rotr)(n,13)^(0,Mi.rotr)(n,22))+vC(n,i,s)|0;v=l,l=f,f=a,a=o+h|0,o=s,s=i,i=n,n=h+d|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,f=f+this.F|0,l=l+this.G|0,v=v+this.H|0,this.set(n,i,s,o,a,f,l,v)}roundClean(){ma.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};Id.sha256=(0,Mi.wrapConstructor)(()=>new Ep)});var Xo=U(Ke=>{"use strict";H();k();Object.defineProperty(Ke,"__esModule",{value:!0});Ke.add5H=Ke.add5L=Ke.add4H=Ke.add4L=Ke.add3H=Ke.add3L=Ke.add=Ke.rotlBL=Ke.rotlBH=Ke.rotlSL=Ke.rotlSH=Ke.rotr32L=Ke.rotr32H=Ke.rotrBL=Ke.rotrBH=Ke.rotrSL=Ke.rotrSH=Ke.shrSL=Ke.shrSH=Ke.toBig=Ke.split=Ke.fromBig=void 0;var Md=BigInt(2**32-1),_p=BigInt(32);function S6(e,t=!1){return t?{h:Number(e&Md),l:Number(e>>_p&Md)}:{h:Number(e>>_p&Md)|0,l:Number(e&Md)|0}}Ke.fromBig=S6;function gC(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){let{h:s,l:o}=S6(e[i],t);[r[i],n[i]]=[s,o]}return[r,n]}Ke.split=gC;var yC=(e,t)=>BigInt(e>>>0)<<_p|BigInt(t>>>0);Ke.toBig=yC;var xC=(e,t,r)=>e>>>r;Ke.shrSH=xC;var mC=(e,t,r)=>e<<32-r|t>>>r;Ke.shrSL=mC;var wC=(e,t,r)=>e>>>r|t<<32-r;Ke.rotrSH=wC;var SC=(e,t,r)=>e<<32-r|t>>>r;Ke.rotrSL=SC;var EC=(e,t,r)=>e<<64-r|t>>>r-32;Ke.rotrBH=EC;var _C=(e,t,r)=>e>>>r-32|t<<64-r;Ke.rotrBL=_C;var AC=(e,t)=>t;Ke.rotr32H=AC;var BC=(e,t)=>e;Ke.rotr32L=BC;var PC=(e,t,r)=>e<<r|t>>>32-r;Ke.rotlSH=PC;var IC=(e,t,r)=>t<<r|e>>>32-r;Ke.rotlSL=IC;var MC=(e,t,r)=>t<<r-32|e>>>64-r;Ke.rotlBH=MC;var CC=(e,t,r)=>e<<r-32|t>>>64-r;Ke.rotlBL=CC;function FC(e,t,r,n){let i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:i|0}}Ke.add=FC;var NC=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);Ke.add3L=NC;var RC=(e,t,r,n)=>t+r+n+(e/2**32|0)|0;Ke.add3H=RC;var OC=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0);Ke.add4L=OC;var DC=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0;Ke.add4H=DC;var TC=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0);Ke.add5L=TC;var qC=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0;Ke.add5H=qC});var Cd=U(fn=>{"use strict";H();k();var HC=fn&&fn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),kC=fn&&fn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),jC=fn&&fn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&HC(t,e,r);return kC(t,e),t};Object.defineProperty(fn,"__esModule",{value:!0});fn.sha384=fn.sha512_256=fn.sha512=fn.SHA512=void 0;var LC=Pd(),ot=jC(Xo()),Pp=Zr(),[KC,UC]=ot.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),wa=new Uint32Array(80),Sa=new Uint32Array(80),Zo=class extends LC.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:r,Bh:n,Bl:i,Ch:s,Cl:o,Dh:a,Dl:f,Eh:l,El:v,Fh:p,Fl:u,Gh:h,Gl:b,Hh:d,Hl:y}=this;return[t,r,n,i,s,o,a,f,l,v,p,u,h,b,d,y]}set(t,r,n,i,s,o,a,f,l,v,p,u,h,b,d,y){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=f|0,this.Eh=l|0,this.El=v|0,this.Fh=p|0,this.Fl=u|0,this.Gh=h|0,this.Gl=b|0,this.Hh=d|0,this.Hl=y|0}process(t,r){for(let I=0;I<16;I++,r+=4)wa[I]=t.getUint32(r),Sa[I]=t.getUint32(r+=4);for(let I=16;I<80;I++){let N=wa[I-15]|0,F=Sa[I-15]|0,O=ot.rotrSH(N,F,1)^ot.rotrSH(N,F,8)^ot.shrSH(N,F,7),q=ot.rotrSL(N,F,1)^ot.rotrSL(N,F,8)^ot.shrSL(N,F,7),P=wa[I-2]|0,D=Sa[I-2]|0,A=ot.rotrSH(P,D,19)^ot.rotrBH(P,D,61)^ot.shrSH(P,D,6),c=ot.rotrSL(P,D,19)^ot.rotrBL(P,D,61)^ot.shrSL(P,D,6),m=ot.add4L(q,c,Sa[I-7],Sa[I-16]),S=ot.add4H(m,O,A,wa[I-7],wa[I-16]);wa[I]=S|0,Sa[I]=m|0}let{Ah:n,Al:i,Bh:s,Bl:o,Ch:a,Cl:f,Dh:l,Dl:v,Eh:p,El:u,Fh:h,Fl:b,Gh:d,Gl:y,Hh:w,Hl:_}=this;for(let I=0;I<80;I++){let N=ot.rotrSH(p,u,14)^ot.rotrSH(p,u,18)^ot.rotrBH(p,u,41),F=ot.rotrSL(p,u,14)^ot.rotrSL(p,u,18)^ot.rotrBL(p,u,41),O=p&h^~p&d,q=u&b^~u&y,P=ot.add5L(_,F,q,UC[I],Sa[I]),D=ot.add5H(P,w,N,O,KC[I],wa[I]),A=P|0,c=ot.rotrSH(n,i,28)^ot.rotrBH(n,i,34)^ot.rotrBH(n,i,39),m=ot.rotrSL(n,i,28)^ot.rotrBL(n,i,34)^ot.rotrBL(n,i,39),S=n&s^n&a^s&a,g=i&o^i&f^o&f;w=d|0,_=y|0,d=h|0,y=b|0,h=p|0,b=u|0,{h:p,l:u}=ot.add(l|0,v|0,D|0,A|0),l=a|0,v=f|0,a=s|0,f=o|0,s=n|0,o=i|0;let E=ot.add3L(A,m,g);n=ot.add3H(E,D,c,S),i=E|0}({h:n,l:i}=ot.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:o}=ot.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:f}=ot.add(this.Ch|0,this.Cl|0,a|0,f|0),{h:l,l:v}=ot.add(this.Dh|0,this.Dl|0,l|0,v|0),{h:p,l:u}=ot.add(this.Eh|0,this.El|0,p|0,u|0),{h,l:b}=ot.add(this.Fh|0,this.Fl|0,h|0,b|0),{h:d,l:y}=ot.add(this.Gh|0,this.Gl|0,d|0,y|0),{h:w,l:_}=ot.add(this.Hh|0,this.Hl|0,w|0,_|0),this.set(n,i,s,o,a,f,l,v,p,u,h,b,d,y,w,_)}roundClean(){wa.fill(0),Sa.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};fn.SHA512=Zo;var Ap=class extends Zo{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},Bp=class extends Zo{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};fn.sha512=(0,Pp.wrapConstructor)(()=>new Zo);fn.sha512_256=(0,Pp.wrapConstructor)(()=>new Ap);fn.sha384=(0,Pp.wrapConstructor)(()=>new Bp)});var Cp=U(Yo=>{"use strict";H();k();Object.defineProperty(Yo,"__esModule",{value:!0});Yo.ripemd160=Yo.RIPEMD160=void 0;var VC=Pd(),zC=Zr(),WC=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),_6=Uint8Array.from({length:16},(e,t)=>t),$C=_6.map(e=>(9*e+5)%16),Ip=[_6],Mp=[$C];for(let e=0;e<4;e++)for(let t of[Ip,Mp])t.push(t[e].map(r=>WC[r]));var A6=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>new Uint8Array(e)),GC=Ip.map((e,t)=>e.map(r=>A6[t][r])),XC=Mp.map((e,t)=>e.map(r=>A6[t][r])),ZC=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),YC=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),Fd=(e,t)=>e<<t|e>>>32-t;function E6(e,t,r,n){return e===0?t^r^n:e===1?t&r|~t&n:e===2?(t|~r)^n:e===3?t&n|r&~n:t^(r|~n)}var Nd=new Uint32Array(16),Rd=class extends VC.SHA2{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:t,h1:r,h2:n,h3:i,h4:s}=this;return[t,r,n,i,s]}set(t,r,n,i,s){this.h0=t|0,this.h1=r|0,this.h2=n|0,this.h3=i|0,this.h4=s|0}process(t,r){for(let h=0;h<16;h++,r+=4)Nd[h]=t.getUint32(r,!0);let n=this.h0|0,i=n,s=this.h1|0,o=s,a=this.h2|0,f=a,l=this.h3|0,v=l,p=this.h4|0,u=p;for(let h=0;h<5;h++){let b=4-h,d=ZC[h],y=YC[h],w=Ip[h],_=Mp[h],I=GC[h],N=XC[h];for(let F=0;F<16;F++){let O=Fd(n+E6(h,s,a,l)+Nd[w[F]]+d,I[F])+p|0;n=p,p=l,l=Fd(a,10)|0,a=s,s=O}for(let F=0;F<16;F++){let O=Fd(i+E6(b,o,f,v)+Nd[_[F]]+y,N[F])+u|0;i=u,u=v,v=Fd(f,10)|0,f=o,o=O}}this.set(this.h1+a+v|0,this.h2+l+u|0,this.h3+p+i|0,this.h4+n+o|0,this.h0+s+f|0)}roundClean(){Nd.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}};Yo.RIPEMD160=Rd;Yo.ripemd160=(0,zC.wrapConstructor)(()=>new Rd)});var Od=U(St=>{"use strict";H();k();var JC=St&&St.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),QC=St&&St.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),eF=St&&St.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&JC(t,e,r);return QC(t,e),t};Object.defineProperty(St,"__esModule",{value:!0});St.shake256=St.shake128=St.keccak_512=St.keccak_384=St.keccak_256=St.keccak_224=St.sha3_512=St.sha3_384=St.sha3_256=St.sha3_224=St.Keccak=St.keccakP=void 0;var Pc=eF(Xo()),q0=Zr(),[I6,M6,C6]=[[],[],[]],tF=BigInt(0),Bc=BigInt(1),rF=BigInt(2),nF=BigInt(7),iF=BigInt(256),sF=BigInt(113);for(let e=0,t=Bc,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],I6.push(2*(5*n+r)),M6.push((e+1)*(e+2)/2%64);let i=tF;for(let s=0;s<7;s++)t=(t<<Bc^(t>>nF)*sF)%iF,t&rF&&(i^=Bc<<(Bc<<BigInt(s))-Bc);C6.push(i)}var[aF,oF]=Pc.split(C6,!0),B6=(e,t,r)=>r>32?Pc.rotlBH(e,t,r):Pc.rotlSH(e,t,r),P6=(e,t,r)=>r>32?Pc.rotlBL(e,t,r):Pc.rotlSL(e,t,r);function F6(e,t=24){let r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let o=0;o<10;o++)r[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){let a=(o+8)%10,f=(o+2)%10,l=r[f],v=r[f+1],p=B6(l,v,1)^r[a],u=P6(l,v,1)^r[a+1];for(let h=0;h<50;h+=10)e[o+h]^=p,e[o+h+1]^=u}let i=e[2],s=e[3];for(let o=0;o<24;o++){let a=M6[o],f=B6(i,s,a),l=P6(i,s,a),v=I6[o];i=e[v],s=e[v+1],e[v]=f,e[v+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}e[0]^=aF[n],e[1]^=oF[n]}r.fill(0)}St.keccakP=F6;var H0=class extends q0.Hash{constructor(t,r,n,i=!1,s=24){if(super(),this.blockLen=t,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,q0.assertNumber)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,q0.u32)(this.state)}keccak(){F6(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){if(this.destroyed)throw new Error("instance is destroyed");if(this.finished)throw new Error("digest() was already called");let{blockLen:r,state:n}=this;t=(0,q0.toBytes)(t);let i=t.length;for(let s=0;s<i;){let o=Math.min(r-this.pos,i-s);for(let a=0;a<o;a++)n[this.pos++]^=t[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:r,pos:n,blockLen:i}=this;t[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),t[i-1]^=128,this.keccak()}writeInto(t){if(this.destroyed)throw new Error("instance is destroyed");if(!(t instanceof Uint8Array))throw new Error("Keccak: invalid output buffer");this.finish();for(let r=0,n=t.length;r<n;){this.posOut>=this.blockLen&&this.keccak();let i=Math.min(this.blockLen-this.posOut,n-r);t.set(this.state.subarray(this.posOut,this.posOut+i),r),this.posOut+=i,r+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,q0.assertNumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(t.length<this.outputLen)throw new Error("Keccak: invalid output buffer");if(this.finished)throw new Error("digest() was already called");return this.finish(),this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:r,suffix:n,outputLen:i,rounds:s,enableXOF:o}=this;return t||(t=new H0(r,n,i,o,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=n,t.outputLen=i,t.enableXOF=o,t.destroyed=this.destroyed,t}};St.Keccak=H0;var Ea=(e,t,r)=>(0,q0.wrapConstructor)(()=>new H0(t,e,r));St.sha3_224=Ea(6,144,224/8);St.sha3_256=Ea(6,136,256/8);St.sha3_384=Ea(6,104,384/8);St.sha3_512=Ea(6,72,512/8);St.keccak_224=Ea(1,144,224/8);St.keccak_256=Ea(1,136,256/8);St.keccak_384=Ea(1,104,384/8);St.keccak_512=Ea(1,72,512/8);var N6=(e,t,r)=>(0,q0.wrapConstructorWithOpts)((n={})=>new H0(t,e,n.dkLen!==void 0?n.dkLen:r,!0));St.shake128=N6(31,168,128/8);St.shake256=N6(31,136,256/8)});var Dd=U(Jo=>{"use strict";H();k();Object.defineProperty(Jo,"__esModule",{value:!0});Jo.BLAKE2=Jo.SIGMA=void 0;var k0=Zr();Jo.SIGMA=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3]);var Fp=class extends k0.Hash{constructor(t,r,n={},i,s,o){if(super(),this.blockLen=t,this.outputLen=r,this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,(0,k0.assertNumber)(t),(0,k0.assertNumber)(r),(0,k0.assertNumber)(i),r<0||r>i)throw new Error("Blake2: outputLen bigger than keyLen");if(n.key!==void 0&&(n.key.length<1||n.key.length>i))throw new Error(`Key should be up 1..${i} byte long or undefined`);if(n.salt!==void 0&&n.salt.length!==s)throw new Error(`Salt should be ${s} byte long or undefined`);if(n.personalization!==void 0&&n.personalization.length!==o)throw new Error(`Personalization should be ${o} byte long or undefined`);this.buffer32=(0,k0.u32)(this.buffer=new Uint8Array(t))}update(t){if(this.destroyed)throw new Error("instance is destroyed");let{finished:r,blockLen:n,buffer:i,buffer32:s}=this;if(r)throw new Error("digest() was already called");t=(0,k0.toBytes)(t);let o=t.length;for(let a=0;a<o;){this.pos===n&&(this.compress(s,0,!1),this.pos=0);let f=Math.min(n-this.pos,o-a),l=t.byteOffset+a;if(f===n&&!(l%4)&&a+f<o){let v=new Uint32Array(t.buffer,l,Math.floor((o-a)/4));for(let p=0;a+n<o;p+=s.length,a+=n)this.length+=n,this.compress(v,p,!1);continue}i.set(t.subarray(a,a+f),this.pos),this.pos+=f,this.length+=f,a+=f}return this}digestInto(t){if(this.destroyed)throw new Error("instance is destroyed");if(!(t instanceof Uint8Array)||t.length<this.outputLen)throw new Error("_Blake2: Invalid output buffer");let{finished:r,pos:n,buffer32:i}=this;if(r)throw new Error("digest() was already called");this.finished=!0,this.buffer.subarray(n).fill(0),this.compress(i,0,!0);let s=(0,k0.u32)(t);this.get().forEach((o,a)=>s[a]=o)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){let{buffer:r,length:n,finished:i,destroyed:s,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.length=n,t.finished=i,t.destroyed=s,t.outputLen=o,t.buffer.set(r),t.pos=a,t}};Jo.BLAKE2=Fp});var Rp=U(ts=>{"use strict";H();k();var fF=ts&&ts.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),cF=ts&&ts.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),O6=ts&&ts.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&fF(t,e,r);return cF(t,e),t};Object.defineProperty(ts,"__esModule",{value:!0});ts.blake2b=void 0;var R6=O6(Dd()),En=O6(Xo()),Qo=Zr(),_r=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ce=new Uint32Array(32);function _a(e,t,r,n,i,s){let o=i[s],a=i[s+1],f=ce[2*e],l=ce[2*e+1],v=ce[2*t],p=ce[2*t+1],u=ce[2*r],h=ce[2*r+1],b=ce[2*n],d=ce[2*n+1],y=En.add3L(f,v,o);l=En.add3H(y,l,p,a),f=y|0,{Dh:d,Dl:b}={Dh:d^l,Dl:b^f},{Dh:d,Dl:b}={Dh:En.rotr32H(d,b),Dl:En.rotr32L(d,b)},{h,l:u}=En.add(h,u,d,b),{Bh:p,Bl:v}={Bh:p^h,Bl:v^u},{Bh:p,Bl:v}={Bh:En.rotrSH(p,v,24),Bl:En.rotrSL(p,v,24)},ce[2*e]=f,ce[2*e+1]=l,ce[2*t]=v,ce[2*t+1]=p,ce[2*r]=u,ce[2*r+1]=h,ce[2*n]=b,ce[2*n+1]=d}function Aa(e,t,r,n,i,s){let o=i[s],a=i[s+1],f=ce[2*e],l=ce[2*e+1],v=ce[2*t],p=ce[2*t+1],u=ce[2*r],h=ce[2*r+1],b=ce[2*n],d=ce[2*n+1],y=En.add3L(f,v,o);l=En.add3H(y,l,p,a),f=y|0,{Dh:d,Dl:b}={Dh:d^l,Dl:b^f},{Dh:d,Dl:b}={Dh:En.rotrSH(d,b,16),Dl:En.rotrSL(d,b,16)},{h,l:u}=En.add(h,u,d,b),{Bh:p,Bl:v}={Bh:p^h,Bl:v^u},{Bh:p,Bl:v}={Bh:En.rotrBH(p,v,63),Bl:En.rotrBL(p,v,63)},ce[2*e]=f,ce[2*e+1]=l,ce[2*t]=v,ce[2*t+1]=p,ce[2*r]=u,ce[2*r+1]=h,ce[2*n]=b,ce[2*n+1]=d}var Np=class extends R6.BLAKE2{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=_r[0]|0,this.v0h=_r[1]|0,this.v1l=_r[2]|0,this.v1h=_r[3]|0,this.v2l=_r[4]|0,this.v2h=_r[5]|0,this.v3l=_r[6]|0,this.v3h=_r[7]|0,this.v4l=_r[8]|0,this.v4h=_r[9]|0,this.v5l=_r[10]|0,this.v5h=_r[11]|0,this.v6l=_r[12]|0,this.v6h=_r[13]|0,this.v7l=_r[14]|0,this.v7h=_r[15]|0;let r=t.key?t.key.length:0;if(this.v0l^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,Qo.u32)((0,Qo.toBytes)(t.salt));this.v4l^=n[0],this.v4h^=n[1],this.v5l^=n[2],this.v5h^=n[3]}if(t.personalization){let n=(0,Qo.u32)((0,Qo.toBytes)(t.personalization));this.v6l^=n[0],this.v6h^=n[1],this.v7l^=n[2],this.v7h^=n[3]}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,Qo.toBytes)(t.key)),this.update(n)}}get(){let{v0l:t,v0h:r,v1l:n,v1h:i,v2l:s,v2h:o,v3l:a,v3h:f,v4l:l,v4h:v,v5l:p,v5h:u,v6l:h,v6h:b,v7l:d,v7h:y}=this;return[t,r,n,i,s,o,a,f,l,v,p,u,h,b,d,y]}set(t,r,n,i,s,o,a,f,l,v,p,u,h,b,d,y){this.v0l=t|0,this.v0h=r|0,this.v1l=n|0,this.v1h=i|0,this.v2l=s|0,this.v2h=o|0,this.v3l=a|0,this.v3h=f|0,this.v4l=l|0,this.v4h=v|0,this.v5l=p|0,this.v5h=u|0,this.v6l=h|0,this.v6h=b|0,this.v7l=d|0,this.v7h=y|0}compress(t,r,n){this.get().forEach((f,l)=>ce[l]=f),ce.set(_r,16);let{h:i,l:s}=En.fromBig(BigInt(this.length));ce[24]=_r[8]^s,ce[25]=_r[9]^i,n&&(ce[28]=~ce[28],ce[29]=~ce[29]);let o=0,a=R6.SIGMA;for(let f=0;f<12;f++)_a(0,4,8,12,t,r+2*a[o++]),Aa(0,4,8,12,t,r+2*a[o++]),_a(1,5,9,13,t,r+2*a[o++]),Aa(1,5,9,13,t,r+2*a[o++]),_a(2,6,10,14,t,r+2*a[o++]),Aa(2,6,10,14,t,r+2*a[o++]),_a(3,7,11,15,t,r+2*a[o++]),Aa(3,7,11,15,t,r+2*a[o++]),_a(0,5,10,15,t,r+2*a[o++]),Aa(0,5,10,15,t,r+2*a[o++]),_a(1,6,11,12,t,r+2*a[o++]),Aa(1,6,11,12,t,r+2*a[o++]),_a(2,7,8,13,t,r+2*a[o++]),Aa(2,7,8,13,t,r+2*a[o++]),_a(3,4,9,14,t,r+2*a[o++]),Aa(3,4,9,14,t,r+2*a[o++]);this.v0l^=ce[0]^ce[16],this.v0h^=ce[1]^ce[17],this.v1l^=ce[2]^ce[18],this.v1h^=ce[3]^ce[19],this.v2l^=ce[4]^ce[20],this.v2h^=ce[5]^ce[21],this.v3l^=ce[6]^ce[22],this.v3h^=ce[7]^ce[23],this.v4l^=ce[8]^ce[24],this.v4h^=ce[9]^ce[25],this.v5l^=ce[10]^ce[26],this.v5h^=ce[11]^ce[27],this.v6l^=ce[12]^ce[28],this.v6h^=ce[13]^ce[29],this.v7l^=ce[14]^ce[30],this.v7h^=ce[15]^ce[31],ce.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};ts.blake2b=(0,Qo.wrapConstructorWithOpts)(e=>new Np(e))});var Ic=U(Qt=>{"use strict";H();k();Object.defineProperty(Qt,"__esModule",{value:!0});Qt.sha3_512=Qt.sha3_256=Qt.ripemd160=Qt.sha512=Qt.sha256=Qt.blake2=Qt.keccak256=Qt.keccak=Qt.hash160=Qt.doubleSha256=void 0;var Td=Go();Object.defineProperty(Qt,"sha256",{enumerable:!0,get:function(){return Td.sha256}});var uF=Cd();Object.defineProperty(Qt,"sha512",{enumerable:!0,get:function(){return uF.sha512}});var D6=Cp();Object.defineProperty(Qt,"ripemd160",{enumerable:!0,get:function(){return D6.ripemd160}});var ef=Od();Object.defineProperty(Qt,"sha3_256",{enumerable:!0,get:function(){return ef.sha3_256}});Object.defineProperty(Qt,"sha3_512",{enumerable:!0,get:function(){return ef.sha3_512}});var dF=Rp();function hF(e){let t=(0,Td.sha256)(e);return(0,Td.sha256)(t)}Qt.doubleSha256=hF;function lF(e){let t=(0,Td.sha256)(e);return(0,D6.ripemd160)(t)}Qt.hash160=lF;var pF=function(e,t=256){let r=j.Buffer.from(e);switch(t){case 224:return j.Buffer.from((0,ef.keccak_224)(r));case 256:return j.Buffer.from((0,ef.keccak_256)(r));case 384:return j.Buffer.from((0,ef.keccak_384)(r));case 512:return j.Buffer.from((0,ef.keccak_512)(r));default:throw new Error(`Invald algorithm: keccak${t}`)}};Qt.keccak=pF;var vF=function(e){return(0,Qt.keccak)(e)};Qt.keccak256=vF;function bF(e,t,r){let n=Math.ceil(t/8);return(0,dF.blake2b)(e,{dkLen:n,key:r})}Qt.blake2=bF});var H6=U(tf=>{"use strict";H();k();Object.defineProperty(tf,"__esModule",{value:!0});tf.fromBase58Check=tf.toBase58Check=void 0;var T6=Ic(),fG=Qb(),q6=T0();function gF(e){return(0,q6.base58check)(T6.sha256).encode(j.Buffer.from(e))}tf.toBase58Check=gF;function yF(e){let t=(0,q6.base58check)(T6.sha256);return j.Buffer.from(t.decode(e))}tf.fromBase58Check=yF});var k6=U(rf=>{"use strict";H();k();Object.defineProperty(rf,"__esModule",{value:!0});rf.fromBech32=rf.toBech32=void 0;var qd=T0();function xF(e,t,r){let n=j.Buffer.from(t),i=qd.bech32.toWords(Uint8Array.from(n));return qd.bech32.encode(e,i,r)}rf.toBech32=xF;function mF(e,t){let r=qd.bech32.decode(e,t),n=qd.bech32.fromWords(r.words);return[r.prefix,j.Buffer.from(n)]}rf.fromBech32=mF});var j6=U(rs=>{"use strict";H();k();Object.defineProperty(rs,"__esModule",{value:!0});rs.isHexPrefixed=rs.stripHexPrefix=rs.fromHex=rs.toHex=void 0;function wF(e,t=!1){let r=j.Buffer.from(e);return t?"0x"+r.toString("hex"):r.toString("hex")}rs.toHex=wF;function SF(e){return e.startsWith("0x")&&(e=e.substring(2)),j.Buffer.from(e,"hex")}rs.fromHex=SF;function EF(e){return e.startsWith("0x")?e.substring(2):e}rs.stripHexPrefix=EF;function _F(e){return e.startsWith("0x")}rs.isHexPrefixed=_F});var K6=U(nf=>{"use strict";H();k();Object.defineProperty(nf,"__esModule",{value:!0});nf.fromBase64=nf.toBase64=void 0;var L6=T0();function AF(e){let t=j.Buffer.from(e);return L6.base64.encode(Uint8Array.from(t))}nf.toBase64=AF;function BF(e){return L6.base64.decode(e)}nf.fromBase64=BF});var Cc=U(Mc=>{"use strict";H();k();Object.defineProperty(Mc,"__esModule",{value:!0});Mc.hmac=void 0;var Hd=Zr(),kd=class extends Hd.Hash{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,(0,Hd.assertHash)(t);let n=(0,Hd.toBytes)(r);if(this.iHash=t.create(),!(this.iHash instanceof Hd.Hash))throw new TypeError("Expected instance of class which extends utils.Hash");let i=this.blockLen=this.iHash.blockLen;this.outputLen=this.iHash.outputLen;let s=new Uint8Array(i);s.set(n.length>this.iHash.blockLen?t.create().update(n).digest():n);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=t.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(t){if(this.destroyed)throw new Error("instance is destroyed");return this.iHash.update(t),this}digestInto(t){if(this.destroyed)throw new Error("instance is destroyed");if(!(t instanceof Uint8Array)||t.length!==this.outputLen)throw new Error("HMAC: Invalid output buffer");if(this.finished)throw new Error("digest() was already called");this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return t=t,t.finished=i,t.destroyed=s,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},PF=(e,t,r)=>new kd(e,t).update(r).digest();Mc.hmac=PF;Mc.hmac.create=(e,t)=>new kd(e,t)});var z6=U(sf=>{"use strict";H();k();Object.defineProperty(sf,"__esModule",{value:!0});sf.hmacSHA512=sf.hmacSHA256=void 0;var U6=Cc(),V6=Ic();function IF(e,t){return j.Buffer.from((0,U6.hmac)(V6.sha256,e,t))}sf.hmacSHA256=IF;function MF(e,t){return j.Buffer.from((0,U6.hmac)(V6.sha512,e,t))}sf.hmacSHA512=MF});var W6=U(af=>{"use strict";H();k();Object.defineProperty(af,"__esModule",{value:!0});af.fromUtf8=af.toUtf8=void 0;function CF(e){return new TextEncoder().encode(e)}af.toUtf8=CF;function FF(e){return new TextDecoder("utf-8",{fatal:!0}).decode(e)}af.fromUtf8=FF});var Dp=U(Ba=>{"use strict";H();k();Object.defineProperty(Ba,"__esModule",{value:!0});Ba.checkIsUndefined=Ba.checkIsDefined=Ba.check=void 0;var Op=(e,t)=>{if(!e)throw t=t||"Invalid statement",t=t instanceof Error?t:new Error(t),t};Ba.check=Op;var NF=(e,t)=>(Op(typeof e<"u",t||"Expect defined but actually undefined"),e);Ba.checkIsDefined=NF;var RF=(e,t)=>{Op(typeof e>"u",t||`Expect undefined but actually ${e}`)};Ba.checkIsUndefined=RF});var G6=U(ns=>{"use strict";H();k();Object.defineProperty(ns,"__esModule",{value:!0});ns.string2BigNumber=ns.bigNumber2String=ns.fromBigIntHex=ns.toBigIntHex=void 0;var $6=er(),OF=Dp(),DF=e=>{let t=e.integerValue().toString(16);return t="0x"+t,t};ns.toBigIntHex=DF;var TF=e=>((0,OF.check)(e&&e.startsWith("0x"),`Invalid hex string. value: ${e}`),new $6.BigNumber(e).integerValue());ns.fromBigIntHex=TF;var qF=(e,t)=>e.integerValue().toString(t);ns.bigNumber2String=qF;var HF=(e,t)=>new $6.BigNumber(e,t);ns.string2BigNumber=HF});var Ar=U((X6,Tp)=>{H();k();(function(e,t){"use strict";function r(A,c){if(!A)throw new Error(c||"Assertion failed")}function n(A,c){A.super_=c;var m=function(){};m.prototype=c.prototype,A.prototype=new m,A.prototype.constructor=A}function i(A,c,m){if(i.isBN(A))return A;this.negative=0,this.words=null,this.length=0,this.red=null,A!==null&&((c==="le"||c==="be")&&(m=c,c=10),this._init(A||0,c||10,m||"be"))}typeof e=="object"?e.exports=i:t.BN=i,i.BN=i,i.wordSize=26;var s;try{typeof window<"u"&&typeof window.Buffer<"u"?s=window.Buffer:s=Zb().Buffer}catch{}i.isBN=function(c){return c instanceof i?!0:c!==null&&typeof c=="object"&&c.constructor.wordSize===i.wordSize&&Array.isArray(c.words)},i.max=function(c,m){return c.cmp(m)>0?c:m},i.min=function(c,m){return c.cmp(m)<0?c:m},i.prototype._init=function(c,m,S){if(typeof c=="number")return this._initNumber(c,m,S);if(typeof c=="object")return this._initArray(c,m,S);m==="hex"&&(m=16),r(m===(m|0)&&m>=2&&m<=36),c=c.toString().replace(/\s+/g,"");var g=0;c[0]==="-"&&(g++,this.negative=1),g<c.length&&(m===16?this._parseHex(c,g,S):(this._parseBase(c,m,g),S==="le"&&this._initArray(this.toArray(),m,S)))},i.prototype._initNumber=function(c,m,S){c<0&&(this.negative=1,c=-c),c<67108864?(this.words=[c&67108863],this.length=1):c<4503599627370496?(this.words=[c&67108863,c/67108864&67108863],this.length=2):(r(c<9007199254740992),this.words=[c&67108863,c/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),m,S)},i.prototype._initArray=function(c,m,S){if(r(typeof c.length=="number"),c.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(c.length/3),this.words=new Array(this.length);for(var g=0;g<this.length;g++)this.words[g]=0;var E,M,T=0;if(S==="be")for(g=c.length-1,E=0;g>=0;g-=3)M=c[g]|c[g-1]<<8|c[g-2]<<16,this.words[E]|=M<<T&67108863,this.words[E+1]=M>>>26-T&67108863,T+=24,T>=26&&(T-=26,E++);else if(S==="le")for(g=0,E=0;g<c.length;g+=3)M=c[g]|c[g+1]<<8|c[g+2]<<16,this.words[E]|=M<<T&67108863,this.words[E+1]=M>>>26-T&67108863,T+=24,T>=26&&(T-=26,E++);return this.strip()};function o(A,c){var m=A.charCodeAt(c);return m>=65&&m<=70?m-55:m>=97&&m<=102?m-87:m-48&15}function a(A,c,m){var S=o(A,m);return m-1>=c&&(S|=o(A,m-1)<<4),S}i.prototype._parseHex=function(c,m,S){this.length=Math.ceil((c.length-m)/6),this.words=new Array(this.length);for(var g=0;g<this.length;g++)this.words[g]=0;var E=0,M=0,T;if(S==="be")for(g=c.length-1;g>=m;g-=2)T=a(c,m,g)<<E,this.words[M]|=T&67108863,E>=18?(E-=18,M+=1,this.words[M]|=T>>>26):E+=8;else{var R=c.length-m;for(g=R%2===0?m+1:m;g<c.length;g+=2)T=a(c,m,g)<<E,this.words[M]|=T&67108863,E>=18?(E-=18,M+=1,this.words[M]|=T>>>26):E+=8}this.strip()};function f(A,c,m,S){for(var g=0,E=Math.min(A.length,m),M=c;M<E;M++){var T=A.charCodeAt(M)-48;g*=S,T>=49?g+=T-49+10:T>=17?g+=T-17+10:g+=T}return g}i.prototype._parseBase=function(c,m,S){this.words=[0],this.length=1;for(var g=0,E=1;E<=67108863;E*=m)g++;g--,E=E/m|0;for(var M=c.length-S,T=M%g,R=Math.min(M,M-T)+S,x=0,C=S;C<R;C+=g)x=f(c,C,C+g,m),this.imuln(E),this.words[0]+x<67108864?this.words[0]+=x:this._iaddn(x);if(T!==0){var K=1;for(x=f(c,C,c.length,m),C=0;C<T;C++)K*=m;this.imuln(K),this.words[0]+x<67108864?this.words[0]+=x:this._iaddn(x)}this.strip()},i.prototype.copy=function(c){c.words=new Array(this.length);for(var m=0;m<this.length;m++)c.words[m]=this.words[m];c.length=this.length,c.negative=this.negative,c.red=this.red},i.prototype.clone=function(){var c=new i(null);return this.copy(c),c},i.prototype._expand=function(c){for(;this.length<c;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(c,m){c=c||10,m=m|0||1;var S;if(c===16||c==="hex"){S="";for(var g=0,E=0,M=0;M<this.length;M++){var T=this.words[M],R=((T<<g|E)&16777215).toString(16);E=T>>>24-g&16777215,E!==0||M!==this.length-1?S=l[6-R.length]+R+S:S=R+S,g+=2,g>=26&&(g-=26,M--)}for(E!==0&&(S=E.toString(16)+S);S.length%m!==0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(c===(c|0)&&c>=2&&c<=36){var x=v[c],C=p[c];S="";var K=this.clone();for(K.negative=0;!K.isZero();){var L=K.modn(C).toString(c);K=K.idivn(C),K.isZero()?S=L+S:S=l[x-L.length]+L+S}for(this.isZero()&&(S="0"+S);S.length%m!==0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var c=this.words[0];return this.length===2?c+=this.words[1]*67108864:this.length===3&&this.words[2]===1?c+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-c:c},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(c,m){return r(typeof s<"u"),this.toArrayLike(s,c,m)},i.prototype.toArray=function(c,m){return this.toArrayLike(Array,c,m)},i.prototype.toArrayLike=function(c,m,S){var g=this.byteLength(),E=S||Math.max(1,g);r(g<=E,"byte array longer than desired length"),r(E>0,"Requested array length <= 0"),this.strip();var M=m==="le",T=new c(E),R,x,C=this.clone();if(M){for(x=0;!C.isZero();x++)R=C.andln(255),C.iushrn(8),T[x]=R;for(;x<E;x++)T[x]=0}else{for(x=0;x<E-g;x++)T[x]=0;for(x=0;!C.isZero();x++)R=C.andln(255),C.iushrn(8),T[E-x-1]=R}return T},Math.clz32?i.prototype._countBits=function(c){return 32-Math.clz32(c)}:i.prototype._countBits=function(c){var m=c,S=0;return m>=4096&&(S+=13,m>>>=13),m>=64&&(S+=7,m>>>=7),m>=8&&(S+=4,m>>>=4),m>=2&&(S+=2,m>>>=2),S+m},i.prototype._zeroBits=function(c){if(c===0)return 26;var m=c,S=0;return(m&8191)===0&&(S+=13,m>>>=13),(m&127)===0&&(S+=7,m>>>=7),(m&15)===0&&(S+=4,m>>>=4),(m&3)===0&&(S+=2,m>>>=2),(m&1)===0&&S++,S},i.prototype.bitLength=function(){var c=this.words[this.length-1],m=this._countBits(c);return(this.length-1)*26+m};function u(A){for(var c=new Array(A.bitLength()),m=0;m<c.length;m++){var S=m/26|0,g=m%26;c[m]=(A.words[S]&1<<g)>>>g}return c}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var c=0,m=0;m<this.length;m++){var S=this._zeroBits(this.words[m]);if(c+=S,S!==26)break}return c},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(c){return this.negative!==0?this.abs().inotn(c).iaddn(1):this.clone()},i.prototype.fromTwos=function(c){return this.testn(c-1)?this.notn(c).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(c){for(;this.length<c.length;)this.words[this.length++]=0;for(var m=0;m<c.length;m++)this.words[m]=this.words[m]|c.words[m];return this.strip()},i.prototype.ior=function(c){return r((this.negative|c.negative)===0),this.iuor(c)},i.prototype.or=function(c){return this.length>c.length?this.clone().ior(c):c.clone().ior(this)},i.prototype.uor=function(c){return this.length>c.length?this.clone().iuor(c):c.clone().iuor(this)},i.prototype.iuand=function(c){var m;this.length>c.length?m=c:m=this;for(var S=0;S<m.length;S++)this.words[S]=this.words[S]&c.words[S];return this.length=m.length,this.strip()},i.prototype.iand=function(c){return r((this.negative|c.negative)===0),this.iuand(c)},i.prototype.and=function(c){return this.length>c.length?this.clone().iand(c):c.clone().iand(this)},i.prototype.uand=function(c){return this.length>c.length?this.clone().iuand(c):c.clone().iuand(this)},i.prototype.iuxor=function(c){var m,S;this.length>c.length?(m=this,S=c):(m=c,S=this);for(var g=0;g<S.length;g++)this.words[g]=m.words[g]^S.words[g];if(this!==m)for(;g<m.length;g++)this.words[g]=m.words[g];return this.length=m.length,this.strip()},i.prototype.ixor=function(c){return r((this.negative|c.negative)===0),this.iuxor(c)},i.prototype.xor=function(c){return this.length>c.length?this.clone().ixor(c):c.clone().ixor(this)},i.prototype.uxor=function(c){return this.length>c.length?this.clone().iuxor(c):c.clone().iuxor(this)},i.prototype.inotn=function(c){r(typeof c=="number"&&c>=0);var m=Math.ceil(c/26)|0,S=c%26;this._expand(m),S>0&&m--;for(var g=0;g<m;g++)this.words[g]=~this.words[g]&67108863;return S>0&&(this.words[g]=~this.words[g]&67108863>>26-S),this.strip()},i.prototype.notn=function(c){return this.clone().inotn(c)},i.prototype.setn=function(c,m){r(typeof c=="number"&&c>=0);var S=c/26|0,g=c%26;return this._expand(S+1),m?this.words[S]=this.words[S]|1<<g:this.words[S]=this.words[S]&~(1<<g),this.strip()},i.prototype.iadd=function(c){var m;if(this.negative!==0&&c.negative===0)return this.negative=0,m=this.isub(c),this.negative^=1,this._normSign();if(this.negative===0&&c.negative!==0)return c.negative=0,m=this.isub(c),c.negative=1,m._normSign();var S,g;this.length>c.length?(S=this,g=c):(S=c,g=this);for(var E=0,M=0;M<g.length;M++)m=(S.words[M]|0)+(g.words[M]|0)+E,this.words[M]=m&67108863,E=m>>>26;for(;E!==0&&M<S.length;M++)m=(S.words[M]|0)+E,this.words[M]=m&67108863,E=m>>>26;if(this.length=S.length,E!==0)this.words[this.length]=E,this.length++;else if(S!==this)for(;M<S.length;M++)this.words[M]=S.words[M];return this},i.prototype.add=function(c){var m;return c.negative!==0&&this.negative===0?(c.negative=0,m=this.sub(c),c.negative^=1,m):c.negative===0&&this.negative!==0?(this.negative=0,m=c.sub(this),this.negative=1,m):this.length>c.length?this.clone().iadd(c):c.clone().iadd(this)},i.prototype.isub=function(c){if(c.negative!==0){c.negative=0;var m=this.iadd(c);return c.negative=1,m._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(c),this.negative=1,this._normSign();var S=this.cmp(c);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;var g,E;S>0?(g=this,E=c):(g=c,E=this);for(var M=0,T=0;T<E.length;T++)m=(g.words[T]|0)-(E.words[T]|0)+M,M=m>>26,this.words[T]=m&67108863;for(;M!==0&&T<g.length;T++)m=(g.words[T]|0)+M,M=m>>26,this.words[T]=m&67108863;if(M===0&&T<g.length&&g!==this)for(;T<g.length;T++)this.words[T]=g.words[T];return this.length=Math.max(this.length,T),g!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(c){return this.clone().isub(c)};function h(A,c,m){m.negative=c.negative^A.negative;var S=A.length+c.length|0;m.length=S,S=S-1|0;var g=A.words[0]|0,E=c.words[0]|0,M=g*E,T=M&67108863,R=M/67108864|0;m.words[0]=T;for(var x=1;x<S;x++){for(var C=R>>>26,K=R&67108863,L=Math.min(x,c.length-1),V=Math.max(0,x-A.length+1);V<=L;V++){var z=x-V|0;g=A.words[z]|0,E=c.words[V]|0,M=g*E+K,C+=M/67108864|0,K=M&67108863}m.words[x]=K|0,R=C|0}return R!==0?m.words[x]=R|0:m.length--,m.strip()}var b=function(c,m,S){var g=c.words,E=m.words,M=S.words,T=0,R,x,C,K=g[0]|0,L=K&8191,V=K>>>13,z=g[1]|0,G=z&8191,$=z>>>13,oe=g[2]|0,Q=oe&8191,te=oe>>>13,ve=g[3]|0,J=ve&8191,Z=ve>>>13,Ce=g[4]|0,se=Ce&8191,re=Ce>>>13,ft=g[5]|0,_e=ft&8191,be=ft>>>13,Bt=g[6]|0,ge=Bt&8191,pe=Bt>>>13,Pt=g[7]|0,Fe=Pt&8191,ie=Pt>>>13,Rt=g[8]|0,ae=Rt&8191,Ee=Rt>>>13,bi=g[9]|0,Ae=bi&8191,Ie=bi>>>13,ws=E[0]|0,Ne=ws&8191,Re=ws>>>13,Ss=E[1]|0,Ve=Ss&8191,Oe=Ss>>>13,Es=E[2]|0,De=Es&8191,ze=Es>>>13,gi=E[3]|0,We=gi&8191,$e=gi>>>13,_s=E[4]|0,Te=_s&8191,Ge=_s>>>13,As=E[5]|0,qe=As&8191,Xe=As>>>13,yi=E[6]|0,ue=yi&8191,me=yi>>>13,xi=E[7]|0,Ze=xi&8191,Qe=xi>>>13,Wf=E[8]|0,et=Wf&8191,tt=Wf>>>13,$f=E[9]|0,rt=$f&8191,nt=$f>>>13;S.negative=c.negative^m.negative,S.length=19,R=Math.imul(L,Ne),x=Math.imul(L,Re),x=x+Math.imul(V,Ne)|0,C=Math.imul(V,Re);var Ya=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(Ya>>>26)|0,Ya&=67108863,R=Math.imul(G,Ne),x=Math.imul(G,Re),x=x+Math.imul($,Ne)|0,C=Math.imul($,Re),R=R+Math.imul(L,Ve)|0,x=x+Math.imul(L,Oe)|0,x=x+Math.imul(V,Ve)|0,C=C+Math.imul(V,Oe)|0;var Ja=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(Ja>>>26)|0,Ja&=67108863,R=Math.imul(Q,Ne),x=Math.imul(Q,Re),x=x+Math.imul(te,Ne)|0,C=Math.imul(te,Re),R=R+Math.imul(G,Ve)|0,x=x+Math.imul(G,Oe)|0,x=x+Math.imul($,Ve)|0,C=C+Math.imul($,Oe)|0,R=R+Math.imul(L,De)|0,x=x+Math.imul(L,ze)|0,x=x+Math.imul(V,De)|0,C=C+Math.imul(V,ze)|0;var Qa=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(Qa>>>26)|0,Qa&=67108863,R=Math.imul(J,Ne),x=Math.imul(J,Re),x=x+Math.imul(Z,Ne)|0,C=Math.imul(Z,Re),R=R+Math.imul(Q,Ve)|0,x=x+Math.imul(Q,Oe)|0,x=x+Math.imul(te,Ve)|0,C=C+Math.imul(te,Oe)|0,R=R+Math.imul(G,De)|0,x=x+Math.imul(G,ze)|0,x=x+Math.imul($,De)|0,C=C+Math.imul($,ze)|0,R=R+Math.imul(L,We)|0,x=x+Math.imul(L,$e)|0,x=x+Math.imul(V,We)|0,C=C+Math.imul(V,$e)|0;var e0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(e0>>>26)|0,e0&=67108863,R=Math.imul(se,Ne),x=Math.imul(se,Re),x=x+Math.imul(re,Ne)|0,C=Math.imul(re,Re),R=R+Math.imul(J,Ve)|0,x=x+Math.imul(J,Oe)|0,x=x+Math.imul(Z,Ve)|0,C=C+Math.imul(Z,Oe)|0,R=R+Math.imul(Q,De)|0,x=x+Math.imul(Q,ze)|0,x=x+Math.imul(te,De)|0,C=C+Math.imul(te,ze)|0,R=R+Math.imul(G,We)|0,x=x+Math.imul(G,$e)|0,x=x+Math.imul($,We)|0,C=C+Math.imul($,$e)|0,R=R+Math.imul(L,Te)|0,x=x+Math.imul(L,Ge)|0,x=x+Math.imul(V,Te)|0,C=C+Math.imul(V,Ge)|0;var t0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(t0>>>26)|0,t0&=67108863,R=Math.imul(_e,Ne),x=Math.imul(_e,Re),x=x+Math.imul(be,Ne)|0,C=Math.imul(be,Re),R=R+Math.imul(se,Ve)|0,x=x+Math.imul(se,Oe)|0,x=x+Math.imul(re,Ve)|0,C=C+Math.imul(re,Oe)|0,R=R+Math.imul(J,De)|0,x=x+Math.imul(J,ze)|0,x=x+Math.imul(Z,De)|0,C=C+Math.imul(Z,ze)|0,R=R+Math.imul(Q,We)|0,x=x+Math.imul(Q,$e)|0,x=x+Math.imul(te,We)|0,C=C+Math.imul(te,$e)|0,R=R+Math.imul(G,Te)|0,x=x+Math.imul(G,Ge)|0,x=x+Math.imul($,Te)|0,C=C+Math.imul($,Ge)|0,R=R+Math.imul(L,qe)|0,x=x+Math.imul(L,Xe)|0,x=x+Math.imul(V,qe)|0,C=C+Math.imul(V,Xe)|0;var r0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(r0>>>26)|0,r0&=67108863,R=Math.imul(ge,Ne),x=Math.imul(ge,Re),x=x+Math.imul(pe,Ne)|0,C=Math.imul(pe,Re),R=R+Math.imul(_e,Ve)|0,x=x+Math.imul(_e,Oe)|0,x=x+Math.imul(be,Ve)|0,C=C+Math.imul(be,Oe)|0,R=R+Math.imul(se,De)|0,x=x+Math.imul(se,ze)|0,x=x+Math.imul(re,De)|0,C=C+Math.imul(re,ze)|0,R=R+Math.imul(J,We)|0,x=x+Math.imul(J,$e)|0,x=x+Math.imul(Z,We)|0,C=C+Math.imul(Z,$e)|0,R=R+Math.imul(Q,Te)|0,x=x+Math.imul(Q,Ge)|0,x=x+Math.imul(te,Te)|0,C=C+Math.imul(te,Ge)|0,R=R+Math.imul(G,qe)|0,x=x+Math.imul(G,Xe)|0,x=x+Math.imul($,qe)|0,C=C+Math.imul($,Xe)|0,R=R+Math.imul(L,ue)|0,x=x+Math.imul(L,me)|0,x=x+Math.imul(V,ue)|0,C=C+Math.imul(V,me)|0;var n0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(n0>>>26)|0,n0&=67108863,R=Math.imul(Fe,Ne),x=Math.imul(Fe,Re),x=x+Math.imul(ie,Ne)|0,C=Math.imul(ie,Re),R=R+Math.imul(ge,Ve)|0,x=x+Math.imul(ge,Oe)|0,x=x+Math.imul(pe,Ve)|0,C=C+Math.imul(pe,Oe)|0,R=R+Math.imul(_e,De)|0,x=x+Math.imul(_e,ze)|0,x=x+Math.imul(be,De)|0,C=C+Math.imul(be,ze)|0,R=R+Math.imul(se,We)|0,x=x+Math.imul(se,$e)|0,x=x+Math.imul(re,We)|0,C=C+Math.imul(re,$e)|0,R=R+Math.imul(J,Te)|0,x=x+Math.imul(J,Ge)|0,x=x+Math.imul(Z,Te)|0,C=C+Math.imul(Z,Ge)|0,R=R+Math.imul(Q,qe)|0,x=x+Math.imul(Q,Xe)|0,x=x+Math.imul(te,qe)|0,C=C+Math.imul(te,Xe)|0,R=R+Math.imul(G,ue)|0,x=x+Math.imul(G,me)|0,x=x+Math.imul($,ue)|0,C=C+Math.imul($,me)|0,R=R+Math.imul(L,Ze)|0,x=x+Math.imul(L,Qe)|0,x=x+Math.imul(V,Ze)|0,C=C+Math.imul(V,Qe)|0;var i0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(i0>>>26)|0,i0&=67108863,R=Math.imul(ae,Ne),x=Math.imul(ae,Re),x=x+Math.imul(Ee,Ne)|0,C=Math.imul(Ee,Re),R=R+Math.imul(Fe,Ve)|0,x=x+Math.imul(Fe,Oe)|0,x=x+Math.imul(ie,Ve)|0,C=C+Math.imul(ie,Oe)|0,R=R+Math.imul(ge,De)|0,x=x+Math.imul(ge,ze)|0,x=x+Math.imul(pe,De)|0,C=C+Math.imul(pe,ze)|0,R=R+Math.imul(_e,We)|0,x=x+Math.imul(_e,$e)|0,x=x+Math.imul(be,We)|0,C=C+Math.imul(be,$e)|0,R=R+Math.imul(se,Te)|0,x=x+Math.imul(se,Ge)|0,x=x+Math.imul(re,Te)|0,C=C+Math.imul(re,Ge)|0,R=R+Math.imul(J,qe)|0,x=x+Math.imul(J,Xe)|0,x=x+Math.imul(Z,qe)|0,C=C+Math.imul(Z,Xe)|0,R=R+Math.imul(Q,ue)|0,x=x+Math.imul(Q,me)|0,x=x+Math.imul(te,ue)|0,C=C+Math.imul(te,me)|0,R=R+Math.imul(G,Ze)|0,x=x+Math.imul(G,Qe)|0,x=x+Math.imul($,Ze)|0,C=C+Math.imul($,Qe)|0,R=R+Math.imul(L,et)|0,x=x+Math.imul(L,tt)|0,x=x+Math.imul(V,et)|0,C=C+Math.imul(V,tt)|0;var s0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(s0>>>26)|0,s0&=67108863,R=Math.imul(Ae,Ne),x=Math.imul(Ae,Re),x=x+Math.imul(Ie,Ne)|0,C=Math.imul(Ie,Re),R=R+Math.imul(ae,Ve)|0,x=x+Math.imul(ae,Oe)|0,x=x+Math.imul(Ee,Ve)|0,C=C+Math.imul(Ee,Oe)|0,R=R+Math.imul(Fe,De)|0,x=x+Math.imul(Fe,ze)|0,x=x+Math.imul(ie,De)|0,C=C+Math.imul(ie,ze)|0,R=R+Math.imul(ge,We)|0,x=x+Math.imul(ge,$e)|0,x=x+Math.imul(pe,We)|0,C=C+Math.imul(pe,$e)|0,R=R+Math.imul(_e,Te)|0,x=x+Math.imul(_e,Ge)|0,x=x+Math.imul(be,Te)|0,C=C+Math.imul(be,Ge)|0,R=R+Math.imul(se,qe)|0,x=x+Math.imul(se,Xe)|0,x=x+Math.imul(re,qe)|0,C=C+Math.imul(re,Xe)|0,R=R+Math.imul(J,ue)|0,x=x+Math.imul(J,me)|0,x=x+Math.imul(Z,ue)|0,C=C+Math.imul(Z,me)|0,R=R+Math.imul(Q,Ze)|0,x=x+Math.imul(Q,Qe)|0,x=x+Math.imul(te,Ze)|0,C=C+Math.imul(te,Qe)|0,R=R+Math.imul(G,et)|0,x=x+Math.imul(G,tt)|0,x=x+Math.imul($,et)|0,C=C+Math.imul($,tt)|0,R=R+Math.imul(L,rt)|0,x=x+Math.imul(L,nt)|0,x=x+Math.imul(V,rt)|0,C=C+Math.imul(V,nt)|0;var a0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(a0>>>26)|0,a0&=67108863,R=Math.imul(Ae,Ve),x=Math.imul(Ae,Oe),x=x+Math.imul(Ie,Ve)|0,C=Math.imul(Ie,Oe),R=R+Math.imul(ae,De)|0,x=x+Math.imul(ae,ze)|0,x=x+Math.imul(Ee,De)|0,C=C+Math.imul(Ee,ze)|0,R=R+Math.imul(Fe,We)|0,x=x+Math.imul(Fe,$e)|0,x=x+Math.imul(ie,We)|0,C=C+Math.imul(ie,$e)|0,R=R+Math.imul(ge,Te)|0,x=x+Math.imul(ge,Ge)|0,x=x+Math.imul(pe,Te)|0,C=C+Math.imul(pe,Ge)|0,R=R+Math.imul(_e,qe)|0,x=x+Math.imul(_e,Xe)|0,x=x+Math.imul(be,qe)|0,C=C+Math.imul(be,Xe)|0,R=R+Math.imul(se,ue)|0,x=x+Math.imul(se,me)|0,x=x+Math.imul(re,ue)|0,C=C+Math.imul(re,me)|0,R=R+Math.imul(J,Ze)|0,x=x+Math.imul(J,Qe)|0,x=x+Math.imul(Z,Ze)|0,C=C+Math.imul(Z,Qe)|0,R=R+Math.imul(Q,et)|0,x=x+Math.imul(Q,tt)|0,x=x+Math.imul(te,et)|0,C=C+Math.imul(te,tt)|0,R=R+Math.imul(G,rt)|0,x=x+Math.imul(G,nt)|0,x=x+Math.imul($,rt)|0,C=C+Math.imul($,nt)|0;var o0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(o0>>>26)|0,o0&=67108863,R=Math.imul(Ae,De),x=Math.imul(Ae,ze),x=x+Math.imul(Ie,De)|0,C=Math.imul(Ie,ze),R=R+Math.imul(ae,We)|0,x=x+Math.imul(ae,$e)|0,x=x+Math.imul(Ee,We)|0,C=C+Math.imul(Ee,$e)|0,R=R+Math.imul(Fe,Te)|0,x=x+Math.imul(Fe,Ge)|0,x=x+Math.imul(ie,Te)|0,C=C+Math.imul(ie,Ge)|0,R=R+Math.imul(ge,qe)|0,x=x+Math.imul(ge,Xe)|0,x=x+Math.imul(pe,qe)|0,C=C+Math.imul(pe,Xe)|0,R=R+Math.imul(_e,ue)|0,x=x+Math.imul(_e,me)|0,x=x+Math.imul(be,ue)|0,C=C+Math.imul(be,me)|0,R=R+Math.imul(se,Ze)|0,x=x+Math.imul(se,Qe)|0,x=x+Math.imul(re,Ze)|0,C=C+Math.imul(re,Qe)|0,R=R+Math.imul(J,et)|0,x=x+Math.imul(J,tt)|0,x=x+Math.imul(Z,et)|0,C=C+Math.imul(Z,tt)|0,R=R+Math.imul(Q,rt)|0,x=x+Math.imul(Q,nt)|0,x=x+Math.imul(te,rt)|0,C=C+Math.imul(te,nt)|0;var f0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(f0>>>26)|0,f0&=67108863,R=Math.imul(Ae,We),x=Math.imul(Ae,$e),x=x+Math.imul(Ie,We)|0,C=Math.imul(Ie,$e),R=R+Math.imul(ae,Te)|0,x=x+Math.imul(ae,Ge)|0,x=x+Math.imul(Ee,Te)|0,C=C+Math.imul(Ee,Ge)|0,R=R+Math.imul(Fe,qe)|0,x=x+Math.imul(Fe,Xe)|0,x=x+Math.imul(ie,qe)|0,C=C+Math.imul(ie,Xe)|0,R=R+Math.imul(ge,ue)|0,x=x+Math.imul(ge,me)|0,x=x+Math.imul(pe,ue)|0,C=C+Math.imul(pe,me)|0,R=R+Math.imul(_e,Ze)|0,x=x+Math.imul(_e,Qe)|0,x=x+Math.imul(be,Ze)|0,C=C+Math.imul(be,Qe)|0,R=R+Math.imul(se,et)|0,x=x+Math.imul(se,tt)|0,x=x+Math.imul(re,et)|0,C=C+Math.imul(re,tt)|0,R=R+Math.imul(J,rt)|0,x=x+Math.imul(J,nt)|0,x=x+Math.imul(Z,rt)|0,C=C+Math.imul(Z,nt)|0;var c0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(c0>>>26)|0,c0&=67108863,R=Math.imul(Ae,Te),x=Math.imul(Ae,Ge),x=x+Math.imul(Ie,Te)|0,C=Math.imul(Ie,Ge),R=R+Math.imul(ae,qe)|0,x=x+Math.imul(ae,Xe)|0,x=x+Math.imul(Ee,qe)|0,C=C+Math.imul(Ee,Xe)|0,R=R+Math.imul(Fe,ue)|0,x=x+Math.imul(Fe,me)|0,x=x+Math.imul(ie,ue)|0,C=C+Math.imul(ie,me)|0,R=R+Math.imul(ge,Ze)|0,x=x+Math.imul(ge,Qe)|0,x=x+Math.imul(pe,Ze)|0,C=C+Math.imul(pe,Qe)|0,R=R+Math.imul(_e,et)|0,x=x+Math.imul(_e,tt)|0,x=x+Math.imul(be,et)|0,C=C+Math.imul(be,tt)|0,R=R+Math.imul(se,rt)|0,x=x+Math.imul(se,nt)|0,x=x+Math.imul(re,rt)|0,C=C+Math.imul(re,nt)|0;var u0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(u0>>>26)|0,u0&=67108863,R=Math.imul(Ae,qe),x=Math.imul(Ae,Xe),x=x+Math.imul(Ie,qe)|0,C=Math.imul(Ie,Xe),R=R+Math.imul(ae,ue)|0,x=x+Math.imul(ae,me)|0,x=x+Math.imul(Ee,ue)|0,C=C+Math.imul(Ee,me)|0,R=R+Math.imul(Fe,Ze)|0,x=x+Math.imul(Fe,Qe)|0,x=x+Math.imul(ie,Ze)|0,C=C+Math.imul(ie,Qe)|0,R=R+Math.imul(ge,et)|0,x=x+Math.imul(ge,tt)|0,x=x+Math.imul(pe,et)|0,C=C+Math.imul(pe,tt)|0,R=R+Math.imul(_e,rt)|0,x=x+Math.imul(_e,nt)|0,x=x+Math.imul(be,rt)|0,C=C+Math.imul(be,nt)|0;var d0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(d0>>>26)|0,d0&=67108863,R=Math.imul(Ae,ue),x=Math.imul(Ae,me),x=x+Math.imul(Ie,ue)|0,C=Math.imul(Ie,me),R=R+Math.imul(ae,Ze)|0,x=x+Math.imul(ae,Qe)|0,x=x+Math.imul(Ee,Ze)|0,C=C+Math.imul(Ee,Qe)|0,R=R+Math.imul(Fe,et)|0,x=x+Math.imul(Fe,tt)|0,x=x+Math.imul(ie,et)|0,C=C+Math.imul(ie,tt)|0,R=R+Math.imul(ge,rt)|0,x=x+Math.imul(ge,nt)|0,x=x+Math.imul(pe,rt)|0,C=C+Math.imul(pe,nt)|0;var h0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(h0>>>26)|0,h0&=67108863,R=Math.imul(Ae,Ze),x=Math.imul(Ae,Qe),x=x+Math.imul(Ie,Ze)|0,C=Math.imul(Ie,Qe),R=R+Math.imul(ae,et)|0,x=x+Math.imul(ae,tt)|0,x=x+Math.imul(Ee,et)|0,C=C+Math.imul(Ee,tt)|0,R=R+Math.imul(Fe,rt)|0,x=x+Math.imul(Fe,nt)|0,x=x+Math.imul(ie,rt)|0,C=C+Math.imul(ie,nt)|0;var l0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(l0>>>26)|0,l0&=67108863,R=Math.imul(Ae,et),x=Math.imul(Ae,tt),x=x+Math.imul(Ie,et)|0,C=Math.imul(Ie,tt),R=R+Math.imul(ae,rt)|0,x=x+Math.imul(ae,nt)|0,x=x+Math.imul(Ee,rt)|0,C=C+Math.imul(Ee,nt)|0;var p0=(T+R|0)+((x&8191)<<13)|0;T=(C+(x>>>13)|0)+(p0>>>26)|0,p0&=67108863,R=Math.imul(Ae,rt),x=Math.imul(Ae,nt),x=x+Math.imul(Ie,rt)|0,C=Math.imul(Ie,nt);var v0=(T+R|0)+((x&8191)<<13)|0;return T=(C+(x>>>13)|0)+(v0>>>26)|0,v0&=67108863,M[0]=Ya,M[1]=Ja,M[2]=Qa,M[3]=e0,M[4]=t0,M[5]=r0,M[6]=n0,M[7]=i0,M[8]=s0,M[9]=a0,M[10]=o0,M[11]=f0,M[12]=c0,M[13]=u0,M[14]=d0,M[15]=h0,M[16]=l0,M[17]=p0,M[18]=v0,T!==0&&(M[19]=T,S.length++),S};Math.imul||(b=h);function d(A,c,m){m.negative=c.negative^A.negative,m.length=A.length+c.length;for(var S=0,g=0,E=0;E<m.length-1;E++){var M=g;g=0;for(var T=S&67108863,R=Math.min(E,c.length-1),x=Math.max(0,E-A.length+1);x<=R;x++){var C=E-x,K=A.words[C]|0,L=c.words[x]|0,V=K*L,z=V&67108863;M=M+(V/67108864|0)|0,z=z+T|0,T=z&67108863,M=M+(z>>>26)|0,g+=M>>>26,M&=67108863}m.words[E]=T,S=M,M=g}return S!==0?m.words[E]=S:m.length--,m.strip()}function y(A,c,m){var S=new w;return S.mulp(A,c,m)}i.prototype.mulTo=function(c,m){var S,g=this.length+c.length;return this.length===10&&c.length===10?S=b(this,c,m):g<63?S=h(this,c,m):g<1024?S=d(this,c,m):S=y(this,c,m),S};function w(A,c){this.x=A,this.y=c}w.prototype.makeRBT=function(c){for(var m=new Array(c),S=i.prototype._countBits(c)-1,g=0;g<c;g++)m[g]=this.revBin(g,S,c);return m},w.prototype.revBin=function(c,m,S){if(c===0||c===S-1)return c;for(var g=0,E=0;E<m;E++)g|=(c&1)<<m-E-1,c>>=1;return g},w.prototype.permute=function(c,m,S,g,E,M){for(var T=0;T<M;T++)g[T]=m[c[T]],E[T]=S[c[T]]},w.prototype.transform=function(c,m,S,g,E,M){this.permute(M,c,m,S,g,E);for(var T=1;T<E;T<<=1)for(var R=T<<1,x=Math.cos(2*Math.PI/R),C=Math.sin(2*Math.PI/R),K=0;K<E;K+=R)for(var L=x,V=C,z=0;z<T;z++){var G=S[K+z],$=g[K+z],oe=S[K+z+T],Q=g[K+z+T],te=L*oe-V*Q;Q=L*Q+V*oe,oe=te,S[K+z]=G+oe,g[K+z]=$+Q,S[K+z+T]=G-oe,g[K+z+T]=$-Q,z!==R&&(te=x*L-C*V,V=x*V+C*L,L=te)}},w.prototype.guessLen13b=function(c,m){var S=Math.max(m,c)|1,g=S&1,E=0;for(S=S/2|0;S;S=S>>>1)E++;return 1<<E+1+g},w.prototype.conjugate=function(c,m,S){if(!(S<=1))for(var g=0;g<S/2;g++){var E=c[g];c[g]=c[S-g-1],c[S-g-1]=E,E=m[g],m[g]=-m[S-g-1],m[S-g-1]=-E}},w.prototype.normalize13b=function(c,m){for(var S=0,g=0;g<m/2;g++){var E=Math.round(c[2*g+1]/m)*8192+Math.round(c[2*g]/m)+S;c[g]=E&67108863,E<67108864?S=0:S=E/67108864|0}return c},w.prototype.convert13b=function(c,m,S,g){for(var E=0,M=0;M<m;M++)E=E+(c[M]|0),S[2*M]=E&8191,E=E>>>13,S[2*M+1]=E&8191,E=E>>>13;for(M=2*m;M<g;++M)S[M]=0;r(E===0),r((E&-8192)===0)},w.prototype.stub=function(c){for(var m=new Array(c),S=0;S<c;S++)m[S]=0;return m},w.prototype.mulp=function(c,m,S){var g=2*this.guessLen13b(c.length,m.length),E=this.makeRBT(g),M=this.stub(g),T=new Array(g),R=new Array(g),x=new Array(g),C=new Array(g),K=new Array(g),L=new Array(g),V=S.words;V.length=g,this.convert13b(c.words,c.length,T,g),this.convert13b(m.words,m.length,C,g),this.transform(T,M,R,x,g,E),this.transform(C,M,K,L,g,E);for(var z=0;z<g;z++){var G=R[z]*K[z]-x[z]*L[z];x[z]=R[z]*L[z]+x[z]*K[z],R[z]=G}return this.conjugate(R,x,g),this.transform(R,x,V,M,g,E),this.conjugate(V,M,g),this.normalize13b(V,g),S.negative=c.negative^m.negative,S.length=c.length+m.length,S.strip()},i.prototype.mul=function(c){var m=new i(null);return m.words=new Array(this.length+c.length),this.mulTo(c,m)},i.prototype.mulf=function(c){var m=new i(null);return m.words=new Array(this.length+c.length),y(this,c,m)},i.prototype.imul=function(c){return this.clone().mulTo(c,this)},i.prototype.imuln=function(c){r(typeof c=="number"),r(c<67108864);for(var m=0,S=0;S<this.length;S++){var g=(this.words[S]|0)*c,E=(g&67108863)+(m&67108863);m>>=26,m+=g/67108864|0,m+=E>>>26,this.words[S]=E&67108863}return m!==0&&(this.words[S]=m,this.length++),this},i.prototype.muln=function(c){return this.clone().imuln(c)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(c){var m=u(c);if(m.length===0)return new i(1);for(var S=this,g=0;g<m.length&&m[g]===0;g++,S=S.sqr());if(++g<m.length)for(var E=S.sqr();g<m.length;g++,E=E.sqr())m[g]!==0&&(S=S.mul(E));return S},i.prototype.iushln=function(c){r(typeof c=="number"&&c>=0);var m=c%26,S=(c-m)/26,g=67108863>>>26-m<<26-m,E;if(m!==0){var M=0;for(E=0;E<this.length;E++){var T=this.words[E]&g,R=(this.words[E]|0)-T<<m;this.words[E]=R|M,M=T>>>26-m}M&&(this.words[E]=M,this.length++)}if(S!==0){for(E=this.length-1;E>=0;E--)this.words[E+S]=this.words[E];for(E=0;E<S;E++)this.words[E]=0;this.length+=S}return this.strip()},i.prototype.ishln=function(c){return r(this.negative===0),this.iushln(c)},i.prototype.iushrn=function(c,m,S){r(typeof c=="number"&&c>=0);var g;m?g=(m-m%26)/26:g=0;var E=c%26,M=Math.min((c-E)/26,this.length),T=67108863^67108863>>>E<<E,R=S;if(g-=M,g=Math.max(0,g),R){for(var x=0;x<M;x++)R.words[x]=this.words[x];R.length=M}if(M!==0)if(this.length>M)for(this.length-=M,x=0;x<this.length;x++)this.words[x]=this.words[x+M];else this.words[0]=0,this.length=1;var C=0;for(x=this.length-1;x>=0&&(C!==0||x>=g);x--){var K=this.words[x]|0;this.words[x]=C<<26-E|K>>>E,C=K&T}return R&&C!==0&&(R.words[R.length++]=C),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(c,m,S){return r(this.negative===0),this.iushrn(c,m,S)},i.prototype.shln=function(c){return this.clone().ishln(c)},i.prototype.ushln=function(c){return this.clone().iushln(c)},i.prototype.shrn=function(c){return this.clone().ishrn(c)},i.prototype.ushrn=function(c){return this.clone().iushrn(c)},i.prototype.testn=function(c){r(typeof c=="number"&&c>=0);var m=c%26,S=(c-m)/26,g=1<<m;if(this.length<=S)return!1;var E=this.words[S];return!!(E&g)},i.prototype.imaskn=function(c){r(typeof c=="number"&&c>=0);var m=c%26,S=(c-m)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(m!==0&&S++,this.length=Math.min(S,this.length),m!==0){var g=67108863^67108863>>>m<<m;this.words[this.length-1]&=g}return this.strip()},i.prototype.maskn=function(c){return this.clone().imaskn(c)},i.prototype.iaddn=function(c){return r(typeof c=="number"),r(c<67108864),c<0?this.isubn(-c):this.negative!==0?this.length===1&&(this.words[0]|0)<c?(this.words[0]=c-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(c),this.negative=1,this):this._iaddn(c)},i.prototype._iaddn=function(c){this.words[0]+=c;for(var m=0;m<this.length&&this.words[m]>=67108864;m++)this.words[m]-=67108864,m===this.length-1?this.words[m+1]=1:this.words[m+1]++;return this.length=Math.max(this.length,m+1),this},i.prototype.isubn=function(c){if(r(typeof c=="number"),r(c<67108864),c<0)return this.iaddn(-c);if(this.negative!==0)return this.negative=0,this.iaddn(c),this.negative=1,this;if(this.words[0]-=c,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var m=0;m<this.length&&this.words[m]<0;m++)this.words[m]+=67108864,this.words[m+1]-=1;return this.strip()},i.prototype.addn=function(c){return this.clone().iaddn(c)},i.prototype.subn=function(c){return this.clone().isubn(c)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(c,m,S){var g=c.length+S,E;this._expand(g);var M,T=0;for(E=0;E<c.length;E++){M=(this.words[E+S]|0)+T;var R=(c.words[E]|0)*m;M-=R&67108863,T=(M>>26)-(R/67108864|0),this.words[E+S]=M&67108863}for(;E<this.length-S;E++)M=(this.words[E+S]|0)+T,T=M>>26,this.words[E+S]=M&67108863;if(T===0)return this.strip();for(r(T===-1),T=0,E=0;E<this.length;E++)M=-(this.words[E]|0)+T,T=M>>26,this.words[E]=M&67108863;return this.negative=1,this.strip()},i.prototype._wordDiv=function(c,m){var S=this.length-c.length,g=this.clone(),E=c,M=E.words[E.length-1]|0,T=this._countBits(M);S=26-T,S!==0&&(E=E.ushln(S),g.iushln(S),M=E.words[E.length-1]|0);var R=g.length-E.length,x;if(m!=="mod"){x=new i(null),x.length=R+1,x.words=new Array(x.length);for(var C=0;C<x.length;C++)x.words[C]=0}var K=g.clone()._ishlnsubmul(E,1,R);K.negative===0&&(g=K,x&&(x.words[R]=1));for(var L=R-1;L>=0;L--){var V=(g.words[E.length+L]|0)*67108864+(g.words[E.length+L-1]|0);for(V=Math.min(V/M|0,67108863),g._ishlnsubmul(E,V,L);g.negative!==0;)V--,g.negative=0,g._ishlnsubmul(E,1,L),g.isZero()||(g.negative^=1);x&&(x.words[L]=V)}return x&&x.strip(),g.strip(),m!=="div"&&S!==0&&g.iushrn(S),{div:x||null,mod:g}},i.prototype.divmod=function(c,m,S){if(r(!c.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var g,E,M;return this.negative!==0&&c.negative===0?(M=this.neg().divmod(c,m),m!=="mod"&&(g=M.div.neg()),m!=="div"&&(E=M.mod.neg(),S&&E.negative!==0&&E.iadd(c)),{div:g,mod:E}):this.negative===0&&c.negative!==0?(M=this.divmod(c.neg(),m),m!=="mod"&&(g=M.div.neg()),{div:g,mod:M.mod}):(this.negative&c.negative)!==0?(M=this.neg().divmod(c.neg(),m),m!=="div"&&(E=M.mod.neg(),S&&E.negative!==0&&E.isub(c)),{div:M.div,mod:E}):c.length>this.length||this.cmp(c)<0?{div:new i(0),mod:this}:c.length===1?m==="div"?{div:this.divn(c.words[0]),mod:null}:m==="mod"?{div:null,mod:new i(this.modn(c.words[0]))}:{div:this.divn(c.words[0]),mod:new i(this.modn(c.words[0]))}:this._wordDiv(c,m)},i.prototype.div=function(c){return this.divmod(c,"div",!1).div},i.prototype.mod=function(c){return this.divmod(c,"mod",!1).mod},i.prototype.umod=function(c){return this.divmod(c,"mod",!0).mod},i.prototype.divRound=function(c){var m=this.divmod(c);if(m.mod.isZero())return m.div;var S=m.div.negative!==0?m.mod.isub(c):m.mod,g=c.ushrn(1),E=c.andln(1),M=S.cmp(g);return M<0||E===1&&M===0?m.div:m.div.negative!==0?m.div.isubn(1):m.div.iaddn(1)},i.prototype.modn=function(c){r(c<=67108863);for(var m=(1<<26)%c,S=0,g=this.length-1;g>=0;g--)S=(m*S+(this.words[g]|0))%c;return S},i.prototype.idivn=function(c){r(c<=67108863);for(var m=0,S=this.length-1;S>=0;S--){var g=(this.words[S]|0)+m*67108864;this.words[S]=g/c|0,m=g%c}return this.strip()},i.prototype.divn=function(c){return this.clone().idivn(c)},i.prototype.egcd=function(c){r(c.negative===0),r(!c.isZero());var m=this,S=c.clone();m.negative!==0?m=m.umod(c):m=m.clone();for(var g=new i(1),E=new i(0),M=new i(0),T=new i(1),R=0;m.isEven()&&S.isEven();)m.iushrn(1),S.iushrn(1),++R;for(var x=S.clone(),C=m.clone();!m.isZero();){for(var K=0,L=1;(m.words[0]&L)===0&&K<26;++K,L<<=1);if(K>0)for(m.iushrn(K);K-- >0;)(g.isOdd()||E.isOdd())&&(g.iadd(x),E.isub(C)),g.iushrn(1),E.iushrn(1);for(var V=0,z=1;(S.words[0]&z)===0&&V<26;++V,z<<=1);if(V>0)for(S.iushrn(V);V-- >0;)(M.isOdd()||T.isOdd())&&(M.iadd(x),T.isub(C)),M.iushrn(1),T.iushrn(1);m.cmp(S)>=0?(m.isub(S),g.isub(M),E.isub(T)):(S.isub(m),M.isub(g),T.isub(E))}return{a:M,b:T,gcd:S.iushln(R)}},i.prototype._invmp=function(c){r(c.negative===0),r(!c.isZero());var m=this,S=c.clone();m.negative!==0?m=m.umod(c):m=m.clone();for(var g=new i(1),E=new i(0),M=S.clone();m.cmpn(1)>0&&S.cmpn(1)>0;){for(var T=0,R=1;(m.words[0]&R)===0&&T<26;++T,R<<=1);if(T>0)for(m.iushrn(T);T-- >0;)g.isOdd()&&g.iadd(M),g.iushrn(1);for(var x=0,C=1;(S.words[0]&C)===0&&x<26;++x,C<<=1);if(x>0)for(S.iushrn(x);x-- >0;)E.isOdd()&&E.iadd(M),E.iushrn(1);m.cmp(S)>=0?(m.isub(S),g.isub(E)):(S.isub(m),E.isub(g))}var K;return m.cmpn(1)===0?K=g:K=E,K.cmpn(0)<0&&K.iadd(c),K},i.prototype.gcd=function(c){if(this.isZero())return c.abs();if(c.isZero())return this.abs();var m=this.clone(),S=c.clone();m.negative=0,S.negative=0;for(var g=0;m.isEven()&&S.isEven();g++)m.iushrn(1),S.iushrn(1);do{for(;m.isEven();)m.iushrn(1);for(;S.isEven();)S.iushrn(1);var E=m.cmp(S);if(E<0){var M=m;m=S,S=M}else if(E===0||S.cmpn(1)===0)break;m.isub(S)}while(!0);return S.iushln(g)},i.prototype.invm=function(c){return this.egcd(c).a.umod(c)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(c){return this.words[0]&c},i.prototype.bincn=function(c){r(typeof c=="number");var m=c%26,S=(c-m)/26,g=1<<m;if(this.length<=S)return this._expand(S+1),this.words[S]|=g,this;for(var E=g,M=S;E!==0&&M<this.length;M++){var T=this.words[M]|0;T+=E,E=T>>>26,T&=67108863,this.words[M]=T}return E!==0&&(this.words[M]=E,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(c){var m=c<0;if(this.negative!==0&&!m)return-1;if(this.negative===0&&m)return 1;this.strip();var S;if(this.length>1)S=1;else{m&&(c=-c),r(c<=67108863,"Number is too big");var g=this.words[0]|0;S=g===c?0:g<c?-1:1}return this.negative!==0?-S|0:S},i.prototype.cmp=function(c){if(this.negative!==0&&c.negative===0)return-1;if(this.negative===0&&c.negative!==0)return 1;var m=this.ucmp(c);return this.negative!==0?-m|0:m},i.prototype.ucmp=function(c){if(this.length>c.length)return 1;if(this.length<c.length)return-1;for(var m=0,S=this.length-1;S>=0;S--){var g=this.words[S]|0,E=c.words[S]|0;if(g!==E){g<E?m=-1:g>E&&(m=1);break}}return m},i.prototype.gtn=function(c){return this.cmpn(c)===1},i.prototype.gt=function(c){return this.cmp(c)===1},i.prototype.gten=function(c){return this.cmpn(c)>=0},i.prototype.gte=function(c){return this.cmp(c)>=0},i.prototype.ltn=function(c){return this.cmpn(c)===-1},i.prototype.lt=function(c){return this.cmp(c)===-1},i.prototype.lten=function(c){return this.cmpn(c)<=0},i.prototype.lte=function(c){return this.cmp(c)<=0},i.prototype.eqn=function(c){return this.cmpn(c)===0},i.prototype.eq=function(c){return this.cmp(c)===0},i.red=function(c){return new P(c)},i.prototype.toRed=function(c){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),c.convertTo(this)._forceRed(c)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(c){return this.red=c,this},i.prototype.forceRed=function(c){return r(!this.red,"Already a number in reduction context"),this._forceRed(c)},i.prototype.redAdd=function(c){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,c)},i.prototype.redIAdd=function(c){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,c)},i.prototype.redSub=function(c){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,c)},i.prototype.redISub=function(c){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,c)},i.prototype.redShl=function(c){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,c)},i.prototype.redMul=function(c){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.mul(this,c)},i.prototype.redIMul=function(c){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.imul(this,c)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(c){return r(this.red&&!c.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,c)};var _={k256:null,p224:null,p192:null,p25519:null};function I(A,c){this.name=A,this.p=new i(c,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}I.prototype._tmp=function(){var c=new i(null);return c.words=new Array(Math.ceil(this.n/13)),c},I.prototype.ireduce=function(c){var m=c,S;do this.split(m,this.tmp),m=this.imulK(m),m=m.iadd(this.tmp),S=m.bitLength();while(S>this.n);var g=S<this.n?-1:m.ucmp(this.p);return g===0?(m.words[0]=0,m.length=1):g>0?m.isub(this.p):m.strip!==void 0?m.strip():m._strip(),m},I.prototype.split=function(c,m){c.iushrn(this.n,0,m)},I.prototype.imulK=function(c){return c.imul(this.k)};function N(){I.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(N,I),N.prototype.split=function(c,m){for(var S=4194303,g=Math.min(c.length,9),E=0;E<g;E++)m.words[E]=c.words[E];if(m.length=g,c.length<=9){c.words[0]=0,c.length=1;return}var M=c.words[9];for(m.words[m.length++]=M&S,E=10;E<c.length;E++){var T=c.words[E]|0;c.words[E-10]=(T&S)<<4|M>>>22,M=T}M>>>=22,c.words[E-10]=M,M===0&&c.length>10?c.length-=10:c.length-=9},N.prototype.imulK=function(c){c.words[c.length]=0,c.words[c.length+1]=0,c.length+=2;for(var m=0,S=0;S<c.length;S++){var g=c.words[S]|0;m+=g*977,c.words[S]=m&67108863,m=g*64+(m/67108864|0)}return c.words[c.length-1]===0&&(c.length--,c.words[c.length-1]===0&&c.length--),c};function F(){I.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(F,I);function O(){I.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(O,I);function q(){I.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(q,I),q.prototype.imulK=function(c){for(var m=0,S=0;S<c.length;S++){var g=(c.words[S]|0)*19+m,E=g&67108863;g>>>=26,c.words[S]=E,m=g}return m!==0&&(c.words[c.length++]=m),c},i._prime=function(c){if(_[c])return _[c];var m;if(c==="k256")m=new N;else if(c==="p224")m=new F;else if(c==="p192")m=new O;else if(c==="p25519")m=new q;else throw new Error("Unknown prime "+c);return _[c]=m,m};function P(A){if(typeof A=="string"){var c=i._prime(A);this.m=c.p,this.prime=c}else r(A.gtn(1),"modulus must be greater than 1"),this.m=A,this.prime=null}P.prototype._verify1=function(c){r(c.negative===0,"red works only with positives"),r(c.red,"red works only with red numbers")},P.prototype._verify2=function(c,m){r((c.negative|m.negative)===0,"red works only with positives"),r(c.red&&c.red===m.red,"red works only with red numbers")},P.prototype.imod=function(c){return this.prime?this.prime.ireduce(c)._forceRed(this):c.umod(this.m)._forceRed(this)},P.prototype.neg=function(c){return c.isZero()?c.clone():this.m.sub(c)._forceRed(this)},P.prototype.add=function(c,m){this._verify2(c,m);var S=c.add(m);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},P.prototype.iadd=function(c,m){this._verify2(c,m);var S=c.iadd(m);return S.cmp(this.m)>=0&&S.isub(this.m),S},P.prototype.sub=function(c,m){this._verify2(c,m);var S=c.sub(m);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},P.prototype.isub=function(c,m){this._verify2(c,m);var S=c.isub(m);return S.cmpn(0)<0&&S.iadd(this.m),S},P.prototype.shl=function(c,m){return this._verify1(c),this.imod(c.ushln(m))},P.prototype.imul=function(c,m){return this._verify2(c,m),this.imod(c.imul(m))},P.prototype.mul=function(c,m){return this._verify2(c,m),this.imod(c.mul(m))},P.prototype.isqr=function(c){return this.imul(c,c.clone())},P.prototype.sqr=function(c){return this.mul(c,c)},P.prototype.sqrt=function(c){if(c.isZero())return c.clone();var m=this.m.andln(3);if(r(m%2===1),m===3){var S=this.m.add(new i(1)).iushrn(2);return this.pow(c,S)}for(var g=this.m.subn(1),E=0;!g.isZero()&&g.andln(1)===0;)E++,g.iushrn(1);r(!g.isZero());var M=new i(1).toRed(this),T=M.redNeg(),R=this.m.subn(1).iushrn(1),x=this.m.bitLength();for(x=new i(2*x*x).toRed(this);this.pow(x,R).cmp(T)!==0;)x.redIAdd(T);for(var C=this.pow(x,g),K=this.pow(c,g.addn(1).iushrn(1)),L=this.pow(c,g),V=E;L.cmp(M)!==0;){for(var z=L,G=0;z.cmp(M)!==0;G++)z=z.redSqr();r(G<V);var $=this.pow(C,new i(1).iushln(V-G-1));K=K.redMul($),C=$.redSqr(),L=L.redMul(C),V=G}return K},P.prototype.invm=function(c){var m=c._invmp(this.m);return m.negative!==0?(m.negative=0,this.imod(m).redNeg()):this.imod(m)},P.prototype.pow=function(c,m){if(m.isZero())return new i(1).toRed(this);if(m.cmpn(1)===0)return c.clone();var S=4,g=new Array(1<<S);g[0]=new i(1).toRed(this),g[1]=c;for(var E=2;E<g.length;E++)g[E]=this.mul(g[E-1],c);var M=g[0],T=0,R=0,x=m.bitLength()%26;for(x===0&&(x=26),E=m.length-1;E>=0;E--){for(var C=m.words[E],K=x-1;K>=0;K--){var L=C>>K&1;if(M!==g[0]&&(M=this.sqr(M)),L===0&&T===0){R=0;continue}T<<=1,T|=L,R++,!(R!==S&&(E!==0||K!==0))&&(M=this.mul(M,g[T]),R=0,T=0)}x=26}return M},P.prototype.convertTo=function(c){var m=c.umod(this.m);return m===c?m.clone():m},P.prototype.convertFrom=function(c){var m=c.clone();return m.red=null,m},i.mont=function(c){return new D(c)};function D(A){P.call(this,A),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(D,P),D.prototype.convertTo=function(c){return this.imod(c.ushln(this.shift))},D.prototype.convertFrom=function(c){var m=this.imod(c.mul(this.rinv));return m.red=null,m},D.prototype.imul=function(c,m){if(c.isZero()||m.isZero())return c.words[0]=0,c.length=1,c;var S=c.imul(m),g=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=S.isub(g).iushrn(this.shift),M=E;return E.cmp(this.m)>=0?M=E.isub(this.m):E.cmpn(0)<0&&(M=E.iadd(this.m)),M._forceRed(this)},D.prototype.mul=function(c,m){if(c.isZero()||m.isZero())return new i(0)._forceRed(this);var S=c.mul(m),g=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=S.isub(g).iushrn(this.shift),M=E;return E.cmp(this.m)>=0?M=E.isub(this.m):E.cmpn(0)<0&&(M=E.iadd(this.m)),M._forceRed(this)},D.prototype.invm=function(c){var m=this.imod(c._invmp(this.m).mul(this.r2));return m._forceRed(this)}})(typeof Tp>"u"||Tp,X6)});var Q6=U(Mn=>{"use strict";H();k();var kF=Mn&&Mn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mn,"__esModule",{value:!0});Mn.stripHexPrefix=Mn.isHexPrefixed=Mn.getLength=Mn.decode=Mn.encode=void 0;var jF=kF(Ar());function Y6(e){if(Array.isArray(e)){let t=[];for(let n=0;n<e.length;n++)t.push(Y6(e[n]));let r=j.Buffer.concat(t);return j.Buffer.concat([Z6(r.length,192),r])}else{let t=Lp(e);return t.length===1&&t[0]<128?t:j.Buffer.concat([Z6(t.length,128),t])}}Mn.encode=Y6;function qp(e,t){if(e[0]==="0"&&e[1]==="0")throw new Error("invalid RLP: extra zeros");return parseInt(e,t)}function Z6(e,t){if(e<56)return j.Buffer.from([e+t]);{let r=kp(e),n=r.length/2,i=kp(t+55+n);return j.Buffer.from(i+r,"hex")}}function LF(e,t=!1){if(!e||e.length===0)return j.Buffer.from([]);let r=Lp(e),n=Hp(r);if(t)return n;if(n.remainder.length!==0)throw new Error("invalid remainder");return n.data}Mn.decode=LF;function KF(e){if(!e||e.length===0)return j.Buffer.from([]);let t=Lp(e),r=t[0];if(r<=127)return t.length;if(r<=183)return r-127;if(r<=191)return r-182;if(r<=247)return r-191;{let n=r-246,i=qp(t.slice(1,n).toString("hex"),16);return n+i}}Mn.getLength=KF;function Hp(e){let t,r,n,i,s,o=[],a=e[0];if(a<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(a<=183){if(t=a-127,a===128?n=j.Buffer.from([]):n=e.slice(1,t),t===2&&n[0]<128)throw new Error("invalid rlp encoding: byte must be less 0x80");return{data:n,remainder:e.slice(t)}}else if(a<=191){if(r=a-182,e.length-1<r)throw new Error("invalid RLP: not enough bytes for string length");if(t=qp(e.slice(1,r).toString("hex"),16),t<=55)throw new Error("invalid RLP: expected string length to be greater than 55");if(n=e.slice(r,t+r),n.length<t)throw new Error("invalid RLP: not enough bytes for string");return{data:n,remainder:e.slice(t+r)}}else if(a<=247){for(t=a-191,i=e.slice(1,t);i.length;)s=Hp(i),o.push(s.data),i=s.remainder;return{data:o,remainder:e.slice(t)}}else{r=a-246,t=qp(e.slice(1,r).toString("hex"),16);let f=r+t;if(f>e.length)throw new Error("invalid rlp: total length is larger than the data");if(i=e.slice(r,f),i.length===0)throw new Error("invalid rlp, List has a invalid length");for(;i.length;)s=Hp(i),o.push(s.data),i=s.remainder;return{data:o,remainder:e.slice(f)}}}function jp(e){return e.slice(0,2)==="0x"}Mn.isHexPrefixed=jp;function J6(e){return jp(e)?e.slice(2):e}Mn.stripHexPrefix=J6;function kp(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");let t=e.toString(16);return t.length%2?`0${t}`:t}function UF(e){return e.length%2?`0${e}`:e}function VF(e){let t=kp(e);return j.Buffer.from(t,"hex")}function Lp(e){if(!j.Buffer.isBuffer(e)){if(typeof e=="string")return jp(e)?j.Buffer.from(UF(J6(e)),"hex"):j.Buffer.from(e);if(typeof e=="number"||typeof e=="bigint")return e?VF(e):j.Buffer.from([]);if(e==null)return j.Buffer.from([]);if(e instanceof Uint8Array)return j.Buffer.from(e);if(jF.default.isBN(e))return j.Buffer.from(e.toArray());throw new Error("invalid type")}return e}});var e5=U(of=>{"use strict";H();k();Object.defineProperty(of,"__esModule",{value:!0});of.validateHexString=of.isHexString=void 0;function zF(e,t){return e.match(/^0x[0-9A-Fa-f]*$/)?!(t&&e.length!==2+2*t):!1}of.isHexString=zF;function WF(e){if(!e)return!1;let t=e.toLowerCase().startsWith("0x")?e.substring(2).toLowerCase():e.toLowerCase();return!(t.length===0||t.length%2!==0||!t.match(/^[0-9A-Fa-f]*$/))}of.validateHexString=WF});var t5=U(jd=>{"use strict";H();k();Object.defineProperty(jd,"__esModule",{value:!0});jd.encode=void 0;function $F(e){var t="0123456789abcdef";function r(F){var O,q="";for(O=0;O<=3;O++)q+=t.charAt(F>>O*8+4&15)+t.charAt(F>>O*8&15);return q}function n(F,O){var q=(F&65535)+(O&65535),P=(F>>16)+(O>>16)+(q>>16);return P<<16|q&65535}function i(F,O){return F<<O|F>>>32-O}function s(F,O,q,P,D,A){return n(i(n(n(O,F),n(P,A)),D),q)}function o(F,O,q,P,D,A,c){return s(O&q|~O&P,F,O,D,A,c)}function a(F,O,q,P,D,A,c){return s(O&P|q&~P,F,O,D,A,c)}function f(F,O,q,P,D,A,c){return s(O^q^P,F,O,D,A,c)}function l(F,O,q,P,D,A,c){return s(q^(O|~P),F,O,D,A,c)}function v(F){var O,q=(F.length+8>>6)+1,P=new Array(q*16);for(O=0;O<q*16;O++)P[O]=0;for(O=0;O<F.length;O++)P[O>>2]|=F.charCodeAt(O)<<O%4*8;return P[O>>2]|=128<<O%4*8,P[q*16-2]=F.length*8,P}var p,u=v(""+e),h=1732584193,b=-271733879,d=-1732584194,y=271733878,w,_,I,N;for(p=0;p<u.length;p+=16)w=h,_=b,I=d,N=y,h=o(h,b,d,y,u[p+0],7,-680876936),y=o(y,h,b,d,u[p+1],12,-389564586),d=o(d,y,h,b,u[p+2],17,606105819),b=o(b,d,y,h,u[p+3],22,-1044525330),h=o(h,b,d,y,u[p+4],7,-176418897),y=o(y,h,b,d,u[p+5],12,1200080426),d=o(d,y,h,b,u[p+6],17,-1473231341),b=o(b,d,y,h,u[p+7],22,-45705983),h=o(h,b,d,y,u[p+8],7,1770035416),y=o(y,h,b,d,u[p+9],12,-1958414417),d=o(d,y,h,b,u[p+10],17,-42063),b=o(b,d,y,h,u[p+11],22,-1990404162),h=o(h,b,d,y,u[p+12],7,1804603682),y=o(y,h,b,d,u[p+13],12,-40341101),d=o(d,y,h,b,u[p+14],17,-1502002290),b=o(b,d,y,h,u[p+15],22,1236535329),h=a(h,b,d,y,u[p+1],5,-165796510),y=a(y,h,b,d,u[p+6],9,-1069501632),d=a(d,y,h,b,u[p+11],14,643717713),b=a(b,d,y,h,u[p+0],20,-373897302),h=a(h,b,d,y,u[p+5],5,-701558691),y=a(y,h,b,d,u[p+10],9,38016083),d=a(d,y,h,b,u[p+15],14,-660478335),b=a(b,d,y,h,u[p+4],20,-405537848),h=a(h,b,d,y,u[p+9],5,568446438),y=a(y,h,b,d,u[p+14],9,-1019803690),d=a(d,y,h,b,u[p+3],14,-187363961),b=a(b,d,y,h,u[p+8],20,1163531501),h=a(h,b,d,y,u[p+13],5,-1444681467),y=a(y,h,b,d,u[p+2],9,-51403784),d=a(d,y,h,b,u[p+7],14,1735328473),b=a(b,d,y,h,u[p+12],20,-1926607734),h=f(h,b,d,y,u[p+5],4,-378558),y=f(y,h,b,d,u[p+8],11,-2022574463),d=f(d,y,h,b,u[p+11],16,1839030562),b=f(b,d,y,h,u[p+14],23,-35309556),h=f(h,b,d,y,u[p+1],4,-1530992060),y=f(y,h,b,d,u[p+4],11,1272893353),d=f(d,y,h,b,u[p+7],16,-155497632),b=f(b,d,y,h,u[p+10],23,-1094730640),h=f(h,b,d,y,u[p+13],4,681279174),y=f(y,h,b,d,u[p+0],11,-358537222),d=f(d,y,h,b,u[p+3],16,-722521979),b=f(b,d,y,h,u[p+6],23,76029189),h=f(h,b,d,y,u[p+9],4,-640364487),y=f(y,h,b,d,u[p+12],11,-421815835),d=f(d,y,h,b,u[p+15],16,530742520),b=f(b,d,y,h,u[p+2],23,-995338651),h=l(h,b,d,y,u[p+0],6,-198630844),y=l(y,h,b,d,u[p+7],10,1126891415),d=l(d,y,h,b,u[p+14],15,-1416354905),b=l(b,d,y,h,u[p+5],21,-57434055),h=l(h,b,d,y,u[p+12],6,1700485571),y=l(y,h,b,d,u[p+3],10,-1894986606),d=l(d,y,h,b,u[p+10],15,-1051523),b=l(b,d,y,h,u[p+1],21,-2054922799),h=l(h,b,d,y,u[p+8],6,1873313359),y=l(y,h,b,d,u[p+15],10,-30611744),d=l(d,y,h,b,u[p+6],15,-1560198380),b=l(b,d,y,h,u[p+13],21,1309151649),h=l(h,b,d,y,u[p+4],6,-145523070),y=l(y,h,b,d,u[p+11],10,-1120210379),d=l(d,y,h,b,u[p+2],15,718787259),b=l(b,d,y,h,u[p+9],21,-343485551),h=n(h,w),b=n(b,_),d=n(d,I),y=n(y,N);return r(h)+r(b)+r(d)+r(y)}jd.encode=$F});var Up=U(Mt=>{"use strict";H();k();var GF=Mt&&Mt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),XF=Mt&&Mt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n5=Mt&&Mt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&GF(t,e,r);return XF(t,e),t};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.blake2s=Mt.compress=Mt.IV=void 0;var ZF=n5(Xo()),r5=n5(Dd()),is=Zr();Mt.IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);function Pa(e,t,r,n,i){return e=e+t+i|0,n=(0,is.rotr)(n^e,16),r=r+n|0,t=(0,is.rotr)(t^r,12),{a:e,b:t,c:r,d:n}}function Ia(e,t,r,n,i){return e=e+t+i|0,n=(0,is.rotr)(n^e,8),r=r+n|0,t=(0,is.rotr)(t^r,7),{a:e,b:t,c:r,d:n}}function i5(e,t,r,n,i,s,o,a,f,l,v,p,u,h,b,d,y,w,_,I){let N=0;for(let F=0;F<n;F++)({a:i,b:f,c:u,d:y}=Pa(i,f,u,y,r[t+e[N++]])),{a:i,b:f,c:u,d:y}=Ia(i,f,u,y,r[t+e[N++]]),{a:s,b:l,c:h,d:w}=Pa(s,l,h,w,r[t+e[N++]]),{a:s,b:l,c:h,d:w}=Ia(s,l,h,w,r[t+e[N++]]),{a:o,b:v,c:b,d:_}=Pa(o,v,b,_,r[t+e[N++]]),{a:o,b:v,c:b,d:_}=Ia(o,v,b,_,r[t+e[N++]]),{a,b:p,c:d,d:I}=Pa(a,p,d,I,r[t+e[N++]]),{a,b:p,c:d,d:I}=Ia(a,p,d,I,r[t+e[N++]]),{a:i,b:l,c:b,d:I}=Pa(i,l,b,I,r[t+e[N++]]),{a:i,b:l,c:b,d:I}=Ia(i,l,b,I,r[t+e[N++]]),{a:s,b:v,c:d,d:y}=Pa(s,v,d,y,r[t+e[N++]]),{a:s,b:v,c:d,d:y}=Ia(s,v,d,y,r[t+e[N++]]),{a:o,b:p,c:u,d:w}=Pa(o,p,u,w,r[t+e[N++]]),{a:o,b:p,c:u,d:w}=Ia(o,p,u,w,r[t+e[N++]]),{a,b:f,c:h,d:_}=Pa(a,f,h,_,r[t+e[N++]]),{a,b:f,c:h,d:_}=Ia(a,f,h,_,r[t+e[N++]]);return{v0:i,v1:s,v2:o,v3:a,v4:f,v5:l,v6:v,v7:p,v8:u,v9:h,v10:b,v11:d,v12:y,v13:w,v14:_,v15:I}}Mt.compress=i5;var Kp=class extends r5.BLAKE2{constructor(t={}){super(64,t.dkLen===void 0?32:t.dkLen,t,32,8,8),this.v0=Mt.IV[0]|0,this.v1=Mt.IV[1]|0,this.v2=Mt.IV[2]|0,this.v3=Mt.IV[3]|0,this.v4=Mt.IV[4]|0,this.v5=Mt.IV[5]|0,this.v6=Mt.IV[6]|0,this.v7=Mt.IV[7]|0;let r=t.key?t.key.length:0;if(this.v0^=this.outputLen|r<<8|1<<16|1<<24,t.salt){let n=(0,is.u32)((0,is.toBytes)(t.salt));this.v4^=n[0],this.v5^=n[1]}if(t.personalization){let n=(0,is.u32)((0,is.toBytes)(t.personalization));this.v6^=n[0],this.v7^=n[1]}if(t.key){let n=new Uint8Array(this.blockLen);n.set((0,is.toBytes)(t.key)),this.update(n)}}get(){let{v0:t,v1:r,v2:n,v3:i,v4:s,v5:o,v6:a,v7:f}=this;return[t,r,n,i,s,o,a,f]}set(t,r,n,i,s,o,a,f){this.v0=t|0,this.v1=r|0,this.v2=n|0,this.v3=i|0,this.v4=s|0,this.v5=o|0,this.v6=a|0,this.v7=f|0}compress(t,r,n){let{h:i,l:s}=ZF.fromBig(BigInt(this.length)),{v0:o,v1:a,v2:f,v3:l,v4:v,v5:p,v6:u,v7:h,v8:b,v9:d,v10:y,v11:w,v12:_,v13:I,v14:N,v15:F}=i5(r5.SIGMA,r,t,10,this.v0,this.v1,this.v2,this.v3,this.v4,this.v5,this.v6,this.v7,Mt.IV[0],Mt.IV[1],Mt.IV[2],Mt.IV[3],s^Mt.IV[4],i^Mt.IV[5],n?~Mt.IV[6]:Mt.IV[6],Mt.IV[7]);this.v0^=o^b,this.v1^=a^d,this.v2^=f^y,this.v3^=l^w,this.v4^=v^_,this.v5^=p^I,this.v6^=u^N,this.v7^=h^F}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0)}};Mt.blake2s=(0,is.wrapConstructorWithOpts)(e=>new Kp(e))});var Ld=U(ff=>{"use strict";H();k();Object.defineProperty(ff,"__esModule",{value:!0});ff.pbkdf2Async=ff.pbkdf2=void 0;var YF=Cc(),ss=Zr();function s5(e,t,r,n){(0,ss.assertHash)(e);let i=(0,ss.checkOpts)({dkLen:32,asyncTick:10},n),{c:s,dkLen:o,asyncTick:a}=i;if((0,ss.assertNumber)(s),(0,ss.assertNumber)(o),(0,ss.assertNumber)(a),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let f=(0,ss.toBytes)(t),l=(0,ss.toBytes)(r),v=new Uint8Array(o),p=YF.hmac.create(e,f),u=p._cloneInto().update(l);return{c:s,dkLen:o,asyncTick:a,DK:v,PRF:p,PRFSalt:u}}function a5(e,t,r,n,i){return e.destroy(),t.destroy(),n&&n.destroy(),i.fill(0),r}function JF(e,t,r,n){let{c:i,dkLen:s,DK:o,PRF:a,PRFSalt:f}=s5(e,t,r,n),l,v=new Uint8Array(4),p=(0,ss.createView)(v),u=new Uint8Array(a.outputLen);for(let h=1,b=0;b<s;h++,b+=a.outputLen){let d=o.subarray(b,b+a.outputLen);p.setInt32(0,h,!1),(l=f._cloneInto(l)).update(v).digestInto(u),d.set(u.subarray(0,d.length));for(let y=1;y<i;y++){a._cloneInto(l).update(u).digestInto(u);for(let w=0;w<d.length;w++)d[w]^=u[w]}}return a5(a,f,o,l,u)}ff.pbkdf2=JF;async function QF(e,t,r,n){let{c:i,dkLen:s,asyncTick:o,DK:a,PRF:f,PRFSalt:l}=s5(e,t,r,n),v,p=new Uint8Array(4),u=(0,ss.createView)(p),h=new Uint8Array(f.outputLen);for(let b=1,d=0;d<s;b++,d+=f.outputLen){let y=a.subarray(d,d+f.outputLen);u.setInt32(0,b,!1),(v=l._cloneInto(v)).update(p).digestInto(h),y.set(h.subarray(0,y.length)),await(0,ss.asyncLoop)(i-1,o,w=>{f._cloneInto(v).update(h).digestInto(h);for(let _=0;_<y.length;_++)y[_]^=h[_]})}return a5(f,l,a,v,h)}ff.pbkdf2Async=QF});var h5=U(uf=>{"use strict";H();k();Object.defineProperty(uf,"__esModule",{value:!0});uf.scryptAsync=uf.scrypt=void 0;var f5=Go(),c5=Ld(),Xn=Zr(),Et=(e,t)=>e<<t|e>>>32-t;function o5(e,t,r,n,i,s){let o=e[t++]^r[n++],a=e[t++]^r[n++],f=e[t++]^r[n++],l=e[t++]^r[n++],v=e[t++]^r[n++],p=e[t++]^r[n++],u=e[t++]^r[n++],h=e[t++]^r[n++],b=e[t++]^r[n++],d=e[t++]^r[n++],y=e[t++]^r[n++],w=e[t++]^r[n++],_=e[t++]^r[n++],I=e[t++]^r[n++],N=e[t++]^r[n++],F=e[t++]^r[n++],O=o,q=a,P=f,D=l,A=v,c=p,m=u,S=h,g=b,E=d,M=y,T=w,R=_,x=I,C=N,K=F;for(let L=0;L<8;L+=2)A^=Et(O+R|0,7),g^=Et(A+O|0,9),R^=Et(g+A|0,13),O^=Et(R+g|0,18),E^=Et(c+q|0,7),x^=Et(E+c|0,9),q^=Et(x+E|0,13),c^=Et(q+x|0,18),C^=Et(M+m|0,7),P^=Et(C+M|0,9),m^=Et(P+C|0,13),M^=Et(m+P|0,18),D^=Et(K+T|0,7),S^=Et(D+K|0,9),T^=Et(S+D|0,13),K^=Et(T+S|0,18),q^=Et(O+D|0,7),P^=Et(q+O|0,9),D^=Et(P+q|0,13),O^=Et(D+P|0,18),m^=Et(c+A|0,7),S^=Et(m+c|0,9),A^=Et(S+m|0,13),c^=Et(A+S|0,18),T^=Et(M+E|0,7),g^=Et(T+M|0,9),E^=Et(g+T|0,13),M^=Et(E+g|0,18),R^=Et(K+C|0,7),x^=Et(R+K|0,9),C^=Et(x+R|0,13),K^=Et(C+x|0,18);i[s++]=o+O|0,i[s++]=a+q|0,i[s++]=f+P|0,i[s++]=l+D|0,i[s++]=v+A|0,i[s++]=p+c|0,i[s++]=u+m|0,i[s++]=h+S|0,i[s++]=b+g|0,i[s++]=d+E|0,i[s++]=y+M|0,i[s++]=w+T|0,i[s++]=_+R|0,i[s++]=I+x|0,i[s++]=N+C|0,i[s++]=F+K|0}function cf(e,t,r,n,i){let s=n+0,o=n+16*i;for(let a=0;a<16;a++)r[o+a]=e[t+(2*i-1)*16+a];for(let a=0;a<i;a++,s+=16,t+=16)o5(r,o,e,t,r,s),a>0&&(o+=16),o5(r,s,e,t+=16,r,o)}function u5(e,t,r){let n=(0,Xn.checkOpts)({dkLen:32,asyncTick:10,maxmem:1073742848},r),{N:i,r:s,p:o,dkLen:a,asyncTick:f,maxmem:l,onProgress:v}=n;if((0,Xn.assertNumber)(i),(0,Xn.assertNumber)(s),(0,Xn.assertNumber)(o),(0,Xn.assertNumber)(a),(0,Xn.assertNumber)(f),(0,Xn.assertNumber)(l),v!==void 0&&typeof v!="function")throw new Error("progressCb should be function");let p=128*s,u=p/4;if(i<=1||(i&i-1)!==0||i>=2**(p/8)||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(o<0||o>(2**32-1)*32/p)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(a<0||a>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");let h=p*(i+o);if(h>l)throw new Error(`Scrypt: parameters too large, ${h} (128 * r * (N + p)) > ${l} (maxmem)`);let b=(0,c5.pbkdf2)(f5.sha256,e,t,{c:1,dkLen:p*o}),d=(0,Xn.u32)(b),y=(0,Xn.u32)(new Uint8Array(p*i)),w=(0,Xn.u32)(new Uint8Array(p)),_=()=>{};if(v){let I=2*i*o,N=Math.max(Math.floor(I/1e4),1),F=0;_=()=>{F++,v&&(!(F%N)||F===I)&&v(F/I)}}return{N:i,r:s,p:o,dkLen:a,blockSize32:u,V:y,B32:d,B:b,tmp:w,blockMixCb:_,asyncTick:f}}function d5(e,t,r,n,i){let s=(0,c5.pbkdf2)(f5.sha256,e,r,{c:1,dkLen:t});return r.fill(0),n.fill(0),i.fill(0),s}function eN(e,t,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:a,V:f,B32:l,B:v,tmp:p,blockMixCb:u}=u5(e,t,r);for(let h=0;h<s;h++){let b=a*h;for(let d=0;d<a;d++)f[d]=l[b+d];for(let d=0,y=0;d<n-1;d++)cf(f,y,f,y+=a,i),u();cf(f,(n-1)*a,l,b,i),u();for(let d=0;d<n;d++){let y=l[b+a-16]%n;for(let w=0;w<a;w++)p[w]=l[b+w]^f[y*a+w];cf(p,0,l,b,i),u()}}return d5(e,o,v,f,p)}uf.scrypt=eN;async function tN(e,t,r){let{N:n,r:i,p:s,dkLen:o,blockSize32:a,V:f,B32:l,B:v,tmp:p,blockMixCb:u,asyncTick:h}=u5(e,t,r);for(let b=0;b<s;b++){let d=a*b;for(let w=0;w<a;w++)f[w]=l[d+w];let y=0;await(0,Xn.asyncLoop)(n-1,h,w=>{cf(f,y,f,y+=a,i),u()}),cf(f,(n-1)*a,l,d,i),u(),await(0,Xn.asyncLoop)(n,h,w=>{let _=l[d+a-16]%n;for(let I=0;I<a;I++)p[I]=l[d+I]^f[_*a+I];cf(p,0,l,d,i),u()})}return d5(e,o,v,f,p)}uf.scryptAsync=tN});var v5=U(as=>{"use strict";H();k();var rN=as&&as.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),nN=as&&as.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Vp=as&&as.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&rN(t,e,r);return nN(t,e),t};Object.defineProperty(as,"__esModule",{value:!0});as.blake3=void 0;var l5=Vp(Xo()),iN=Vp(Dd()),Ci=Vp(Up()),j0=Zr(),Zn;(function(e){e[e.CHUNK_START=1]="CHUNK_START",e[e.CHUNK_END=2]="CHUNK_END",e[e.PARENT=4]="PARENT",e[e.ROOT=8]="ROOT",e[e.KEYED_HASH=16]="KEYED_HASH",e[e.DERIVE_KEY_CONTEXT=32]="DERIVE_KEY_CONTEXT",e[e.DERIVE_KEY_MATERIAL=64]="DERIVE_KEY_MATERIAL"})(Zn||(Zn={}));var p5=(()=>{let e=Array.from({length:16},(n,i)=>i),t=n=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(i=>n[i]),r=[];for(let n=0,i=e;n<7;n++,i=t(i))r.push(...i);return Uint8Array.from(r)})(),Fc=class extends iN.BLAKE2{constructor(t={},r=0){if(super(64,t.dkLen===void 0?32:t.dkLen,{},Number.MAX_SAFE_INTEGER,0,0),this.flags=0,this.chunkPos=0,this.chunksDone=0,this.stack=[],this.posOut=0,this.bufferOut32=new Uint32Array(16),this.chunkOut=0,this.enableXOF=!0,this.outputLen=t.dkLen===void 0?32:t.dkLen,(0,j0.assertNumber)(this.outputLen),t.key!==void 0&&t.context!==void 0)throw new Error("Blake3: only key or context can be specified at same time");if(t.key!==void 0){let n=(0,j0.toBytes)(t.key);if(n.length!==32)throw new Error("Blake3: key should be 32 byte");this.IV=(0,j0.u32)(n),this.flags=r|Zn.KEYED_HASH}else if(t.context!==void 0){let n=new Fc({dkLen:32},Zn.DERIVE_KEY_CONTEXT).update(t.context).digest();this.IV=(0,j0.u32)(n),this.flags=r|Zn.DERIVE_KEY_MATERIAL}else this.IV=Ci.IV.slice(),this.flags=r;this.state=this.IV.slice(),this.bufferOut=(0,j0.u8)(this.bufferOut32)}get(){return[]}set(){}b2Compress(t,r,n,i=0){let{state:s,pos:o}=this,{h:a,l:f}=l5.fromBig(BigInt(t),!0),{v0:l,v1:v,v2:p,v3:u,v4:h,v5:b,v6:d,v7:y,v8:w,v9:_,v10:I,v11:N,v12:F,v13:O,v14:q,v15:P}=Ci.compress(p5,i,n,7,s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],Ci.IV[0],Ci.IV[1],Ci.IV[2],Ci.IV[3],a,f,o,r);s[0]=l^w,s[1]=v^_,s[2]=p^I,s[3]=u^N,s[4]=h^F,s[5]=b^O,s[6]=d^q,s[7]=y^P}compress(t,r=0,n=!1){let i=this.flags;if(this.chunkPos||(i|=Zn.CHUNK_START),(this.chunkPos===15||n)&&(i|=Zn.CHUNK_END),n||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,i,t,r),this.chunkPos+=1,this.chunkPos===16||n){let s=this.state;this.state=this.IV.slice();for(let o,a=this.chunksDone+1;(n||!(a&1))&&(o=this.stack.pop());a>>=1)this.buffer32.set(o,0),this.buffer32.set(s,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|Zn.PARENT,this.buffer32,0),s=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(s)}this.pos=0}_cloneInto(t){t=super._cloneInto(t);let{IV:r,flags:n,state:i,chunkPos:s,posOut:o,chunkOut:a,stack:f,chunksDone:l}=this;return t.state.set(i.slice()),t.stack=f.map(v=>Uint32Array.from(v)),t.IV.set(r),t.flags=n,t.chunkPos=s,t.chunksDone=l,t.posOut=o,t.chunkOut=a,t.enableXOF=this.enableXOF,t.bufferOut32.set(this.bufferOut32),t}destroy(){this.destroyed=!0,this.state.fill(0),this.buffer32.fill(0),this.IV.fill(0),this.bufferOut32.fill(0);for(let t of this.stack)t.fill(0)}b2CompressOut(){let{state:t,pos:r,flags:n,buffer32:i,bufferOut32:s}=this,{h:o,l:a}=l5.fromBig(BigInt(this.chunkOut++)),{v0:f,v1:l,v2:v,v3:p,v4:u,v5:h,v6:b,v7:d,v8:y,v9:w,v10:_,v11:I,v12:N,v13:F,v14:O,v15:q}=Ci.compress(p5,0,i,7,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],Ci.IV[0],Ci.IV[1],Ci.IV[2],Ci.IV[3],a,o,r,n);s[0]=f^y,s[1]=l^w,s[2]=v^_,s[3]=p^I,s[4]=u^N,s[5]=h^F,s[6]=b^O,s[7]=d^q,s[8]=t[0]^y,s[9]=t[1]^w,s[10]=t[2]^_,s[11]=t[3]^I,s[12]=t[4]^N,s[13]=t[5]^F,s[14]=t[6]^O,s[15]=t[7]^q,this.posOut=0}finish(){if(this.finished)return;this.finished=!0,this.buffer.fill(0,this.pos);let t=this.flags|Zn.ROOT;this.stack.length?(t|=Zn.PARENT,this.compress(this.buffer32,0,!0),this.chunksDone=0,this.pos=this.blockLen):t|=(this.chunkPos?0:Zn.CHUNK_START)|Zn.CHUNK_END,this.flags=t,this.b2CompressOut()}writeInto(t){if(this.destroyed)throw new Error("instance is destroyed");if(!(t instanceof Uint8Array))throw new Error("Blake3: Invalid output buffer");this.finish();let{blockLen:r,bufferOut:n}=this;for(let i=0,s=t.length;i<s;){this.posOut>=r&&this.b2CompressOut();let o=Math.min(this.blockLen-this.posOut,s-i);t.set(n.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF impossible after digest call");return this.writeInto(t)}xof(t){return(0,j0.assertNumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(t.length<this.outputLen)throw new Error("Blake3: Invalid output buffer");if(this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}};as.blake3=(0,j0.wrapConstructorWithOpts)(e=>new Fc(e))});var L0=U(Je=>{"use strict";H();k();var b5=Je&&Je.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),sN=Je&&Je.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ar=Je&&Je.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&b5(t,e,r)},zp=Je&&Je.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&b5(t,e,r);return sN(t,e),t};Object.defineProperty(Je,"__esModule",{value:!0});Je.randomBytes=Je.concatBytes=Je.reverseBuffer=Je.md5=Je.rlp=void 0;ar(x6(),Je);ar(H6(),Je);ar(k6(),Je);ar(j6(),Je);ar(K6(),Je);ar(Ic(),Je);ar(z6(),Je);ar(W6(),Je);ar(G6(),Je);ar(Dp(),Je);Je.rlp=zp(Q6());ar(e5(),Je);Je.md5=zp(t5());ar(T0(),Je);ar(Go(),Je);ar(Cc(),Je);ar(Cp(),Je);ar(Cd(),Je);ar(Od(),Je);ar(Rp(),Je);ar(Up(),Je);ar(Ld(),Je);ar(h5(),Je);ar(v5(),Je);var aN=zp(Zr()),oN=Jb();function fN(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e}Je.reverseBuffer=fN;function cN(e,t){return aN.concatBytes(Uint8Array.from(e),Uint8Array.from(t))}Je.concatBytes=cN;function uN(e){return oN(e)}Je.randomBytes=uN});var Dn=U(g5=>{"use strict";H();k();var Fi=g5,dN=Ar(),hN=eg(),Kd=rg();Fi.assert=hN;Fi.toArray=Kd.toArray;Fi.zero2=Kd.zero2;Fi.toHex=Kd.toHex;Fi.encode=Kd.encode;function lN(e,t,r){var n=new Array(Math.max(e.bitLength(),r)+1);n.fill(0);for(var i=1<<t+1,s=e.clone(),o=0;o<n.length;o++){var a,f=s.andln(i-1);s.isOdd()?(f>(i>>1)-1?a=(i>>1)-f:a=f,s.isubn(a)):a=0,n[o]=a,s.iushrn(1)}return n}Fi.getNAF=lN;function pN(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n=0,i=0,s;e.cmpn(-n)>0||t.cmpn(-i)>0;){var o=e.andln(3)+n&3,a=t.andln(3)+i&3;o===3&&(o=-1),a===3&&(a=-1);var f;(o&1)===0?f=0:(s=e.andln(7)+n&7,(s===3||s===5)&&a===2?f=-o:f=o),r[0].push(f);var l;(a&1)===0?l=0:(s=t.andln(7)+i&7,(s===3||s===5)&&o===2?l=-a:l=a),r[1].push(l),2*n===f+1&&(n=1-n),2*i===l+1&&(i=1-i),e.iushrn(1),t.iushrn(1)}return r}Fi.getJSF=pN;function vN(e,t,r){var n="_"+t;e.prototype[t]=function(){return this[n]!==void 0?this[n]:this[n]=r.call(this)}}Fi.cachedProperty=vN;function bN(e){return typeof e=="string"?Fi.toArray(e,"hex"):e}Fi.parseBytes=bN;function gN(e){return new dN(e,"hex","le")}Fi.intFromLE=gN});var Rc=U((dX,y5)=>{"use strict";H();k();var Nc=Dn(),K0=Ar(),Ud=Nc.getNAF,yN=Nc.getJSF,Vd=Nc.assert;function Ma(e,t){this.type=e,this.p=new K0(t.p,16),this.red=t.prime?K0.red(t.prime):K0.mont(this.p),this.zero=new K0(0).toRed(this.red),this.one=new K0(1).toRed(this.red),this.two=new K0(2).toRed(this.red),this.n=t.n&&new K0(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}y5.exports=Ma;Ma.prototype.point=function(){throw new Error("Not implemented")};Ma.prototype.validate=function(){throw new Error("Not implemented")};Ma.prototype._fixedNafMul=function(t,r){Vd(t.precomputed);var n=t._getDoubles(),i=Ud(r,1,this._bitLength),s=(1<<n.step+1)-(n.step%2===0?2:1);s/=3;var o=[],a,f;for(a=0;a<i.length;a+=n.step){f=0;for(var l=a+n.step-1;l>=a;l--)f=(f<<1)+i[l];o.push(f)}for(var v=this.jpoint(null,null,null),p=this.jpoint(null,null,null),u=s;u>0;u--){for(a=0;a<o.length;a++)f=o[a],f===u?p=p.mixedAdd(n.points[a]):f===-u&&(p=p.mixedAdd(n.points[a].neg()));v=v.add(p)}return v.toP()};Ma.prototype._wnafMul=function(t,r){var n=4,i=t._getNAFPoints(n);n=i.wnd;for(var s=i.points,o=Ud(r,n,this._bitLength),a=this.jpoint(null,null,null),f=o.length-1;f>=0;f--){for(var l=0;f>=0&&o[f]===0;f--)l++;if(f>=0&&l++,a=a.dblp(l),f<0)break;var v=o[f];Vd(v!==0),t.type==="affine"?v>0?a=a.mixedAdd(s[v-1>>1]):a=a.mixedAdd(s[-v-1>>1].neg()):v>0?a=a.add(s[v-1>>1]):a=a.add(s[-v-1>>1].neg())}return t.type==="affine"?a.toP():a};Ma.prototype._wnafMulAdd=function(t,r,n,i,s){var o=this._wnafT1,a=this._wnafT2,f=this._wnafT3,l=0,v,p,u;for(v=0;v<i;v++){u=r[v];var h=u._getNAFPoints(t);o[v]=h.wnd,a[v]=h.points}for(v=i-1;v>=1;v-=2){var b=v-1,d=v;if(o[b]!==1||o[d]!==1){f[b]=Ud(n[b],o[b],this._bitLength),f[d]=Ud(n[d],o[d],this._bitLength),l=Math.max(f[b].length,l),l=Math.max(f[d].length,l);continue}var y=[r[b],null,null,r[d]];r[b].y.cmp(r[d].y)===0?(y[1]=r[b].add(r[d]),y[2]=r[b].toJ().mixedAdd(r[d].neg())):r[b].y.cmp(r[d].y.redNeg())===0?(y[1]=r[b].toJ().mixedAdd(r[d]),y[2]=r[b].add(r[d].neg())):(y[1]=r[b].toJ().mixedAdd(r[d]),y[2]=r[b].toJ().mixedAdd(r[d].neg()));var w=[-3,-1,-5,-7,0,7,5,1,3],_=yN(n[b],n[d]);for(l=Math.max(_[0].length,l),f[b]=new Array(l),f[d]=new Array(l),p=0;p<l;p++){var I=_[0][p]|0,N=_[1][p]|0;f[b][p]=w[(I+1)*3+(N+1)],f[d][p]=0,a[b]=y}}var F=this.jpoint(null,null,null),O=this._wnafT4;for(v=l;v>=0;v--){for(var q=0;v>=0;){var P=!0;for(p=0;p<i;p++)O[p]=f[p][v]|0,O[p]!==0&&(P=!1);if(!P)break;q++,v--}if(v>=0&&q++,F=F.dblp(q),v<0)break;for(p=0;p<i;p++){var D=O[p];D!==0&&(D>0?u=a[p][D-1>>1]:D<0&&(u=a[p][-D-1>>1].neg()),u.type==="affine"?F=F.mixedAdd(u):F=F.add(u))}}for(v=0;v<i;v++)a[v]=null;return s?F:F.toP()};function Yn(e,t){this.curve=e,this.type=t,this.precomputed=null}Ma.BasePoint=Yn;Yn.prototype.eq=function(){throw new Error("Not implemented")};Yn.prototype.validate=function(){return this.curve.validate(this)};Ma.prototype.decodePoint=function(t,r){t=Nc.toArray(t,r);var n=this.p.byteLength();if((t[0]===4||t[0]===6||t[0]===7)&&t.length-1===2*n){t[0]===6?Vd(t[t.length-1]%2===0):t[0]===7&&Vd(t[t.length-1]%2===1);var i=this.point(t.slice(1,1+n),t.slice(1+n,1+2*n));return i}else if((t[0]===2||t[0]===3)&&t.length-1===n)return this.pointFromX(t.slice(1,1+n),t[0]===3);throw new Error("Unknown point format")};Yn.prototype.encodeCompressed=function(t){return this.encode(t,!0)};Yn.prototype._encode=function(t){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return t?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))};Yn.prototype.encode=function(t,r){return Nc.encode(this._encode(r),t)};Yn.prototype.precompute=function(t){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,t),r.beta=this._getBeta(),this.precomputed=r,this};Yn.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((t.bitLength()+1)/r.step):!1};Yn.prototype._getDoubles=function(t,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,s=0;s<r;s+=t){for(var o=0;o<t;o++)i=i.dbl();n.push(i)}return{step:t,points:n}};Yn.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<t)-1,i=n===1?null:this.dbl(),s=1;s<n;s++)r[s]=r[s-1].add(i);return{wnd:t,points:r}};Yn.prototype._getBeta=function(){return null};Yn.prototype.dblp=function(t){for(var r=this,n=0;n<t;n++)r=r.dbl();return r}});var m5=U((pX,x5)=>{"use strict";H();k();var xN=Dn(),or=Ar(),Wp=bo(),df=Rc(),mN=xN.assert;function Jn(e){df.call(this,"short",e),this.a=new or(e.a,16).toRed(this.red),this.b=new or(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Wp(Jn,df);x5.exports=Jn;Jn.prototype._getEndomorphism=function(t){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(t.beta)r=new or(t.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(t.lambda)n=new or(t.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?n=s[0]:(n=s[1],mN(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var o;return t.basis?o=t.basis.map(function(a){return{a:new or(a.a,16),b:new or(a.b,16)}}):o=this._getEndoBasis(n),{beta:r,lambda:n,basis:o}}};Jn.prototype._getEndoRoots=function(t){var r=t===this.p?this.red:or.mont(t),n=new or(2).toRed(r).redInvm(),i=n.redNeg(),s=new or(3).toRed(r).redNeg().redSqrt().redMul(n),o=i.redAdd(s).fromRed(),a=i.redSub(s).fromRed();return[o,a]};Jn.prototype._getEndoBasis=function(t){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=t,i=this.n.clone(),s=new or(1),o=new or(0),a=new or(0),f=new or(1),l,v,p,u,h,b,d,y=0,w,_;n.cmpn(0)!==0;){var I=i.div(n);w=i.sub(I.mul(n)),_=a.sub(I.mul(s));var N=f.sub(I.mul(o));if(!p&&w.cmp(r)<0)l=d.neg(),v=s,p=w.neg(),u=_;else if(p&&++y===2)break;d=w,i=n,n=w,a=s,s=_,f=o,o=N}h=w.neg(),b=_;var F=p.sqr().add(u.sqr()),O=h.sqr().add(b.sqr());return O.cmp(F)>=0&&(h=l,b=v),p.negative&&(p=p.neg(),u=u.neg()),h.negative&&(h=h.neg(),b=b.neg()),[{a:p,b:u},{a:h,b}]};Jn.prototype._endoSplit=function(t){var r=this.endo.basis,n=r[0],i=r[1],s=i.b.mul(t).divRound(this.n),o=n.b.neg().mul(t).divRound(this.n),a=s.mul(n.a),f=o.mul(i.a),l=s.mul(n.b),v=o.mul(i.b),p=t.sub(a).sub(f),u=l.add(v).neg();return{k1:p,k2:u}};Jn.prototype.pointFromX=function(t,r){t=new or(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var s=i.fromRed().isOdd();return(r&&!s||!r&&s)&&(i=i.redNeg()),this.point(t,i)};Jn.prototype.validate=function(t){if(t.inf)return!0;var r=t.x,n=t.y,i=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(s).cmpn(0)===0};Jn.prototype._endoWnafMulAdd=function(t,r,n){for(var i=this._endoWnafT1,s=this._endoWnafT2,o=0;o<t.length;o++){var a=this._endoSplit(r[o]),f=t[o],l=f._getBeta();a.k1.negative&&(a.k1.ineg(),f=f.neg(!0)),a.k2.negative&&(a.k2.ineg(),l=l.neg(!0)),i[o*2]=f,i[o*2+1]=l,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var v=this._wnafMulAdd(1,i,s,o*2,n),p=0;p<o*2;p++)i[p]=null,s[p]=null;return v};function Tr(e,t,r,n){df.BasePoint.call(this,e,"affine"),t===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new or(t,16),this.y=new or(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Wp(Tr,df.BasePoint);Jn.prototype.point=function(t,r,n){return new Tr(this,t,r,n)};Jn.prototype.pointFromJSON=function(t,r){return Tr.fromJSON(this,t,r)};Tr.prototype._getBeta=function(){if(!!this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var n=this.curve,i=function(s){return n.point(s.x.redMul(n.endo.beta),s.y)};t.beta=r,r.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(i)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(i)}}}return r}};Tr.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Tr.fromJSON=function(t,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=t.point(r[0],r[1],n);if(!r[2])return i;function s(a){return t.point(a[0],a[1],n)}var o=r[2];return i.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[i].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[i].concat(o.naf.points.map(s))}},i};Tr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Tr.prototype.isInfinity=function(){return this.inf};Tr.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(this.x.cmp(t.x)===0)return this.curve.point(null,null);var r=this.y.redSub(t.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(t.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(t.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};Tr.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(t.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=t.redInvm(),s=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};Tr.prototype.getX=function(){return this.x.fromRed()};Tr.prototype.getY=function(){return this.y.fromRed()};Tr.prototype.mul=function(t){return t=new or(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)};Tr.prototype.mulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)};Tr.prototype.jmulAdd=function(t,r,n){var i=[this,r],s=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)};Tr.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||this.x.cmp(t.x)===0&&this.y.cmp(t.y)===0)};Tr.prototype.neg=function(t){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var n=this.precomputed,i=function(s){return s.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r};Tr.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var t=this.curve.jpoint(this.x,this.y,this.curve.one);return t};function Yr(e,t,r,n){df.BasePoint.call(this,e,"jacobian"),t===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new or(0)):(this.x=new or(t,16),this.y=new or(r,16),this.z=new or(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Wp(Yr,df.BasePoint);Jn.prototype.jpoint=function(t,r,n){return new Yr(this,t,r,n)};Yr.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),r=t.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(t);return this.curve.point(n,i)};Yr.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Yr.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var r=t.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),s=t.x.redMul(n),o=this.y.redMul(r.redMul(t.z)),a=t.y.redMul(n.redMul(this.z)),f=i.redSub(s),l=o.redSub(a);if(f.cmpn(0)===0)return l.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var v=f.redSqr(),p=v.redMul(f),u=i.redMul(v),h=l.redSqr().redIAdd(p).redISub(u).redISub(u),b=l.redMul(u.redISub(h)).redISub(o.redMul(p)),d=this.z.redMul(t.z).redMul(f);return this.curve.jpoint(h,b,d)};Yr.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=t.x.redMul(r),s=this.y,o=t.y.redMul(r).redMul(this.z),a=n.redSub(i),f=s.redSub(o);if(a.cmpn(0)===0)return f.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=a.redSqr(),v=l.redMul(a),p=n.redMul(l),u=f.redSqr().redIAdd(v).redISub(p).redISub(p),h=f.redMul(p.redISub(u)).redISub(s.redMul(v)),b=this.z.redMul(a);return this.curve.jpoint(u,h,b)};Yr.prototype.dblp=function(t){if(t===0)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<t;r++)n=n.dbl();return n}var i=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,f=this.z,l=f.redSqr().redSqr(),v=a.redAdd(a);for(r=0;r<t;r++){var p=o.redSqr(),u=v.redSqr(),h=u.redSqr(),b=p.redAdd(p).redIAdd(p).redIAdd(i.redMul(l)),d=o.redMul(u),y=b.redSqr().redISub(d.redAdd(d)),w=d.redISub(y),_=b.redMul(w);_=_.redIAdd(_).redISub(h);var I=v.redMul(f);r+1<t&&(l=l.redMul(h)),o=y,f=I,v=_}return this.curve.jpoint(o,v.redMul(s),f)};Yr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Yr.prototype._zeroDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var f=i.redAdd(i).redIAdd(i),l=f.redSqr().redISub(a).redISub(a),v=o.redIAdd(o);v=v.redIAdd(v),v=v.redIAdd(v),t=l,r=f.redMul(a.redISub(l)).redISub(v),n=this.y.redAdd(this.y)}else{var p=this.x.redSqr(),u=this.y.redSqr(),h=u.redSqr(),b=this.x.redAdd(u).redSqr().redISub(p).redISub(h);b=b.redIAdd(b);var d=p.redAdd(p).redIAdd(p),y=d.redSqr(),w=h.redIAdd(h);w=w.redIAdd(w),w=w.redIAdd(w),t=y.redISub(b).redISub(b),r=d.redMul(b.redISub(t)).redISub(w),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(t,r,n)};Yr.prototype._threeDbl=function(){var t,r,n;if(this.zOne){var i=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(i).redISub(o);a=a.redIAdd(a);var f=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),l=f.redSqr().redISub(a).redISub(a);t=l;var v=o.redIAdd(o);v=v.redIAdd(v),v=v.redIAdd(v),r=f.redMul(a.redISub(l)).redISub(v),n=this.y.redAdd(this.y)}else{var p=this.z.redSqr(),u=this.y.redSqr(),h=this.x.redMul(u),b=this.x.redSub(p).redMul(this.x.redAdd(p));b=b.redAdd(b).redIAdd(b);var d=h.redIAdd(h);d=d.redIAdd(d);var y=d.redAdd(d);t=b.redSqr().redISub(y),n=this.y.redAdd(this.z).redSqr().redISub(u).redISub(p);var w=u.redSqr();w=w.redIAdd(w),w=w.redIAdd(w),w=w.redIAdd(w),r=b.redMul(d.redISub(t)).redISub(w)}return this.curve.jpoint(t,r,n)};Yr.prototype._dbl=function(){var t=this.curve.a,r=this.x,n=this.y,i=this.z,s=i.redSqr().redSqr(),o=r.redSqr(),a=n.redSqr(),f=o.redAdd(o).redIAdd(o).redIAdd(t.redMul(s)),l=r.redAdd(r);l=l.redIAdd(l);var v=l.redMul(a),p=f.redSqr().redISub(v.redAdd(v)),u=v.redISub(p),h=a.redSqr();h=h.redIAdd(h),h=h.redIAdd(h),h=h.redIAdd(h);var b=f.redMul(u).redISub(h),d=n.redAdd(n).redMul(i);return this.curve.jpoint(p,b,d)};Yr.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),s=t.redAdd(t).redIAdd(t),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(t).redISub(i);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var f=a.redSqr(),l=i.redIAdd(i);l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var v=s.redIAdd(a).redSqr().redISub(o).redISub(f).redISub(l),p=r.redMul(v);p=p.redIAdd(p),p=p.redIAdd(p);var u=this.x.redMul(f).redISub(p);u=u.redIAdd(u),u=u.redIAdd(u);var h=this.y.redMul(v.redMul(l.redISub(v)).redISub(a.redMul(f)));h=h.redIAdd(h),h=h.redIAdd(h),h=h.redIAdd(h);var b=this.z.redAdd(a).redSqr().redISub(n).redISub(f);return this.curve.jpoint(u,h,b)};Yr.prototype.mul=function(t,r){return t=new or(t,r),this.curve._wnafMul(this,t)};Yr.prototype.eq=function(t){if(t.type==="affine")return this.eq(t.toJ());if(this===t)return!0;var r=this.z.redSqr(),n=t.z.redSqr();if(this.x.redMul(n).redISub(t.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),s=n.redMul(t.z);return this.y.redMul(s).redISub(t.y.redMul(i)).cmpn(0)===0};Yr.prototype.eqXToP=function(t){var r=this.z.redSqr(),n=t.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=t.clone(),s=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(s),this.x.cmp(n)===0)return!0}};Yr.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Yr.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var E5=U((gX,S5)=>{"use strict";H();k();var hf=Ar(),w5=bo(),zd=Rc(),wN=Dn();function lf(e){zd.call(this,"mont",e),this.a=new hf(e.a,16).toRed(this.red),this.b=new hf(e.b,16).toRed(this.red),this.i4=new hf(4).toRed(this.red).redInvm(),this.two=new hf(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}w5(lf,zd);S5.exports=lf;lf.prototype.validate=function(t){var r=t.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),s=i.redSqrt();return s.redSqr().cmp(i)===0};function qr(e,t,r){zd.BasePoint.call(this,e,"projective"),t===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new hf(t,16),this.z=new hf(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}w5(qr,zd.BasePoint);lf.prototype.decodePoint=function(t,r){return this.point(wN.toArray(t,r),1)};lf.prototype.point=function(t,r){return new qr(this,t,r)};lf.prototype.pointFromJSON=function(t){return qr.fromJSON(this,t)};qr.prototype.precompute=function(){};qr.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};qr.fromJSON=function(t,r){return new qr(t,r[0],r[1]||t.one)};qr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};qr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};qr.prototype.dbl=function(){var t=this.x.redAdd(this.z),r=t.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),s=r.redSub(i),o=r.redMul(i),a=s.redMul(i.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)};qr.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};qr.prototype.diffAdd=function(t,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=t.x.redAdd(t.z),o=t.x.redSub(t.z),a=o.redMul(n),f=s.redMul(i),l=r.z.redMul(a.redAdd(f).redSqr()),v=r.x.redMul(a.redISub(f).redSqr());return this.curve.point(l,v)};qr.prototype.mul=function(t){for(var r=t.clone(),n=this,i=this.curve.point(null,null),s=this,o=[];r.cmpn(0)!==0;r.iushrn(1))o.push(r.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(n=n.diffAdd(i,s),i=i.dbl()):(i=n.diffAdd(i,s),n=n.dbl());return i};qr.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};qr.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};qr.prototype.eq=function(t){return this.getX().cmp(t.getX())===0};qr.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};qr.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var B5=U((mX,A5)=>{"use strict";H();k();var SN=Dn(),Ns=Ar(),_5=bo(),Wd=Rc(),EN=SN.assert;function os(e){this.twisted=(e.a|0)!==1,this.mOneA=this.twisted&&(e.a|0)===-1,this.extended=this.mOneA,Wd.call(this,"edwards",e),this.a=new Ns(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Ns(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Ns(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),EN(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(e.c|0)===1}_5(os,Wd);A5.exports=os;os.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)};os.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)};os.prototype.jpoint=function(t,r,n,i){return this.point(t,r,n,i)};os.prototype.pointFromX=function(t,r){t=new Ns(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),o=i.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var f=a.fromRed().isOdd();return(r&&!f||!r&&f)&&(a=a.redNeg()),this.point(t,a)};os.prototype.pointFromY=function(t,r){t=new Ns(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr(),i=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,t)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,t)};os.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var r=t.x.redSqr(),n=t.y.redSqr(),i=r.redMul(this.a).redAdd(n),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(s)===0};function Ht(e,t,r,n,i){Wd.BasePoint.call(this,e,"projective"),t===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Ns(t,16),this.y=new Ns(r,16),this.z=n?new Ns(n,16):this.curve.one,this.t=i&&new Ns(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}_5(Ht,Wd.BasePoint);os.prototype.pointFromJSON=function(t){return Ht.fromJSON(this,t)};os.prototype.point=function(t,r,n,i){return new Ht(this,t,r,n,i)};Ht.fromJSON=function(t,r){return new Ht(t,r[0],r[1],r[2])};Ht.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Ht.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Ht.prototype._extDbl=function(){var t=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(t),s=this.x.redAdd(this.y).redSqr().redISub(t).redISub(r),o=i.redAdd(r),a=o.redSub(n),f=i.redSub(r),l=s.redMul(a),v=o.redMul(f),p=s.redMul(f),u=a.redMul(o);return this.curve.point(l,v,u,p)};Ht.prototype._projDbl=function(){var t=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,s,o,a,f,l;if(this.curve.twisted){a=this.curve._mulA(r);var v=a.redAdd(n);this.zOne?(i=t.redSub(r).redSub(n).redMul(v.redSub(this.curve.two)),s=v.redMul(a.redSub(n)),o=v.redSqr().redSub(v).redSub(v)):(f=this.z.redSqr(),l=v.redSub(f).redISub(f),i=t.redSub(r).redISub(n).redMul(l),s=v.redMul(a.redSub(n)),o=v.redMul(l))}else a=r.redAdd(n),f=this.curve._mulC(this.z).redSqr(),l=a.redSub(f).redSub(f),i=this.curve._mulC(t.redISub(a)).redMul(l),s=this.curve._mulC(a).redMul(r.redISub(n)),o=a.redMul(l);return this.curve.point(i,s,o)};Ht.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};Ht.prototype._extAdd=function(t){var r=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),n=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),i=this.t.redMul(this.curve.dd).redMul(t.t),s=this.z.redMul(t.z.redAdd(t.z)),o=n.redSub(r),a=s.redSub(i),f=s.redAdd(i),l=n.redAdd(r),v=o.redMul(a),p=f.redMul(l),u=o.redMul(l),h=a.redMul(f);return this.curve.point(v,p,h,u)};Ht.prototype._projAdd=function(t){var r=this.z.redMul(t.z),n=r.redSqr(),i=this.x.redMul(t.x),s=this.y.redMul(t.y),o=this.curve.d.redMul(i).redMul(s),a=n.redSub(o),f=n.redAdd(o),l=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(i).redISub(s),v=r.redMul(a).redMul(l),p,u;return this.curve.twisted?(p=r.redMul(f).redMul(s.redSub(this.curve._mulA(i))),u=a.redMul(f)):(p=r.redMul(f).redMul(s.redSub(i)),u=this.curve._mulC(a).redMul(f)),this.curve.point(v,p,u)};Ht.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)};Ht.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)};Ht.prototype.mulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!1)};Ht.prototype.jmulAdd=function(t,r,n){return this.curve._wnafMulAdd(1,[this,r],[t,n],2,!0)};Ht.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this};Ht.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Ht.prototype.getX=function(){return this.normalize(),this.x.fromRed()};Ht.prototype.getY=function(){return this.normalize(),this.y.fromRed()};Ht.prototype.eq=function(t){return this===t||this.getX().cmp(t.getX())===0&&this.getY().cmp(t.getY())===0};Ht.prototype.eqXToP=function(t){var r=t.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=t.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}};Ht.prototype.toP=Ht.prototype.normalize;Ht.prototype.mixedAdd=Ht.prototype.add});var $p=U(P5=>{"use strict";H();k();var $d=P5;$d.base=Rc();$d.short=m5();$d.mont=E5();$d.edwards=B5()});var M5=U((BX,I5)=>{"use strict";H();k();I5.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var Gd=U(N5=>{"use strict";H();k();var Xp=N5,Ca=yu(),Gp=$p(),_N=Dn(),C5=_N.assert;function F5(e){e.type==="short"?this.curve=new Gp.short(e):e.type==="edwards"?this.curve=new Gp.edwards(e):this.curve=new Gp.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,C5(this.g.validate(),"Invalid curve"),C5(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}Xp.PresetCurve=F5;function Fa(e,t){Object.defineProperty(Xp,e,{configurable:!0,enumerable:!0,get:function(){var r=new F5(t);return Object.defineProperty(Xp,e,{configurable:!0,enumerable:!0,value:r}),r}})}Fa("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Ca.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Fa("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Ca.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Fa("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Ca.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Fa("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Ca.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Fa("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Ca.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Fa("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ca.sha256,gRed:!1,g:["9"]});Fa("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ca.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var Zp;try{Zp=M5()}catch{Zp=void 0}Fa("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Ca.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",Zp]})});var O5=U((NX,R5)=>{"use strict";H();k();var AN=Ar(),BN=Dn(),Yp=BN.assert;function cn(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}R5.exports=cn;cn.fromPublic=function(t,r,n){return r instanceof cn?r:new cn(t,{pub:r,pubEnc:n})};cn.fromPrivate=function(t,r,n){return r instanceof cn?r:new cn(t,{priv:r,privEnc:n})};cn.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};cn.prototype.getPublic=function(t,r){return typeof t=="string"&&(r=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,t):this.pub};cn.prototype.getPrivate=function(t){return t==="hex"?this.priv.toString(16,2):this.priv};cn.prototype._importPrivate=function(t,r){this.priv=new AN(t,r||16),this.priv=this.priv.umod(this.ec.curve.n)};cn.prototype._importPublic=function(t,r){if(t.x||t.y){this.ec.curve.type==="mont"?Yp(t.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Yp(t.x&&t.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(t.x,t.y);return}this.pub=this.ec.curve.decodePoint(t,r)};cn.prototype.derive=function(t){return t.validate()||Yp(t.validate(),"public point not validated"),t.mul(this.priv).getX()};cn.prototype.sign=function(t,r,n){return this.ec.sign(t,this,r,n)};cn.prototype.verify=function(t,r){return this.ec.verify(t,r,this)};cn.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var q5=U((DX,T5)=>{"use strict";H();k();var Xd=Ar(),ev=Dn(),PN=ev.assert;function Oc(e,t,r){if(t instanceof Oc)return t;this._importDER(t,r)||(PN(t.r&&t.s,"Signature without r or s"),this.r=new Xd(t.r,16),this.s=new Xd(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam,this.curve=e,this.byteLength=this.curve.n.byteLength())}T5.exports=Oc;function IN(){this.place=0}function Jp(e,t){var r=e[t.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4)return!1;for(var i=0,s=0,o=t.place;s<n;s++,o++)i<<=8,i|=e[o],i>>>=0;return i<=127?!1:(t.place=o,i)}function D5(e){for(var t=0,r=e.length-1;!e[t]&&!(e[t+1]&128)&&t<r;)t++;return t===0?e:e.slice(t)}Oc.prototype._importDER=function(t,r){t=ev.toArray(t,r);var n=new IN;if(t[n.place++]!==48)return!1;var i=Jp(t,n);if(i===!1||i+n.place!==t.length||t[n.place++]!==2)return!1;var s=Jp(t,n);if(s===!1)return!1;var o=t.slice(n.place,s+n.place);if(n.place+=s,t[n.place++]!==2)return!1;var a=Jp(t,n);if(a===!1||t.length!==a+n.place)return!1;var f=t.slice(n.place,a+n.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(f[0]===0)if(f[1]&128)f=f.slice(1);else return!1;return this.r=new Xd(o),this.s=new Xd(f),this.recoveryParam=null,!0};function Qp(e,t){if(t<128){e.push(t);return}var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(r|128);--r;)e.push(t>>>(r<<3)&255);e.push(t)}Oc.prototype.toDER=function(t){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=D5(r),n=D5(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];Qp(i,r.length),i=i.concat(r),i.push(2),Qp(i,n.length);var s=i.concat(n),o=[48];return Qp(o,s.length),o=o.concat(s),ev.encode(o,t)};Oc.prototype.toBytes=function(){let t=this.r.toArray("be",this.byteLength),r=this.s.toArray("be",this.byteLength);return t.concat(r)}});var L5=U((HX,j5)=>{"use strict";H();k();var U0=Ar(),H5=ng(),MN=Dn(),tv=Gd(),CN=tg(),k5=MN.assert,rv=O5(),Zd=q5();function Qn(e){if(!(this instanceof Qn))return new Qn(e);typeof e=="string"&&(k5(Object.prototype.hasOwnProperty.call(tv,e),"Unknown curve "+e),e=tv[e]),e instanceof tv.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}j5.exports=Qn;Qn.prototype.keyPair=function(t){return new rv(this,t)};Qn.prototype.keyFromPrivate=function(t,r){return rv.fromPrivate(this,t,r)};Qn.prototype.keyFromPublic=function(t,r){return rv.fromPublic(this,t,r)};Qn.prototype.genKeyPair=function(t){t||(t={});for(var r=new H5({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||CN(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new U0(2));;){var s=new U0(r.generate(n));if(!(s.cmp(i)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Qn.prototype._truncateToN=function(t,r){var n=t.byteLength()*8-this.n.bitLength();return n>0&&(t=t.ushrn(n)),!r&&t.cmp(this.n)>=0?t.sub(this.n):t};Qn.prototype.sign=function(t,r,n,i){typeof n=="object"&&(i=n,n=null),i||(i={}),r=this.keyFromPrivate(r,n),t=this._truncateToN(new U0(t,16));for(var s=this.n.byteLength(),o=r.getPrivate().toArray("be",s),a=t.toArray("be",s),f=new H5({hash:this.hash,entropy:o,nonce:a,pers:i.pers,persEnc:i.persEnc||"utf8"}),l=this.n.sub(new U0(1)),v=0;;v++){var p=i.k?i.k(v):new U0(f.generate(this.n.byteLength()));if(p=this._truncateToN(p,!0),!(p.cmpn(1)<=0||p.cmp(l)>=0)){var u=this.g.mul(p);if(!u.isInfinity()){var h=u.getX(),b=h.umod(this.n);if(b.cmpn(0)!==0){var d=p.invm(this.n).mul(b.mul(r.getPrivate()).iadd(t));if(d=d.umod(this.n),d.cmpn(0)!==0){var y=(u.getY().isOdd()?1:0)|(h.cmp(b)!==0?2:0);return i.canonical&&d.cmp(this.nh)>0&&(d=this.n.sub(d),y^=1),new Zd(this.curve,{r:b,s:d,recoveryParam:y})}}}}}};Qn.prototype.verify=function(t,r,n,i){t=this._truncateToN(new U0(t,16)),n=this.keyFromPublic(n,i),r=new Zd(this.curve,r,"hex");var s=r.r,o=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),f=a.mul(t).umod(this.n),l=a.mul(s).umod(this.n),v;return this.curve._maxwellTrick?(v=this.g.jmulAdd(f,n.getPublic(),l),v.isInfinity()?!1:v.eqXToP(s)):(v=this.g.mulAdd(f,n.getPublic(),l),v.isInfinity()?!1:v.getX().umod(this.n).cmp(s)===0)};Qn.prototype.recoverPubKey=function(e,t,r,n){k5((3&r)===r,"The recovery param is more than two bits"),t=new Zd(this.curve,t,n);var i=this.n,s=new U0(e),o=t.r,a=t.s,f=r&1,l=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");l?o=this.curve.pointFromX(o.add(this.curve.n),f):o=this.curve.pointFromX(o,f);var v=t.r.invm(i),p=i.sub(s).mul(v).umod(i),u=a.mul(v).umod(i);return this.g.mulAdd(p,o,u)};Qn.prototype.getKeyRecoveryParam=function(e,t,r,n){if(t=new Zd(this.curve,t,n),t.recoveryParam!==null)return t.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,t,i)}catch{continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")}});var z5=U((LX,V5)=>{"use strict";H();k();var Dc=Dn(),U5=Dc.assert,K5=Dc.parseBytes,pf=Dc.cachedProperty;function Hr(e,t){this.eddsa=e,this._secret=K5(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=K5(t.pub)}Hr.fromPublic=function(t,r){return r instanceof Hr?r:new Hr(t,{pub:r})};Hr.fromSecret=function(t,r){return r instanceof Hr?r:new Hr(t,{secret:r})};Hr.prototype.secret=function(){return this._secret};pf(Hr,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});pf(Hr,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});pf(Hr,"privBytes",function(){var t=this.eddsa,r=this.hash(),n=t.encodingLength-1,i=r.slice(0,t.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i});pf(Hr,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});pf(Hr,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});pf(Hr,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});Hr.prototype.sign=function(t){return U5(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)};Hr.prototype.verify=function(t,r){return this.eddsa.verify(t,r,this)};Hr.prototype.getSecret=function(t){return U5(this._secret,"KeyPair is public only"),Dc.encode(this.secret(),t)};Hr.prototype.getPublic=function(t){return Dc.encode(this.pubBytes(),t)};V5.exports=Hr});var $5=U((VX,W5)=>{"use strict";H();k();var FN=Ar(),Yd=Dn(),NN=Yd.assert,Jd=Yd.cachedProperty,RN=Yd.parseBytes;function V0(e,t){this.eddsa=e,typeof t!="object"&&(t=RN(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),NN(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof FN&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}Jd(V0,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Jd(V0,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Jd(V0,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Jd(V0,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});V0.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};V0.prototype.toHex=function(){return Yd.encode(this.toBytes(),"hex").toUpperCase()};W5.exports=V0});var J5=U(($X,Y5)=>{"use strict";H();k();var ON=yu(),DN=Gd(),vf=Dn(),TN=vf.assert,X5=vf.parseBytes,Z5=z5(),G5=$5();function Cn(e){if(TN(e==="ed25519","only tested with ed25519 so far"),!(this instanceof Cn))return new Cn(e);e=DN[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=ON.sha512}Y5.exports=Cn;Cn.prototype.sign=function(t,r){t=X5(t);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),t),s=this.g.mul(i),o=this.encodePoint(s),a=this.hashInt(o,n.pubBytes(),t).mul(n.priv()),f=i.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:f,Rencoded:o})};Cn.prototype.verify=function(t,r,n){t=X5(t),r=this.makeSignature(r);var i=this.keyFromPublic(n),s=this.hashInt(r.Rencoded(),i.pubBytes(),t),o=this.g.mul(r.S()),a=r.R().add(i.pub().mul(s));return a.eq(o)};Cn.prototype.hashInt=function(){for(var t=this.hash(),r=0;r<arguments.length;r++)t.update(arguments[r]);return vf.intFromLE(t.digest()).umod(this.curve.n)};Cn.prototype.keyFromPublic=function(t){return Z5.fromPublic(this,t)};Cn.prototype.keyFromSecret=function(t){return Z5.fromSecret(this,t)};Cn.prototype.makeSignature=function(t){return t instanceof G5?t:new G5(this,t)};Cn.prototype.encodePoint=function(t){var r=t.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=t.getX().isOdd()?128:0,r};Cn.prototype.decodePoint=function(t){t=vf.parseBytes(t);var r=t.length-1,n=t.slice(0,r).concat(t[r]&-129),i=(t[r]&128)!==0,s=vf.intFromLE(n);return this.curve.pointFromY(s,i)};Cn.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)};Cn.prototype.decodeInt=function(t){return vf.intFromLE(t)};Cn.prototype.isPoint=function(t){return t instanceof this.pointClass}});var bf=U(ei=>{"use strict";H();k();Object.defineProperty(ei,"__esModule",{value:!0});ei.utils=ei.curves=ei.curve=ei.eddsa=ei.ec=void 0;var qN=$p();ei.curve=qN;var HN=Gd();ei.curves=HN;var kN=L5();ei.ec=kN;var jN=J5();ei.eddsa=jN;var LN=Dn();ei.utils=LN});var ty=U((Q5,ey)=>{"use strict";H();k();Object.defineProperty(Q5,"__esModule",{value:!0});var KN=bf(),fs=new KN.ec("secp256k1"),lt=fs.curve,kt=Ar();function UN(e,t){let r=new kt(t);if(r.cmp(lt.p)>=0)return null;r=r.toRed(lt.red);let n=r.redSqr().redIMul(r).redIAdd(lt.b).redSqrt();e===3!==n.isOdd()&&(n=n.redNeg());let i=r.redSqr().redIMul(r);return n.redSqr().redISub(i.redIAdd(lt.b)).isZero()?fs.keyPair({pub:{x:r,y:n}}):null}function VN(e,t,r){let n=new kt(t),i=new kt(r);if(n.cmp(lt.p)>=0||i.cmp(lt.p)>=0||(n=n.toRed(lt.red),i=i.toRed(lt.red),(e===6||e===7)&&i.isOdd()!==(e===7)))return null;let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(lt.b)).isZero()?fs.keyPair({pub:{x:n,y:i}}):null}function Na(e){let t=e[0];switch(t){case 2:case 3:return e.length!==33?null:UN(t,e.subarray(1,33));case 4:case 6:case 7:return e.length!==65?null:VN(t,e.subarray(1,33),e.subarray(33,65));default:return null}}ey.exports={contextRandomize(){return 0},privateKeyVerify(e){let t=new kt(e);return t.cmp(lt.n)<0&&!t.isZero()},privateKeyNegate(e){let t=new kt(e);return j.Buffer.from(lt.n.sub(t).umod(lt.n).toArray("be",32))},privateKeyTweakAdd(e,t){let r=new kt(t);return r.cmp(lt.n)>=0||(r.iadd(new kt(e)),r.cmp(lt.n)>=0&&r.isub(lt.n),r.isZero())?null:j.Buffer.from(r.toArray("be",32))},privateKeyTweakMul(e,t){let r=new kt(t);return r.cmp(lt.n)>=0||r.isZero()?1:(r.imul(new kt(e)),r.cmp(lt.n)>=0&&(r=r.umod(lt.n)),j.Buffer.from(r.toArray("be",32)))},publicKeyVerify(e){let t=Na(e);return t==null?null:t.validate().result},publicKeyCreate(e,t){let r=new kt(e);if(r.cmp(lt.n)>=0||r.isZero())return null;let n=fs.keyFromPrivate(e,null).getPublic();return j.Buffer.from(n.encode(null,t))},publicKeyConvert(e,t){let n=Na(e).getPublic();return j.Buffer.from(n.encode(null,t))},publicKeyNegate(e,t){let r=Na(e);if(r===null)return 1;let n=r.getPublic();return n.y=n.y.redNeg(),j.Buffer.from(n.encode(null,t))},publicKeyCombine(e,t){let r=new Array(e.length);for(let i=0;i<e.length;++i)if(r[i]=Na(e[i]),r[i]===null)return null;let n=r[0].getPublic();for(let i=1;i<r.length;++i)n=n.add(r[i].pub);return n.isInfinity()?null:j.Buffer.from(n.encode(null,t))},publicKeyTweakAdd(e,t,r){let n=Na(e);if(n===null||new kt(t).cmp(lt.n)>=0)return null;let s=n.getPublic().add(lt.g.mul(t));return s.isInfinity()?null:j.Buffer.from(s.encode(null,r))},publicKeyTweakMul(e,t,r){let n=Na(e);if(n===null)return null;let i=new kt(t);if(i.cmp(lt.n)>=0||i.isZero())return null;let s=n.getPublic().mul(t);return j.Buffer.from(s.encode(null,r))},signatureNormalize(e){let t=new kt(e.subarray(0,32)),r=new kt(e.subarray(32,64));return t.cmp(lt.n)>=0||r.cmp(lt.n)>=0?null:(r.cmp(fs.nh)===1&&e.set(lt.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(e,t){let r=t.subarray(0,32),n=t.subarray(32,64);if(new kt(r).cmp(lt.n)>=0||new kt(n).cmp(lt.n)>=0)return 1;let{output:i}=e,s=i.subarray(4,4+33);s[0]=0,s.set(r,1);let o=33,a=0;for(;o>1&&s[a]===0&&!(s[a+1]&128);--o,++a);if(s=s.subarray(a),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let f=i.subarray(6+33,6+33+33);f[0]=0,f.set(n,1);let l=33,v=0;for(;l>1&&f[v]===0&&!(f[v+1]&128);--l,++v);return f=f.subarray(v),f[0]&128||l>1&&f[0]===0&&!(f[1]&128)?1:(e.outputlen=6+o+l,i[0]=48,i[1]=e.outputlen-2,i[2]=2,i[3]=s.length,i.set(s,4),i[4+o]=2,i[5+o]=f.length,i.set(f,6+o),0)},signatureImport(e,t){if(t.length<8||t.length>72||t[0]!==48||t[1]!==t.length-2||t[2]!==2)return 1;let r=t[3];if(r===0||5+r>=t.length||t[4+r]!==2)return 1;let n=t[5+r];if(n===0||6+r+n!==t.length||t[4]&128||r>1&&t[4]===0&&!(t[5]&128)||t[r+6]&128||n>1&&t[r+6]===0&&!(t[r+7]&128))return 1;let i=t.subarray(4,4+r);if(i.length===33&&i[0]===0&&(i=i.subarray(1)),i.length>32)return 1;let s=t.subarray(6+r);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new kt(i);o.cmp(lt.n)>=0&&(o=new kt(0));let a=new kt(t.subarray(6+r));return a.cmp(lt.n)>=0&&(a=new kt(0)),e.set(o.toArrayLike(Uint8Array,"be",32),0),e.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(e,t){let r=new kt(t);return r.cmp(lt.n)>=0||r.isZero()?null:fs.sign(e,t,{canonical:!0}).toBytes()},ecdsaVerify(e,t,r){let n={r:e.subarray(0,32),s:e.subarray(32,64)},i=new kt(n.r),s=new kt(n.s);if(i.cmp(lt.n)>=0||s.cmp(lt.n)>=0)return 1;if(s.cmp(fs.nh)===1||i.isZero()||s.isZero())return 3;let o=Na(r);if(o===null)return 2;let a=o.getPublic();return fs.verify(t,n,a)},ecdsaRecover(e,t,r,n){let i={r:e.slice(0,32),s:e.slice(32,64)},s=new kt(i.r),o=new kt(i.s);if(s.cmp(lt.n)>=0||o.cmp(lt.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let a;try{a=fs.recoverPubKey(r,i,t,null)}catch{return 2}return j.Buffer.from(a.encode(null,n))},ecdh(e,t,r,n,i,s,o){let a=Na(t);if(a===null)return 1;let f=new kt(r);if(f.cmp(lt.n)>=0||f.isZero())return 2;let l=a.getPublic().mul(f);if(i===void 0){let v=l.encode(null,!0),p=fs.hash().update(v).digest();for(let u=0;u<32;++u)e[u]=p[u]}else{s||(s=new Uint8Array(32));let v=l.getX().toArray("be",32);for(let b=0;b<32;++b)s[b]=v[b];o||(o=new Uint8Array(32));let p=l.getY().toArray("be",32);for(let b=0;b<32;++b)o[b]=p[b];let u=i(s,o,n);if(!(u instanceof Uint8Array&&u.length===e.length))return 2;e.set(u)}return 0}}});var ay=U(kr=>{"use strict";H();k();var zN=kr&&kr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),WN=kr&&kr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),$N=kr&&kr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&zN(t,e,r);return WN(t,e),t};Object.defineProperty(kr,"__esModule",{value:!0});kr.fromSeed=kr.fromPublicKey=kr.fromPrivateKey=kr.fromBase58=kr.tinySecp256k1Interface=void 0;var nv=$N(L0()),GN=T0(),XN=Ic(),ny=(0,GN.base58check)(XN.sha256),iy=ty(),Jr=xu(),ZN=sg();function YN(e){return{isPoint:t=>e.publicKeyVerify(t),isPrivate:t=>e.privateKeyVerify(t),pointAddScalar:(t,r,n)=>e.publicKeyTweakAdd(t,r,n),pointFromScalar:(t,r)=>e.publicKeyCreate(t,r),privateAdd:(t,r)=>e.privateKeyTweakAdd(new Uint8Array(t),r),sign:(t,r)=>e.ecdsaSign(t,r),verify:(t,r,n)=>e.ecdsaVerify(n,t,r)}}function JN(e){return{isPoint:t=>e.publicKeyVerify(t),pointCompress:(t,r)=>Uint8Array.from(e.publicKeyConvert(t,r??!0)),isPrivate:t=>e.privateKeyVerify(t),pointFromScalar:(t,r)=>{let n=e.publicKeyCreate(t,r??!0);return n==null?null:Uint8Array.from(n)},sign:(t,r,n)=>Uint8Array.from(e.ecdsaSign(t,r)),verify:(t,r,n,i)=>e.ecdsaVerify(n,t,r)}}var Ra=YN(iy);kr.tinySecp256k1Interface=JN(iy);var iv=Jr.BufferN(32),QN=Jr.compile({wif:Jr.UInt8,bip32:{public:Jr.UInt32,private:Jr.UInt32}}),th={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},ry=2147483648,eR=Math.pow(2,31)-1;function tR(e){return Jr.String(e)&&e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)!==null}function rR(e){return Jr.UInt32(e)&&e<=eR}var Qd=class{constructor(t,r,n,i,s=0,o=0,a=0){this.__D=t,this.__Q=r,this.chainCode=n,this.network=i,this.__DEPTH=s,this.__INDEX=o,this.__PARENT_FINGERPRINT=a,Jr(QN,i),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return this.__Q===void 0&&(this.__Q=j.Buffer.from(Ra.pointFromScalar(this.__D,!0))),this.__Q}get privateKey(){return this.__D}get identifier(){return j.Buffer.from(nv.hash160(this.publicKey))}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return this.__D===void 0}neutered(){return eh(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){let t=this.network,r=this.isNeutered()?t.bip32.public:t.bip32.private,n=j.Buffer.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),ny.encode(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return ZN.encode(this.network.wif,this.privateKey,!0)}derive(t){Jr(Jr.UInt32,t);let r=t>=ry,n=j.Buffer.allocUnsafe(37);if(r){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");n[0]=0,this.privateKey.copy(n,1),n.writeUInt32BE(t,33)}else this.publicKey.copy(n,0),n.writeUInt32BE(t,33);let i=nv.hmacSHA512(this.chainCode,n),s=i.slice(0,32),o=i.slice(32);if(!Ra.isPrivate(s))return this.derive(t+1);let a;if(this.isNeutered()){let f=Ra.pointAddScalar(this.publicKey,s,!0);if(f===null)return this.derive(t+1);a=eh(f,o,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}else{let f=Ra.privateAdd(this.privateKey,s);if(f==null)return this.derive(t+1);a=sv(f,o,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}return a}deriveHardened(t){return Jr(rR,t),this.derive(t+ry)}derivePath(t){Jr(tR,t);let r=t.split("/");if(r[0]==="m"){if(this.parentFingerprint)throw new TypeError("Expected master, got child");r=r.slice(1)}return r.reduce((n,i)=>{let s;return i.slice(-1)==="'"?(s=parseInt(i.slice(0,-1),10),n.deriveHardened(s)):(s=parseInt(i,10),n.derive(s))},this)}sign(t){if(!this.privateKey)throw new Error("Missing private key");return Ra.sign(t,this.privateKey)}verify(t,r){return Ra.verify(t,this.publicKey,r)}};function nR(e,t){let r=j.Buffer.from(ny.decode(e));if(r.length!==78)throw new TypeError("Invalid buffer length");t=t||th;let n=r.readUInt32BE(0);if(n!==t.bip32.private&&n!==t.bip32.public)throw new TypeError("Invalid network version");let i=r[4],s=r.readUInt32BE(5);if(i===0&&s!==0)throw new TypeError("Invalid parent fingerprint");let o=r.readUInt32BE(9);if(i===0&&o!==0)throw new TypeError("Invalid index");let a=r.slice(13,45),f;if(n===t.bip32.private){if(r.readUInt8(45)!==0)throw new TypeError("Invalid private key");let l=r.slice(46,78);f=sv(l,a,t,i,o,s)}else{let l=r.slice(45,78);f=eh(l,a,t,i,o,s)}return f}kr.fromBase58=nR;function sy(e,t,r){return sv(e,t,r)}kr.fromPrivateKey=sy;function sv(e,t,r,n,i,s){if(Jr({privateKey:iv,chainCode:iv},{privateKey:e,chainCode:t}),r=r||th,!Ra.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return new Qd(e,void 0,t,r,n,i,s)}function iR(e,t,r){return eh(e,t,r)}kr.fromPublicKey=iR;function eh(e,t,r,n,i,s){if(Jr({publicKey:Jr.BufferN(33),chainCode:iv},{publicKey:e,chainCode:t}),r=r||th,!Ra.isPoint(e))throw new TypeError("Point is not on the curve");return new Qd(void 0,e,t,r,n,i,s)}function sR(e,t){if(Jr(Jr.Buffer,e),e.length<16)throw new TypeError("Seed should be at least 128 bits");if(e.length>64)throw new TypeError("Seed should be at most 512 bits");t=t||th;let r=nv.hmacSHA512(j.Buffer.from("Bitcoin seed","utf8"),e),n=r.slice(0,32),i=r.slice(32);return sy(n,i,t)}kr.fromSeed=sR});var oy=U(ti=>{"use strict";H();k();Object.defineProperty(ti,"__esModule",{value:!0});ti.fromPrivateKey=ti.fromPublicKey=ti.fromBase58=ti.fromSeed=ti.tinySecp256k1Interface=void 0;var Tc=ay();Object.defineProperty(ti,"tinySecp256k1Interface",{enumerable:!0,get:function(){return Tc.tinySecp256k1Interface}});Object.defineProperty(ti,"fromSeed",{enumerable:!0,get:function(){return Tc.fromSeed}});Object.defineProperty(ti,"fromBase58",{enumerable:!0,get:function(){return Tc.fromBase58}});Object.defineProperty(ti,"fromPublicKey",{enumerable:!0,get:function(){return Tc.fromPublicKey}});Object.defineProperty(ti,"fromPrivateKey",{enumerable:!0,get:function(){return Tc.fromPrivateKey}})});var fy=U((oZ,aR)=>{aR.exports=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]});var ov=U(z0=>{"use strict";H();k();Object.defineProperty(z0,"__esModule",{value:!0});z0._default=z0.wordlists=void 0;var av={};z0.wordlists=av;var rh;z0._default=rh;try{z0._default=rh=fy(),av.english=rh,av.EN=rh}catch{}});var wy=U(br=>{"use strict";H();k();Object.defineProperty(br,"__esModule",{value:!0});br.wordlists=br.getDefaultWordlist=br.setDefaultWordlist=br.validateMnemonic=br.generateMnemonic=br.entropyToMnemonic=br.mnemonicToEntropy=br.mnemonicToSeed=br.mnemonicToSeedSync=void 0;var uy=L0(),dy=Ld(),nh=ov(),hy=Cd(),qc=nh._default,cy="Invalid mnemonic",W0="Invalid entropy",oR="Invalid mnemonic checksum",ly=`A wordlist is required but a default could not be found.
Please pass a 2048 word array explicitly.`;function fR(e,t,r,n,i){let s=(0,dy.pbkdf2)(hy.sha512,e,t,{c:r,dkLen:n});return Promise.resolve(j.Buffer.from(s))}function Hc(e){return(e||"").normalize("NFKD")}function py(e,t,r){for(;e.length<r;)e=t+e;return e}function vy(e){return parseInt(e,2)}function by(e){return e.map(t=>py(t.toString(2),"0",8)).join("")}function gy(e){let r=e.length*8/32,n=(0,uy.sha256)(e);return by(Array.from(n)).slice(0,r)}function yy(e){return"mnemonic"+(e||"")}function cR(e,t){let r=j.Buffer.from(Hc(e),"utf8"),n=j.Buffer.from(yy(Hc(t)),"utf8"),i=(0,dy.pbkdf2)(hy.sha512,r,n,{c:2048,dkLen:64});return j.Buffer.from(i)}br.mnemonicToSeedSync=cR;function uR(e,t){return Promise.resolve().then(()=>{let r=j.Buffer.from(Hc(e),"utf8"),n=j.Buffer.from(yy(Hc(t)),"utf8");return fR(r,n,2048,64,"sha512")})}br.mnemonicToSeed=uR;function xy(e,t){if(t=t||qc,!t)throw new Error(ly);let r=Hc(e).split(" ");if(r.length%3!==0)throw new Error(cy);let n=r.map(v=>{let p=t.indexOf(v);if(p===-1)throw new Error(cy);return py(p.toString(2),"0",11)}).join(""),i=Math.floor(n.length/33)*32,s=n.slice(0,i),o=n.slice(i),a=s.match(/(.{1,8})/g).map(vy);if(a.length<16)throw new Error(W0);if(a.length>32)throw new Error(W0);if(a.length%4!==0)throw new Error(W0);let f=j.Buffer.from(a);if(gy(f)!==o)throw new Error(oR);return f.toString("hex")}br.mnemonicToEntropy=xy;function my(e,t){if(j.Buffer.isBuffer(e)||(e=j.Buffer.from(e,"hex")),t=t||qc,!t)throw new Error(ly);if(e.length<16)throw new TypeError(W0);if(e.length>32)throw new TypeError(W0);if(e.length%4!==0)throw new TypeError(W0);let r=by(Array.from(e)),n=gy(e),o=(r+n).match(/(.{1,11})/g).map(a=>{let f=vy(a);return t[f]});return t[0]==="\u3042\u3044\u3053\u304F\u3057\u3093"?o.join("\u3000"):o.join(" ")}br.entropyToMnemonic=my;function dR(e,t,r){if(e=e||128,e%32!==0)throw new TypeError(W0);return t=t||uy.randomBytes,my(t(e/8),r)}br.generateMnemonic=dR;function hR(e,t){try{xy(e,t)}catch{return!1}return!0}br.validateMnemonic=hR;function lR(e){let t=nh.wordlists[e];if(t)qc=t;else throw new Error('Could not find wordlist for language "'+e+'"')}br.setDefaultWordlist=lR;function pR(){if(!qc)throw new Error("No Default Wordlist set");return Object.keys(nh.wordlists).filter(e=>e==="JA"||e==="EN"?!1:nh.wordlists[e].every((t,r)=>t===qc[r]))[0]}br.getDefaultWordlist=pR;var vR=ov();Object.defineProperty(br,"wordlists",{enumerable:!0,get:function(){return vR.wordlists}})});var Ey=U(un=>{"use strict";H();k();Object.defineProperty(un,"__esModule",{value:!0});un.unpadBuffer=un.stripZeros=un.setLengthRight=un.setLengthLeft=un.zeros=un.assertIsBuffer=void 0;var bR=function(e){if(!j.Buffer.isBuffer(e)){let t=`This method only supports Buffer but input was: ${e}`;throw new Error(t)}};un.assertIsBuffer=bR;var gR=function(e){return j.Buffer.allocUnsafe(e).fill(0)};un.zeros=gR;var Sy=function(e,t,r){let n=(0,un.zeros)(t);return r?e.length<t?(e.copy(n),n):e.slice(0,t):e.length<t?(e.copy(n,t-e.length),n):e.slice(-t)},yR=function(e,t){return j.Buffer.isBuffer(e)||(e=j.Buffer.from(e)),Sy(e,t,!1)};un.setLengthLeft=yR;var xR=function(e,t){return j.Buffer.isBuffer(e)||(e=j.Buffer.from(e)),Sy(e,t,!0)};un.setLengthRight=xR;var mR=function(e){let t=e[0];for(;e.length>0&&t.toString()==="0";)e=e.slice(1),t=e[0];return e};un.stripZeros=mR;var wR=function(e){return j.Buffer.isBuffer(e)||(e=j.Buffer.from(e)),(0,un.stripZeros)(e)};un.unpadBuffer=wR});var ih=U(fr=>{"use strict";H();k();Object.defineProperty(fr,"__esModule",{value:!0});fr.isHexString=fr.getKeys=fr.fromAscii=fr.fromUtf8=fr.toAscii=fr.arrayContainsArray=fr.getBinarySize=fr.padToEven=fr.stripHexPrefix=fr.isHexPrefixed=void 0;function _y(e){if(typeof e!="string")throw new Error(`[isHexPrefixed] input must be type 'string', received type ${typeof e}`);return e[0]==="0"&&e[1]==="x"}fr.isHexPrefixed=_y;var SR=e=>{if(typeof e!="string")throw new Error(`[stripHexPrefix] input must be type 'string', received ${typeof e}`);return _y(e)?e.slice(2):e};fr.stripHexPrefix=SR;function Ay(e){let t=e;if(typeof t!="string")throw new Error(`[padToEven] value must be type 'string', received ${typeof t}`);return t.length%2&&(t=`0${t}`),t}fr.padToEven=Ay;function ER(e){if(typeof e!="string")throw new Error(`[getBinarySize] method requires input type 'string', received ${typeof e}`);return j.Buffer.byteLength(e,"utf8")}fr.getBinarySize=ER;function _R(e,t,r){if(Array.isArray(e)!==!0)throw new Error(`[arrayContainsArray] method requires input 'superset' to be an array, got type '${typeof e}'`);if(Array.isArray(t)!==!0)throw new Error(`[arrayContainsArray] method requires input 'subset' to be an array, got type '${typeof t}'`);return t[r===!0?"some":"every"](n=>e.indexOf(n)>=0)}fr.arrayContainsArray=_R;function AR(e){let t="",r=0,n=e.length;for(e.substring(0,2)==="0x"&&(r=2);r<n;r+=2){let i=parseInt(e.substr(r,2),16);t+=String.fromCharCode(i)}return t}fr.toAscii=AR;function BR(e){let t=j.Buffer.from(e,"utf8");return`0x${Ay(t.toString("hex")).replace(/^0+|0+$/g,"")}`}fr.fromUtf8=BR;function PR(e){let t="";for(let r=0;r<e.length;r++){let i=e.charCodeAt(r).toString(16);t+=i.length<2?`0${i}`:i}return`0x${t}`}fr.fromAscii=PR;function IR(e,t,r){if(!Array.isArray(e))throw new Error(`[getKeys] method expects input 'params' to be an array, got ${typeof e}`);if(typeof t!="string")throw new Error(`[getKeys] method expects input 'key' to be type 'string', got ${typeof e}`);let n=[];for(let i=0;i<e.length;i++){let s=e[i][t];if(r===!0&&!s)s="";else if(typeof s!="string")throw new Error(`invalid abi - expected type 'string', received ${typeof s}`);n.push(s)}return n}fr.getKeys=IR;function MR(e,t){return!(typeof e!="string"||!e.match(/^0x[0-9A-Fa-f]*$/)||typeof t<"u"&&t>0&&e.length!==2+2*t)}fr.isHexString=MR});var By=U(cs=>{"use strict";H();k();Object.defineProperty(cs,"__esModule",{value:!0});cs.assertIsString=cs.assertIsArray=cs.assertIsBuffer=cs.assertIsHexString=void 0;var CR=ih(),FR=function(e){if(!(0,CR.isHexString)(e)){let t=`This method only supports 0x-prefixed hex strings but input was: ${e}`;throw new Error(t)}};cs.assertIsHexString=FR;var NR=function(e){if(!j.Buffer.isBuffer(e)){let t=`This method only supports Buffer but input was: ${e}`;throw new Error(t)}};cs.assertIsBuffer=NR;var RR=function(e){if(!Array.isArray(e)){let t=`This method only supports number arrays but input was: ${e}`;throw new Error(t)}};cs.assertIsArray=RR;var OR=function(e){if(typeof e!="string"){let t=`This method only supports strings but input was: ${e}`;throw new Error(t)}};cs.assertIsString=OR});var Cy=U(xe=>{"use strict";H();k();Object.defineProperty(xe,"__esModule",{value:!0});xe.intToUnpaddedBuffer=xe.bigIntToUnpaddedBuffer=xe.bigIntToHex=xe.bufArrToArr=xe.arrToBufArr=xe.validateNoLeadingZeroes=xe.baToJSON=xe.toUtf8=xe.short=xe.addHexPrefix=xe.toUnsigned=xe.fromSigned=xe.bufferToInt=xe.bigIntToBuffer=xe.bufferToBigInt=xe.bufferToHex=xe.toBuffer=xe.unpadHexString=xe.unpadArray=xe.unpadBuffer=xe.setLengthRight=xe.setLengthLeft=xe.zeros=xe.intToBuffer=xe.intToHex=void 0;var kc=By(),$0=ih(),DR=function(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Received an invalid integer type: ${e}`);return`0x${e.toString(16)}`};xe.intToHex=DR;var TR=function(e){let t=(0,xe.intToHex)(e);return j.Buffer.from((0,$0.padToEven)(t.slice(2)),"hex")};xe.intToBuffer=TR;var qR=function(e){return j.Buffer.allocUnsafe(e).fill(0)};xe.zeros=qR;var Py=function(e,t,r){let n=(0,xe.zeros)(t);return r?e.length<t?(e.copy(n),n):e.slice(0,t):e.length<t?(e.copy(n,t-e.length),n):e.slice(-t)},HR=function(e,t){return(0,kc.assertIsBuffer)(e),Py(e,t,!1)};xe.setLengthLeft=HR;var kR=function(e,t){return(0,kc.assertIsBuffer)(e),Py(e,t,!0)};xe.setLengthRight=kR;var fv=function(e){let t=e[0];for(;e.length>0&&t.toString()==="0";)e=e.slice(1),t=e[0];return e},jR=function(e){return(0,kc.assertIsBuffer)(e),fv(e)};xe.unpadBuffer=jR;var LR=function(e){return(0,kc.assertIsArray)(e),fv(e)};xe.unpadArray=LR;var KR=function(e){return(0,kc.assertIsHexString)(e),e=(0,$0.stripHexPrefix)(e),"0x"+fv(e)};xe.unpadHexString=KR;var UR=function(e){if(e==null)return j.Buffer.allocUnsafe(0);if(j.Buffer.isBuffer(e))return j.Buffer.from(e);if(Array.isArray(e)||e instanceof Uint8Array)return j.Buffer.from(e);if(typeof e=="string"){if(!(0,$0.isHexString)(e))throw new Error(`Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ${e}`);return j.Buffer.from((0,$0.padToEven)((0,$0.stripHexPrefix)(e)),"hex")}if(typeof e=="number")return(0,xe.intToBuffer)(e);if(typeof e=="bigint"){if(e<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${e}`);let t=e.toString(16);return t.length%2&&(t="0"+t),j.Buffer.from(t,"hex")}if(e.toArray)return j.Buffer.from(e.toArray());if(e.toBuffer)return j.Buffer.from(e.toBuffer());throw new Error("invalid type")};xe.toBuffer=UR;var VR=function(e){return e=(0,xe.toBuffer)(e),"0x"+e.toString("hex")};xe.bufferToHex=VR;function cv(e){let t=(0,xe.bufferToHex)(e);return BigInt(t==="0x"?0:t)}xe.bufferToBigInt=cv;function uv(e){return(0,xe.toBuffer)("0x"+e.toString(16))}xe.bigIntToBuffer=uv;var zR=function(e){let t=Number(cv(e));if(!Number.isSafeInteger(t))throw new Error("Number exceeds 53 bits");return t};xe.bufferToInt=zR;var WR=function(e){return BigInt.asIntN(256,cv(e))};xe.fromSigned=WR;var $R=function(e){return uv(BigInt.asUintN(256,e))};xe.toUnsigned=$R;var GR=function(e){return typeof e!="string"||(0,$0.isHexPrefixed)(e)?e:"0x"+e};xe.addHexPrefix=GR;function XR(e,t=50){let r=j.Buffer.isBuffer(e)?e.toString("hex"):e;return r.length<=t?r:r.slice(0,t)+"\u2026"}xe.short=XR;var ZR=function(e){let t=/^(00)+|(00)+$/g;if(e=(0,$0.stripHexPrefix)(e),e.length%2!==0)throw new Error("Invalid non-even hex string input for toUtf8() provided");return j.Buffer.from(e.replace(t,""),"hex").toString("utf8")};xe.toUtf8=ZR;var YR=function(e){if(j.Buffer.isBuffer(e))return`0x${e.toString("hex")}`;if(e instanceof Array){let t=[];for(let r=0;r<e.length;r++)t.push((0,xe.baToJSON)(e[r]));return t}};xe.baToJSON=YR;var JR=function(e){for(let[t,r]of Object.entries(e))if(r!==void 0&&r.length>0&&r[0]===0)throw new Error(`${t} cannot have leading zeroes, received: ${r.toString("hex")}`)};xe.validateNoLeadingZeroes=JR;function Iy(e){return Array.isArray(e)?e.map(t=>Iy(t)):j.Buffer.from(e)}xe.arrToBufArr=Iy;function My(e){return Array.isArray(e)?e.map(t=>My(t)):Uint8Array.from(e??[])}xe.bufArrToArr=My;var QR=e=>"0x"+e.toString(16);xe.bigIntToHex=QR;function eO(e){return(0,xe.unpadBuffer)(uv(e))}xe.bigIntToUnpaddedBuffer=eO;function tO(e){return(0,xe.unpadBuffer)((0,xe.intToBuffer)(e))}xe.intToUnpaddedBuffer=tO});var Oy=U((BZ,Ry)=>{"use strict";H();k();var sh=Ey(),gf=L0(),Fn=Ar(),{isHexString:rO,stripHexPrefix:nO,padToEven:iO}=ih(),{intToBuffer:sO,addHexPrefix:aO,bufferToHex:oO}=Cy(),Zt=function(){};function ah(e){return e.startsWith("int[")?"int256"+e.slice(3):e==="int"?"int256":e.startsWith("uint[")?"uint256"+e.slice(4):e==="uint"?"uint256":e.startsWith("fixed[")?"fixed128x128"+e.slice(5):e==="fixed"?"fixed128x128":e.startsWith("ufixed[")?"ufixed128x128"+e.slice(6):e==="ufixed"?"ufixed128x128":e}function dv(e){if(e==null)return j.Buffer.allocUnsafe(0);if(j.Buffer.isBuffer(e))return j.Buffer.from(e);if(Array.isArray(e)||e instanceof Uint8Array)return j.Buffer.from(e);if(typeof e=="string"){if(!rO(e))throw new Error(`Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ${e}`);return j.Buffer.from(iO(nO(e)),"hex")}if(typeof e=="number")return sO(e);if(typeof e=="bigint"){if(e<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${e}`);let t=e.toString(16);return t.length%2&&(t="0"+t),j.Buffer.from(t,"hex")}if(e.toArray)return j.Buffer.from(e.toArray());if(e.toBuffer)return j.Buffer.from(e.toBuffer());throw new Error("invalid type")}function fO(e){if(!!e){if(typeof e=="number"){if(e<0)return"0x";let t=dv(e);e=oO(t)}if(typeof e!="string"){let t="eth-sig-util.normalize() requires hex string or integer input.";throw t+=` received ${typeof e}: ${e}`,new Error(t)}return aO(e.toLowerCase())}}Zt.eventID=function(e,t){var r=e+"("+t.map(ah).join(",")+")";return gf.keccak256(j.Buffer.from(r))};Zt.methodID=function(e,t){return Zt.eventID(e,t).slice(0,4)};function Oa(e){return parseInt(/^\D+(\d+)$/.exec(e)[1],10)}function hv(e){var t=/^\D+(\d+)x(\d+)$/.exec(e);return[parseInt(t[1],10),parseInt(t[2],10)]}function Lc(e){var t=e.match(/(.*)\[(.*?)\]$/);return t?t[2]===""?"dynamic":parseInt(t[2],10):null}function G0(e){var t=typeof e;if(t==="string")return gf.isHexPrefixed(e)?new Fn(gf.stripHexPrefix(e),16):new Fn(e,10);if(t==="number")return new Fn(e);if(e.toArray)return e;throw new Error("Argument is not a number")}function Ny(e){var t=/^(\w+)\((.*)\)$/.exec(e);if(t.length!==3)throw new Error("Invalid method signature");var r=/^(.+)\):\((.+)$/.exec(t[2]);if(r!==null&&r.length===3)return{method:t[1],args:r[1].split(","),retargs:r[2].split(",")};var n=t[2].split(",");return n.length===1&&n[0]===""&&(n=[]),{method:t[1],args:n}}function us(e,t){var r,n,i,s;if(e==="address")return us("uint160",G0(t));if(e==="bool")return us("uint8",t?1:0);if(e==="string")return us("bytes",j.Buffer.from(t,"utf8"));if(jc(e)){if(typeof t.length>"u")throw new Error("Not an array?");if(r=Lc(e),r!=="dynamic"&&r!==0&&t.length>r)throw new Error("Elements exceed array size: "+r);i=[],e=e.slice(0,e.lastIndexOf("[")),typeof t=="string"&&(t=JSON.parse(t));for(s in t)i.push(us(e,t[s]));if(r==="dynamic"){var o=us("uint256",t.length);i.unshift(o)}return j.Buffer.concat(i)}else{if(e==="bytes")return t=j.Buffer.from(t),i=j.Buffer.concat([us("uint256",t.length),t]),t.length%32!==0&&(i=j.Buffer.concat([i,sh.zeros(32-t.length%32)])),i;if(e.startsWith("bytes")){if(r=Oa(e),r<1||r>32)throw new Error("Invalid bytes<N> width: "+r);return sh.setLengthRight(t,32)}else if(e.startsWith("uint")){if(r=Oa(e),r%8||r<8||r>256)throw new Error("Invalid uint<N> width: "+r);if(n=G0(t),n.bitLength()>r)throw new Error("Supplied uint exceeds width: "+r+" vs "+n.bitLength());if(n<0)throw new Error("Supplied uint is negative");return n.toArrayLike(j.Buffer,"be",32)}else if(e.startsWith("int")){if(r=Oa(e),r%8||r<8||r>256)throw new Error("Invalid int<N> width: "+r);if(n=G0(t),n.bitLength()>r)throw new Error("Supplied int exceeds width: "+r+" vs "+n.bitLength());return n.toTwos(256).toArrayLike(j.Buffer,"be",32)}else if(e.startsWith("ufixed")){if(r=hv(e),n=G0(t),n<0)throw new Error("Supplied ufixed is negative");return us("uint256",n.mul(new Fn(2).pow(new Fn(r[1]))))}else if(e.startsWith("fixed"))return r=hv(e),us("int256",G0(t).mul(new Fn(2).pow(new Fn(r[1]))))}throw new Error("Unsupported or invalid type: "+e)}function Ni(e,t,r){typeof e=="string"&&(e=lv(e));var n,i,s,o;if(e.name==="address")return Ni(e.rawType,t,r).toArrayLike(j.Buffer,"be",20).toString("hex");if(e.name==="bool")return Ni(e.rawType,t,r).toString()===new Fn(1).toString();if(e.name==="string"){var a=Ni(e.rawType,t,r);return j.Buffer.from(a,"utf8").toString()}else if(e.isArray){for(s=[],n=e.size,e.size==="dynamic"&&(r=Ni("uint256",t,r).toNumber(),n=Ni("uint256",t,r).toNumber(),r=r+32),o=0;o<n;o++){var f=Ni(e.subArray,t,r);s.push(f),r+=e.subArray.memoryUsage}return s}else{if(e.name==="bytes")return r=Ni("uint256",t,r).toNumber(),n=Ni("uint256",t,r).toNumber(),t.slice(r+32,r+32+n);if(e.name.startsWith("bytes"))return t.slice(r,r+e.size);if(e.name.startsWith("uint")){if(i=new Fn(t.slice(r,r+32),16,"be"),i.bitLength()>e.size)throw new Error("Decoded int exceeds width: "+e.size+" vs "+i.bitLength());return i}else if(e.name.startsWith("int")){if(i=new Fn(t.slice(r,r+32),16,"be").fromTwos(256),i.bitLength()>e.size)throw new Error("Decoded uint exceeds width: "+e.size+" vs "+i.bitLength());return i}else if(e.name.startsWith("ufixed")){if(n=new Fn(2).pow(new Fn(e.size[1])),i=Ni("uint256",t,r),!i.mod(n).isZero())throw new Error("Decimals not supported yet");return i.div(n)}else if(e.name.startsWith("fixed")){if(n=new Fn(2).pow(new Fn(e.size[1])),i=Ni("int256",t,r),!i.mod(n).isZero())throw new Error("Decimals not supported yet");return i.div(n)}}throw new Error("Unsupported or invalid type: "+e.name)}function lv(e){var t,r;if(jc(e)){t=Lc(e);var n=e.slice(0,e.lastIndexOf("["));return n=lv(n),r={isArray:!0,name:e,size:t,memoryUsage:t==="dynamic"?32:n.memoryUsage*t,subArray:n},r}else{var i;switch(e){case"address":i="uint160";break;case"bool":i="uint8";break;case"string":i="bytes";break}if(r={rawType:i,name:e,memoryUsage:32},e.startsWith("bytes")&&e!=="bytes"||e.startsWith("uint")||e.startsWith("int")?r.size=Oa(e):(e.startsWith("ufixed")||e.startsWith("fixed"))&&(r.size=hv(e)),e.startsWith("bytes")&&e!=="bytes"&&(r.size<1||r.size>32))throw new Error("Invalid bytes<N> width: "+r.size);if((e.startsWith("uint")||e.startsWith("int"))&&(r.size%8||r.size<8||r.size>256))throw new Error("Invalid int/uint<N> width: "+r.size);return r}}function cO(e){return e==="string"||e==="bytes"||Lc(e)==="dynamic"}function jc(e){return e.lastIndexOf("]")===e.length-1}Zt.rawEncode=function(e,t){var r=[],n=[],i=0;e.forEach(function(l){if(jc(l)){var v=Lc(l);v!=="dynamic"?i+=32*v:i+=32}else i+=32});for(var s=0;s<e.length;s++){var o=ah(e[s]),a=t[s],f=us(o,a);cO(o)?(r.push(us("uint256",i)),n.push(f),i+=f.length):r.push(f)}return j.Buffer.concat(r.concat(n))};Zt.rawDecode=function(e,t){var r=[];t=j.Buffer.from(t);for(var n=0,i=0;i<e.length;i++){var s=ah(e[i]),o=lv(s,t,n),a=Ni(o,t,n);n+=o.memoryUsage,r.push(a)}return r};Zt.simpleEncode=function(e){var t=Array.prototype.slice.call(arguments).slice(1),r=Ny(e);if(t.length!==r.args.length)throw new Error("Argument count mismatch");return j.Buffer.concat([Zt.methodID(r.method,r.args),Zt.rawEncode(r.args,t)])};Zt.simpleDecode=function(e,t){var r=Ny(e);if(!r.retargs)throw new Error("No return values in method");return Zt.rawDecode(r.retargs,t)};function Fy(e,t){return e.startsWith("address")||e.startsWith("bytes")?"0x"+t.toString("hex"):t.toString()}Zt.stringify=function(e,t){var r=[];for(var n in e){var i=e[n],s=t[n];/^[^\[]+\[.*\]$/.test(i)?s=s.map(function(o){return Fy(i,o)}).join(", "):s=Fy(i,s),r.push(s)}return r};Zt.solidityHexValue=function(e,t,r){var n,i;if(jc(e)){var s=e.replace(/\[.*?\]/,"");if(!jc(s)){var o=Lc(e);if(o!=="dynamic"&&o!==0&&t.length>o)throw new Error("Elements exceed array size: "+o)}var a=t.map(function(v){return Zt.solidityHexValue(s,v,256)});return j.Buffer.concat(a)}else{if(e==="bytes")return t;if(e==="string")return j.Buffer.from(t,"utf8");if(e==="bool"){r=r||8;var f=Array(r/4).join("0");return j.Buffer.from(t?f+"1":f+"0","hex")}else if(e==="address"){var l=20;return r&&(l=r/8),sh.setLengthLeft(dv(t),l)}else if(e.startsWith("bytes")){if(n=Oa(e),n<1||n>32)throw new Error("Invalid bytes<N> width: "+n);return typeof t=="number"&&(t=fO(t)),sh.setLengthRight(dv(t),n)}else if(e.startsWith("uint")){if(n=Oa(e),n%8||n<8||n>256)throw new Error("Invalid uint<N> width: "+n);if(i=G0(t),i.bitLength()>n)throw new Error("Supplied uint exceeds width: "+n+" vs "+i.bitLength());return r=r||n,i.toArrayLike(j.Buffer,"be",r/8)}else if(e.startsWith("int")){if(n=Oa(e),n%8||n<8||n>256)throw new Error("Invalid int<N> width: "+n);if(i=G0(t),i.bitLength()>n)throw new Error("Supplied int exceeds width: "+n+" vs "+i.bitLength());return r=r||n,i.toTwos(n).toArrayLike(j.Buffer,"be",r/8)}else throw new Error("Unsupported or invalid type: "+e)}};Zt.solidityPack=function(e,t){if(e.length!==t.length)throw new Error("Number of types are not matching the values");for(var r=[],n=0;n<e.length;n++){var i=ah(e[n]),s=t[n];r.push(Zt.solidityHexValue(i,s,null))}return j.Buffer.concat(r)};Zt.soliditySHA3=function(e,t){return gf.keccak256(Zt.solidityPack(e,t))};Zt.soliditySHA256=function(e,t){return gf.sha256(Zt.solidityPack(e,t))};Zt.solidityRIPEMD160=function(e,t){return gf.ripemd160(Zt.solidityPack(e,t),!0)};function uO(e){return e>="0"&&e<="9"}Zt.fromSerpent=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(n==="s")t.push("bytes");else if(n==="b"){for(var i="bytes",s=r+1;s<e.length&&uO(e[s]);)i+=e[s]-"0",s++;r=s-1,t.push(i)}else if(n==="i")t.push("int256");else if(n==="a")t.push("int256[]");else throw new Error("Unsupported or invalid type: "+n)}return t};Zt.toSerpent=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(n==="bytes")t.push("s");else if(n.startsWith("bytes"))t.push("b"+Oa(n));else if(n==="int256")t.push("i");else if(n==="int256[]")t.push("a");else throw new Error("Unsupported or invalid type: "+n)}return t.join("")};Ry.exports=Zt});var Dy=U(Da=>{"use strict";H();k();Object.defineProperty(Da,"__esModule",{value:!0});Da.SoliditySHA3=Da.RawEncode=Da.ABI=void 0;var pv=Oy();Da.ABI=pv;function dO(e,t){return pv.rawEncode(e,t)}Da.RawEncode=dO;function hO(e,t){return pv.soliditySHA3(e,t)}Da.SoliditySHA3=hO});var Ly=U(gt=>{"use strict";H();k();var lO=gt&&gt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),pO=gt&&gt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),vO=gt&&gt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&lO(t,e,r);return pO(t,e),t},bO=gt&&gt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gt,"__esModule",{value:!0});gt.loadUncompressedPublicKey=gt.loadCompressedPublicKey=gt.publicKeyConvert=gt.publicKeyCreate=gt.publicKeyVerify=gt.privateKeyVerify=gt.loadPublicKey=gt.recover=gt.verifyWithNoRecovery=gt.verify=gt.getV=gt.sign=void 0;var gO=vO(bf()),Br=new gO.ec("secp256k1"),Ty=L0(),yf=bO(Ar());function yO(e,t,r=!0){let n=Br.sign(Array.from(e),j.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}gt.sign=yO;function xO(e,t,r,n,i=!0){let s=Kc(n);if(s==null)throw new Error("pubkey error");let o=Br.keyPair({pub:{x:s.x,y:s.y}}).getPublic();return Br.getKeyRecoveryParam(e,{r:t,s:r},o,i)}gt.getV=xO;function mO(e,t,r,n){let i=qy(t,r,e,!0);if(i==null)return!1;let s=Hy(n,!0);return s==null?!1:i.equals(s)}gt.verify=mO;function wO(e,t,r){let n=Kc(r);if(n==null)throw new Error("pubkey error");let i=Br.keyPair({pub:{x:n.x,y:n.y}}),s={r:(0,Ty.toHex)(t.slice(0,32)),s:(0,Ty.toHex)(t.slice(32,64))};return i.verify(e,s)}gt.verifyWithNoRecovery=wO;function qy(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new yf.default(i.r),o=new yf.default(i.s);if(s.cmp(Br.curve.n)>=0||o.cmp(Br.curve.n)>=0||s.isZero()||o.isZero())return null;let a;try{a=Br.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return j.Buffer.from(a.encode(null,n))}gt.recover=qy;function Kc(e){let t=j.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:ky(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:jy(r,t.subarray(1,33),t.subarray(33,65));default:return null}}gt.loadPublicKey=Kc;function SO(e){let t=new yf.default(Array.from(e));return t.cmp(Br.curve.n)<0&&!t.isZero()}gt.privateKeyVerify=SO;function EO(e){return Kc(e)!==null}gt.publicKeyVerify=EO;function _O(e,t){let r=Br.keyFromPrivate(Array.from(e),"bytes").getPublic();return j.Buffer.from(r.encode(null,t))}gt.publicKeyCreate=_O;function Hy(e,t){let r=Kc(e);if(r==null)return null;let n=Br.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return j.Buffer.from(n.encode(null,t))}gt.publicKeyConvert=Hy;function ky(e,t){let r=new yf.default(Array.from(t));if(r.cmp(Br.curve.p)>=0)return null;let n=r.toRed(Br.curve.red),i=n.redSqr().redIMul(n).redIAdd(Br.curve.b).redSqrt();e===3!==i.isOdd()&&(i=i.redNeg());let s=n.redSqr().redIMul(n);return i.redSqr().redISub(s.redIAdd(Br.curve.b)).isZero()?{x:n,y:i}:null}gt.loadCompressedPublicKey=ky;function jy(e,t,r){let n=new yf.default(Array.from(t)),i=new yf.default(Array.from(r));if(n.cmp(Br.curve.p)>=0||i.cmp(Br.curve.p)>=0)return null;let s=n.toRed(Br.curve.red),o=i.toRed(Br.curve.red);if((e===6||e===7)&&o.isOdd()!==(e===7))return null;let a=s.redSqr().redIMul(s);return o.redSqr().redISub(a.redIAdd(Br.curve.b)).isZero()?{x:s,y:o}:null}gt.loadUncompressedPublicKey=jy});var Vy=U(jt=>{"use strict";H();k();var AO=jt&&jt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),BO=jt&&jt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),PO=jt&&jt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&AO(t,e,r);return BO(t,e),t},IO=jt&&jt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jt,"__esModule",{value:!0});jt.fromSecret=jt.fromSeed=jt.privateKeyVerify=jt.publicKeyVerify=jt.publicKeyCreate=jt.verify=jt.sign=jt.ed25519MulBase=void 0;var Ky=PO(bf()),MO=L0(),CO=IO(Ar()),Rs=new Ky.eddsa("ed25519"),Uy=Rs.curve;function FO(e){let t=Rs.curve.g;return Rs.encodePoint(t.mul(Ky.utils.intFromLE(e)))}jt.ed25519MulBase=FO;function NO(e,t){let r=t;r.length==64&&(r=r.slice(0,32));let i=Rs.keyFromSecret(Array.from(r)).sign(Array.from(e)).toBytes();return Uint8Array.from(i)}jt.sign=NO;function RO(e,t,r){return Rs.keyFromPublic(Array.from(r)).verify(Array.from(e),Array.from(t))}jt.verify=RO;function OO(e){let t=e;t.length==64&&(t=t.slice(0,32));let r=Rs.keyFromSecret(Array.from(t));return Uint8Array.from(r.getPublic())}jt.publicKeyCreate=OO;function DO(e){let t=Rs.decodePoint(Array.from(e));return Uy.validate(t)}jt.publicKeyVerify=DO;function TO(e){let t=new CO.default(Array.from(e));return t.cmp(Uy.n)<0&&!t.isZero()}jt.privateKeyVerify=TO;function qO(e){let t=Rs.keyFromSecret(Array.from(e)),r=Uint8Array.from(t.getPublic());return{publicKey:r,secretKey:(0,MO.concatBytes)(e,r)}}jt.fromSeed=qO;function HO(e){let t=e.slice(0,32),r=Rs.keyFromSecret(Array.from(t));return{publicKey:Uint8Array.from(r.getPublic()),secretKey:Uint8Array.from(t)}}jt.fromSecret=HO});var Gy=U(Ft=>{"use strict";H();k();var kO=Ft&&Ft.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),jO=Ft&&Ft.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),LO=Ft&&Ft.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&kO(t,e,r);return jO(t,e),t},KO=Ft&&Ft.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ft,"__esModule",{value:!0});Ft.loadUncompressedPublicKey=Ft.loadCompressedPublicKey=Ft.publicKeyConvert=Ft.publicKeyCreate=Ft.publicKeyVerify=Ft.privateKeyVerify=Ft.loadPublicKey=Ft.recover=Ft.verify=Ft.sign=void 0;var UO=LO(bf()),_n=new UO.ec("p256"),xf=KO(Ar());function VO(e,t,r=!0){let n=_n.sign(Array.from(e),j.Buffer.from(t),{canonical:r});return{signature:n.toBytes(),recovery:n.recoveryParam}}Ft.sign=VO;function zO(e,t,r,n){let i=zy(t,r,e,!1);return i==null?!1:i.equals(n)}Ft.verify=zO;function zy(e,t,r,n){let i={r:Array.from(e.slice(0,32)),s:Array.from(e.slice(32,64))},s=new xf.default(i.r),o=new xf.default(i.s);if(s.cmp(_n.curve.n)>=0||o.cmp(_n.curve.n)>=0||s.isZero()||o.isZero())return null;let a;try{a=_n.recoverPubKey(Array.from(r),i,t,null)}catch{return null}return j.Buffer.from(a.encode(null,n))}Ft.recover=zy;function vv(e){let t=j.Buffer.from(e),r=t[0];switch(r){case 2:case 3:return t.length!==33?null:Wy(r,t.subarray(1,33));case 4:case 6:case 7:return t.length!==65?null:$y(r,t.subarray(1,33),t.subarray(33,65));default:return null}}Ft.loadPublicKey=vv;function WO(e){let t=new xf.default(Array.from(e));return t.cmp(_n.curve.n)<0&&!t.isZero()}Ft.privateKeyVerify=WO;function $O(e){return vv(e)!==null}Ft.publicKeyVerify=$O;function GO(e,t){let r=_n.keyFromPrivate(Array.from(e),"bytes").getPublic();return j.Buffer.from(r.encode(null,t))}Ft.publicKeyCreate=GO;function XO(e,t){let r=vv(e);if(r==null)return null;let n=_n.keyPair({pub:{x:r.x,y:r.y}}).getPublic();return j.Buffer.from(n.encode(null,t))}Ft.publicKeyConvert=XO;function Wy(e,t){let r=new xf.default(Array.from(t));if(r.cmp(_n.curve.p)>=0)return null;let n=r.toRed(_n.curve.red),i=n.redSqr().redIMul(n).redIAdd(_n.curve.b).redSqrt();return e===3!==i.isOdd()&&(i=i.redNeg()),{x:n,y:i}}Ft.loadCompressedPublicKey=Wy;function $y(e,t,r){let n=new xf.default(Array.from(t)),i=new xf.default(Array.from(r));if(n.cmp(_n.curve.p)>=0||i.cmp(_n.curve.p)>=0)return null;let s=n.toRed(_n.curve.red),o=i.toRed(_n.curve.red);if((e===6||e===7)&&o.isOdd()!==(e===7))return null;let a=s.redSqr().redIMul(s);return o.redSqr().redISub(a.redIAdd(_n.curve.b)).isZero()?{x:s,y:o}:null}Ft.loadUncompressedPublicKey=$y});var Os=U(st=>{"use strict";H();k();Object.defineProperty(st,"__esModule",{value:!0});st.validateObject=st.createHmacDrbg=st.bitMask=st.bitSet=st.bitGet=st.bitLen=st.utf8ToBytes=st.equalBytes=st.concatBytes=st.ensureBytes=st.numberToVarBytesBE=st.numberToBytesLE=st.numberToBytesBE=st.bytesToNumberLE=st.bytesToNumberBE=st.hexToBytes=st.hexToNumber=st.numberToHexUnpadded=st.bytesToHex=void 0;var Zy=BigInt(0),oh=BigInt(1),ZO=BigInt(2),fh=e=>e instanceof Uint8Array,YO=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function gv(e){if(!fh(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=YO[e[r]];return t}st.bytesToHex=gv;function Yy(e){let t=e.toString(16);return t.length&1?`0${t}`:t}st.numberToHexUnpadded=Yy;function yv(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}st.hexToNumber=yv;function ch(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(e.length%2)throw new Error("hex string is invalid: unpadded "+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("invalid byte sequence");t[r]=s}return t}st.hexToBytes=ch;function JO(e){return yv(gv(e))}st.bytesToNumberBE=JO;function QO(e){if(!fh(e))throw new Error("Uint8Array expected");return yv(gv(Uint8Array.from(e).reverse()))}st.bytesToNumberLE=QO;var eD=(e,t)=>ch(e.toString(16).padStart(t*2,"0"));st.numberToBytesBE=eD;var tD=(e,t)=>(0,st.numberToBytesBE)(e,t).reverse();st.numberToBytesLE=tD;var rD=e=>ch(Yy(e));st.numberToVarBytesBE=rD;function nD(e,t,r){let n;if(typeof t=="string")try{n=ch(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(fh(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${e} expected ${r} bytes, got ${i}`);return n}st.ensureBytes=nD;function Jy(...e){let t=new Uint8Array(e.reduce((n,i)=>n+i.length,0)),r=0;return e.forEach(n=>{if(!fh(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}st.concatBytes=Jy;function iD(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}st.equalBytes=iD;function sD(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}st.utf8ToBytes=sD;function aD(e){let t;for(t=0;e>Zy;e>>=oh,t+=1);return t}st.bitLen=aD;var oD=(e,t)=>e>>BigInt(t)&oh;st.bitGet=oD;var fD=(e,t,r)=>e|(r?oh:Zy)<<BigInt(t);st.bitSet=fD;var cD=e=>(ZO<<BigInt(e-1))-oh;st.bitMask=cD;var bv=e=>new Uint8Array(e),Xy=e=>Uint8Array.from(e);function uD(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=bv(e),i=bv(e),s=0,o=()=>{n.fill(1),i.fill(0),s=0},a=(...p)=>r(i,n,...p),f=(p=bv())=>{i=a(Xy([0]),p),n=a(),p.length!==0&&(i=a(Xy([1]),p),n=a())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let p=0,u=[];for(;p<t;){n=a();let h=n.slice();u.push(h),p+=n.length}return Jy(...u)};return(p,u)=>{o(),f(p);let h;for(;!(h=u(l()));)f();return o(),h}}st.createHmacDrbg=uD;var dD={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function hD(e,t,r={}){let n=(i,s,o)=>{let a=dD[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);let f=e[i];if(!(o&&f===void 0)&&!a(f,e))throw new Error(`Invalid param ${String(i)}=${f} (${typeof f}), expected ${s}`)};for(let[i,s]of Object.entries(t))n(i,s,!1);for(let[i,s]of Object.entries(r))n(i,s,!0);return e}st.validateObject=hD});var X0=U(dt=>{"use strict";H();k();Object.defineProperty(dt,"__esModule",{value:!0});dt.hashToPrivateScalar=dt.FpSqrtEven=dt.FpSqrtOdd=dt.Field=dt.nLength=dt.FpIsSquare=dt.FpDiv=dt.FpInvertBatch=dt.FpPow=dt.validateField=dt.isNegativeLE=dt.FpSqrt=dt.tonelliShanks=dt.invert=dt.pow2=dt.pow=dt.mod=void 0;var Ds=Os(),Pr=BigInt(0),Vt=BigInt(1),Ta=BigInt(2),lD=BigInt(3),xv=BigInt(4),Qy=BigInt(5),ex=BigInt(8),pD=BigInt(9),vD=BigInt(16);function ri(e,t){let r=e%t;return r>=Pr?r:t+r}dt.mod=ri;function tx(e,t,r){if(r<=Pr||t<Pr)throw new Error("Expected power/modulo > 0");if(r===Vt)return Pr;let n=Vt;for(;t>Pr;)t&Vt&&(n=n*e%r),e=e*e%r,t>>=Vt;return n}dt.pow=tx;function bD(e,t,r){let n=e;for(;t-- >Pr;)n*=n,n%=r;return n}dt.pow2=bD;function uh(e,t){if(e===Pr||t<=Pr)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=ri(e,t),n=t,i=Pr,s=Vt,o=Vt,a=Pr;for(;r!==Pr;){let l=n/r,v=n%r,p=i-o*l,u=s-a*l;n=r,r=v,i=o,s=a,o=p,a=u}if(n!==Vt)throw new Error("invert: does not exist");return ri(i,t)}dt.invert=uh;function rx(e){let t=(e-Vt)/Ta,r,n,i;for(r=e-Vt,n=0;r%Ta===Pr;r/=Ta,n++);for(i=Ta;i<e&&tx(i,t,e)!==e-Vt;i++);if(n===1){let o=(e+Vt)/xv;return function(f,l){let v=f.pow(l,o);if(!f.eql(f.sqr(v),l))throw new Error("Cannot find square root");return v}}let s=(r+Vt)/Ta;return function(a,f){if(a.pow(f,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=n,v=a.pow(a.mul(a.ONE,i),r),p=a.pow(f,s),u=a.pow(f,r);for(;!a.eql(u,a.ONE);){if(a.eql(u,a.ZERO))return a.ZERO;let h=1;for(let d=a.sqr(u);h<l&&!a.eql(d,a.ONE);h++)d=a.sqr(d);let b=a.pow(v,Vt<<BigInt(l-h-1));v=a.sqr(b),p=a.mul(p,b),u=a.mul(u,v),l=h}return p}}dt.tonelliShanks=rx;function nx(e){if(e%xv===lD){let t=(e+Vt)/xv;return function(n,i){let s=n.pow(i,t);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(e%ex===Qy){let t=(e-Qy)/ex;return function(n,i){let s=n.mul(i,Ta),o=n.pow(s,t),a=n.mul(i,o),f=n.mul(n.mul(a,Ta),o),l=n.mul(a,n.sub(f,n.ONE));if(!n.eql(n.sqr(l),i))throw new Error("Cannot find square root");return l}}return e%vD,rx(e)}dt.FpSqrt=nx;var gD=(e,t)=>(ri(e,t)&Vt)===Vt;dt.isNegativeLE=gD;var yD=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function xD(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=yD.reduce((n,i)=>(n[i]="function",n),t);return(0,Ds.validateObject)(e,r)}dt.validateField=xD;function ix(e,t,r){if(r<Pr)throw new Error("Expected power > 0");if(r===Pr)return e.ONE;if(r===Vt)return t;let n=e.ONE,i=t;for(;r>Pr;)r&Vt&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Vt;return n}dt.FpPow=ix;function sx(e,t){let r=new Array(t.length),n=t.reduce((s,o,a)=>e.is0(o)?s:(r[a]=s,e.mul(s,o)),e.ONE),i=e.inv(n);return t.reduceRight((s,o,a)=>e.is0(o)?s:(r[a]=e.mul(s,r[a]),e.mul(s,o)),i),r}dt.FpInvertBatch=sx;function mD(e,t,r){return e.mul(t,typeof r=="bigint"?uh(r,e.ORDER):e.inv(r))}dt.FpDiv=mD;function wD(e){let t=(e.ORDER-Vt)/Ta;return r=>{let n=e.pow(r,t);return e.eql(n,e.ZERO)||e.eql(n,e.ONE)}}dt.FpIsSquare=wD;function mv(e,t){let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}dt.nLength=mv;function SD(e,t,r=!1,n={}){if(e<=Pr)throw new Error(`Expected Fp ORDER > 0, got ${e}`);let{nBitLength:i,nByteLength:s}=mv(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let o=nx(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:s,MASK:(0,Ds.bitMask)(i),ZERO:Pr,ONE:Vt,create:f=>ri(f,e),isValid:f=>{if(typeof f!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof f}`);return Pr<=f&&f<e},is0:f=>f===Pr,isOdd:f=>(f&Vt)===Vt,neg:f=>ri(-f,e),eql:(f,l)=>f===l,sqr:f=>ri(f*f,e),add:(f,l)=>ri(f+l,e),sub:(f,l)=>ri(f-l,e),mul:(f,l)=>ri(f*l,e),pow:(f,l)=>ix(a,f,l),div:(f,l)=>ri(f*uh(l,e),e),sqrN:f=>f*f,addN:(f,l)=>f+l,subN:(f,l)=>f-l,mulN:(f,l)=>f*l,inv:f=>uh(f,e),sqrt:n.sqrt||(f=>o(a,f)),invertBatch:f=>sx(a,f),cmov:(f,l,v)=>v?l:f,toBytes:f=>r?(0,Ds.numberToBytesLE)(f,s):(0,Ds.numberToBytesBE)(f,s),fromBytes:f=>{if(f.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${f.length}`);return r?(0,Ds.bytesToNumberLE)(f):(0,Ds.bytesToNumberBE)(f)}});return Object.freeze(a)}dt.Field=SD;function ED(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)}dt.FpSqrtOdd=ED;function _D(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}dt.FpSqrtEven=_D;function AD(e,t,r=!1){e=(0,Ds.ensureBytes)("privateHash",e);let n=e.length,i=mv(t).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let s=r?(0,Ds.bytesToNumberLE)(e):(0,Ds.bytesToNumberBE)(e);return ri(s,t-Vt)+Vt}dt.hashToPrivateScalar=AD});var ox=U(mf=>{"use strict";H();k();Object.defineProperty(mf,"__esModule",{value:!0});mf.validateBasic=mf.wNAF=void 0;var ax=X0(),BD=Os(),PD=BigInt(0),wv=BigInt(1);function ID(e,t){let r=(i,s)=>{let o=s.negate();return i?o:s},n=i=>{let s=Math.ceil(t/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:r,unsafeLadder(i,s){let o=e.ZERO,a=i;for(;s>PD;)s&wv&&(o=o.add(a)),a=a.double(),s>>=wv;return o},precomputeWindow(i,s){let{windows:o,windowSize:a}=n(s),f=[],l=i,v=l;for(let p=0;p<o;p++){v=l,f.push(v);for(let u=1;u<a;u++)v=v.add(l),f.push(v);l=v.double()}return f},wNAF(i,s,o){let{windows:a,windowSize:f}=n(i),l=e.ZERO,v=e.BASE,p=BigInt(2**i-1),u=2**i,h=BigInt(i);for(let b=0;b<a;b++){let d=b*f,y=Number(o&p);o>>=h,y>f&&(y-=u,o+=wv);let w=d,_=d+Math.abs(y)-1,I=b%2!==0,N=y<0;y===0?v=v.add(r(I,s[w])):l=l.add(r(N,s[_]))}return{p:l,f:v}},wNAFCached(i,s,o,a){let f=i._WINDOW_SIZE||1,l=s.get(i);return l||(l=this.precomputeWindow(i,f),f!==1&&s.set(i,a(l))),this.wNAF(f,l,o)}}}mf.wNAF=ID;function MD(e){return(0,ax.validateField)(e.Fp),(0,BD.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,ax.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}mf.validateBasic=MD});var hh=U(zt=>{"use strict";H();k();var CD=zt&&zt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),FD=zt&&zt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),cx=zt&&zt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&CD(t,e,r);return FD(t,e),t};Object.defineProperty(zt,"__esModule",{value:!0});zt.mapToCurveSimpleSWU=zt.SWUFpSqrtRatio=zt.weierstrass=zt.weierstrassPoints=zt.DER=void 0;var Uc=cx(X0()),gr=cx(Os()),ds=Os(),Sv=ox();function ND(e){let t=(0,Sv.validateBasic)(e);gr.validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=t;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:RD,hexToBytes:OD}=gr;zt.DER={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){let{Err:t}=zt.DER;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");let r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:RD(n),l:e.subarray(r+2)}},toSig(e){let{Err:t}=zt.DER,r=typeof e=="string"?OD(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");let{d:i,l:s}=zt.DER._parseInt(r.subarray(2)),{d:o,l:a}=zt.DER._parseInt(s);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(e){let t=l=>Number.parseInt(l[0],16)&8?"00"+l:l,r=l=>{let v=l.toString(16);return v.length&1?`0${v}`:v},n=t(r(e.s)),i=t(r(e.r)),s=n.length/2,o=i.length/2,a=r(s),f=r(o);return`30${r(o+s+4)}02${f}${i}02${a}${n}`}};var Ri=BigInt(0),cr=BigInt(1),qa=BigInt(2),dh=BigInt(3),fx=BigInt(4);function ux(e){let t=ND(e),{Fp:r}=t,n=t.toBytes||((b,d,y)=>{let w=d.toAffine();return gr.concatBytes(Uint8Array.from([4]),r.toBytes(w.x),r.toBytes(w.y))}),i=t.fromBytes||(b=>{let d=b.subarray(1),y=r.fromBytes(d.subarray(0,r.BYTES)),w=r.fromBytes(d.subarray(r.BYTES,2*r.BYTES));return{x:y,y:w}});function s(b){let{a:d,b:y}=t,w=r.sqr(b),_=r.mul(w,b);return r.add(r.add(_,r.mul(b,d)),y)}if(!r.eql(r.sqr(t.Gy),s(t.Gx)))throw new Error("bad generator point: equation left != right");function o(b){return typeof b=="bigint"&&Ri<b&&b<t.n}function a(b){if(!o(b))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function f(b){let{allowedPrivateKeyLengths:d,nByteLength:y,wrapPrivateKey:w,n:_}=t;if(d&&typeof b!="bigint"){if(b instanceof Uint8Array&&(b=gr.bytesToHex(b)),typeof b!="string"||!d.includes(b.length))throw new Error("Invalid key");b=b.padStart(y*2,"0")}let I;try{I=typeof b=="bigint"?b:gr.bytesToNumberBE((0,ds.ensureBytes)("private key",b,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof b}`)}return w&&(I=Uc.mod(I,_)),a(I),I}let l=new Map;function v(b){if(!(b instanceof p))throw new Error("ProjectivePoint expected")}class p{constructor(d,y,w){if(this.px=d,this.py=y,this.pz=w,d==null||!r.isValid(d))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(w==null||!r.isValid(w))throw new Error("z required")}static fromAffine(d){let{x:y,y:w}=d||{};if(!d||!r.isValid(y)||!r.isValid(w))throw new Error("invalid affine point");if(d instanceof p)throw new Error("projective point not allowed");let _=I=>r.eql(I,r.ZERO);return _(y)&&_(w)?p.ZERO:new p(y,w,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){let y=r.invertBatch(d.map(w=>w.pz));return d.map((w,_)=>w.toAffine(y[_])).map(p.fromAffine)}static fromHex(d){let y=p.fromAffine(i((0,ds.ensureBytes)("pointHex",d)));return y.assertValidity(),y}static fromPrivateKey(d){return p.BASE.multiply(f(d))}_setWindowSize(d){this._WINDOW_SIZE=d,l.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}let{x:d,y}=this.toAffine();if(!r.isValid(d)||!r.isValid(y))throw new Error("bad point: x or y not FE");let w=r.sqr(y),_=s(d);if(!r.eql(w,_))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:d}=this.toAffine();if(r.isOdd)return!r.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){v(d);let{px:y,py:w,pz:_}=this,{px:I,py:N,pz:F}=d,O=r.eql(r.mul(y,F),r.mul(I,_)),q=r.eql(r.mul(w,F),r.mul(N,_));return O&&q}negate(){return new p(this.px,r.neg(this.py),this.pz)}double(){let{a:d,b:y}=t,w=r.mul(y,dh),{px:_,py:I,pz:N}=this,F=r.ZERO,O=r.ZERO,q=r.ZERO,P=r.mul(_,_),D=r.mul(I,I),A=r.mul(N,N),c=r.mul(_,I);return c=r.add(c,c),q=r.mul(_,N),q=r.add(q,q),F=r.mul(d,q),O=r.mul(w,A),O=r.add(F,O),F=r.sub(D,O),O=r.add(D,O),O=r.mul(F,O),F=r.mul(c,F),q=r.mul(w,q),A=r.mul(d,A),c=r.sub(P,A),c=r.mul(d,c),c=r.add(c,q),q=r.add(P,P),P=r.add(q,P),P=r.add(P,A),P=r.mul(P,c),O=r.add(O,P),A=r.mul(I,N),A=r.add(A,A),P=r.mul(A,c),F=r.sub(F,P),q=r.mul(A,D),q=r.add(q,q),q=r.add(q,q),new p(F,O,q)}add(d){v(d);let{px:y,py:w,pz:_}=this,{px:I,py:N,pz:F}=d,O=r.ZERO,q=r.ZERO,P=r.ZERO,D=t.a,A=r.mul(t.b,dh),c=r.mul(y,I),m=r.mul(w,N),S=r.mul(_,F),g=r.add(y,w),E=r.add(I,N);g=r.mul(g,E),E=r.add(c,m),g=r.sub(g,E),E=r.add(y,_);let M=r.add(I,F);return E=r.mul(E,M),M=r.add(c,S),E=r.sub(E,M),M=r.add(w,_),O=r.add(N,F),M=r.mul(M,O),O=r.add(m,S),M=r.sub(M,O),P=r.mul(D,E),O=r.mul(A,S),P=r.add(O,P),O=r.sub(m,P),P=r.add(m,P),q=r.mul(O,P),m=r.add(c,c),m=r.add(m,c),S=r.mul(D,S),E=r.mul(A,E),m=r.add(m,S),S=r.sub(c,S),S=r.mul(D,S),E=r.add(E,S),c=r.mul(m,E),q=r.add(q,c),c=r.mul(M,E),O=r.mul(g,O),O=r.sub(O,c),c=r.mul(g,m),P=r.mul(M,P),P=r.add(P,c),new p(O,q,P)}subtract(d){return this.add(d.negate())}is0(){return this.equals(p.ZERO)}wNAF(d){return h.wNAFCached(this,l,d,y=>{let w=r.invertBatch(y.map(_=>_.pz));return y.map((_,I)=>_.toAffine(w[I])).map(p.fromAffine)})}multiplyUnsafe(d){let y=p.ZERO;if(d===Ri)return y;if(a(d),d===cr)return this;let{endo:w}=t;if(!w)return h.unsafeLadder(this,d);let{k1neg:_,k1:I,k2neg:N,k2:F}=w.splitScalar(d),O=y,q=y,P=this;for(;I>Ri||F>Ri;)I&cr&&(O=O.add(P)),F&cr&&(q=q.add(P)),P=P.double(),I>>=cr,F>>=cr;return _&&(O=O.negate()),N&&(q=q.negate()),q=new p(r.mul(q.px,w.beta),q.py,q.pz),O.add(q)}multiply(d){a(d);let y=d,w,_,{endo:I}=t;if(I){let{k1neg:N,k1:F,k2neg:O,k2:q}=I.splitScalar(y),{p:P,f:D}=this.wNAF(F),{p:A,f:c}=this.wNAF(q);P=h.constTimeNegate(N,P),A=h.constTimeNegate(O,A),A=new p(r.mul(A.px,I.beta),A.py,A.pz),w=P.add(A),_=D.add(c)}else{let{p:N,f:F}=this.wNAF(y);w=N,_=F}return p.normalizeZ([w,_])[0]}multiplyAndAddUnsafe(d,y,w){let _=p.BASE,I=(F,O)=>O===Ri||O===cr||!F.equals(_)?F.multiplyUnsafe(O):F.multiply(O),N=I(this,y).add(I(d,w));return N.is0()?void 0:N}toAffine(d){let{px:y,py:w,pz:_}=this,I=this.is0();d==null&&(d=I?r.ONE:r.inv(_));let N=r.mul(y,d),F=r.mul(w,d),O=r.mul(_,d);if(I)return{x:r.ZERO,y:r.ZERO};if(!r.eql(O,r.ONE))throw new Error("invZ was invalid");return{x:N,y:F}}isTorsionFree(){let{h:d,isTorsionFree:y}=t;if(d===cr)return!0;if(y)return y(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:d,clearCofactor:y}=t;return d===cr?this:y?y(p,this):this.multiplyUnsafe(t.h)}toRawBytes(d=!0){return this.assertValidity(),n(p,this,d)}toHex(d=!0){return gr.bytesToHex(this.toRawBytes(d))}}p.BASE=new p(t.Gx,t.Gy,r.ONE),p.ZERO=new p(r.ZERO,r.ONE,r.ZERO);let u=t.nBitLength,h=(0,Sv.wNAF)(p,t.endo?Math.ceil(u/2):u);return{CURVE:t,ProjectivePoint:p,normPrivateKeyToScalar:f,weierstrassEquation:s,isWithinCurveOrder:o}}zt.weierstrassPoints=ux;function DD(e){let t=(0,Sv.validateBasic)(e);return gr.validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function TD(e){let t=DD(e),{Fp:r,n}=t,i=r.BYTES+1,s=2*r.BYTES+1;function o(E){return Ri<E&&E<r.ORDER}function a(E){return Uc.mod(E,n)}function f(E){return Uc.invert(E,n)}let{ProjectivePoint:l,normPrivateKeyToScalar:v,weierstrassEquation:p,isWithinCurveOrder:u}=ux({...t,toBytes(E,M,T){let R=M.toAffine(),x=r.toBytes(R.x),C=gr.concatBytes;return T?C(Uint8Array.from([M.hasEvenY()?2:3]),x):C(Uint8Array.from([4]),x,r.toBytes(R.y))},fromBytes(E){let M=E.length,T=E[0],R=E.subarray(1);if(M===i&&(T===2||T===3)){let x=gr.bytesToNumberBE(R);if(!o(x))throw new Error("Point is not on curve");let C=p(x),K=r.sqrt(C),L=(K&cr)===cr;return(T&1)===1!==L&&(K=r.neg(K)),{x,y:K}}else if(M===s&&T===4){let x=r.fromBytes(R.subarray(0,r.BYTES)),C=r.fromBytes(R.subarray(r.BYTES,2*r.BYTES));return{x,y:C}}else throw new Error(`Point of length ${M} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),h=E=>gr.bytesToHex(gr.numberToBytesBE(E,t.nByteLength));function b(E){let M=n>>cr;return E>M}function d(E){return b(E)?a(-E):E}let y=(E,M,T)=>gr.bytesToNumberBE(E.slice(M,T));class w{constructor(M,T,R){this.r=M,this.s=T,this.recovery=R,this.assertValidity()}static fromCompact(M){let T=t.nByteLength;return M=(0,ds.ensureBytes)("compactSignature",M,T*2),new w(y(M,0,T),y(M,T,2*T))}static fromDER(M){let{r:T,s:R}=zt.DER.toSig((0,ds.ensureBytes)("DER",M));return new w(T,R)}assertValidity(){if(!u(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!u(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(M){return new w(this.r,this.s,M)}recoverPublicKey(M){let{r:T,s:R,recovery:x}=this,C=q((0,ds.ensureBytes)("msgHash",M));if(x==null||![0,1,2,3].includes(x))throw new Error("recovery id invalid");let K=x===2||x===3?T+t.n:T;if(K>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let L=(x&1)===0?"02":"03",V=l.fromHex(L+h(K)),z=f(K),G=a(-C*z),$=a(R*z),oe=l.BASE.multiplyAndAddUnsafe(V,G,$);if(!oe)throw new Error("point at infinify");return oe.assertValidity(),oe}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return gr.hexToBytes(this.toDERHex())}toDERHex(){return zt.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return gr.hexToBytes(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}let _={isValidPrivateKey(E){try{return v(E),!0}catch{return!1}},normPrivateKeyToScalar:v,randomPrivateKey:()=>{let E=t.randomBytes(r.BYTES+8),M=Uc.hashToPrivateScalar(E,n);return gr.numberToBytesBE(M,t.nByteLength)},precompute(E=8,M=l.BASE){return M._setWindowSize(E),M.multiply(BigInt(3)),M}};function I(E,M=!0){return l.fromPrivateKey(E).toRawBytes(M)}function N(E){let M=E instanceof Uint8Array,T=typeof E=="string",R=(M||T)&&E.length;return M?R===i||R===s:T?R===2*i||R===2*s:E instanceof l}function F(E,M,T=!0){if(N(E))throw new Error("first arg must be private key");if(!N(M))throw new Error("second arg must be public key");return l.fromHex(M).multiply(v(E)).toRawBytes(T)}let O=t.bits2int||function(E){let M=gr.bytesToNumberBE(E),T=E.length*8-t.nBitLength;return T>0?M>>BigInt(T):M},q=t.bits2int_modN||function(E){return a(O(E))},P=gr.bitMask(t.nBitLength);function D(E){if(typeof E!="bigint")throw new Error("bigint expected");if(!(Ri<=E&&E<P))throw new Error(`bigint expected < 2^${t.nBitLength}`);return gr.numberToBytesBE(E,t.nByteLength)}function A(E,M,T=c){if(["recovered","canonical"].some(te=>te in T))throw new Error("sign() legacy options not supported");let{hash:R,randomBytes:x}=t,{lowS:C,prehash:K,extraEntropy:L}=T;C==null&&(C=!0),E=(0,ds.ensureBytes)("msgHash",E),K&&(E=(0,ds.ensureBytes)("prehashed msgHash",R(E)));let V=q(E),z=v(M),G=[D(z),D(V)];if(L!=null){let te=L===!0?x(r.BYTES):L;G.push((0,ds.ensureBytes)("extraEntropy",te,r.BYTES))}let $=gr.concatBytes(...G),oe=V;function Q(te){let ve=O(te);if(!u(ve))return;let J=f(ve),Z=l.BASE.multiply(ve).toAffine(),Ce=a(Z.x);if(Ce===Ri)return;let se=a(J*a(oe+Ce*z));if(se===Ri)return;let re=(Z.x===Ce?0:2)|Number(Z.y&cr),ft=se;return C&&b(se)&&(ft=d(se),re^=1),new w(Ce,ft,re)}return{seed:$,k2sig:Q}}let c={lowS:t.lowS,prehash:!1},m={lowS:t.lowS,prehash:!1};function S(E,M,T=c){let{seed:R,k2sig:x}=A(E,M,T),C=t;return gr.createHmacDrbg(C.hash.outputLen,C.nByteLength,C.hmac)(R,x)}l.BASE._setWindowSize(8);function g(E,M,T,R=m){let x=E;if(M=(0,ds.ensureBytes)("msgHash",M),T=(0,ds.ensureBytes)("publicKey",T),"strict"in R)throw new Error("options.strict was renamed to lowS");let{lowS:C,prehash:K}=R,L,V;try{if(typeof x=="string"||x instanceof Uint8Array)try{L=w.fromDER(x)}catch(Z){if(!(Z instanceof zt.DER.Err))throw Z;L=w.fromCompact(x)}else if(typeof x=="object"&&typeof x.r=="bigint"&&typeof x.s=="bigint"){let{r:Z,s:Ce}=x;L=new w(Z,Ce)}else throw new Error("PARSE");V=l.fromHex(T)}catch(Z){if(Z.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(C&&L.hasHighS())return!1;K&&(M=t.hash(M));let{r:z,s:G}=L,$=q(M),oe=f(G),Q=a($*oe),te=a(z*oe),ve=l.BASE.multiplyAndAddUnsafe(V,Q,te)?.toAffine();return ve?a(ve.x)===z:!1}return{CURVE:t,getPublicKey:I,getSharedSecret:F,sign:S,verify:g,ProjectivePoint:l,Signature:w,utils:_}}zt.weierstrass=TD;function dx(e,t){let r=e.ORDER,n=Ri;for(let b=r-cr;b%qa===Ri;b/=qa)n+=cr;let i=n,s=qa<<i-cr-cr,o=s*qa,a=(r-cr)/o,f=(a-cr)/qa,l=o-cr,v=s,p=e.pow(t,a),u=e.pow(t,(a+cr)/qa),h=(b,d)=>{let y=p,w=e.pow(d,l),_=e.sqr(w);_=e.mul(_,d);let I=e.mul(b,_);I=e.pow(I,f),I=e.mul(I,w),w=e.mul(I,d),_=e.mul(I,b);let N=e.mul(_,w);I=e.pow(N,v);let F=e.eql(I,e.ONE);w=e.mul(_,u),I=e.mul(N,y),_=e.cmov(w,_,F),N=e.cmov(I,N,F);for(let O=i;O>cr;O--){let q=O-qa;q=qa<<q-cr;let P=e.pow(N,q),D=e.eql(P,e.ONE);w=e.mul(_,y),y=e.mul(y,y),P=e.mul(N,y),_=e.cmov(w,_,D),N=e.cmov(P,N,D)}return{isValid:F,value:_}};if(e.ORDER%fx===dh){let b=(e.ORDER-dh)/fx,d=e.sqrt(e.neg(t));h=(y,w)=>{let _=e.sqr(w),I=e.mul(y,w);_=e.mul(_,I);let N=e.pow(_,b);N=e.mul(N,I);let F=e.mul(N,d),O=e.mul(e.sqr(N),w),q=e.eql(O,y),P=e.cmov(F,N,q);return{isValid:q,value:P}}}return h}zt.SWUFpSqrtRatio=dx;function qD(e,t){if(Uc.validateField(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let r=dx(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,o,a,f,l,v,p;i=e.sqr(n),i=e.mul(i,t.Z),s=e.sqr(i),s=e.add(s,i),o=e.add(s,e.ONE),o=e.mul(o,t.B),a=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),a=e.mul(a,t.A),s=e.sqr(o),l=e.sqr(a),f=e.mul(l,t.A),s=e.add(s,f),s=e.mul(s,o),l=e.mul(l,a),f=e.mul(l,t.B),s=e.add(s,f),v=e.mul(i,o);let{isValid:u,value:h}=r(s,l);p=e.mul(i,n),p=e.mul(p,h),v=e.cmov(v,o,u),p=e.cmov(p,h,u);let b=e.isOdd(n)===e.isOdd(p);return p=e.cmov(e.neg(p),p,b),v=e.div(v,a),{x:v,y:p}}}zt.mapToCurveSimpleSWU=qD});var px=U(ni=>{"use strict";H();k();Object.defineProperty(ni,"__esModule",{value:!0});ni.createHasher=ni.isogenyMap=ni.hash_to_field=ni.expand_message_xof=ni.expand_message_xmd=void 0;var HD=X0(),Oi=Os();function kD(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")return(0,Oi.utf8ToBytes)(e);throw new Error("DST must be Uint8Array or string")}var jD=Oi.bytesToNumberBE;function Ha(e,t){if(e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);let r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=e&255,e>>>=8;return new Uint8Array(r)}function LD(e,t){let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}function Vc(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected")}function _v(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function hx(e,t,r,n){Vc(e),Vc(t),_v(r),t.length>255&&(t=n((0,Oi.concatBytes)((0,Oi.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:i,blockLen:s}=n,o=Math.ceil(r/i);if(o>255)throw new Error("Invalid xmd length");let a=(0,Oi.concatBytes)(t,Ha(t.length,1)),f=Ha(0,s),l=Ha(r,2),v=new Array(o),p=n((0,Oi.concatBytes)(f,e,l,Ha(0,1),a));v[0]=n((0,Oi.concatBytes)(p,Ha(1,1),a));for(let h=1;h<=o;h++){let b=[LD(p,v[h-1]),Ha(h+1,1),a];v[h]=n((0,Oi.concatBytes)(...b))}return(0,Oi.concatBytes)(...v).slice(0,r)}ni.expand_message_xmd=hx;function lx(e,t,r,n,i){if(Vc(e),Vc(t),_v(r),t.length>255){let s=Math.ceil(2*n/8);t=i.create({dkLen:s}).update((0,Oi.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(e).update(Ha(r,2)).update(t).update(Ha(t.length,1)).digest()}ni.expand_message_xof=lx;function Ev(e,t,r){(0,Oi.validateObject)(r,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:i,m:s,hash:o,expand:a,DST:f}=r;Vc(e),_v(t);let l=kD(f),v=n.toString(2).length,p=Math.ceil((v+i)/8),u=t*s*p,h;if(a==="xmd")h=hx(e,l,u,o);else if(a==="xof")h=lx(e,l,u,i,o);else if(a==="_internal_pass")h=e;else throw new Error('expand must be "xmd" or "xof"');let b=new Array(t);for(let d=0;d<t;d++){let y=new Array(s);for(let w=0;w<s;w++){let _=p*(w+d*s),I=h.subarray(_,_+p);y[w]=(0,HD.mod)(jD(I),n)}b[d]=y}return b}ni.hash_to_field=Ev;function KD(e,t){let r=t.map(n=>Array.from(n).reverse());return(n,i)=>{let[s,o,a,f]=r.map(l=>l.reduce((v,p)=>e.add(e.mul(v,n),p)));return n=e.div(s,o),i=e.mul(i,e.div(a,f)),{x:n,y:i}}}ni.isogenyMap=KD;function UD(e,t,r){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){let s=Ev(n,2,{...r,DST:r.DST,...i}),o=e.fromAffine(t(s[0])),a=e.fromAffine(t(s[1])),f=o.add(a).clearCofactor();return f.assertValidity(),f},encodeToCurve(n,i){let s=Ev(n,1,{...r,DST:r.encodeDST,...i}),o=e.fromAffine(t(s[0])).clearCofactor();return o.assertValidity(),o}}}ni.createHasher=UD});var Av=U(wf=>{"use strict";H();k();Object.defineProperty(wf,"__esModule",{value:!0});wf.createCurve=wf.getHash=void 0;var VD=Cc(),vx=Zr(),zD=hh();function bx(e){return{hash:e,hmac:(t,...r)=>(0,VD.hmac)(e,t,(0,vx.concatBytes)(...r)),randomBytes:vx.randomBytes}}wf.getHash=bx;function WD(e,t){let r=n=>(0,zD.weierstrass)({...e,...bx(n)});return Object.freeze({...r(t),create:r})}wf.createCurve=WD});var Bx=U(yr=>{"use strict";H();k();var $D=yr&&yr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),GD=yr&&yr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),XD=yr&&yr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&$D(t,e,r);return GD(t,e),t},Bv;Object.defineProperty(yr,"__esModule",{value:!0});yr.encodeToCurve=yr.hashToCurve=yr.schnorr=yr.secp256k1=void 0;var lh=Go(),ZD=Zr(),jr=X0(),YD=hh(),dn=Os(),xx=XD(px()),JD=Av(),gh=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),ph=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),mx=BigInt(1),vh=BigInt(2),gx=(e,t)=>(e+t/vh)/t;function wx(e){let t=gh,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),f=BigInt(88),l=e*e*e%t,v=l*l*e%t,p=(0,jr.pow2)(v,r,t)*v%t,u=(0,jr.pow2)(p,r,t)*v%t,h=(0,jr.pow2)(u,vh,t)*l%t,b=(0,jr.pow2)(h,i,t)*h%t,d=(0,jr.pow2)(b,s,t)*b%t,y=(0,jr.pow2)(d,a,t)*d%t,w=(0,jr.pow2)(y,f,t)*y%t,_=(0,jr.pow2)(w,a,t)*d%t,I=(0,jr.pow2)(_,r,t)*v%t,N=(0,jr.pow2)(I,o,t)*b%t,F=(0,jr.pow2)(N,n,t)*l%t,O=(0,jr.pow2)(F,vh,t);if(!ka.eql(ka.sqr(O),e))throw new Error("Cannot find square root");return O}var ka=(0,jr.Field)(gh,void 0,void 0,{sqrt:wx});yr.secp256k1=(0,JD.createCurve)({a:BigInt(0),b:BigInt(7),Fp:ka,n:ph,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=ph,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-mx*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=gx(s*e,t),f=gx(-n*e,t),l=(0,jr.mod)(e-a*r-f*i,t),v=(0,jr.mod)(-a*n-f*s,t),p=l>o,u=v>o;if(p&&(l=t-l),u&&(v=t-v),l>o||v>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:p,k1:l,k2neg:u,k2:v}}}},lh.sha256);var yh=BigInt(0),Sx=e=>typeof e=="bigint"&&yh<e&&e<gh,QD=e=>typeof e=="bigint"&&yh<e&&e<ph,yx={};function bh(e,...t){let r=yx[e];if(r===void 0){let n=(0,lh.sha256)(Uint8Array.from(e,i=>i.charCodeAt(0)));r=(0,dn.concatBytes)(n,n),yx[e]=r}return(0,lh.sha256)((0,dn.concatBytes)(r,...t))}var Cv=e=>e.toRawBytes(!0).slice(1),Iv=e=>(0,dn.numberToBytesBE)(e,32),Pv=e=>(0,jr.mod)(e,gh),zc=e=>(0,jr.mod)(e,ph),Fv=yr.secp256k1.ProjectivePoint,eT=(e,t,r)=>Fv.BASE.multiplyAndAddUnsafe(e,t,r);function Mv(e){let t=yr.secp256k1.utils.normPrivateKeyToScalar(e),r=Fv.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:zc(-t),bytes:Cv(r)}}function Ex(e){if(!Sx(e))throw new Error("bad x: need 0 < x < p");let t=Pv(e*e),r=Pv(t*e+BigInt(7)),n=wx(r);n%vh!==yh&&(n=Pv(-n));let i=new Fv(e,n,mx);return i.assertValidity(),i}function _x(...e){return zc((0,dn.bytesToNumberBE)(bh("BIP0340/challenge",...e)))}function tT(e){return Mv(e).bytes}function rT(e,t,r=(0,ZD.randomBytes)(32)){let n=(0,dn.ensureBytes)("message",e),{bytes:i,scalar:s}=Mv(t),o=(0,dn.ensureBytes)("auxRand",r,32),a=Iv(s^(0,dn.bytesToNumberBE)(bh("BIP0340/aux",o))),f=bh("BIP0340/nonce",a,i,n),l=zc((0,dn.bytesToNumberBE)(f));if(l===yh)throw new Error("sign failed: k is zero");let{bytes:v,scalar:p}=Mv(l),u=_x(v,i,n),h=new Uint8Array(64);if(h.set(v,0),h.set(Iv(zc(p+u*s)),32),!Ax(h,n,i))throw new Error("sign: Invalid signature produced");return h}function Ax(e,t,r){let n=(0,dn.ensureBytes)("signature",e,64),i=(0,dn.ensureBytes)("message",t),s=(0,dn.ensureBytes)("publicKey",r,32);try{let o=Ex((0,dn.bytesToNumberBE)(s)),a=(0,dn.bytesToNumberBE)(n.subarray(0,32));if(!Sx(a))return!1;let f=(0,dn.bytesToNumberBE)(n.subarray(32,64));if(!QD(f))return!1;let l=_x(Iv(a),Cv(o),i),v=eT(o,f,zc(-l));return!(!v||!v.hasEvenY()||v.toAffine().x!==a)}catch{return!1}}yr.schnorr={getPublicKey:tT,sign:rT,verify:Ax,utils:{randomPrivateKey:yr.secp256k1.utils.randomPrivateKey,lift_x:Ex,pointToBytes:Cv,numberToBytesBE:dn.numberToBytesBE,bytesToNumberBE:dn.bytesToNumberBE,taggedHash:bh,mod:jr.mod}};var nT=xx.isogenyMap(ka,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),iT=(0,YD.mapToCurveSimpleSWU)(ka,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:ka.create(BigInt("-11"))});Bv=xx.createHasher(yr.secp256k1.ProjectivePoint,e=>{let{x:t,y:r}=iT(ka.create(e[0]));return nT(t,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:ka.ORDER,m:1,k:128,expand:"xmd",hash:lh.sha256}),yr.hashToCurve=Bv.hashToCurve,yr.encodeToCurve=Bv.encodeToCurve});var Mx=U(ja=>{"use strict";H();k();Object.defineProperty(ja,"__esModule",{value:!0});ja.poseidon=ja.splitConstants=ja.validateOpts=void 0;var Px=X0();function Ix(e){let{Fp:t}=e;(0,Px.validateField)(t);for(let f of["t","roundsFull","roundsPartial"])if(typeof e[f]!="number"||!Number.isSafeInteger(e[f]))throw new Error(`Poseidon: invalid param ${f}=${e[f]} (${typeof e[f]})`);if(e.reversePartialPowIdx!==void 0&&typeof e.reversePartialPowIdx!="boolean")throw new Error(`Poseidon: invalid param reversePartialPowIdx=${e.reversePartialPowIdx}`);let r=e.sboxPower;if(r===void 0&&(r=5),typeof r!="number"||!Number.isSafeInteger(r))throw new Error(`Poseidon wrong sboxPower=${r}`);let n=BigInt(r),i=f=>(0,Px.FpPow)(t,f,n);if(r===3?i=f=>t.mul(t.sqrN(f),f):r===5&&(i=f=>t.mul(t.sqrN(t.sqrN(f)),f)),e.roundsFull%2!==0)throw new Error(`Poseidon roundsFull is not even: ${e.roundsFull}`);let s=e.roundsFull+e.roundsPartial;if(!Array.isArray(e.roundConstants)||e.roundConstants.length!==s)throw new Error("Poseidon: wrong round constants");let o=e.roundConstants.map(f=>{if(!Array.isArray(f)||f.length!==e.t)throw new Error(`Poseidon wrong round constants: ${f}`);return f.map(l=>{if(typeof l!="bigint"||!t.isValid(l))throw new Error(`Poseidon wrong round constant=${l}`);return t.create(l)})});if(!Array.isArray(e.mds)||e.mds.length!==e.t)throw new Error("Poseidon: wrong MDS matrix");let a=e.mds.map(f=>{if(!Array.isArray(f)||f.length!==e.t)throw new Error(`Poseidon MDS matrix row: ${f}`);return f.map(l=>{if(typeof l!="bigint")throw new Error(`Poseidon MDS matrix value=${l}`);return t.create(l)})});return Object.freeze({...e,rounds:s,sboxFn:i,roundConstants:o,mds:a})}ja.validateOpts=Ix;function sT(e,t){if(typeof t!="number")throw new Error("poseidonSplitConstants: wrong t");if(!Array.isArray(e)||e.length%t)throw new Error("poseidonSplitConstants: wrong rc");let r=[],n=[];for(let i=0;i<e.length;i++)n.push(e[i]),n.length===t&&(r.push(n),n=[]);return r}ja.splitConstants=sT;function aT(e){let{t,Fp:r,rounds:n,sboxFn:i,reversePartialPowIdx:s}=Ix(e),o=Math.floor(e.roundsFull/2),a=s?t-1:0,f=(v,p,u)=>(v=v.map((h,b)=>r.add(h,e.roundConstants[u][b])),p?v=v.map(h=>i(h)):v[a]=i(v[a]),v=e.mds.map(h=>h.reduce((b,d,y)=>r.add(b,r.mulN(d,v[y])),r.ZERO)),v),l=function(p){if(!Array.isArray(p)||p.length!==t)throw new Error(`Poseidon: wrong values (expected array of bigints with length ${t})`);p=p.map(h=>{if(typeof h!="bigint")throw new Error(`Poseidon: wrong value=${h} (${typeof h})`);return r.create(h)});let u=0;for(let h=0;h<o;h++)p=f(p,!0,u++);for(let h=0;h<e.roundsPartial;h++)p=f(p,!1,u++);for(let h=0;h<o;h++)p=f(p,!0,u++);if(u!==n)throw new Error(`Poseidon: wrong number of rounds: last round=${u}, total=${n}`);return p};return l.roundConstants=e.roundConstants,l}ja.poseidon=aT});var Kx=U(he=>{"use strict";H();k();var oT=he&&he.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),fT=he&&he.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),cT=he&&he.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&oT(t,e,r);return fT(t,e),t};Object.defineProperty(he,"__esModule",{value:!0});he.poseidonHashMany=he.poseidonHashSingle=he.poseidonHashFunc=he.poseidonHash=he.poseidonSmall=he.poseidonCreate=he.poseidonBasic=he._poseidonMDS=he.Fp251=he.Fp253=he.keccak=he.computeHashOnElements=he.hashChain=he.pedersen=he.getAccountPath=he.ethSigToPrivate=he.getStarkKey=he.grindKey=he.utils=he.Signature=he.ProjectivePoint=he.CURVE=he.verify=he.sign=he.getSharedSecret=he.getPublicKey=he._starkCurve=void 0;var uT=Od(),Ov=Go(),dT=Zr(),Y0=X0(),hT=Mx(),lT=hh(),hn=cT(Os()),pT=Av(),mh=BigInt("3618502788666131213697322783095070105526743751716087489154079457884512865583"),Nx=252;function Cx(e){for(;e[0]===0;)e=e.subarray(1);let t=e.length*8-Nx,r=hn.bytesToNumberBE(e);return t>0?r>>BigInt(t):r}function Rx(e){return typeof e=="string"&&(e=Tv(e),e.length&1&&(e="0"+e)),hn.hexToBytes(e)}var J0=(0,lT.weierstrass)({a:BigInt(1),b:BigInt("3141592653589793238462643383279502884197169399375105820974944592307816406665"),Fp:(0,Y0.Field)(BigInt("0x800000000000011000000000000000000000000000000000000000000000001")),n:mh,nBitLength:Nx,Gx:BigInt("874739451078007766457464989774322083649278607533249481151382481072868806602"),Gy:BigInt("152666792071518830868575557812948353041420400780739481342941381225525861407"),h:BigInt(1),lowS:!1,...(0,pT.getHash)(Ov.sha256),bits2int:Cx,bits2int_modN:e=>{let t=hn.bytesToNumberBE(e).toString(16);return t.length===63&&(e=Rx(t+"0")),(0,Y0.mod)(Cx(e),mh)}});he._starkCurve=J0;function Z0(e){return hn.ensureBytes("",typeof e=="string"?Rx(e):e)}function Dv(e){return hn.bytesToHex(Z0(e)).padStart(64,"0")}function Ox(e,t=!1){return J0.getPublicKey(Dv(e),t)}he.getPublicKey=Ox;function vT(e,t){return J0.getSharedSecret(Dv(e),t)}he.getSharedSecret=vT;function bT(e,t,r){return J0.sign(Z0(e),Dv(t),r)}he.sign=bT;function gT(e,t,r){let n=e instanceof Dx?e:Z0(e);return J0.verify(n,Z0(t),Z0(r))}he.verify=gT;var{CURVE:yT,ProjectivePoint:Sf,Signature:Dx,utils:xT}=J0;he.CURVE=yT;he.ProjectivePoint=Sf;he.Signature=Dx;he.utils=xT;function Tx(e){return`0x${hn.bytesToHex(e.subarray(1)).replace(/^0+/gm,"")}`}function Tv(e){return e.replace(/^0x/i,"")}function mT(e){return`0x${e.toString(16)}`}function qx(e){let t=Z0(e),r=2n**256n,n=r-(0,Y0.mod)(r,mh);for(let i=0;;i++){let s=Nv(hn.concatBytes(t,hn.numberToVarBytesBE(BigInt(i))));if(s<n)return(0,Y0.mod)(s,mh).toString(16);if(i===1e5)throw new Error("grindKey is broken: tried 100k vals")}}he.grindKey=qx;function wT(e){return Tx(Ox(e,!0))}he.getStarkKey=wT;function ST(e){if(e=Tv(e),e.length!==130)throw new Error("Wrong ethereum signature");return qx(e.substring(0,64))}he.ethSigToPrivate=ST;var ET=2n**31n-1n,xh=e=>Number(e&ET);function _T(e,t,r,n){let i=xh(Nv(e)),s=xh(Nv(t)),o=hn.hexToNumber(Tv(r));return`m/2645'/${i}'/${s}'/${xh(o)}'/${xh(o>>31n)}'/${n}`}he.getAccountPath=_T;var Wc=[new Sf(2089986280348253421170679821480865132823066470938446095505822317253594081284n,1713931329540660377023406109199410414810705867260802078187082345529207694986n,1n),new Sf(996781205833008774514500082376783249102396023663454813447423147977397232763n,1668503676786377725805489344771023921079126552019160156920634619255970485781n,1n),new Sf(2251563274489750535117886426533222435294046428347329203627021249169616184184n,1798716007562728905295480679789526322175868328062420237419143593021674992973n,1n),new Sf(2138414695194151160943305727036575959195309218611738193261179310511854807447n,113410276730064486255102093846540133784865286929052426931474106396135072156n,1n),new Sf(2379962749567351885752724891227938183011949129833673362440656643086021394946n,776496453633298175483985398648758586525933812536653089401905292063708816422n,1n)];function Hx(e,t){let r=[],n=e;for(let i=0;i<248;i++)r.push(n),n=n.double();n=t;for(let i=0;i<4;i++)r.push(n),n=n.double();return r}var AT=Hx(Wc[1],Wc[2]),BT=Hx(Wc[3],Wc[4]);function kx(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"){if(!Number.isSafeInteger(e))throw new Error(`Invalid pedersenArg: ${e}`);t=BigInt(e)}else t=hn.bytesToNumberBE(Z0(e));if(!(0n<=t&&t<J0.CURVE.Fp.ORDER))throw new Error(`PedersenArg should be 0 <= value < CURVE.P: ${t}`);return t}function Fx(e,t,r){let n=kx(t);for(let i=0;i<252;i++){let s=r[i];if(s.equals(e))throw new Error("Same point");(n&1n)!==0n&&(e=e.add(s)),n>>=1n}return e}function qv(e,t){let r=Wc[0];return r=Fx(r,e,AT),r=Fx(r,t,BT),Tx(r.toRawBytes(!0))}he.pedersen=qv;function PT(e,t=qv){if(!Array.isArray(e)||e.length<1)throw new Error("data should be array of at least 1 element");return e.length===1?mT(kx(e[0])):Array.from(e).reverse().reduce((r,n)=>t(n,r))}he.hashChain=PT;var IT=(e,t=qv)=>[0,...e,e.length].reduce((r,n)=>t(r,n));he.computeHashOnElements=IT;var MT=hn.bitMask(250),CT=e=>hn.bytesToNumberBE((0,uT.keccak_256)(e))&MT;he.keccak=CT;var Nv=e=>hn.bytesToNumberBE((0,Ov.sha256)(e));he.Fp253=(0,Y0.Field)(BigInt("14474011154664525231415395255581126252639794253786371766033694892385558855681"));he.Fp251=(0,Y0.Field)(BigInt("3618502788666131213697322783095070105623107215331596699973092056135872020481"));function Rv(e,t,r){let n=e.fromBytes((0,Ov.sha256)((0,dT.utf8ToBytes)(`${t}${r}`)));return e.create(n)}function jx(e,t,r,n=0){let i=[],s=[];for(let o=0;o<r;o++)i.push(Rv(e,`${t}x`,n*r+o)),s.push(Rv(e,`${t}y`,n*r+o));if(new Set([...i,...s]).size!==2*r)throw new Error("X and Y values are not distinct");return i.map(o=>s.map(a=>e.inv(e.sub(o,a))))}he._poseidonMDS=jx;var FT=[[3,1,1],[1,-1,1],[1,1,-2]].map(e=>e.map(BigInt));function Hv(e,t){if((0,Y0.validateField)(e.Fp),!Number.isSafeInteger(e.rate)||!Number.isSafeInteger(e.capacity))throw new Error(`Wrong poseidon opts: ${e}`);let r=e.rate+e.capacity,n=e.roundsFull+e.roundsPartial,i=[];for(let o=0;o<n;o++){let a=[];for(let f=0;f<r;f++)a.push(Rv(e.Fp,"Hades",r*o+f));i.push(a)}let s=(0,hT.poseidon)({...e,t:r,sboxPower:3,reversePartialPowIdx:!0,mds:t,roundConstants:i});return s.m=r,s.rate=e.rate,s.capacity=e.capacity,s}he.poseidonBasic=Hv;function NT(e,t=0){let r=e.rate+e.capacity;if(!Number.isSafeInteger(t))throw new Error(`Wrong mdsAttempt=${t}`);return Hv(e,jx(e.Fp,"HadesMDS",r,t))}he.poseidonCreate=NT;he.poseidonSmall=Hv({Fp:he.Fp251,rate:2,capacity:1,roundsFull:8,roundsPartial:83},FT);function Lx(e,t,r=he.poseidonSmall){return r([e,t,2n])[0]}he.poseidonHash=Lx;function RT(e,t,r=he.poseidonSmall){return hn.numberToVarBytesBE(Lx(hn.bytesToNumberBE(e),hn.bytesToNumberBE(t),r))}he.poseidonHashFunc=RT;function OT(e,t=he.poseidonSmall){return t([e,0n,1n])[0]}he.poseidonHashSingle=OT;function DT(e,t=he.poseidonSmall){let{m:r,rate:n}=t;if(!Array.isArray(e))throw new Error("bigint array expected in values");let i=Array.from(e);for(i.push(1n);i.length%n!==0;)i.push(0n);let s=new Array(r).fill(0n);for(let o=0;o<i.length;o+=n){for(let a=0;a<n;a++)s[a]+=i[o+a];s=t(s)}return s[0]}he.poseidonHashMany=DT});var zx=U(ln=>{"use strict";H();k();var TT=ln&&ln.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),qT=ln&&ln.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ux=ln&&ln.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&TT(t,e,r);return qT(t,e),t};Object.defineProperty(ln,"__esModule",{value:!0});ln.bytesToHex=ln.hexToBytes=ln.stark=ln.secp256k1=void 0;ln.secp256k1=Ux(Bx());ln.stark=Ux(Kx());var Vx=Os();Object.defineProperty(ln,"hexToBytes",{enumerable:!0,get:function(){return Vx.hexToBytes}});Object.defineProperty(ln,"bytesToHex",{enumerable:!0,get:function(){return Vx.bytesToHex}})});var Wx=U(pn=>{"use strict";H();k();var HT=pn&&pn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),kT=pn&&pn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),wh=pn&&pn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&HT(t,e,r);return kT(t,e),t};Object.defineProperty(pn,"__esModule",{value:!0});pn.schnorr=pn.p256=pn.ed25519=pn.secp256k1=void 0;pn.secp256k1=wh(Ly());pn.ed25519=wh(Vy());pn.p256=wh(Gy());pn.schnorr=wh(zx())});var Gx=U(Ef=>{"use strict";H();k();var jT=Ef&&Ef.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ef,"__esModule",{value:!0});Ef.Decimal=void 0;var Q0=jT(Ar()),$x=100,xr=class{static fromUserInput(t,r){xr.verifyFractionalDigits(r);let n=t.match(/[^0-9.]/);if(n)throw new Error(`Invalid character at position ${n.index+1}`);let i,s;if(t.search(/\./)===-1)i=t,s="";else{let a=t.split(".");switch(a.length){case 0:case 1:throw new Error("Fewer than two elements in split result. This must not happen here.");case 2:if(!a[1])throw new Error("Fractional part missing");i=a[0],s=a[1].replace(/0+$/,"");break;default:throw new Error("More than one separator found")}}if(s.length>r)throw new Error("Got more fractional digits than supported");let o=`${i}${s.padEnd(r,"0")}`;return new xr(o,r)}static fromAtomics(t,r){return xr.verifyFractionalDigits(r),new xr(t,r)}static zero(t){return xr.verifyFractionalDigits(t),new xr("0",t)}static one(t){return xr.verifyFractionalDigits(t),new xr("1"+"0".repeat(t),t)}static verifyFractionalDigits(t){if(!Number.isInteger(t))throw new Error("Fractional digits is not an integer");if(t<0)throw new Error("Fractional digits must not be negative");if(t>$x)throw new Error(`Fractional digits must not exceed ${$x}`)}static compare(t,r){if(t.fractionalDigits!==r.fractionalDigits)throw new Error("Fractional digits do not match");return t.data.atomics.cmp(new Q0.default(r.atomics))}get atomics(){return this.data.atomics.toString()}get fractionalDigits(){return this.data.fractionalDigits}constructor(t,r){this.data={atomics:new Q0.default(t),fractionalDigits:r}}toString(){let t=new Q0.default(10).pow(new Q0.default(this.data.fractionalDigits)),r=this.data.atomics.div(t),n=this.data.atomics.mod(t);if(n.isZero())return r.toString();{let s=n.toString().padStart(this.data.fractionalDigits,"0").replace(/0+$/,"");return`${r.toString()}.${s}`}}toFloatApproximation(){let t=Number(this.toString());if(Number.isNaN(t))throw new Error("Conversion to number failed");return t}plus(t){if(this.fractionalDigits!==t.fractionalDigits)throw new Error("Fractional digits do not match");let r=this.data.atomics.add(new Q0.default(t.atomics));return new xr(r.toString(),this.fractionalDigits)}minus(t){if(this.fractionalDigits!==t.fractionalDigits)throw new Error("Fractional digits do not match");let r=this.data.atomics.sub(new Q0.default(t.atomics));if(r.ltn(0))throw new Error("Difference must not be negative");return new xr(r.toString(),this.fractionalDigits)}multiply(t){let r=this.data.atomics.mul(new Q0.default(t.toString()));return new xr(r.toString(),this.fractionalDigits)}equals(t){return xr.compare(this,t)===0}isLessThan(t){return xr.compare(this,t)<0}isLessThanOrEqual(t){return xr.compare(this,t)<=0}isGreaterThan(t){return xr.compare(this,t)>0}isGreaterThanOrEqual(t){return xr.compare(this,t)>=0}};Ef.Decimal=xr});var Xx=U(ii=>{"use strict";H();k();var LT=ii&&ii.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ii,"__esModule",{value:!0});ii.Uint64=ii.Uint53=ii.Int53=ii.Uint32=void 0;var Sh=LT(Ar()),KT=new Sh.default("18446744073709551615",10,"be"),eo=class{static fromBigEndianBytes(t){return eo.fromBytes(t)}static fromBytes(t,r="be"){if(t.length!==4)throw new Error("Invalid input length. Expected 4 bytes.");for(let i=0;i<t.length;++i)if(!Number.isInteger(t[i])||t[i]>255||t[i]<0)throw new Error("Invalid value in byte. Found: "+t[i]);let n=r==="be"?t:Array.from(t).reverse();return new eo(n[0]*2**24+n[1]*2**16+n[2]*2**8+n[3])}static fromString(t){if(!t.match(/^[0-9]+$/))throw new Error("Invalid string format");return new eo(Number.parseInt(t,10))}constructor(t){if(Number.isNaN(t))throw new Error("Input is not a number");if(!Number.isInteger(t))throw new Error("Input is not an integer");if(t<0||t>4294967295)throw new Error("Input not in uint32 range: "+t.toString());this.data=t}toBytesBigEndian(){return new Uint8Array([Math.floor(this.data/2**24)&255,Math.floor(this.data/2**16)&255,Math.floor(this.data/2**8)&255,Math.floor(this.data/2**0)&255])}toBytesLittleEndian(){return new Uint8Array([Math.floor(this.data/2**0)&255,Math.floor(this.data/2**8)&255,Math.floor(this.data/2**16)&255,Math.floor(this.data/2**24)&255])}toNumber(){return this.data}toString(){return this.data.toString()}};ii.Uint32=eo;var to=class{static fromString(t){if(!t.match(/^-?[0-9]+$/))throw new Error("Invalid string format");return new to(Number.parseInt(t,10))}constructor(t){if(Number.isNaN(t))throw new Error("Input is not a number");if(!Number.isInteger(t))throw new Error("Input is not an integer");if(t<Number.MIN_SAFE_INTEGER||t>Number.MAX_SAFE_INTEGER)throw new Error("Input not in int53 range: "+t.toString());this.data=t}toNumber(){return this.data}toString(){return this.data.toString()}};ii.Int53=to;var $c=class{static fromString(t){let r=to.fromString(t);return new $c(r.toNumber())}constructor(t){let r=new to(t);if(r.toNumber()<0)throw new Error("Input is negative");this.data=r}toNumber(){return this.data.toNumber()}toString(){return this.data.toString()}};ii.Uint53=$c;var La=class{static fromBytesBigEndian(t){return La.fromBytes(t)}static fromBytes(t,r="be"){if(t.length!==8)throw new Error("Invalid input length. Expected 8 bytes.");for(let i=0;i<t.length;++i)if(!Number.isInteger(t[i])||t[i]>255||t[i]<0)throw new Error("Invalid value in byte. Found: "+t[i]);let n=r==="be"?Array.from(t):Array.from(t).reverse();return new La(new Sh.default(n))}static fromString(t){if(!t.match(/^[0-9]+$/))throw new Error("Invalid string format");return new La(new Sh.default(t,10,"be"))}static fromNumber(t){if(Number.isNaN(t))throw new Error("Input is not a number");if(!Number.isInteger(t))throw new Error("Input is not an integer");let r;try{r=new Sh.default(t)}catch{throw new Error("Input is not a safe integer")}return new La(r)}constructor(t){if(t.isNeg())throw new Error("Input is negative");if(t.gt(KT))throw new Error("Input exceeds uint64 range");this.data=t}toBytesBigEndian(){return Uint8Array.from(this.data.toArray("be",8))}toBytesLittleEndian(){return Uint8Array.from(this.data.toArray("le",8))}toString(){return this.data.toString(10)}toNumber(){return this.data.toNumber()}};ii.Uint64=La});var Zx=U(si=>{"use strict";H();k();Object.defineProperty(si,"__esModule",{value:!0});si.Uint64=si.Uint53=si.Uint32=si.Int53=si.Decimal=void 0;var UT=Gx();Object.defineProperty(si,"Decimal",{enumerable:!0,get:function(){return UT.Decimal}});var Eh=Xx();Object.defineProperty(si,"Int53",{enumerable:!0,get:function(){return Eh.Int53}});Object.defineProperty(si,"Uint32",{enumerable:!0,get:function(){return Eh.Uint32}});Object.defineProperty(si,"Uint53",{enumerable:!0,get:function(){return Eh.Uint53}});Object.defineProperty(si,"Uint64",{enumerable:!0,get:function(){return Eh.Uint64}})});var Qx=U((Jx,kv)=>{H();k();var Yx=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function r(S,g,E){this.low=S|0,this.high=g|0,this.unsigned=!!E}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0});function n(S){return(S&&S.__isLong__)===!0}function i(S){var g=Math.clz32(S&-S);return S?31-g:g}r.isLong=n;var s={},o={};function a(S,g){var E,M,T;return g?(S>>>=0,(T=0<=S&&S<256)&&(M=o[S],M)?M:(E=l(S,0,!0),T&&(o[S]=E),E)):(S|=0,(T=-128<=S&&S<128)&&(M=s[S],M)?M:(E=l(S,S<0?-1:0,!1),T&&(s[S]=E),E))}r.fromInt=a;function f(S,g){if(isNaN(S))return g?N:I;if(g){if(S<0)return N;if(S>=y)return D}else{if(S<=-w)return A;if(S+1>=w)return P}return S<0?f(-S,g).neg():l(S%d|0,S/d|0,g)}r.fromNumber=f;function l(S,g,E){return new r(S,g,E)}r.fromBits=l;var v=Math.pow;function p(S,g,E){if(S.length===0)throw Error("empty string");if(typeof g=="number"?(E=g,g=!1):g=!!g,S==="NaN"||S==="Infinity"||S==="+Infinity"||S==="-Infinity")return g?N:I;if(E=E||10,E<2||36<E)throw RangeError("radix");var M;if((M=S.indexOf("-"))>0)throw Error("interior hyphen");if(M===0)return p(S.substring(1),g,E).neg();for(var T=f(v(E,8)),R=I,x=0;x<S.length;x+=8){var C=Math.min(8,S.length-x),K=parseInt(S.substring(x,x+C),E);if(C<8){var L=f(v(E,C));R=R.mul(L).add(f(K))}else R=R.mul(T),R=R.add(f(K))}return R.unsigned=g,R}r.fromString=p;function u(S,g){return typeof S=="number"?f(S,g):typeof S=="string"?p(S,g):l(S.low,S.high,typeof g=="boolean"?g:S.unsigned)}r.fromValue=u;var h=1<<16,b=1<<24,d=h*h,y=d*d,w=y/2,_=a(b),I=a(0);r.ZERO=I;var N=a(0,!0);r.UZERO=N;var F=a(1);r.ONE=F;var O=a(1,!0);r.UONE=O;var q=a(-1);r.NEG_ONE=q;var P=l(-1,2147483647,!1);r.MAX_VALUE=P;var D=l(-1,-1,!0);r.MAX_UNSIGNED_VALUE=D;var A=l(0,-2147483648,!1);r.MIN_VALUE=A;var c=r.prototype;c.toInt=function(){return this.unsigned?this.low>>>0:this.low},c.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},c.toString=function(g){if(g=g||10,g<2||36<g)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(A)){var E=f(g),M=this.div(E),T=M.mul(E).sub(this);return M.toString(g)+T.toInt().toString(g)}else return"-"+this.neg().toString(g);for(var R=f(v(g,6),this.unsigned),x=this,C="";;){var K=x.div(R),L=x.sub(K.mul(R)).toInt()>>>0,V=L.toString(g);if(x=K,x.isZero())return V+C;for(;V.length<6;)V="0"+V;C=""+V+C}},c.getHighBits=function(){return this.high},c.getHighBitsUnsigned=function(){return this.high>>>0},c.getLowBits=function(){return this.low},c.getLowBitsUnsigned=function(){return this.low>>>0},c.getNumBitsAbs=function(){if(this.isNegative())return this.eq(A)?64:this.neg().getNumBitsAbs();for(var g=this.high!=0?this.high:this.low,E=31;E>0&&(g&1<<E)==0;E--);return this.high!=0?E+33:E+1},c.isZero=function(){return this.high===0&&this.low===0},c.eqz=c.isZero,c.isNegative=function(){return!this.unsigned&&this.high<0},c.isPositive=function(){return this.unsigned||this.high>=0},c.isOdd=function(){return(this.low&1)===1},c.isEven=function(){return(this.low&1)===0},c.equals=function(g){return n(g)||(g=u(g)),this.unsigned!==g.unsigned&&this.high>>>31===1&&g.high>>>31===1?!1:this.high===g.high&&this.low===g.low},c.eq=c.equals,c.notEquals=function(g){return!this.eq(g)},c.neq=c.notEquals,c.ne=c.notEquals,c.lessThan=function(g){return this.comp(g)<0},c.lt=c.lessThan,c.lessThanOrEqual=function(g){return this.comp(g)<=0},c.lte=c.lessThanOrEqual,c.le=c.lessThanOrEqual,c.greaterThan=function(g){return this.comp(g)>0},c.gt=c.greaterThan,c.greaterThanOrEqual=function(g){return this.comp(g)>=0},c.gte=c.greaterThanOrEqual,c.ge=c.greaterThanOrEqual,c.compare=function(g){if(n(g)||(g=u(g)),this.eq(g))return 0;var E=this.isNegative(),M=g.isNegative();return E&&!M?-1:!E&&M?1:this.unsigned?g.high>>>0>this.high>>>0||g.high===this.high&&g.low>>>0>this.low>>>0?-1:1:this.sub(g).isNegative()?-1:1},c.comp=c.compare,c.negate=function(){return!this.unsigned&&this.eq(A)?A:this.not().add(F)},c.neg=c.negate,c.add=function(g){n(g)||(g=u(g));var E=this.high>>>16,M=this.high&65535,T=this.low>>>16,R=this.low&65535,x=g.high>>>16,C=g.high&65535,K=g.low>>>16,L=g.low&65535,V=0,z=0,G=0,$=0;return $+=R+L,G+=$>>>16,$&=65535,G+=T+K,z+=G>>>16,G&=65535,z+=M+C,V+=z>>>16,z&=65535,V+=E+x,V&=65535,l(G<<16|$,V<<16|z,this.unsigned)},c.subtract=function(g){return n(g)||(g=u(g)),this.add(g.neg())},c.sub=c.subtract,c.multiply=function(g){if(this.isZero())return this;if(n(g)||(g=u(g)),t){var E=t.mul(this.low,this.high,g.low,g.high);return l(E,t.get_high(),this.unsigned)}if(g.isZero())return this.unsigned?N:I;if(this.eq(A))return g.isOdd()?A:I;if(g.eq(A))return this.isOdd()?A:I;if(this.isNegative())return g.isNegative()?this.neg().mul(g.neg()):this.neg().mul(g).neg();if(g.isNegative())return this.mul(g.neg()).neg();if(this.lt(_)&&g.lt(_))return f(this.toNumber()*g.toNumber(),this.unsigned);var M=this.high>>>16,T=this.high&65535,R=this.low>>>16,x=this.low&65535,C=g.high>>>16,K=g.high&65535,L=g.low>>>16,V=g.low&65535,z=0,G=0,$=0,oe=0;return oe+=x*V,$+=oe>>>16,oe&=65535,$+=R*V,G+=$>>>16,$&=65535,$+=x*L,G+=$>>>16,$&=65535,G+=T*V,z+=G>>>16,G&=65535,G+=R*L,z+=G>>>16,G&=65535,G+=x*K,z+=G>>>16,G&=65535,z+=M*V+T*L+R*K+x*C,z&=65535,l($<<16|oe,z<<16|G,this.unsigned)},c.mul=c.multiply,c.divide=function(g){if(n(g)||(g=u(g)),g.isZero())throw Error("division by zero");if(t){if(!this.unsigned&&this.high===-2147483648&&g.low===-1&&g.high===-1)return this;var E=(this.unsigned?t.div_u:t.div_s)(this.low,this.high,g.low,g.high);return l(E,t.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?N:I;var M,T,R;if(this.unsigned){if(g.unsigned||(g=g.toUnsigned()),g.gt(this))return N;if(g.gt(this.shru(1)))return O;R=N}else{if(this.eq(A)){if(g.eq(F)||g.eq(q))return A;if(g.eq(A))return F;var x=this.shr(1);return M=x.div(g).shl(1),M.eq(I)?g.isNegative()?F:q:(T=this.sub(g.mul(M)),R=M.add(T.div(g)),R)}else if(g.eq(A))return this.unsigned?N:I;if(this.isNegative())return g.isNegative()?this.neg().div(g.neg()):this.neg().div(g).neg();if(g.isNegative())return this.div(g.neg()).neg();R=I}for(T=this;T.gte(g);){M=Math.max(1,Math.floor(T.toNumber()/g.toNumber()));for(var C=Math.ceil(Math.log(M)/Math.LN2),K=C<=48?1:v(2,C-48),L=f(M),V=L.mul(g);V.isNegative()||V.gt(T);)M-=K,L=f(M,this.unsigned),V=L.mul(g);L.isZero()&&(L=F),R=R.add(L),T=T.sub(V)}return R},c.div=c.divide,c.modulo=function(g){if(n(g)||(g=u(g)),t){var E=(this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,g.low,g.high);return l(E,t.get_high(),this.unsigned)}return this.sub(this.div(g).mul(g))},c.mod=c.modulo,c.rem=c.modulo,c.not=function(){return l(~this.low,~this.high,this.unsigned)},c.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},c.clz=c.countLeadingZeros,c.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},c.ctz=c.countTrailingZeros,c.and=function(g){return n(g)||(g=u(g)),l(this.low&g.low,this.high&g.high,this.unsigned)},c.or=function(g){return n(g)||(g=u(g)),l(this.low|g.low,this.high|g.high,this.unsigned)},c.xor=function(g){return n(g)||(g=u(g)),l(this.low^g.low,this.high^g.high,this.unsigned)},c.shiftLeft=function(g){return n(g)&&(g=g.toInt()),(g&=63)===0?this:g<32?l(this.low<<g,this.high<<g|this.low>>>32-g,this.unsigned):l(0,this.low<<g-32,this.unsigned)},c.shl=c.shiftLeft,c.shiftRight=function(g){return n(g)&&(g=g.toInt()),(g&=63)===0?this:g<32?l(this.low>>>g|this.high<<32-g,this.high>>g,this.unsigned):l(this.high>>g-32,this.high>=0?0:-1,this.unsigned)},c.shr=c.shiftRight,c.shiftRightUnsigned=function(g){return n(g)&&(g=g.toInt()),(g&=63)===0?this:g<32?l(this.low>>>g|this.high<<32-g,this.high>>>g,this.unsigned):g===32?l(this.high,0,this.unsigned):l(this.high>>>g-32,0,this.unsigned)},c.shru=c.shiftRightUnsigned,c.shr_u=c.shiftRightUnsigned,c.rotateLeft=function(g){var E;return n(g)&&(g=g.toInt()),(g&=63)===0?this:g===32?l(this.high,this.low,this.unsigned):g<32?(E=32-g,l(this.low<<g|this.high>>>E,this.high<<g|this.low>>>E,this.unsigned)):(g-=32,E=32-g,l(this.high<<g|this.low>>>E,this.low<<g|this.high>>>E,this.unsigned))},c.rotl=c.rotateLeft,c.rotateRight=function(g){var E;return n(g)&&(g=g.toInt()),(g&=63)===0?this:g===32?l(this.high,this.low,this.unsigned):g<32?(E=32-g,l(this.high<<E|this.low>>>g,this.low<<E|this.high>>>g,this.unsigned)):(g-=32,E=32-g,l(this.low<<E|this.high>>>g,this.high<<E|this.low>>>g,this.unsigned))},c.rotr=c.rotateRight,c.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},c.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},c.toBytes=function(g){return g?this.toBytesLE():this.toBytesBE()},c.toBytesLE=function(){var g=this.high,E=this.low;return[E&255,E>>>8&255,E>>>16&255,E>>>24,g&255,g>>>8&255,g>>>16&255,g>>>24]},c.toBytesBE=function(){var g=this.high,E=this.low;return[g>>>24,g>>>16&255,g>>>8&255,g&255,E>>>24,E>>>16&255,E>>>8&255,E&255]},r.fromBytes=function(g,E,M){return M?r.fromBytesLE(g,E):r.fromBytesBE(g,E)},r.fromBytesLE=function(g,E){return new r(g[0]|g[1]<<8|g[2]<<16|g[3]<<24,g[4]|g[5]<<8|g[6]<<16|g[7]<<24,E)},r.fromBytesBE=function(g,E){return new r(g[4]<<24|g[5]<<16|g[6]<<8|g[7],g[0]<<24|g[1]<<16|g[2]<<8|g[3],E)};var m=r;return e.default=m,"default"in e?e.default:e}({});typeof define=="function"&&define.amd?define([],function(){return Yx}):typeof kv=="object"&&typeof Jx=="object"&&(kv.exports=Yx)});var er=U(Ue=>{"use strict";H();k();var em=Ue&&Ue.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),VT=Ue&&Ue.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Di=Ue&&Ue.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&em(t,e,r);return VT(t,e),t},tm=Ue&&Ue.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&em(t,e,r)},_h=Ue&&Ue.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ue,"__esModule",{value:!0});Ue.secp256k1=Ue.ed25519=Ue.Long=Ue._m0=Ue.protobuf=Ue.typeforce=Ue.safeBuffer=Ue.BigNumber=Ue.BN=Ue.math=Ue.signUtil=Ue.abi=Ue.elliptic=Ue.bip39=Ue.bip32=Ue.base=void 0;Ue.base=Di(L0());Ue.bip32=Di(oy());Ue.bip39=Di(wy());Ue.elliptic=Di(bf());Ue.abi=Di(Dy());Ue.signUtil=Di(Wx());Ue.math=Di(Zx());var zT=_h(Ar());Ue.BN=zT.default;var WT=_h(ig());Ue.BigNumber=WT.default;var $T=_h(Yb());Ue.safeBuffer=$T.default;var GT=xu();Ue.typeforce=GT;Ue.protobuf=Di(ag());Ue._m0=Di(og());var XT=_h(Qx());Ue.Long=XT.default;Ue.ed25519=Di(fg());Ue.secp256k1=Di(cg());tm((dg(),b0(ug)),Ue);tm((lg(),b0(hg)),Ue)});var yt=U((Ah,rm)=>{H();k();(function(e,t){typeof Ah=="object"?rm.exports=Ah=t():typeof define=="function"&&define.amd?define([],t):e.CryptoJS=t()})(Ah,function(){var e=e||function(t,r){var n=Object.create||function(){function d(){}return function(y){var w;return d.prototype=y,w=new d,d.prototype=null,w}}(),i={},s=i.lib={},o=s.Base=function(){return{extend:function(d){var y=n(this);return d&&y.mixIn(d),(!y.hasOwnProperty("init")||this.init===y.init)&&(y.init=function(){y.$super.init.apply(this,arguments)}),y.init.prototype=y,y.$super=this,y},create:function(){var d=this.extend();return d.init.apply(d,arguments),d},init:function(){},mixIn:function(d){for(var y in d)d.hasOwnProperty(y)&&(this[y]=d[y]);d.hasOwnProperty("toString")&&(this.toString=d.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),a=s.WordArray=o.extend({init:function(d,y){d=this.words=d||[],y!=r?this.sigBytes=y:this.sigBytes=d.length*4},toString:function(d){return(d||l).stringify(this)},concat:function(d){var y=this.words,w=d.words,_=this.sigBytes,I=d.sigBytes;if(this.clamp(),_%4)for(var N=0;N<I;N++){var F=w[N>>>2]>>>24-N%4*8&255;y[_+N>>>2]|=F<<24-(_+N)%4*8}else for(var N=0;N<I;N+=4)y[_+N>>>2]=w[N>>>2];return this.sigBytes+=I,this},clamp:function(){var d=this.words,y=this.sigBytes;d[y>>>2]&=4294967295<<32-y%4*8,d.length=t.ceil(y/4)},clone:function(){var d=o.clone.call(this);return d.words=this.words.slice(0),d},random:function(d){for(var y=[],w=function(O){var O=O,q=987654321,P=4294967295;return function(){q=36969*(q&65535)+(q>>16)&P,O=18e3*(O&65535)+(O>>16)&P;var D=(q<<16)+O&P;return D/=4294967296,D+=.5,D*(t.random()>.5?1:-1)}},_=0,I;_<d;_+=4){var N=w((I||t.random())*4294967296);I=N()*987654071,y.push(N()*4294967296|0)}return new a.init(y,d)}}),f=i.enc={},l=f.Hex={stringify:function(d){for(var y=d.words,w=d.sigBytes,_=[],I=0;I<w;I++){var N=y[I>>>2]>>>24-I%4*8&255;_.push((N>>>4).toString(16)),_.push((N&15).toString(16))}return _.join("")},parse:function(d){for(var y=d.length,w=[],_=0;_<y;_+=2)w[_>>>3]|=parseInt(d.substr(_,2),16)<<24-_%8*4;return new a.init(w,y/2)}},v=f.Latin1={stringify:function(d){for(var y=d.words,w=d.sigBytes,_=[],I=0;I<w;I++){var N=y[I>>>2]>>>24-I%4*8&255;_.push(String.fromCharCode(N))}return _.join("")},parse:function(d){for(var y=d.length,w=[],_=0;_<y;_++)w[_>>>2]|=(d.charCodeAt(_)&255)<<24-_%4*8;return new a.init(w,y)}},p=f.Utf8={stringify:function(d){try{return decodeURIComponent(escape(v.stringify(d)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(d){return v.parse(unescape(encodeURIComponent(d)))}},u=s.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(d){typeof d=="string"&&(d=p.parse(d)),this._data.concat(d),this._nDataBytes+=d.sigBytes},_process:function(d){var y=this._data,w=y.words,_=y.sigBytes,I=this.blockSize,N=I*4,F=_/N;d?F=t.ceil(F):F=t.max((F|0)-this._minBufferSize,0);var O=F*I,q=t.min(O*4,_);if(O){for(var P=0;P<O;P+=I)this._doProcessBlock(w,P);var D=w.splice(0,O);y.sigBytes-=q}return new a.init(D,q)},clone:function(){var d=o.clone.call(this);return d._data=this._data.clone(),d},_minBufferSize:0}),h=s.Hasher=u.extend({cfg:o.extend(),init:function(d){this.cfg=this.cfg.extend(d),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(d){return this._append(d),this._process(),this},finalize:function(d){d&&this._append(d);var y=this._doFinalize();return y},blockSize:512/32,_createHelper:function(d){return function(y,w){return new d.init(w).finalize(y)}},_createHmacHelper:function(d){return function(y,w){return new b.HMAC.init(d,w).finalize(y)}}}),b=i.algo={};return i}(Math);return e})});var Gc=U((Bh,nm)=>{H();k();(function(e,t){typeof Bh=="object"?nm.exports=Bh=t(yt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(Bh,function(e){return function(t){var r=e,n=r.lib,i=n.Base,s=n.WordArray,o=r.x64={},a=o.Word=i.extend({init:function(l,v){this.high=l,this.low=v}}),f=o.WordArray=i.extend({init:function(l,v){l=this.words=l||[],v!=t?this.sigBytes=v:this.sigBytes=l.length*8},toX32:function(){for(var l=this.words,v=l.length,p=[],u=0;u<v;u++){var h=l[u];p.push(h.high),p.push(h.low)}return s.create(p,this.sigBytes)},clone:function(){for(var l=i.clone.call(this),v=l.words=this.words.slice(0),p=v.length,u=0;u<p;u++)v[u]=v[u].clone();return l}})}(),e})});var sm=U((Ph,im)=>{H();k();(function(e,t){typeof Ph=="object"?im.exports=Ph=t(yt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(Ph,function(e){return function(){if(typeof ArrayBuffer=="function"){var t=e,r=t.lib,n=r.WordArray,i=n.init,s=n.init=function(o){if(o instanceof ArrayBuffer&&(o=new Uint8Array(o)),(o instanceof Int8Array||typeof Uint8ClampedArray<"u"&&o instanceof Uint8ClampedArray||o instanceof Int16Array||o instanceof Uint16Array||o instanceof Int32Array||o instanceof Uint32Array||o instanceof Float32Array||o instanceof Float64Array)&&(o=new Uint8Array(o.buffer,o.byteOffset,o.byteLength)),o instanceof Uint8Array){for(var a=o.byteLength,f=[],l=0;l<a;l++)f[l>>>2]|=o[l]<<24-l%4*8;i.call(this,f,a)}else i.apply(this,arguments)};s.prototype=n}}(),e.lib.WordArray})});var om=U((Ih,am)=>{H();k();(function(e,t){typeof Ih=="object"?am.exports=Ih=t(yt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(Ih,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=t.enc,s=i.Utf16=i.Utf16BE={stringify:function(a){for(var f=a.words,l=a.sigBytes,v=[],p=0;p<l;p+=2){var u=f[p>>>2]>>>16-p%4*8&65535;v.push(String.fromCharCode(u))}return v.join("")},parse:function(a){for(var f=a.length,l=[],v=0;v<f;v++)l[v>>>1]|=a.charCodeAt(v)<<16-v%2*16;return n.create(l,f*2)}};i.Utf16LE={stringify:function(a){for(var f=a.words,l=a.sigBytes,v=[],p=0;p<l;p+=2){var u=o(f[p>>>2]>>>16-p%4*8&65535);v.push(String.fromCharCode(u))}return v.join("")},parse:function(a){for(var f=a.length,l=[],v=0;v<f;v++)l[v>>>1]|=o(a.charCodeAt(v)<<16-v%2*16);return n.create(l,f*2)}};function o(a){return a<<8&4278255360|a>>>8&16711935}}(),e.enc.Utf16})});var ro=U((Mh,fm)=>{H();k();(function(e,t){typeof Mh=="object"?fm.exports=Mh=t(yt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(Mh,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=t.enc,s=i.Base64={stringify:function(a){var f=a.words,l=a.sigBytes,v=this._map;a.clamp();for(var p=[],u=0;u<l;u+=3)for(var h=f[u>>>2]>>>24-u%4*8&255,b=f[u+1>>>2]>>>24-(u+1)%4*8&255,d=f[u+2>>>2]>>>24-(u+2)%4*8&255,y=h<<16|b<<8|d,w=0;w<4&&u+w*.75<l;w++)p.push(v.charAt(y>>>6*(3-w)&63));var _=v.charAt(64);if(_)for(;p.length%4;)p.push(_);return p.join("")},parse:function(a){var f=a.length,l=this._map,v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var p=0;p<l.length;p++)v[l.charCodeAt(p)]=p}var u=l.charAt(64);if(u){var h=a.indexOf(u);h!==-1&&(f=h)}return o(a,f,v)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(a,f,l){for(var v=[],p=0,u=0;u<f;u++)if(u%4){var h=l[a.charCodeAt(u-1)]<<u%4*2,b=l[a.charCodeAt(u)]>>>6-u%4*2;v[p>>>2]|=(h|b)<<24-p%4*8,p++}return n.create(v,p)}}(),e.enc.Base64})});var no=U((Ch,cm)=>{H();k();(function(e,t){typeof Ch=="object"?cm.exports=Ch=t(yt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(Ch,function(e){return function(t){var r=e,n=r.lib,i=n.WordArray,s=n.Hasher,o=r.algo,a=[];(function(){for(var h=0;h<64;h++)a[h]=t.abs(t.sin(h+1))*4294967296|0})();var f=o.MD5=s.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(h,b){for(var d=0;d<16;d++){var y=b+d,w=h[y];h[y]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360}var _=this._hash.words,I=h[b+0],N=h[b+1],F=h[b+2],O=h[b+3],q=h[b+4],P=h[b+5],D=h[b+6],A=h[b+7],c=h[b+8],m=h[b+9],S=h[b+10],g=h[b+11],E=h[b+12],M=h[b+13],T=h[b+14],R=h[b+15],x=_[0],C=_[1],K=_[2],L=_[3];x=l(x,C,K,L,I,7,a[0]),L=l(L,x,C,K,N,12,a[1]),K=l(K,L,x,C,F,17,a[2]),C=l(C,K,L,x,O,22,a[3]),x=l(x,C,K,L,q,7,a[4]),L=l(L,x,C,K,P,12,a[5]),K=l(K,L,x,C,D,17,a[6]),C=l(C,K,L,x,A,22,a[7]),x=l(x,C,K,L,c,7,a[8]),L=l(L,x,C,K,m,12,a[9]),K=l(K,L,x,C,S,17,a[10]),C=l(C,K,L,x,g,22,a[11]),x=l(x,C,K,L,E,7,a[12]),L=l(L,x,C,K,M,12,a[13]),K=l(K,L,x,C,T,17,a[14]),C=l(C,K,L,x,R,22,a[15]),x=v(x,C,K,L,N,5,a[16]),L=v(L,x,C,K,D,9,a[17]),K=v(K,L,x,C,g,14,a[18]),C=v(C,K,L,x,I,20,a[19]),x=v(x,C,K,L,P,5,a[20]),L=v(L,x,C,K,S,9,a[21]),K=v(K,L,x,C,R,14,a[22]),C=v(C,K,L,x,q,20,a[23]),x=v(x,C,K,L,m,5,a[24]),L=v(L,x,C,K,T,9,a[25]),K=v(K,L,x,C,O,14,a[26]),C=v(C,K,L,x,c,20,a[27]),x=v(x,C,K,L,M,5,a[28]),L=v(L,x,C,K,F,9,a[29]),K=v(K,L,x,C,A,14,a[30]),C=v(C,K,L,x,E,20,a[31]),x=p(x,C,K,L,P,4,a[32]),L=p(L,x,C,K,c,11,a[33]),K=p(K,L,x,C,g,16,a[34]),C=p(C,K,L,x,T,23,a[35]),x=p(x,C,K,L,N,4,a[36]),L=p(L,x,C,K,q,11,a[37]),K=p(K,L,x,C,A,16,a[38]),C=p(C,K,L,x,S,23,a[39]),x=p(x,C,K,L,M,4,a[40]),L=p(L,x,C,K,I,11,a[41]),K=p(K,L,x,C,O,16,a[42]),C=p(C,K,L,x,D,23,a[43]),x=p(x,C,K,L,m,4,a[44]),L=p(L,x,C,K,E,11,a[45]),K=p(K,L,x,C,R,16,a[46]),C=p(C,K,L,x,F,23,a[47]),x=u(x,C,K,L,I,6,a[48]),L=u(L,x,C,K,A,10,a[49]),K=u(K,L,x,C,T,15,a[50]),C=u(C,K,L,x,P,21,a[51]),x=u(x,C,K,L,E,6,a[52]),L=u(L,x,C,K,O,10,a[53]),K=u(K,L,x,C,S,15,a[54]),C=u(C,K,L,x,N,21,a[55]),x=u(x,C,K,L,c,6,a[56]),L=u(L,x,C,K,R,10,a[57]),K=u(K,L,x,C,D,15,a[58]),C=u(C,K,L,x,M,21,a[59]),x=u(x,C,K,L,q,6,a[60]),L=u(L,x,C,K,g,10,a[61]),K=u(K,L,x,C,F,15,a[62]),C=u(C,K,L,x,m,21,a[63]),_[0]=_[0]+x|0,_[1]=_[1]+C|0,_[2]=_[2]+K|0,_[3]=_[3]+L|0},_doFinalize:function(){var h=this._data,b=h.words,d=this._nDataBytes*8,y=h.sigBytes*8;b[y>>>5]|=128<<24-y%32;var w=t.floor(d/4294967296),_=d;b[(y+64>>>9<<4)+15]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,b[(y+64>>>9<<4)+14]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,h.sigBytes=(b.length+1)*4,this._process();for(var I=this._hash,N=I.words,F=0;F<4;F++){var O=N[F];N[F]=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360}return I},clone:function(){var h=s.clone.call(this);return h._hash=this._hash.clone(),h}});function l(h,b,d,y,w,_,I){var N=h+(b&d|~b&y)+w+I;return(N<<_|N>>>32-_)+b}function v(h,b,d,y,w,_,I){var N=h+(b&y|d&~y)+w+I;return(N<<_|N>>>32-_)+b}function p(h,b,d,y,w,_,I){var N=h+(b^d^y)+w+I;return(N<<_|N>>>32-_)+b}function u(h,b,d,y,w,_,I){var N=h+(d^(b|~y))+w+I;return(N<<_|N>>>32-_)+b}r.MD5=s._createHelper(f),r.HmacMD5=s._createHmacHelper(f)}(Math),e.MD5})});var Nh=U((Fh,um)=>{H();k();(function(e,t){typeof Fh=="object"?um.exports=Fh=t(yt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(Fh,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=r.Hasher,s=t.algo,o=[],a=s.SHA1=i.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(f,l){for(var v=this._hash.words,p=v[0],u=v[1],h=v[2],b=v[3],d=v[4],y=0;y<80;y++){if(y<16)o[y]=f[l+y]|0;else{var w=o[y-3]^o[y-8]^o[y-14]^o[y-16];o[y]=w<<1|w>>>31}var _=(p<<5|p>>>27)+d+o[y];y<20?_+=(u&h|~u&b)+1518500249:y<40?_+=(u^h^b)+1859775393:y<60?_+=(u&h|u&b|h&b)-1894007588:_+=(u^h^b)-899497514,d=b,b=h,h=u<<30|u>>>2,u=p,p=_}v[0]=v[0]+p|0,v[1]=v[1]+u|0,v[2]=v[2]+h|0,v[3]=v[3]+b|0,v[4]=v[4]+d|0},_doFinalize:function(){var f=this._data,l=f.words,v=this._nDataBytes*8,p=f.sigBytes*8;return l[p>>>5]|=128<<24-p%32,l[(p+64>>>9<<4)+14]=Math.floor(v/4294967296),l[(p+64>>>9<<4)+15]=v,f.sigBytes=l.length*4,this._process(),this._hash},clone:function(){var f=i.clone.call(this);return f._hash=this._hash.clone(),f}});t.SHA1=i._createHelper(a),t.HmacSHA1=i._createHmacHelper(a)}(),e.SHA1})});var jv=U((Rh,dm)=>{H();k();(function(e,t){typeof Rh=="object"?dm.exports=Rh=t(yt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(Rh,function(e){return function(t){var r=e,n=r.lib,i=n.WordArray,s=n.Hasher,o=r.algo,a=[],f=[];(function(){function p(d){for(var y=t.sqrt(d),w=2;w<=y;w++)if(!(d%w))return!1;return!0}function u(d){return(d-(d|0))*4294967296|0}for(var h=2,b=0;b<64;)p(h)&&(b<8&&(a[b]=u(t.pow(h,1/2))),f[b]=u(t.pow(h,1/3)),b++),h++})();var l=[],v=o.SHA256=s.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(p,u){for(var h=this._hash.words,b=h[0],d=h[1],y=h[2],w=h[3],_=h[4],I=h[5],N=h[6],F=h[7],O=0;O<64;O++){if(O<16)l[O]=p[u+O]|0;else{var q=l[O-15],P=(q<<25|q>>>7)^(q<<14|q>>>18)^q>>>3,D=l[O-2],A=(D<<15|D>>>17)^(D<<13|D>>>19)^D>>>10;l[O]=P+l[O-7]+A+l[O-16]}var c=_&I^~_&N,m=b&d^b&y^d&y,S=(b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22),g=(_<<26|_>>>6)^(_<<21|_>>>11)^(_<<7|_>>>25),E=F+g+c+f[O]+l[O],M=S+m;F=N,N=I,I=_,_=w+E|0,w=y,y=d,d=b,b=E+M|0}h[0]=h[0]+b|0,h[1]=h[1]+d|0,h[2]=h[2]+y|0,h[3]=h[3]+w|0,h[4]=h[4]+_|0,h[5]=h[5]+I|0,h[6]=h[6]+N|0,h[7]=h[7]+F|0},_doFinalize:function(){var p=this._data,u=p.words,h=this._nDataBytes*8,b=p.sigBytes*8;return u[b>>>5]|=128<<24-b%32,u[(b+64>>>9<<4)+14]=t.floor(h/4294967296),u[(b+64>>>9<<4)+15]=h,p.sigBytes=u.length*4,this._process(),this._hash},clone:function(){var p=s.clone.call(this);return p._hash=this._hash.clone(),p}});r.SHA256=s._createHelper(v),r.HmacSHA256=s._createHmacHelper(v)}(Math),e.SHA256})});var lm=U((Oh,hm)=>{H();k();(function(e,t,r){typeof Oh=="object"?hm.exports=Oh=t(yt(),jv()):typeof define=="function"&&define.amd?define(["./core","./sha256"],t):t(e.CryptoJS)})(Oh,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=t.algo,s=i.SHA256,o=i.SHA224=s.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var a=s._doFinalize.call(this);return a.sigBytes-=4,a}});t.SHA224=s._createHelper(o),t.HmacSHA224=s._createHmacHelper(o)}(),e.SHA224})});var Lv=U((Dh,pm)=>{H();k();(function(e,t,r){typeof Dh=="object"?pm.exports=Dh=t(yt(),Gc()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],t):t(e.CryptoJS)})(Dh,function(e){return function(){var t=e,r=t.lib,n=r.Hasher,i=t.x64,s=i.Word,o=i.WordArray,a=t.algo;function f(){return s.create.apply(s,arguments)}var l=[f(1116352408,3609767458),f(1899447441,602891725),f(3049323471,3964484399),f(3921009573,2173295548),f(961987163,4081628472),f(1508970993,3053834265),f(2453635748,2937671579),f(2870763221,3664609560),f(3624381080,2734883394),f(310598401,1164996542),f(607225278,1323610764),f(1426881987,3590304994),f(1925078388,4068182383),f(2162078206,991336113),f(2614888103,633803317),f(3248222580,3479774868),f(3835390401,2666613458),f(4022224774,944711139),f(264347078,2341262773),f(604807628,2007800933),f(770255983,1495990901),f(1249150122,1856431235),f(1555081692,3175218132),f(1996064986,2198950837),f(2554220882,3999719339),f(2821834349,766784016),f(2952996808,2566594879),f(3210313671,3203337956),f(3336571891,1034457026),f(3584528711,2466948901),f(113926993,3758326383),f(338241895,168717936),f(666307205,1188179964),f(773529912,1546045734),f(1294757372,1522805485),f(1396182291,2643833823),f(1695183700,2343527390),f(1986661051,1014477480),f(2177026350,1206759142),f(2456956037,344077627),f(2730485921,1290863460),f(2820302411,3158454273),f(3259730800,3505952657),f(3345764771,106217008),f(3516065817,3606008344),f(3600352804,1432725776),f(4094571909,1467031594),f(275423344,851169720),f(430227734,3100823752),f(506948616,1363258195),f(659060556,3750685593),f(883997877,3785050280),f(958139571,3318307427),f(1322822218,3812723403),f(1537002063,2003034995),f(1747873779,3602036899),f(1955562222,1575990012),f(2024104815,1125592928),f(2227730452,2716904306),f(2361852424,442776044),f(2428436474,593698344),f(2756734187,3733110249),f(3204031479,2999351573),f(3329325298,3815920427),f(3391569614,3928383900),f(3515267271,566280711),f(3940187606,3454069534),f(4118630271,4000239992),f(116418474,1914138554),f(174292421,2731055270),f(289380356,3203993006),f(460393269,320620315),f(685471733,587496836),f(852142971,1086792851),f(1017036298,365543100),f(1126000580,2618297676),f(1288033470,3409855158),f(1501505948,4234509866),f(1607167915,987167468),f(1816402316,1246189591)],v=[];(function(){for(var u=0;u<80;u++)v[u]=f()})();var p=a.SHA512=n.extend({_doReset:function(){this._hash=new o.init([new s.init(1779033703,4089235720),new s.init(3144134277,2227873595),new s.init(1013904242,4271175723),new s.init(2773480762,1595750129),new s.init(1359893119,2917565137),new s.init(2600822924,725511199),new s.init(528734635,4215389547),new s.init(1541459225,327033209)])},_doProcessBlock:function(u,h){for(var b=this._hash.words,d=b[0],y=b[1],w=b[2],_=b[3],I=b[4],N=b[5],F=b[6],O=b[7],q=d.high,P=d.low,D=y.high,A=y.low,c=w.high,m=w.low,S=_.high,g=_.low,E=I.high,M=I.low,T=N.high,R=N.low,x=F.high,C=F.low,K=O.high,L=O.low,V=q,z=P,G=D,$=A,oe=c,Q=m,te=S,ve=g,J=E,Z=M,Ce=T,se=R,re=x,ft=C,_e=K,be=L,Bt=0;Bt<80;Bt++){var ge=v[Bt];if(Bt<16)var pe=ge.high=u[h+Bt*2]|0,Pt=ge.low=u[h+Bt*2+1]|0;else{var Fe=v[Bt-15],ie=Fe.high,Rt=Fe.low,ae=(ie>>>1|Rt<<31)^(ie>>>8|Rt<<24)^ie>>>7,Ee=(Rt>>>1|ie<<31)^(Rt>>>8|ie<<24)^(Rt>>>7|ie<<25),bi=v[Bt-2],Ae=bi.high,Ie=bi.low,ws=(Ae>>>19|Ie<<13)^(Ae<<3|Ie>>>29)^Ae>>>6,Ne=(Ie>>>19|Ae<<13)^(Ie<<3|Ae>>>29)^(Ie>>>6|Ae<<26),Re=v[Bt-7],Ss=Re.high,Ve=Re.low,Oe=v[Bt-16],Es=Oe.high,De=Oe.low,Pt=Ee+Ve,pe=ae+Ss+(Pt>>>0<Ee>>>0?1:0),Pt=Pt+Ne,pe=pe+ws+(Pt>>>0<Ne>>>0?1:0),Pt=Pt+De,pe=pe+Es+(Pt>>>0<De>>>0?1:0);ge.high=pe,ge.low=Pt}var ze=J&Ce^~J&re,gi=Z&se^~Z&ft,We=V&G^V&oe^G&oe,$e=z&$^z&Q^$&Q,_s=(V>>>28|z<<4)^(V<<30|z>>>2)^(V<<25|z>>>7),Te=(z>>>28|V<<4)^(z<<30|V>>>2)^(z<<25|V>>>7),Ge=(J>>>14|Z<<18)^(J>>>18|Z<<14)^(J<<23|Z>>>9),As=(Z>>>14|J<<18)^(Z>>>18|J<<14)^(Z<<23|J>>>9),qe=l[Bt],Xe=qe.high,yi=qe.low,ue=be+As,me=_e+Ge+(ue>>>0<be>>>0?1:0),ue=ue+gi,me=me+ze+(ue>>>0<gi>>>0?1:0),ue=ue+yi,me=me+Xe+(ue>>>0<yi>>>0?1:0),ue=ue+Pt,me=me+pe+(ue>>>0<Pt>>>0?1:0),xi=Te+$e,Ze=_s+We+(xi>>>0<Te>>>0?1:0);_e=re,be=ft,re=Ce,ft=se,Ce=J,se=Z,Z=ve+ue|0,J=te+me+(Z>>>0<ve>>>0?1:0)|0,te=oe,ve=Q,oe=G,Q=$,G=V,$=z,z=ue+xi|0,V=me+Ze+(z>>>0<ue>>>0?1:0)|0}P=d.low=P+z,d.high=q+V+(P>>>0<z>>>0?1:0),A=y.low=A+$,y.high=D+G+(A>>>0<$>>>0?1:0),m=w.low=m+Q,w.high=c+oe+(m>>>0<Q>>>0?1:0),g=_.low=g+ve,_.high=S+te+(g>>>0<ve>>>0?1:0),M=I.low=M+Z,I.high=E+J+(M>>>0<Z>>>0?1:0),R=N.low=R+se,N.high=T+Ce+(R>>>0<se>>>0?1:0),C=F.low=C+ft,F.high=x+re+(C>>>0<ft>>>0?1:0),L=O.low=L+be,O.high=K+_e+(L>>>0<be>>>0?1:0)},_doFinalize:function(){var u=this._data,h=u.words,b=this._nDataBytes*8,d=u.sigBytes*8;h[d>>>5]|=128<<24-d%32,h[(d+128>>>10<<5)+30]=Math.floor(b/4294967296),h[(d+128>>>10<<5)+31]=b,u.sigBytes=h.length*4,this._process();var y=this._hash.toX32();return y},clone:function(){var u=n.clone.call(this);return u._hash=this._hash.clone(),u},blockSize:1024/32});t.SHA512=n._createHelper(p),t.HmacSHA512=n._createHmacHelper(p)}(),e.SHA512})});var bm=U((Th,vm)=>{H();k();(function(e,t,r){typeof Th=="object"?vm.exports=Th=t(yt(),Gc(),Lv()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./sha512"],t):t(e.CryptoJS)})(Th,function(e){return function(){var t=e,r=t.x64,n=r.Word,i=r.WordArray,s=t.algo,o=s.SHA512,a=s.SHA384=o.extend({_doReset:function(){this._hash=new i.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var f=o._doFinalize.call(this);return f.sigBytes-=16,f}});t.SHA384=o._createHelper(a),t.HmacSHA384=o._createHmacHelper(a)}(),e.SHA384})});var ym=U((qh,gm)=>{H();k();(function(e,t,r){typeof qh=="object"?gm.exports=qh=t(yt(),Gc()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],t):t(e.CryptoJS)})(qh,function(e){return function(t){var r=e,n=r.lib,i=n.WordArray,s=n.Hasher,o=r.x64,a=o.Word,f=r.algo,l=[],v=[],p=[];(function(){for(var b=1,d=0,y=0;y<24;y++){l[b+5*d]=(y+1)*(y+2)/2%64;var w=d%5,_=(2*b+3*d)%5;b=w,d=_}for(var b=0;b<5;b++)for(var d=0;d<5;d++)v[b+5*d]=d+(2*b+3*d)%5*5;for(var I=1,N=0;N<24;N++){for(var F=0,O=0,q=0;q<7;q++){if(I&1){var P=(1<<q)-1;P<32?O^=1<<P:F^=1<<P-32}I&128?I=I<<1^113:I<<=1}p[N]=a.create(F,O)}})();var u=[];(function(){for(var b=0;b<25;b++)u[b]=a.create()})();var h=f.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){for(var b=this._state=[],d=0;d<25;d++)b[d]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(b,d){for(var y=this._state,w=this.blockSize/2,_=0;_<w;_++){var I=b[d+2*_],N=b[d+2*_+1];I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,N=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360;var F=y[_];F.high^=N,F.low^=I}for(var O=0;O<24;O++){for(var q=0;q<5;q++){for(var P=0,D=0,A=0;A<5;A++){var F=y[q+5*A];P^=F.high,D^=F.low}var c=u[q];c.high=P,c.low=D}for(var q=0;q<5;q++)for(var m=u[(q+4)%5],S=u[(q+1)%5],g=S.high,E=S.low,P=m.high^(g<<1|E>>>31),D=m.low^(E<<1|g>>>31),A=0;A<5;A++){var F=y[q+5*A];F.high^=P,F.low^=D}for(var M=1;M<25;M++){var F=y[M],T=F.high,R=F.low,x=l[M];if(x<32)var P=T<<x|R>>>32-x,D=R<<x|T>>>32-x;else var P=R<<x-32|T>>>64-x,D=T<<x-32|R>>>64-x;var C=u[v[M]];C.high=P,C.low=D}var K=u[0],L=y[0];K.high=L.high,K.low=L.low;for(var q=0;q<5;q++)for(var A=0;A<5;A++){var M=q+5*A,F=y[M],V=u[M],z=u[(q+1)%5+5*A],G=u[(q+2)%5+5*A];F.high=V.high^~z.high&G.high,F.low=V.low^~z.low&G.low}var F=y[0],$=p[O];F.high^=$.high,F.low^=$.low}},_doFinalize:function(){var b=this._data,d=b.words,y=this._nDataBytes*8,w=b.sigBytes*8,_=this.blockSize*32;d[w>>>5]|=1<<24-w%32,d[(t.ceil((w+1)/_)*_>>>5)-1]|=128,b.sigBytes=d.length*4,this._process();for(var I=this._state,N=this.cfg.outputLength/8,F=N/8,O=[],q=0;q<F;q++){var P=I[q],D=P.high,A=P.low;D=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,O.push(A),O.push(D)}return new i.init(O,N)},clone:function(){for(var b=s.clone.call(this),d=b._state=this._state.slice(0),y=0;y<25;y++)d[y]=d[y].clone();return b}});r.SHA3=s._createHelper(h),r.HmacSHA3=s._createHmacHelper(h)}(Math),e.SHA3})});var mm=U((Hh,xm)=>{H();k();(function(e,t){typeof Hh=="object"?xm.exports=Hh=t(yt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(Hh,function(e){return function(t){var r=e,n=r.lib,i=n.WordArray,s=n.Hasher,o=r.algo,a=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),f=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),v=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=i.create([0,1518500249,1859775393,2400959708,2840853838]),u=i.create([1352829926,1548603684,1836072691,2053994217,0]),h=o.RIPEMD160=s.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(N,F){for(var O=0;O<16;O++){var q=F+O,P=N[q];N[q]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}var D=this._hash.words,A=p.words,c=u.words,m=a.words,S=f.words,g=l.words,E=v.words,M,T,R,x,C,K,L,V,z,G;K=M=D[0],L=T=D[1],V=R=D[2],z=x=D[3],G=C=D[4];for(var $,O=0;O<80;O+=1)$=M+N[F+m[O]]|0,O<16?$+=b(T,R,x)+A[0]:O<32?$+=d(T,R,x)+A[1]:O<48?$+=y(T,R,x)+A[2]:O<64?$+=w(T,R,x)+A[3]:$+=_(T,R,x)+A[4],$=$|0,$=I($,g[O]),$=$+C|0,M=C,C=x,x=I(R,10),R=T,T=$,$=K+N[F+S[O]]|0,O<16?$+=_(L,V,z)+c[0]:O<32?$+=w(L,V,z)+c[1]:O<48?$+=y(L,V,z)+c[2]:O<64?$+=d(L,V,z)+c[3]:$+=b(L,V,z)+c[4],$=$|0,$=I($,E[O]),$=$+G|0,K=G,G=z,z=I(V,10),V=L,L=$;$=D[1]+R+z|0,D[1]=D[2]+x+G|0,D[2]=D[3]+C+K|0,D[3]=D[4]+M+L|0,D[4]=D[0]+T+V|0,D[0]=$},_doFinalize:function(){var N=this._data,F=N.words,O=this._nDataBytes*8,q=N.sigBytes*8;F[q>>>5]|=128<<24-q%32,F[(q+64>>>9<<4)+14]=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360,N.sigBytes=(F.length+1)*4,this._process();for(var P=this._hash,D=P.words,A=0;A<5;A++){var c=D[A];D[A]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360}return P},clone:function(){var N=s.clone.call(this);return N._hash=this._hash.clone(),N}});function b(N,F,O){return N^F^O}function d(N,F,O){return N&F|~N&O}function y(N,F,O){return(N|~F)^O}function w(N,F,O){return N&O|F&~O}function _(N,F,O){return N^(F|~O)}function I(N,F){return N<<F|N>>>32-F}r.RIPEMD160=s._createHelper(h),r.HmacRIPEMD160=s._createHmacHelper(h)}(Math),e.RIPEMD160})});var jh=U((kh,wm)=>{H();k();(function(e,t){typeof kh=="object"?wm.exports=kh=t(yt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(kh,function(e){(function(){var t=e,r=t.lib,n=r.Base,i=t.enc,s=i.Utf8,o=t.algo,a=o.HMAC=n.extend({init:function(f,l){f=this._hasher=new f.init,typeof l=="string"&&(l=s.parse(l));var v=f.blockSize,p=v*4;l.sigBytes>p&&(l=f.finalize(l)),l.clamp();for(var u=this._oKey=l.clone(),h=this._iKey=l.clone(),b=u.words,d=h.words,y=0;y<v;y++)b[y]^=1549556828,d[y]^=909522486;u.sigBytes=h.sigBytes=p,this.reset()},reset:function(){var f=this._hasher;f.reset(),f.update(this._iKey)},update:function(f){return this._hasher.update(f),this},finalize:function(f){var l=this._hasher,v=l.finalize(f);l.reset();var p=l.finalize(this._oKey.clone().concat(v));return p}})})()})});var Em=U((Lh,Sm)=>{H();k();(function(e,t,r){typeof Lh=="object"?Sm.exports=Lh=t(yt(),Nh(),jh()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],t):t(e.CryptoJS)})(Lh,function(e){return function(){var t=e,r=t.lib,n=r.Base,i=r.WordArray,s=t.algo,o=s.SHA1,a=s.HMAC,f=s.PBKDF2=n.extend({cfg:n.extend({keySize:128/32,hasher:o,iterations:1}),init:function(l){this.cfg=this.cfg.extend(l)},compute:function(l,v){for(var p=this.cfg,u=a.create(p.hasher,l),h=i.create(),b=i.create([1]),d=h.words,y=b.words,w=p.keySize,_=p.iterations;d.length<w;){var I=u.update(v).finalize(b);u.reset();for(var N=I.words,F=N.length,O=I,q=1;q<_;q++){O=u.finalize(O),u.reset();for(var P=O.words,D=0;D<F;D++)N[D]^=P[D]}h.concat(I),y[0]++}return h.sigBytes=w*4,h}});t.PBKDF2=function(l,v,p){return f.create(p).compute(l,v)}}(),e.PBKDF2})});var Ka=U((Kh,_m)=>{H();k();(function(e,t,r){typeof Kh=="object"?_m.exports=Kh=t(yt(),Nh(),jh()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],t):t(e.CryptoJS)})(Kh,function(e){return function(){var t=e,r=t.lib,n=r.Base,i=r.WordArray,s=t.algo,o=s.MD5,a=s.EvpKDF=n.extend({cfg:n.extend({keySize:128/32,hasher:o,iterations:1}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,l){for(var v=this.cfg,p=v.hasher.create(),u=i.create(),h=u.words,b=v.keySize,d=v.iterations;h.length<b;){y&&p.update(y);var y=p.update(f).finalize(l);p.reset();for(var w=1;w<d;w++)y=p.finalize(y),p.reset();u.concat(y)}return u.sigBytes=b*4,u}});t.EvpKDF=function(f,l,v){return a.create(v).compute(f,l)}}(),e.EvpKDF})});var Lr=U((Uh,Am)=>{H();k();(function(e,t,r){typeof Uh=="object"?Am.exports=Uh=t(yt(),Ka()):typeof define=="function"&&define.amd?define(["./core","./evpkdf"],t):t(e.CryptoJS)})(Uh,function(e){e.lib.Cipher||function(t){var r=e,n=r.lib,i=n.Base,s=n.WordArray,o=n.BufferedBlockAlgorithm,a=r.enc,f=a.Utf8,l=a.Base64,v=r.algo,p=v.EvpKDF,u=n.Cipher=o.extend({cfg:i.extend(),createEncryptor:function(c,m){return this.create(this._ENC_XFORM_MODE,c,m)},createDecryptor:function(c,m){return this.create(this._DEC_XFORM_MODE,c,m)},init:function(c,m,S){this.cfg=this.cfg.extend(S),this._xformMode=c,this._key=m,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(c){return this._append(c),this._process()},finalize:function(c){c&&this._append(c);var m=this._doFinalize();return m},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function c(m){return typeof m=="string"?A:q}return function(m){return{encrypt:function(S,g,E){return c(g).encrypt(m,S,g,E)},decrypt:function(S,g,E){return c(g).decrypt(m,S,g,E)}}}}()}),h=n.StreamCipher=u.extend({_doFinalize:function(){var c=this._process(!0);return c},blockSize:1}),b=r.mode={},d=n.BlockCipherMode=i.extend({createEncryptor:function(c,m){return this.Encryptor.create(c,m)},createDecryptor:function(c,m){return this.Decryptor.create(c,m)},init:function(c,m){this._cipher=c,this._iv=m}}),y=b.CBC=function(){var c=d.extend();c.Encryptor=c.extend({processBlock:function(S,g){var E=this._cipher,M=E.blockSize;m.call(this,S,g,M),E.encryptBlock(S,g),this._prevBlock=S.slice(g,g+M)}}),c.Decryptor=c.extend({processBlock:function(S,g){var E=this._cipher,M=E.blockSize,T=S.slice(g,g+M);E.decryptBlock(S,g),m.call(this,S,g,M),this._prevBlock=T}});function m(S,g,E){var M=this._iv;if(M){var T=M;this._iv=t}else var T=this._prevBlock;for(var R=0;R<E;R++)S[g+R]^=T[R]}return c}(),w=r.pad={},_=w.Pkcs7={pad:function(c,m){for(var S=m*4,g=S-c.sigBytes%S,E=g<<24|g<<16|g<<8|g,M=[],T=0;T<g;T+=4)M.push(E);var R=s.create(M,g);c.concat(R)},unpad:function(c){var m=c.words[c.sigBytes-1>>>2]&255;c.sigBytes-=m}},I=n.BlockCipher=u.extend({cfg:u.cfg.extend({mode:y,padding:_}),reset:function(){u.reset.call(this);var c=this.cfg,m=c.iv,S=c.mode;if(this._xformMode==this._ENC_XFORM_MODE)var g=S.createEncryptor;else{var g=S.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==g?this._mode.init(this,m&&m.words):(this._mode=g.call(S,this,m&&m.words),this._mode.__creator=g)},_doProcessBlock:function(c,m){this._mode.processBlock(c,m)},_doFinalize:function(){var c=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){c.pad(this._data,this.blockSize);var m=this._process(!0)}else{var m=this._process(!0);c.unpad(m)}return m},blockSize:128/32}),N=n.CipherParams=i.extend({init:function(c){this.mixIn(c)},toString:function(c){return(c||this.formatter).stringify(this)}}),F=r.format={},O=F.OpenSSL={stringify:function(c){var m=c.ciphertext,S=c.salt;if(S)var g=s.create([1398893684,1701076831]).concat(S).concat(m);else var g=m;return g.toString(l)},parse:function(c){var m=l.parse(c),S=m.words;if(S[0]==1398893684&&S[1]==1701076831){var g=s.create(S.slice(2,4));S.splice(0,4),m.sigBytes-=16}return N.create({ciphertext:m,salt:g})}},q=n.SerializableCipher=i.extend({cfg:i.extend({format:O}),encrypt:function(c,m,S,g){g=this.cfg.extend(g);var E=c.createEncryptor(S,g),M=E.finalize(m),T=E.cfg;return N.create({ciphertext:M,key:S,iv:T.iv,algorithm:c,mode:T.mode,padding:T.padding,blockSize:c.blockSize,formatter:g.format})},decrypt:function(c,m,S,g){g=this.cfg.extend(g),m=this._parse(m,g.format);var E=c.createDecryptor(S,g).finalize(m.ciphertext);return E},_parse:function(c,m){return typeof c=="string"?m.parse(c,this):c}}),P=r.kdf={},D=P.OpenSSL={execute:function(c,m,S,g){g||(g=s.random(64/8));var E=p.create({keySize:m+S}).compute(c,g),M=s.create(E.words.slice(m),S*4);return E.sigBytes=m*4,N.create({key:E,iv:M,salt:g})}},A=n.PasswordBasedCipher=q.extend({cfg:q.cfg.extend({kdf:D}),encrypt:function(c,m,S,g){g=this.cfg.extend(g);var E=g.kdf.execute(S,c.keySize,c.ivSize);g.iv=E.iv;var M=q.encrypt.call(this,c,m,E.key,g);return M.mixIn(E),M},decrypt:function(c,m,S,g){g=this.cfg.extend(g),m=this._parse(m,g.format);var E=g.kdf.execute(S,c.keySize,c.ivSize,m.salt);g.iv=E.iv;var M=q.decrypt.call(this,c,m,E.key,g);return M}})}()})});var Pm=U((Vh,Bm)=>{H();k();(function(e,t,r){typeof Vh=="object"?Bm.exports=Vh=t(yt(),Lr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Vh,function(e){return e.mode.CFB=function(){var t=e.lib.BlockCipherMode.extend();t.Encryptor=t.extend({processBlock:function(n,i){var s=this._cipher,o=s.blockSize;r.call(this,n,i,o,s),this._prevBlock=n.slice(i,i+o)}}),t.Decryptor=t.extend({processBlock:function(n,i){var s=this._cipher,o=s.blockSize,a=n.slice(i,i+o);r.call(this,n,i,o,s),this._prevBlock=a}});function r(n,i,s,o){var a=this._iv;if(a){var f=a.slice(0);this._iv=void 0}else var f=this._prevBlock;o.encryptBlock(f,0);for(var l=0;l<s;l++)n[i+l]^=f[l]}return t}(),e.mode.CFB})});var Mm=U((zh,Im)=>{H();k();(function(e,t,r){typeof zh=="object"?Im.exports=zh=t(yt(),Lr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(zh,function(e){return e.mode.CTR=function(){var t=e.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(n,i){var s=this._cipher,o=s.blockSize,a=this._iv,f=this._counter;a&&(f=this._counter=a.slice(0),this._iv=void 0);var l=f.slice(0);s.encryptBlock(l,0),f[o-1]=f[o-1]+1|0;for(var v=0;v<o;v++)n[i+v]^=l[v]}});return t.Decryptor=r,t}(),e.mode.CTR})});var Fm=U((Wh,Cm)=>{H();k();(function(e,t,r){typeof Wh=="object"?Cm.exports=Wh=t(yt(),Lr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Wh,function(e){return e.mode.CTRGladman=function(){var t=e.lib.BlockCipherMode.extend();function r(s){if((s>>24&255)===255){var o=s>>16&255,a=s>>8&255,f=s&255;o===255?(o=0,a===255?(a=0,f===255?f=0:++f):++a):++o,s=0,s+=o<<16,s+=a<<8,s+=f}else s+=1<<24;return s}function n(s){return(s[0]=r(s[0]))===0&&(s[1]=r(s[1])),s}var i=t.Encryptor=t.extend({processBlock:function(s,o){var a=this._cipher,f=a.blockSize,l=this._iv,v=this._counter;l&&(v=this._counter=l.slice(0),this._iv=void 0),n(v);var p=v.slice(0);a.encryptBlock(p,0);for(var u=0;u<f;u++)s[o+u]^=p[u]}});return t.Decryptor=i,t}(),e.mode.CTRGladman})});var Rm=U(($h,Nm)=>{H();k();(function(e,t,r){typeof $h=="object"?Nm.exports=$h=t(yt(),Lr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})($h,function(e){return e.mode.OFB=function(){var t=e.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(n,i){var s=this._cipher,o=s.blockSize,a=this._iv,f=this._keystream;a&&(f=this._keystream=a.slice(0),this._iv=void 0),s.encryptBlock(f,0);for(var l=0;l<o;l++)n[i+l]^=f[l]}});return t.Decryptor=r,t}(),e.mode.OFB})});var Dm=U((Gh,Om)=>{H();k();(function(e,t,r){typeof Gh=="object"?Om.exports=Gh=t(yt(),Lr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Gh,function(e){return e.mode.ECB=function(){var t=e.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(r,n){this._cipher.encryptBlock(r,n)}}),t.Decryptor=t.extend({processBlock:function(r,n){this._cipher.decryptBlock(r,n)}}),t}(),e.mode.ECB})});var qm=U((Xh,Tm)=>{H();k();(function(e,t,r){typeof Xh=="object"?Tm.exports=Xh=t(yt(),Lr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Xh,function(e){return e.pad.AnsiX923={pad:function(t,r){var n=t.sigBytes,i=r*4,s=i-n%i,o=n+s-1;t.clamp(),t.words[o>>>2]|=s<<24-o%4*8,t.sigBytes+=s},unpad:function(t){var r=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=r}},e.pad.Ansix923})});var km=U((Zh,Hm)=>{H();k();(function(e,t,r){typeof Zh=="object"?Hm.exports=Zh=t(yt(),Lr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Zh,function(e){return e.pad.Iso10126={pad:function(t,r){var n=r*4,i=n-t.sigBytes%n;t.concat(e.lib.WordArray.random(i-1)).concat(e.lib.WordArray.create([i<<24],1))},unpad:function(t){var r=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=r}},e.pad.Iso10126})});var Lm=U((Yh,jm)=>{H();k();(function(e,t,r){typeof Yh=="object"?jm.exports=Yh=t(yt(),Lr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Yh,function(e){return e.pad.Iso97971={pad:function(t,r){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,r)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971})});var Um=U((Jh,Km)=>{H();k();(function(e,t,r){typeof Jh=="object"?Km.exports=Jh=t(yt(),Lr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Jh,function(e){return e.pad.ZeroPadding={pad:function(t,r){var n=r*4;t.clamp(),t.sigBytes+=n-(t.sigBytes%n||n)},unpad:function(t){for(var r=t.words,n=t.sigBytes-1;!(r[n>>>2]>>>24-n%4*8&255);)n--;t.sigBytes=n+1}},e.pad.ZeroPadding})});var zm=U((Qh,Vm)=>{H();k();(function(e,t,r){typeof Qh=="object"?Vm.exports=Qh=t(yt(),Lr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(Qh,function(e){return e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding})});var $m=U((el,Wm)=>{H();k();(function(e,t,r){typeof el=="object"?Wm.exports=el=t(yt(),Lr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(el,function(e){return function(t){var r=e,n=r.lib,i=n.CipherParams,s=r.enc,o=s.Hex,a=r.format,f=a.Hex={stringify:function(l){return l.ciphertext.toString(o)},parse:function(l){var v=o.parse(l);return i.create({ciphertext:v})}}}(),e.format.Hex})});var Xm=U((tl,Gm)=>{H();k();(function(e,t,r){typeof tl=="object"?Gm.exports=tl=t(yt(),ro(),no(),Ka(),Lr()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(tl,function(e){return function(){var t=e,r=t.lib,n=r.BlockCipher,i=t.algo,s=[],o=[],a=[],f=[],l=[],v=[],p=[],u=[],h=[],b=[];(function(){for(var w=[],_=0;_<256;_++)_<128?w[_]=_<<1:w[_]=_<<1^283;for(var I=0,N=0,_=0;_<256;_++){var F=N^N<<1^N<<2^N<<3^N<<4;F=F>>>8^F&255^99,s[I]=F,o[F]=I;var O=w[I],q=w[O],P=w[q],D=w[F]*257^F*16843008;a[I]=D<<24|D>>>8,f[I]=D<<16|D>>>16,l[I]=D<<8|D>>>24,v[I]=D;var D=P*16843009^q*65537^O*257^I*16843008;p[F]=D<<24|D>>>8,u[F]=D<<16|D>>>16,h[F]=D<<8|D>>>24,b[F]=D,I?(I=O^w[w[w[P^O]]],N^=w[w[N]]):I=N=1}})();var d=[0,1,2,4,8,16,32,64,128,27,54],y=i.AES=n.extend({_doReset:function(){if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var w=this._keyPriorReset=this._key,_=w.words,I=w.sigBytes/4,N=this._nRounds=I+6,F=(N+1)*4,O=this._keySchedule=[],q=0;q<F;q++)if(q<I)O[q]=_[q];else{var P=O[q-1];q%I?I>6&&q%I==4&&(P=s[P>>>24]<<24|s[P>>>16&255]<<16|s[P>>>8&255]<<8|s[P&255]):(P=P<<8|P>>>24,P=s[P>>>24]<<24|s[P>>>16&255]<<16|s[P>>>8&255]<<8|s[P&255],P^=d[q/I|0]<<24),O[q]=O[q-I]^P}for(var D=this._invKeySchedule=[],A=0;A<F;A++){var q=F-A;if(A%4)var P=O[q];else var P=O[q-4];A<4||q<=4?D[A]=P:D[A]=p[s[P>>>24]]^u[s[P>>>16&255]]^h[s[P>>>8&255]]^b[s[P&255]]}}},encryptBlock:function(w,_){this._doCryptBlock(w,_,this._keySchedule,a,f,l,v,s)},decryptBlock:function(w,_){var I=w[_+1];w[_+1]=w[_+3],w[_+3]=I,this._doCryptBlock(w,_,this._invKeySchedule,p,u,h,b,o);var I=w[_+1];w[_+1]=w[_+3],w[_+3]=I},_doCryptBlock:function(w,_,I,N,F,O,q,P){for(var D=this._nRounds,A=w[_]^I[0],c=w[_+1]^I[1],m=w[_+2]^I[2],S=w[_+3]^I[3],g=4,E=1;E<D;E++){var M=N[A>>>24]^F[c>>>16&255]^O[m>>>8&255]^q[S&255]^I[g++],T=N[c>>>24]^F[m>>>16&255]^O[S>>>8&255]^q[A&255]^I[g++],R=N[m>>>24]^F[S>>>16&255]^O[A>>>8&255]^q[c&255]^I[g++],x=N[S>>>24]^F[A>>>16&255]^O[c>>>8&255]^q[m&255]^I[g++];A=M,c=T,m=R,S=x}var M=(P[A>>>24]<<24|P[c>>>16&255]<<16|P[m>>>8&255]<<8|P[S&255])^I[g++],T=(P[c>>>24]<<24|P[m>>>16&255]<<16|P[S>>>8&255]<<8|P[A&255])^I[g++],R=(P[m>>>24]<<24|P[S>>>16&255]<<16|P[A>>>8&255]<<8|P[c&255])^I[g++],x=(P[S>>>24]<<24|P[A>>>16&255]<<16|P[c>>>8&255]<<8|P[m&255])^I[g++];w[_]=M,w[_+1]=T,w[_+2]=R,w[_+3]=x},keySize:256/32});t.AES=n._createHelper(y)}(),e.AES})});var Ym=U((rl,Zm)=>{H();k();(function(e,t,r){typeof rl=="object"?Zm.exports=rl=t(yt(),ro(),no(),Ka(),Lr()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(rl,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=r.BlockCipher,s=t.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],f=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],v=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=s.DES=i.extend({_doReset:function(){for(var d=this._key,y=d.words,w=[],_=0;_<56;_++){var I=o[_]-1;w[_]=y[I>>>5]>>>31-I%32&1}for(var N=this._subKeys=[],F=0;F<16;F++){for(var O=N[F]=[],q=f[F],_=0;_<24;_++)O[_/6|0]|=w[(a[_]-1+q)%28]<<31-_%6,O[4+(_/6|0)]|=w[28+(a[_+24]-1+q)%28]<<31-_%6;O[0]=O[0]<<1|O[0]>>>31;for(var _=1;_<7;_++)O[_]=O[_]>>>(_-1)*4+3;O[7]=O[7]<<5|O[7]>>>27}for(var P=this._invSubKeys=[],_=0;_<16;_++)P[_]=N[15-_]},encryptBlock:function(d,y){this._doCryptBlock(d,y,this._subKeys)},decryptBlock:function(d,y){this._doCryptBlock(d,y,this._invSubKeys)},_doCryptBlock:function(d,y,w){this._lBlock=d[y],this._rBlock=d[y+1],u.call(this,4,252645135),u.call(this,16,65535),h.call(this,2,858993459),h.call(this,8,16711935),u.call(this,1,1431655765);for(var _=0;_<16;_++){for(var I=w[_],N=this._lBlock,F=this._rBlock,O=0,q=0;q<8;q++)O|=l[q][((F^I[q])&v[q])>>>0];this._lBlock=F,this._rBlock=N^O}var P=this._lBlock;this._lBlock=this._rBlock,this._rBlock=P,u.call(this,1,1431655765),h.call(this,8,16711935),h.call(this,2,858993459),u.call(this,16,65535),u.call(this,4,252645135),d[y]=this._lBlock,d[y+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function u(d,y){var w=(this._lBlock>>>d^this._rBlock)&y;this._rBlock^=w,this._lBlock^=w<<d}function h(d,y){var w=(this._rBlock>>>d^this._lBlock)&y;this._lBlock^=w,this._rBlock^=w<<d}t.DES=i._createHelper(p);var b=s.TripleDES=i.extend({_doReset:function(){var d=this._key,y=d.words;this._des1=p.createEncryptor(n.create(y.slice(0,2))),this._des2=p.createEncryptor(n.create(y.slice(2,4))),this._des3=p.createEncryptor(n.create(y.slice(4,6)))},encryptBlock:function(d,y){this._des1.encryptBlock(d,y),this._des2.decryptBlock(d,y),this._des3.encryptBlock(d,y)},decryptBlock:function(d,y){this._des3.decryptBlock(d,y),this._des2.encryptBlock(d,y),this._des1.decryptBlock(d,y)},keySize:192/32,ivSize:64/32,blockSize:64/32});t.TripleDES=i._createHelper(b)}(),e.TripleDES})});var Qm=U((nl,Jm)=>{H();k();(function(e,t,r){typeof nl=="object"?Jm.exports=nl=t(yt(),ro(),no(),Ka(),Lr()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(nl,function(e){return function(){var t=e,r=t.lib,n=r.StreamCipher,i=t.algo,s=i.RC4=n.extend({_doReset:function(){for(var f=this._key,l=f.words,v=f.sigBytes,p=this._S=[],u=0;u<256;u++)p[u]=u;for(var u=0,h=0;u<256;u++){var b=u%v,d=l[b>>>2]>>>24-b%4*8&255;h=(h+p[u]+d)%256;var y=p[u];p[u]=p[h],p[h]=y}this._i=this._j=0},_doProcessBlock:function(f,l){f[l]^=o.call(this)},keySize:256/32,ivSize:0});function o(){for(var f=this._S,l=this._i,v=this._j,p=0,u=0;u<4;u++){l=(l+1)%256,v=(v+f[l])%256;var h=f[l];f[l]=f[v],f[v]=h,p|=f[(f[l]+f[v])%256]<<24-u*8}return this._i=l,this._j=v,p}t.RC4=n._createHelper(s);var a=i.RC4Drop=s.extend({cfg:s.cfg.extend({drop:192}),_doReset:function(){s._doReset.call(this);for(var f=this.cfg.drop;f>0;f--)o.call(this)}});t.RC4Drop=n._createHelper(a)}(),e.RC4})});var t7=U((il,e7)=>{H();k();(function(e,t,r){typeof il=="object"?e7.exports=il=t(yt(),ro(),no(),Ka(),Lr()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(il,function(e){return function(){var t=e,r=t.lib,n=r.StreamCipher,i=t.algo,s=[],o=[],a=[],f=i.Rabbit=n.extend({_doReset:function(){for(var v=this._key.words,p=this.cfg.iv,u=0;u<4;u++)v[u]=(v[u]<<8|v[u]>>>24)&16711935|(v[u]<<24|v[u]>>>8)&4278255360;var h=this._X=[v[0],v[3]<<16|v[2]>>>16,v[1],v[0]<<16|v[3]>>>16,v[2],v[1]<<16|v[0]>>>16,v[3],v[2]<<16|v[1]>>>16],b=this._C=[v[2]<<16|v[2]>>>16,v[0]&4294901760|v[1]&65535,v[3]<<16|v[3]>>>16,v[1]&4294901760|v[2]&65535,v[0]<<16|v[0]>>>16,v[2]&4294901760|v[3]&65535,v[1]<<16|v[1]>>>16,v[3]&4294901760|v[0]&65535];this._b=0;for(var u=0;u<4;u++)l.call(this);for(var u=0;u<8;u++)b[u]^=h[u+4&7];if(p){var d=p.words,y=d[0],w=d[1],_=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,I=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,N=_>>>16|I&4294901760,F=I<<16|_&65535;b[0]^=_,b[1]^=N,b[2]^=I,b[3]^=F,b[4]^=_,b[5]^=N,b[6]^=I,b[7]^=F;for(var u=0;u<4;u++)l.call(this)}},_doProcessBlock:function(v,p){var u=this._X;l.call(this),s[0]=u[0]^u[5]>>>16^u[3]<<16,s[1]=u[2]^u[7]>>>16^u[5]<<16,s[2]=u[4]^u[1]>>>16^u[7]<<16,s[3]=u[6]^u[3]>>>16^u[1]<<16;for(var h=0;h<4;h++)s[h]=(s[h]<<8|s[h]>>>24)&16711935|(s[h]<<24|s[h]>>>8)&4278255360,v[p+h]^=s[h]},blockSize:128/32,ivSize:64/32});function l(){for(var v=this._X,p=this._C,u=0;u<8;u++)o[u]=p[u];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<o[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<o[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<o[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<o[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<o[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<o[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<o[6]>>>0?1:0)|0,this._b=p[7]>>>0<o[7]>>>0?1:0;for(var u=0;u<8;u++){var h=v[u]+p[u],b=h&65535,d=h>>>16,y=((b*b>>>17)+b*d>>>15)+d*d,w=((h&4294901760)*h|0)+((h&65535)*h|0);a[u]=y^w}v[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,v[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,v[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,v[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,v[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,v[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,v[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,v[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}t.Rabbit=n._createHelper(f)}(),e.Rabbit})});var n7=U((sl,r7)=>{H();k();(function(e,t,r){typeof sl=="object"?r7.exports=sl=t(yt(),ro(),no(),Ka(),Lr()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(sl,function(e){return function(){var t=e,r=t.lib,n=r.StreamCipher,i=t.algo,s=[],o=[],a=[],f=i.RabbitLegacy=n.extend({_doReset:function(){var v=this._key.words,p=this.cfg.iv,u=this._X=[v[0],v[3]<<16|v[2]>>>16,v[1],v[0]<<16|v[3]>>>16,v[2],v[1]<<16|v[0]>>>16,v[3],v[2]<<16|v[1]>>>16],h=this._C=[v[2]<<16|v[2]>>>16,v[0]&4294901760|v[1]&65535,v[3]<<16|v[3]>>>16,v[1]&4294901760|v[2]&65535,v[0]<<16|v[0]>>>16,v[2]&4294901760|v[3]&65535,v[1]<<16|v[1]>>>16,v[3]&4294901760|v[0]&65535];this._b=0;for(var b=0;b<4;b++)l.call(this);for(var b=0;b<8;b++)h[b]^=u[b+4&7];if(p){var d=p.words,y=d[0],w=d[1],_=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,I=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,N=_>>>16|I&4294901760,F=I<<16|_&65535;h[0]^=_,h[1]^=N,h[2]^=I,h[3]^=F,h[4]^=_,h[5]^=N,h[6]^=I,h[7]^=F;for(var b=0;b<4;b++)l.call(this)}},_doProcessBlock:function(v,p){var u=this._X;l.call(this),s[0]=u[0]^u[5]>>>16^u[3]<<16,s[1]=u[2]^u[7]>>>16^u[5]<<16,s[2]=u[4]^u[1]>>>16^u[7]<<16,s[3]=u[6]^u[3]>>>16^u[1]<<16;for(var h=0;h<4;h++)s[h]=(s[h]<<8|s[h]>>>24)&16711935|(s[h]<<24|s[h]>>>8)&4278255360,v[p+h]^=s[h]},blockSize:128/32,ivSize:64/32});function l(){for(var v=this._X,p=this._C,u=0;u<8;u++)o[u]=p[u];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<o[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<o[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<o[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<o[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<o[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<o[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<o[6]>>>0?1:0)|0,this._b=p[7]>>>0<o[7]>>>0?1:0;for(var u=0;u<8;u++){var h=v[u]+p[u],b=h&65535,d=h>>>16,y=((b*b>>>17)+b*d>>>15)+d*d,w=((h&4294901760)*h|0)+((h&65535)*h|0);a[u]=y^w}v[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,v[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,v[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,v[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,v[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,v[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,v[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,v[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}t.RabbitLegacy=n._createHelper(f)}(),e.RabbitLegacy})});var Kv=U((al,i7)=>{H();k();(function(e,t,r){typeof al=="object"?i7.exports=al=t(yt(),Gc(),sm(),om(),ro(),no(),Nh(),jv(),lm(),Lv(),bm(),ym(),mm(),jh(),Em(),Ka(),Lr(),Pm(),Mm(),Fm(),Rm(),Dm(),qm(),km(),Lm(),Um(),zm(),$m(),Xm(),Ym(),Qm(),t7(),n7()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy"],t):e.CryptoJS=t(e.CryptoJS)})(al,function(e){return e})});var ai=U(ur=>{"use strict";H();k();var ZT=ur&&ur.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),YT=ur&&ur.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),JT=ur&&ur.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&ZT(t,e,r);return YT(t,e),t};Object.defineProperty(ur,"__esModule",{value:!0});ur.cvtBigintToUint8arrayNoPadding=ur.cvtBigintToUint8array=ur.cvtUint8arrayToBigint=ur.randomSafePrime=ur.RandomNum=ur.HmacSHA512Int=ur.SHA256Int=void 0;var QT=er(),ol=er(),s7=er(),Uv=JT(Kv());function eq(e){let t=s7.base.sha256.create();for(let r of e){if(r<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${r}`);let n=r.toString(16);n.length%2&&(n="0"+n),t.update(j.Buffer.from(n,"hex"))}return(0,QT.bufToBigint)(t.digest())}ur.SHA256Int=eq;function tq(e){return e.length%2!==0&&(e="0"+e),e}function rq(e){let n=e.map(s=>tq(new s7.BN(s.toString()).toString(16))).map(s=>Uv.enc.Hex.parse(s)).reduce((s,o)=>s.concat(o)),i=Uv.HmacSHA512(n,"");return BigInt(`0x${Uv.enc.Hex.stringify(i)}`)}ur.HmacSHA512Int=rq;function nq(e){let t=BigInt(1),r=BigInt(2);if(e<=r)throw new Error("max has to be greater than two");return(0,ol.randBetween)(e-t,r)}ur.RandomNum=nq;async function iq(e){let t=8*e-1;for(;;){let r=await(0,ol.prime)(t);for(;r<BigInt(3)<<BigInt(t-2);)r=await(0,ol.prime)(t);let n=2n*r+1n;if(await(0,ol.isProbablyPrime)(n))return n}}ur.randomSafePrime=iq;function sq(e){let t=BigInt(0);for(let r=0;r<e.length;r++)t=t*BigInt(256)+BigInt(e[r]);return t}ur.cvtUint8arrayToBigint=sq;function aq(e){let t=new Uint8Array(32),r=t.length-1;for(;e>0&&r>=0;)t[r]=Number(e%BigInt(256)),e=e/BigInt(256),r--;return t}ur.cvtBigintToUint8array=aq;function oq(e){let t=[];for(;e>0n;){let n=Number(e%256n);t.push(n),e/=256n}return new Uint8Array(t).reverse()}ur.cvtBigintToUint8arrayNoPadding=oq});var a7=U(Xc=>{"use strict";H();k();Object.defineProperty(Xc,"__esModule",{value:!0});Xc.Commitment=void 0;var Vv=ai(),fq;(function(e){function t(i){let s=(0,Vv.RandomNum)(2n**256n);return i.unshift(s),{C:(0,Vv.HmacSHA512Int)(i.slice()),Msg:i}}e.NewCommitment=t;function r(i){return n(i)?i.Msg.slice(1):null}e.Open=r;function n(i){let s=(0,Vv.HmacSHA512Int)(i.Msg);return i.C==s}e.Verify=n})(fq=Xc.Commitment||(Xc.Commitment={}))});var hs=U(_t=>{"use strict";H();k();Object.defineProperty(_t,"__esModule",{value:!0});_t.GenRSAKeyPairError=_t.DecodeRsaPublicKeyError=_t.DecodeRSAPrivateKeyError=_t.RSADecodeError=_t.RSAEncodeError=_t.AESDecryptError=_t.AESEncryptError=_t.Bip32DeriveError=_t.Bip32NewChildKeyError=_t.CommitmentDeCommitfail=_t.SchnorrVerifyFail=_t.SchnorrVerifyError=_t.SchnorrProveError=_t.CreatPailKeyError=_t.MPCError=void 0;var zv=class extends Error{constructor(t,r){super(r.toString()),this.name=t}};_t.MPCError=zv;var cq="create paillier key error";_t.CreatPailKeyError=cq;var uq="schnorr prove error";_t.SchnorrProveError=uq;var dq="schnorr verify error";_t.SchnorrVerifyError=dq;var hq="schnorr verify fail";_t.SchnorrVerifyFail=hq;var lq="commitment DeCommit fail";_t.CommitmentDeCommitfail=lq;var pq="bip32 new child key error";_t.Bip32NewChildKeyError=pq;var vq="bip32 derive error";_t.Bip32DeriveError=vq;var bq="aes encrypt error";_t.AESEncryptError=bq;var gq="aes decrypt error";_t.AESDecryptError=gq;var yq="rsa encode error";_t.RSAEncodeError=yq;var xq="rsa decode error";_t.RSADecodeError=xq;var mq="decode rsa private key error";_t.DecodeRSAPrivateKeyError=mq;var wq="decode rsa public key error";_t.DecodeRsaPublicKeyError=wq;var Sq="gen rsa key pair error";_t.GenRSAKeyPairError=Sq});var c7=U(Ua=>{"use strict";H();k();Object.defineProperty(Ua,"__esModule",{value:!0});Ua.createPailKeyPair=Ua.PailPrivKey=Ua.PailPubKey=void 0;var Wv=ai(),Ti=er(),o7=hs(),fl=class{constructor(t){this.n=t}n2(){return this.n.sqr()}g(){return this.n.addn(1)}encryptWithR(t,r){let n=this.n2(),i=Ti.BN.red(n),s=r.toRed(i),o=this.n.toRed(i).redMul(t.toRed(i)).addn(1),a=s.redPow(this.n);return o.redMul(a).fromRed()}encrypt(t){let r=BigInt(this.n.toString());for(;;){let n=new Ti.BN((0,Wv.RandomNum)(r).toString());if(n.gcd(this.n).eqn(1))return this.encryptWithR(t,n)}}HomoAdd(t,r){let n=Ti.BN.red(this.n2());return t.toRed(n).redMul(r.toRed(n)).fromRed()}homomorphicAddPlain(t,r){let n=Ti.BN.red(this.n2()),i=this.n.toRed(n).redMul(r.toRed(n)).addn(1);return t.toRed(n).redMul(i).fromRed()}homomorphicMulPlain(t,r){let n=Ti.BN.red(this.n2());return t.toRed(n).redPow(r).fromRed()}};Ua.PailPubKey=fl;var cl=class{constructor(t,r){this.lambda=t,this.pailPubKey=r}decrypt(t){let r=this.pailPubKey.n2(),n=this.pailPubKey.n,i=this.pailPubKey.g(),s=t.toRed(Ti.BN.red(r)).redPow(this.lambda),o=f7(s.fromRed(),n),a=i.toRed(Ti.BN.red(r)).redPow(this.lambda),l=f7(a.fromRed(),n).toRed(Ti.BN.red(n)).redInvm();return o.mul(l).mod(n)}};Ua.PailPrivKey=cl;function f7(e,t){return e.subn(1).div(t)}async function Eq(e){try{let t=0n,r=0n;for(;t==r;)t=await(0,Wv.randomSafePrime)(e/2),r=await(0,Wv.randomSafePrime)(e/2);if(t<r){let v=t;t=r,r=v}let n=t*r,i=t-1n,s=r-1n,o=i*s,a=(0,Ti.eGcd)(i,s).g,f=o/a,l=new fl(new Ti.BN(n.toString()));return[new cl(new Ti.BN(f.toString()),l),l]}catch(t){return Promise.reject(new o7.MPCError(o7.CreatPailKeyError,t))}}Ua.createPailKeyPair=Eq});var $v=U(qi=>{"use strict";H();k();var _q=qi&&qi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Aq=qi&&qi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Bq=qi&&qi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&_q(t,e,r);return Aq(t,e),t};Object.defineProperty(qi,"__esModule",{value:!0});qi.polynomial=void 0;var u7=Bq(er()),Pq;(function(e){async function t(s,o,a){let f=new Array(a+1);f[0]=o;for(let l=1;l<=a;l++){let v=await u7.prime(s.toString(2).length);f[l]=v}return{coefficients:f,qMod:s}}e.initPolynomial=t;function r(s,o){let a=s.coefficients[0],f=0n;for(let v=1;v<s.coefficients.length;v++)f*=o,a+=f*s.coefficients[v];let l=s.qMod;return a=(a%l+l)%l,{id:o,y:a}}e.evaluatePolynomial=r;function n(s,o){let a=new Array(o.length);for(let l in o)a[l]=o[l].id;let f=0n;for(let l of o)f+=i(s,l.id,l.y,a);return f=(f%s+s)%s,f}e.recoverSecret=n;function i(s,o,a,f){let l=a;for(let v=0;v<f.length;v++){let p=f[v];if(p===o)continue;let u=p-o;u=u7.modInv(u,s),u*=p,l*=u}return l=(l%s+s)%s,l}e.calLagrangian=i})(Pq=qi.polynomial||(qi.polynomial={}))});var h7=U(dl=>{"use strict";H();k();Object.defineProperty(dl,"__esModule",{value:!0});dl.Feldman=void 0;var d7=$v(),ul=er(),Gv=class{constructor(t,r,n){if(!Number.isInteger(t))throw new Error("Expect integer threshold");if(t<2)throw new Error("Expect threshold >= 2");if(this.threshold=t,!Number.isInteger(r))throw new Error("Expect integer limit");if(r<t)throw new Error("Expect limit >= threshold");if(this.limit=r,n=="ed25519")this.primeOrder=ul.ed25519.CURVE.n;else if(n=="secp256k1")this.primeOrder=ul.secp256k1.CURVE.n;else throw new Error("Expect ed25519 or secp256k1 curve");this.curve=n}async evaluate(t){let r=await d7.polynomial.initPolynomial(this.primeOrder,t,this.threshold-1),n=new Array(this.limit);for(let s=1;s<=this.limit;s++){let o=BigInt(s);n[s-1]=d7.polynomial.evaluatePolynomial(r,o)}let i=new Array(r.coefficients.length);for(let s in r.coefficients)i[s]=await ul.ed25519.Point.fromPrivateKey(r.coefficients[s]);return{verifiers:i,shares:n}}async verify(t,r){if(r.length<this.threshold)throw new Error("not enough number of verifiers");let n=await ul.ed25519.Point.fromPrivateKey(t.y),i=1n,s=r[0];for(let o=1;o<=r.length;o++){i*=t.id;let a=r[o].multiply(i);s=s.add(a)}return n===s}};dl.Feldman=Gv});var Zc=U(Ts=>{"use strict";H();k();Object.defineProperty(Ts,"__esModule",{value:!0});Ts.Signature=Ts.ECPoint=Ts.CurveName=void 0;var _f=er(),l7=ai(),hl;(function(e){e.Secp256k1="secp256k1",e.Ed25519="ed25519"})(hl=Ts.CurveName||(Ts.CurveName={}));var Af=class{constructor(t,r,n){this.Curve=t,this.X=r,this.Y=n}toHex(){return this.Curve===hl.Secp256k1?this.toEcdsaPoint().toHex(!0):this.toEd25519Point().toHex()}toEcdsaPoint(){return new _f.secp256k1.Point(this.X,this.Y)}toEd25519Point(){return new _f.ed25519.Point(this.X,this.Y)}static fromEcdsaPoint(t){return new Af(hl.Secp256k1.toString(),t.x,t.y)}static fromEd25519Point(t){return new Af(hl.Ed25519.toString(),t.x,t.y)}};Ts.ECPoint=Af;var Bf=class{constructor(t,r){this.r=t,this.s=r}toEcdsaSignature(){return new _f.secp256k1.Signature(this.r,this.s)}toEd25519Signature(){let t=new Uint8Array((0,l7.cvtBigintToUint8array)(this.r)).reverse(),r=_f.ed25519.Point.fromHex(_f.ed25519.utils.bytesToHex(t));return new _f.ed25519.Signature(r,this.s)}static fromEcdsaSignature(t){return new Bf(t.r,t.s)}static fromEd25519Signature(t){let r=new Uint8Array(t.r.toRawBytes()).reverse(),n=(0,l7.cvtUint8arrayToBigint)(r);return new Bf(n,t.s)}};Ts.Signature=Bf});var Zv=U(Va=>{"use strict";H();k();Object.defineProperty(Va,"__esModule",{value:!0});Va.verify=Va.prove=Va.Proof=void 0;var p7=Zc(),Xv=ai(),io=er(),ll=hs(),pl=class{constructor(t,r){this.R=t,this.S=r}};Va.Proof=pl;async function Iq(e,t,r){try{let n=io.secp256k1.CURVE.n,i=(0,Xv.RandomNum)(n),s=io.secp256k1.Point.fromPrivateKey(i),o=io.secp256k1.Point.fromPrivateKey(BigInt(1)),a=(0,Xv.SHA256Int)([e,o.x,o.y,r.x,r.y,s.x,s.y])%n,f=(i+a*t)%n;return new pl(new p7.ECPoint(p7.CurveName.Secp256k1,s.x,s.y),f)}catch(n){return Promise.reject(new ll.MPCError(ll.SchnorrProveError,n))}}Va.prove=Iq;function Mq(e,t,r){try{let n=new io.secp256k1.Point(t.R.X,t.R.Y),i=io.secp256k1.CURVE.n,s=io.secp256k1.Point.fromPrivateKey(BigInt(1)),o=(0,Xv.SHA256Int)([e,s.x,s.y,r.x,r.y,n.x,n.y])%i,a=io.secp256k1.Point.fromPrivateKey(BigInt(t.S.toString(10))),f=r.multiply(o);return n.add(f).equals(a)}catch(n){throw new ll.MPCError(ll.SchnorrVerifyError,n)}}Va.verify=Mq});var Jv=U(ls=>{"use strict";H();k();Object.defineProperty(ls,"__esModule",{value:!0});ls.verify=ls.prove=ls.Proof=ls.Ed25519Point=void 0;var Yv=ai(),Yc=er(),vl=Zc(),bl=hs(),gl=class{constructor(t,r,n){this.Curve=t,this.X=r,this.Y=n}};ls.Ed25519Point=gl;var Pf=class{constructor(t,r){this.R=t,this.S=r}JsonStringify(){let t=new gl("ed25519",this.R.X,this.R.Y);return JSON.stringify({R:t,S:this.S},(r,n)=>typeof n=="bigint"?n.toString():n)}static JsonParse(t){let r=JSON.parse(t),n=new vl.ECPoint(vl.CurveName.Ed25519.toString(),BigInt(r.R.X),BigInt(r.R.Y));return new Pf(n,r.S)}};ls.Proof=Pf;async function Cq(e,t){try{let r=Yc.ed25519.CURVE.n,n=(0,Yv.RandomNum)(r),i=BigInt(n.toString()),s=Yc.ed25519.Point.BASE.multiply(BigInt(n.toString())),o=(0,Yv.SHA256Int)([t.x,t.y,s.x,s.y])%r,a=(i+o*e)%r;return new Pf(new vl.ECPoint(vl.CurveName.Ed25519,s.x,s.y),a)}catch(r){return Promise.reject(new bl.MPCError(bl.SchnorrProveError,r))}}ls.prove=Cq;function Fq(e,t){try{let r=new Yc.ed25519.Point(e.R.X,e.R.Y),n=Yc.ed25519.CURVE.n,i=(0,Yv.SHA256Int)([t.x,t.y,r.x,r.y])%n,s=BigInt(e.S.toString())%n,o=Yc.ed25519.Point.BASE.multiply(s),a=t.multiply(i);return r.add(a).equals(o)}catch(r){throw new bl.MPCError(bl.SchnorrVerifyError,r)}}ls.verify=Fq});var If=U(Ir=>{"use strict";H();k();var v7=Ir&&Ir.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Nq=Ir&&Ir.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Jc=Ir&&Ir.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&v7(t,e,r)},b7=Ir&&Ir.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&v7(t,e,r);return Nq(t,e),t};Object.defineProperty(Ir,"__esModule",{value:!0});Ir.ed25519Schnorr=Ir.ecdsaSchnorr=void 0;Jc(a7(),Ir);Jc(c7(),Ir);Jc(h7(),Ir);Jc($v(),Ir);Ir.ecdsaSchnorr=b7(Zv());Ir.ed25519Schnorr=b7(Jv());Jc(Zc(),Ir)});var x7=U(Mf=>{"use strict";H();k();Object.defineProperty(Mf,"__esModule",{value:!0});Mf.Ed25519Verify=Mf.Ed25519Sign=void 0;var Qc=If(),ps=er(),g7=ai(),Rq=e=>e.length!==0&&e.length%2===0&&!/[^a-fA-F0-9]/u.test(e),Oq=e=>Uint8Array.from(e.match(/.{1,2}/g).map(t=>parseInt(t,16))),Qv=class{constructor(t,r,n,i,s,o){this.deviceNumber=t,this.threshold=r,this.partList=n,this.publicKey=s,this.message=o,this.roundNumber=1;let a=new Array(n.length);for(let f=0;f<n.length;f++)a[f]=BigInt(n[f]);this.wi=Qc.polynomial.calLagrangian(ps.ed25519.CURVE.n,BigInt(t),i,a)}async signStep1(){if(this.roundNumber!=1)throw new Error("not in round 1");this.ki=(0,g7.RandomNum)(ps.ed25519.CURVE.n);let t=ps.ed25519.Point.BASE.multiply(this.ki),r=Qc.Commitment.NewCommitment([t.x,t.y]);this.cmtD=r.Msg,this.roundNumber=2;let n=new Map;for(let i of this.partList){if(i==this.deviceNumber)continue;let s={c:r.C},o={from:this.deviceNumber,to:i,data:s};n.set(i,o)}return n}async signStep2(t){if(this.roundNumber!=2)throw new Error("not in round 2");if(t.length!=this.threshold-1)throw new Error("message number error");this.commitmentMap=new Map;for(let s of t){if(s.to!=this.deviceNumber)throw new Error("message sending error");let o=s.data;this.commitmentMap.set(s.from,o.c)}let r=ps.ed25519.Point.BASE.multiply(this.ki),n=await Qc.ed25519Schnorr.prove(this.ki,r);this.roundNumber=3;let i=new Map;for(let s of this.partList){if(s==this.deviceNumber)continue;let o={witness:this.cmtD,proof:n},a={from:this.deviceNumber,to:s,data:o};i.set(s,a)}return i}async signStep3(t){if(this.roundNumber!=3)throw new Error("not in round 3");if(t.length!=this.threshold-1)throw new Error("message number error");let r=ps.ed25519.Point.BASE.multiply(this.ki);for(let a of t){if(a.to!=this.deviceNumber)throw new Error("message sending error");let f=a.data,v={C:this.commitmentMap.get(a.from),Msg:f.witness},p=Qc.Commitment.Open(v);if(!p)throw new Error("commitment DeCommit fail");let u=BigInt(p[0].toString()),h=BigInt(p[1].toString()),b=new ps.ed25519.Point(u,h),d=f.proof;if(!Qc.ed25519Schnorr.verify(d,b))throw new Error("schnorr verify fail");r=r.add(b)}let n=Tq(r.toRawBytes());if(!Rq(this.message))throw new Error("stored message not hex");let i=await ps.ed25519.utils.sha512(r.toRawBytes(),this.publicKey.toRawBytes(),Oq(this.message)),s=qq(i);return[y7(this.ki+s*this.wi,ps.ed25519.CURVE.n),n]}};Mf.Ed25519Sign=Qv;async function Dq(e,t,r){let n=e.toEd25519Signature(),i=r.toEd25519Point(),s=await ps.ed25519.verify(n,t,i);return[e,s]}Mf.Ed25519Verify=Dq;function Tq(e){let t=new Uint8Array(e);return t.reverse(),(0,g7.cvtUint8arrayToBigint)(t)}function qq(e){let t=BigInt("0x"+kq(Uint8Array.from(e).reverse()));return y7(t,ps.ed25519.CURVE.l)}function y7(e,t){let r=e%t;return r>=BigInt(0)?r:t+r}var Hq=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function kq(e){let t="";for(let r=0;r<e.length;r++)t+=Hq[e[r]];return t}});var yl=U(Cf=>{"use strict";H();k();Object.defineProperty(Cf,"__esModule",{value:!0});Cf.calPrivateOffset=Cf.TssKey=void 0;var so=er(),jq=ai(),m7=hs(),w7=so.secp256k1.CURVE,eu=class{constructor(t,r,n){this.shareI=t,this.publicKey=r,this.chaincode=n,this.offsetSonPri=new so.BN(0)}async NewChildKey(t){try{let r=j.Buffer.from((0,jq.cvtBigintToUint8arrayNoPadding)(this.publicKey.x)),n=S7(r,this.chaincode,t),i=new so.BN(n.slice(0,32)),s=so.secp256k1.Point.fromPrivateKey(BigInt(i.toString(10))),o=this.publicKey.add(s),a=this.shareI;a!=null&&(a=a.add(i),a=a.mod(new so.BN(w7.n.toString())));let f=this.offsetSonPri.add(i);f=f.mod(new so.BN(w7.n.toString()));let l=new eu(a,o,n.slice(32));return l.offsetSonPri=f,l}catch(r){return Promise.reject(new m7.MPCError(m7.Bip32NewChildKeyError,r))}}};Cf.TssKey=eu;function S7(e,t,r){let n=j.Buffer.allocUnsafe(4);n.writeUInt32BE(r,0);let i=j.Buffer.allocUnsafe(t.length+e.length+n.length);return t.copy(i,0),e.copy(i,t.length),n.copy(i,t.length+e.length),so.base.hmacSHA512(j.Buffer.from(`Key share derivation:
`,"utf8"),i)}Cf.calPrivateOffset=S7});var tb=U(xl=>{"use strict";H();k();Object.defineProperty(xl,"__esModule",{value:!0});xl.TssKey=void 0;var Ff=er(),Lq=yl(),Kq=ai(),E7=hs(),eb=Ff.ed25519.CURVE,tu=class{constructor(t,r,n){this.shareI=t,this.publicKey=r,this.chaincode=n,this.offsetSonPri=new Ff.BN(0)}async NewChildKey(t){try{let r=j.Buffer.from((0,Kq.cvtBigintToUint8arrayNoPadding)(this.publicKey.x)),n=(0,Lq.calPrivateOffset)(r,this.chaincode,t),i=new Ff.BN(n.slice(0,32)),s=Ff.ed25519.Point.BASE.multiply(BigInt(i.toString(10))%eb.n),o=this.publicKey.add(s),a=this.shareI;a!=null&&(a=a.add(i),a=a.mod(new Ff.BN(eb.n.toString())));let f=this.offsetSonPri.add(i);f=f.mod(new Ff.BN(eb.n.toString()));let l=new tu(a,o,n.slice(32));return l.offsetSonPri=f,l}catch(r){return Promise.reject(new E7.MPCError(E7.Bip32NewChildKeyError,r))}}};xl.TssKey=tu});var ml={};cS(ml,{abs:()=>ao,bitLength:()=>Uq,crt:()=>A7,eGcd:()=>_7,gcd:()=>B7,lcm:()=>Vq,max:()=>zq,min:()=>Wq,modAdd:()=>$q,modInv:()=>nb,modMultiply:()=>Gq,modPow:()=>rb,phi:()=>P7,toZn:()=>oo});function ao(e){return e>=0?e:-e}function Uq(e){if(typeof e=="number"&&(e=BigInt(e)),e===1n)return 1;let t=1;do t++;while((e>>=1n)>1n);return t}function _7(e,t){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),e<=0n||t<=0n)throw new RangeError("a and b MUST be > 0");let r=0n,n=1n,i=1n,s=0n;for(;e!==0n;){let o=t/e,a=t%e,f=r-i*o,l=n-s*o;t=e,e=a,r=i,n=s,i=f,s=l}return{g:t,x:r,y:n}}function oo(e,t){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),t<=0n)throw new RangeError("n must be > 0");let r=e%t;return r<0n?r+t:r}function nb(e,t){let r=_7(oo(e,t),t);if(r.g!==1n)throw new RangeError(`${e.toString()} does not have inverse modulo ${t.toString()}`);return oo(r.x,t)}function A7(e,t,r){if(e.length!==t.length)throw new RangeError("The remainders and modulos arrays should have the same length");let n=r??t.reduce((i,s)=>i*s,1n);return t.reduce((i,s,o)=>{let a=n/s;return oo(i+a*nb(a,s)%n*e[o]%n,n)},0n)}function B7(e,t){let r=typeof e=="number"?BigInt(ao(e)):ao(e),n=typeof t=="number"?BigInt(ao(t)):ao(t);if(r===0n)return n;if(n===0n)return r;let i=0n;for(;(1n&(r|n))===0n;)r>>=1n,n>>=1n,i++;for(;(1n&r)===0n;)r>>=1n;do{for(;(1n&n)===0n;)n>>=1n;if(r>n){let s=r;r=n,n=s}n-=r}while(n!==0n);return r<<i}function Vq(e,t){return typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),e===0n&&t===0n?BigInt(0):ao(e/B7(e,t)*t)}function zq(e,t){return e>=t?e:t}function Wq(e,t){return e>=t?t:e}function $q(e,t){let r=BigInt(t);return oo(e.map(n=>BigInt(n)%r).reduce((n,i)=>n+i%r,0n),r)}function Gq(e,t){let r=BigInt(t);return oo(e.map(n=>BigInt(n)%r).reduce((n,i)=>n*i%r,1n),r)}function P7(e){return e.map(t=>t[0]**(t[1]-1n)*(t[0]-1n)).reduce((t,r)=>r*t,1n)}function rb(e,t,r,n){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),typeof r=="number"&&(r=BigInt(r)),r<=0n)throw new RangeError("n must be > 0");if(r===1n)return 0n;if(e=oo(e,r),t<0n)return nb(rb(e,ao(t),r,n),r);if(n!==void 0)return function(s,o,a,f){let l=f.map(u=>u[0]**u[1]),v=f.map(u=>P7([u])),p=v.map((u,h)=>rb(s,o%u,l[h]));return A7(p,l,a)}(e,t,r,function(s){let o={};return s.forEach(a=>{if(typeof a=="bigint"||typeof a=="number"){let f=String(a);o[f]===void 0?o[f]={p:BigInt(a),k:1n}:o[f].k+=1n}else{let f=String(a[0]);o[f]===void 0?o[f]={p:BigInt(a[0]),k:BigInt(a[1])}:o[f].k+=BigInt(a[1])}}),Object.values(o).map(a=>[a.p,a.k])}(n));let i=1n;for(;t>0;)t%2n===1n&&(i=i*e%r),t/=2n,e=e**2n%r;return i}var wl=fS(()=>{H();k()});var sb=U(Nf=>{"use strict";H();k();Object.defineProperty(Nf,"__esModule",{value:!0});Nf.PaillierAffineVerify=Nf.PaillierAffineProve=void 0;var fo=er(),I7=Zc(),qs=ai(),vs=(wl(),b0(ml)),Sl=fo.secp256k1.CURVE,TQ=BigInt(2),ib=2*256,M7=3*256,El=3*256;function Xq(e,t,r){let n=t.N*t.N,i=1n<<BigInt(ib+El),s=1n<<BigInt(M7+El),o=1n<<BigInt(ib),a=(0,qs.RandomNum)(i),f=(0,qs.RandomNum)(s),l=(0,qs.RandomNum)(t.N),v=(0,qs.RandomNum)(i*e.Ntilde),p=(0,qs.RandomNum)(o*e.Ntilde),u=(0,qs.RandomNum)(i*e.Ntilde),h=(0,qs.RandomNum)(o*e.Ntilde),b=(0,vs.modPow)(t.C,a,n);b=b*(0,vs.modPow)(1n+t.N,f,n)%n,b=b*(0,vs.modPow)(l,t.N,n)%n;let d=I7.ECPoint.fromEcdsaPoint(fo.secp256k1.Point.fromPrivateKey(a%Sl.n)),y=I7.ECPoint.fromEcdsaPoint(fo.secp256k1.Point.fromPrivateKey(f%Sl.n)),w=e.Commit(a,v),_=e.Commit(r.X,p),I=e.Commit(f,u),N=e.Commit(r.Y,h),O=(0,qs.SHA256Int)([t.N,t.C,t.D,t.X.X,t.Y.X,b,d.X,y.X,w,_,I,N])%fo.secp256k1.CURVE.n,q=a+O*r.X,P=f+O*r.Y,D=v+O*p,A=u+O*h,c=l*(0,vs.modPow)(r.Rho,O,t.N)%t.N;return{A:b,Bx:d,By:y,E:w,S:_,F:I,T:N,Z1:q,Z2:P,Z3:D,Z4:A,W:c,X:t.X,Y:t.Y}}Nf.PaillierAffineProve=Xq;function Zq(e,t,r){let n=r.N*r.N,s=(0,qs.SHA256Int)([r.N,r.C,r.D,r.X.X,r.Y.X,t.A,t.Bx.X,t.By.X,t.E,t.S,t.F,t.T])%fo.secp256k1.CURVE.n,o=(0,vs.modPow)(r.C,t.Z1,n);o=o*(0,vs.modPow)(1n+r.N,t.Z2,n)%n*(0,vs.modPow)(t.W,r.N,n)%n;let a=t.A*(0,vs.modPow)(r.D,s,n)%n;if(o!==a)return!1;let f=fo.secp256k1.Point.fromPrivateKey(t.Z1%Sl.n),l=t.Bx.toEcdsaPoint().add(r.X.toEcdsaPoint().multiply(s));if(!f.equals(l))return!1;let v=fo.secp256k1.Point.fromPrivateKey(t.Z2%Sl.n),p=t.By.toEcdsaPoint().add(r.Y.toEcdsaPoint().multiply(s));if(!v.equals(p))return!1;let u=e.Commit(t.Z1,t.Z3),h=t.E*(0,vs.modPow)(t.S,s,e.Ntilde)%e.Ntilde;if(u!==h)return!1;let b=e.Commit(t.Z2,t.Z4),d=t.F*(0,vs.modPow)(t.T,s,e.Ntilde)%e.Ntilde;return!(b!==d||t.Z1>=1n<<BigInt(ib+El)||t.Z2>=1n<<BigInt(M7+El))}Nf.PaillierAffineVerify=Zq});var N7=U(_l=>{"use strict";H();k();Object.defineProperty(_l,"__esModule",{value:!0});_l.P1=void 0;var ru=er(),ab=If(),nu=er(),C7=ai(),Yq=sb(),Jq=ab.Commitment.NewCommitment,F7=nu.secp256k1.CURVE,ob=class{constructor(t,r,n,i,s){let o;try{o=(0,ru.hexToBigint)(i)}catch{throw new Error(`message not hex: ${i}`)}this.sessionId=(0,C7.SHA256Int)([r.x,r.y,o]),this.k1=new ru.BN((0,C7.RandomNum)(F7.n).toString()),this.publicKey=r,this.paiPrivKey=n,this.message=i,this.cmtD=[],this.E_x1=t,this.ped=s}step1(){let t=nu.secp256k1.Point.fromPrivateKey(BigInt(this.k1.toString())),r=Jq([this.sessionId,t.x,t.y]);return this.cmtD=r.Msg,r.C}step2(t,r){let n=BigInt(this.k1.toString()),i=nu.secp256k1.Point.fromPrivateKey(n);if(!ab.ecdsaSchnorr.verify(this.sessionId,t,r))throw new Error("schnorr verify fail");return this.R2=r,[ab.ecdsaSchnorr.prove(this.sessionId,n,i),this.cmtD]}step3(t,r){let n={N:BigInt(this.paiPrivKey.pailPubKey.n.toString()),C:BigInt(this.E_x1.toString()),D:BigInt(t.toString()),X:r.X,Y:r.Y};if(!(0,Yq.PaillierAffineVerify)(this.ped,r,n))throw new Error("Paillier Affine verify fail");let s=new ru.BN(F7.n.toString()),a=this.R2?.multiply(BigInt(this.k1.toString()))?.x,f=new ru.BN(a.toString()).mod(new ru.BN(s)),l=this.paiPrivKey.decrypt(t),v=this.k1.invm(s),p=l.mul(v).mod(s),u=s.shrn(1);if(p.cmp(u)==1&&(p=s.sub(p)),p.isZero())throw new Error("calculated S is zero");let h=new nu.secp256k1.Signature(BigInt(f.toString()),BigInt(p.toString()));if(!nu.secp256k1.verify(h,this.message,this.publicKey))throw new Error("ecdsa sign verify fail");return[f,p]}};_l.P1=ob});var T7=U(bs=>{"use strict";H();k();Object.defineProperty(bs,"__esModule",{value:!0});bs.truncateHash=bs.toU8=bs.bits2int_modN=void 0;var R7=2n**256n,Qq=R7-0x1000003d1n,eH=R7-0x14551231950b75fc4402da1732fc9bebfn,tH=e=>Array.from(e).map(t=>rH(t,2)).join(""),rH=(e,t)=>e.toString(16).padStart(t,"0"),nH=e=>BigInt(`0x${tH(e)||"0"}`),iH=e=>{let t=e.length*8-256,r=nH(e);return t>0?r>>BigInt(t):r},sH=e=>aH(iH(e),eH);bs.bits2int_modN=sH;var aH=(e,t=Qq)=>{let r=e%t;return r>=0n?r:t+r},O7=e=>typeof e=="string",oH=(e,t)=>!(e instanceof Uint8Array)||typeof t=="number"&&t>0&&e.length!==t?fb("Uint8Array expected"):e,D7=e=>new Uint8Array(e),fH=(e,t)=>oH(O7(e)?cH(e):D7(e),t);bs.toU8=fH;var cH=e=>{let t=e.length;(!O7(e)||t%2)&&fb("hex invalid 1");let r=D7(t/2);for(let n=0;n<r.length;n++){let i=n*2,s=e.slice(i,i+2),o=Number.parseInt(s,16);(Number.isNaN(o)||o<0)&&fb("hex invalid 2"),r[n]=o}return r},fb=(e="")=>{throw new Error(e)},uH=e=>(0,bs.bits2int_modN)((0,bs.toU8)(e,32));bs.truncateHash=uH});var H7=U(Pl=>{"use strict";H();k();Object.defineProperty(Pl,"__esModule",{value:!0});Pl.P2=void 0;var co=er(),iu=If(),su=er(),Al=ai(),q7=T7(),dH=sb(),hH=(wl(),b0(ml)),Bl=su.secp256k1.CURVE,cb=class{constructor(t,r,n,i,s,o){let a;try{a=(0,co.hexToBigint)(s)}catch{throw new Error(`message not hex: ${s}`)}this.sessionId=(0,Al.SHA256Int)([i.x,i.y,a]),this.x2=t,this.E_x1=r,this.paiPub=n,this.publicKey=i,this.message=s,this.k2=new co.BN((0,Al.RandomNum)(Bl.n).toString()),this.cmtC=0n,this.ped=o}step1(t){this.cmtC=t;let r=su.secp256k1.Point.fromPrivateKey(BigInt(this.k2.toString()));return[iu.ecdsaSchnorr.prove(this.sessionId,BigInt(this.k2.toString()),r),r]}step2(t,r){let n=new co.BN(Bl.n.toString()),i={C:this.cmtC,Msg:r},s=iu.Commitment.Open(i);if(!s)throw new Error("commitment DeCommit fail");if(this.sessionId!==s[0])throw new Error("p2 Step2 commitment sessionId error");let o=new su.secp256k1.Point(s[1],s[2]);if(!iu.ecdsaSchnorr.verify(this.sessionId,t,o))throw new Error("schnorr verify fail");let l=o.multiply(BigInt(this.k2.toString()))?.x,v=new co.BN(l.toString()).mod(n),p=this.k2.invm(n),u=lH(this.message);u=u.mul(p);let b=new co.BN((0,Al.RandomNum)(Bl.n*Bl.n).toString()).mul(n),d=u.add(b),y=v.mul(p),w=d.add(y.mul(this.x2)),_=(0,Al.RandomNum)(BigInt(this.paiPub.n.toString())),I=this.paiPub.homomorphicMulPlain(this.E_x1,y),N=this.paiPub.homomorphicAddPlain(I,w),F=BigInt(this.paiPub.n.toString()),O=BigInt(this.paiPub.n2().toString()),q=new co.BN((0,hH.modPow)(_,F,O).toString()),P=N.mul(q).mod(this.paiPub.n2()),D=iu.ECPoint.fromEcdsaPoint(su.secp256k1.Point.fromPrivateKey(BigInt(y.mod(n).toString()))),A=iu.ECPoint.fromEcdsaPoint(su.secp256k1.Point.fromPrivateKey(BigInt(w.mod(n).toString()))),c={N:BigInt(this.paiPub.n.toString()),C:BigInt(this.E_x1.toString()),D:BigInt(P.toString()),X:D,Y:A},m={X:BigInt(y.toString()),Y:BigInt(w.toString()),Rho:BigInt(_.toString())},S=(0,dH.PaillierAffineProve)(this.ped,c,m);return[P,S]}};Pl.P2=cb;function lH(e){let t=(0,q7.bits2int_modN)((0,q7.toU8)(e,32));return new co.BN(t.toString())}});var L7=U(Qr=>{"use strict";H();k();var k7=Qr&&Qr.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),pH=Qr&&Qr.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ub=Qr&&Qr.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&k7(t,e,r)},j7=Qr&&Qr.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&k7(t,e,r);return pH(t,e),t};Object.defineProperty(Qr,"__esModule",{value:!0});Qr.ed25519TssKey=Qr.ecdsaTssKey=void 0;ub(x7(),Qr);Qr.ecdsaTssKey=j7(yl());Qr.ed25519TssKey=j7(tb());ub(N7(),Qr);ub(H7(),Qr)});var U7=U(K7=>{"use strict";H();k();Object.defineProperty(K7,"__esModule",{value:!0})});var Ml=U(Il=>{"use strict";H();k();Object.defineProperty(Il,"__esModule",{value:!0});Il.md5=void 0;function vH(e){var t="0123456789abcdef";function r(F){var O,q="";for(O=0;O<=3;O++)q+=t.charAt(F>>O*8+4&15)+t.charAt(F>>O*8&15);return q}function n(F,O){var q=(F&65535)+(O&65535),P=(F>>16)+(O>>16)+(q>>16);return P<<16|q&65535}function i(F,O){return F<<O|F>>>32-O}function s(F,O,q,P,D,A){return n(i(n(n(O,F),n(P,A)),D),q)}function o(F,O,q,P,D,A,c){return s(O&q|~O&P,F,O,D,A,c)}function a(F,O,q,P,D,A,c){return s(O&P|q&~P,F,O,D,A,c)}function f(F,O,q,P,D,A,c){return s(O^q^P,F,O,D,A,c)}function l(F,O,q,P,D,A,c){return s(q^(O|~P),F,O,D,A,c)}function v(F){var O,q=(F.length+8>>6)+1,P=new Array(q*16);for(O=0;O<q*16;O++)P[O]=0;for(O=0;O<F.length;O++)P[O>>2]|=F.charCodeAt(O)<<O%4*8;return P[O>>2]|=128<<O%4*8,P[q*16-2]=F.length*8,P}var p,u=v(""+e),h=1732584193,b=-271733879,d=-1732584194,y=271733878,w,_,I,N;for(p=0;p<u.length;p+=16)w=h,_=b,I=d,N=y,h=o(h,b,d,y,u[p+0],7,-680876936),y=o(y,h,b,d,u[p+1],12,-389564586),d=o(d,y,h,b,u[p+2],17,606105819),b=o(b,d,y,h,u[p+3],22,-1044525330),h=o(h,b,d,y,u[p+4],7,-176418897),y=o(y,h,b,d,u[p+5],12,1200080426),d=o(d,y,h,b,u[p+6],17,-1473231341),b=o(b,d,y,h,u[p+7],22,-45705983),h=o(h,b,d,y,u[p+8],7,1770035416),y=o(y,h,b,d,u[p+9],12,-1958414417),d=o(d,y,h,b,u[p+10],17,-42063),b=o(b,d,y,h,u[p+11],22,-1990404162),h=o(h,b,d,y,u[p+12],7,1804603682),y=o(y,h,b,d,u[p+13],12,-40341101),d=o(d,y,h,b,u[p+14],17,-1502002290),b=o(b,d,y,h,u[p+15],22,1236535329),h=a(h,b,d,y,u[p+1],5,-165796510),y=a(y,h,b,d,u[p+6],9,-1069501632),d=a(d,y,h,b,u[p+11],14,643717713),b=a(b,d,y,h,u[p+0],20,-373897302),h=a(h,b,d,y,u[p+5],5,-701558691),y=a(y,h,b,d,u[p+10],9,38016083),d=a(d,y,h,b,u[p+15],14,-660478335),b=a(b,d,y,h,u[p+4],20,-405537848),h=a(h,b,d,y,u[p+9],5,568446438),y=a(y,h,b,d,u[p+14],9,-1019803690),d=a(d,y,h,b,u[p+3],14,-187363961),b=a(b,d,y,h,u[p+8],20,1163531501),h=a(h,b,d,y,u[p+13],5,-1444681467),y=a(y,h,b,d,u[p+2],9,-51403784),d=a(d,y,h,b,u[p+7],14,1735328473),b=a(b,d,y,h,u[p+12],20,-1926607734),h=f(h,b,d,y,u[p+5],4,-378558),y=f(y,h,b,d,u[p+8],11,-2022574463),d=f(d,y,h,b,u[p+11],16,1839030562),b=f(b,d,y,h,u[p+14],23,-35309556),h=f(h,b,d,y,u[p+1],4,-1530992060),y=f(y,h,b,d,u[p+4],11,1272893353),d=f(d,y,h,b,u[p+7],16,-155497632),b=f(b,d,y,h,u[p+10],23,-1094730640),h=f(h,b,d,y,u[p+13],4,681279174),y=f(y,h,b,d,u[p+0],11,-358537222),d=f(d,y,h,b,u[p+3],16,-722521979),b=f(b,d,y,h,u[p+6],23,76029189),h=f(h,b,d,y,u[p+9],4,-640364487),y=f(y,h,b,d,u[p+12],11,-421815835),d=f(d,y,h,b,u[p+15],16,530742520),b=f(b,d,y,h,u[p+2],23,-995338651),h=l(h,b,d,y,u[p+0],6,-198630844),y=l(y,h,b,d,u[p+7],10,1126891415),d=l(d,y,h,b,u[p+14],15,-1416354905),b=l(b,d,y,h,u[p+5],21,-57434055),h=l(h,b,d,y,u[p+12],6,1700485571),y=l(y,h,b,d,u[p+3],10,-1894986606),d=l(d,y,h,b,u[p+10],15,-1051523),b=l(b,d,y,h,u[p+1],21,-2054922799),h=l(h,b,d,y,u[p+8],6,1873313359),y=l(y,h,b,d,u[p+15],10,-30611744),d=l(d,y,h,b,u[p+6],15,-1560198380),b=l(b,d,y,h,u[p+13],21,1309151649),h=l(h,b,d,y,u[p+4],6,-145523070),y=l(y,h,b,d,u[p+11],10,-1120210379),d=l(d,y,h,b,u[p+2],15,718787259),b=l(b,d,y,h,u[p+9],21,-343485551),h=n(h,w),b=n(b,_),d=n(d,I),y=n(y,N);return r(h)+r(b)+r(d)+r(y)}Il.md5=vH});var V7=U(dr=>{"use strict";H();k();Object.defineProperty(dr,"__esModule",{value:!0});dr.sha256HexMsg=dr.GetMapKeyTssSign=dr.MpcVersion=dr.Status=dr.SignStep=dr.FuncType=dr.DeviceNumber=void 0;var Cl=er(),bH=Ml(),gH;(function(e){e[e.P1_No=1]="P1_No",e[e.P2_No=2]="P2_No",e[e.P3_No=3]="P3_No"})(gH=dr.DeviceNumber||(dr.DeviceNumber={}));var yH;(function(e){e[e.ShakeHands=0]="ShakeHands",e[e.KeyGen=1]="KeyGen",e[e.ReShare=2]="ReShare",e[e.TssSign=3]="TssSign"})(yH=dr.FuncType||(dr.FuncType={}));var xH;(function(e){e[e.Step1=1]="Step1",e[e.Step2=2]="Step2",e[e.Step3=3]="Step3"})(xH=dr.SignStep||(dr.SignStep={}));var mH;(function(e){e[e.Success=1]="Success",e[e.Fail=2]="Fail"})(mH=dr.Status||(dr.Status={}));var wH;(function(e){e[e.Version_v0=0]="Version_v0",e[e.Version_v1=1]="Version_v1"})(wH=dr.MpcVersion||(dr.MpcVersion={}));function SH(e,t){let r=(0,bH.md5)(t);return`${e}-${r}`}dr.GetMapKeyTssSign=SH;function EH(e){let t=Cl.secp256k1.CURVE.n,r=Cl.base.sha256(e),n=(0,Cl.bufToBigint)(r)%t,i=(0,Cl.bigintToHex)(n);return i.length%2&&(i="0"+i),i}dr.sha256HexMsg=EH});var W7=U(oi=>{"use strict";H();k();Object.defineProperty(oi,"__esModule",{value:!0});oi.bigintStringify=oi.cvtEd25519MapToObj=oi.cvtObjToEd25519Map=oi.cvtEcdsaMapToObj=oi.cvtObjToEcdsaMap=void 0;var vn=Hi(),_H=Zv(),AH=Jv();function BH(e){let t=new Map;for(let r of Object.keys(e)){let n=e[r],i={};if(n.hasOwnProperty("CmtC")&&n.CmtC!==null&&(i.CmtC=e[r].CmtC),n.hasOwnProperty("Witness")&&n.Witness!==null){i.Witness=[];for(let s of n.Witness)i.Witness.push(s)}n.hasOwnProperty("Proof")&&n.Proof!==null&&(i.Proof=new _H.Proof(new vn.ECPoint(vn.CurveName.Secp256k1.toString(),BigInt(n.Proof.R.X),BigInt(n.Proof.R.Y)),n.Proof.S)),n.hasOwnProperty("R2")&&n.R2!==null&&(i.R2=new vn.ECPoint(vn.CurveName.Secp256k1.toString(),BigInt(n.R2.X),BigInt(n.R2.Y))),n.hasOwnProperty("E_k2_h_rx")&&n.E_k2_h_rx!==null&&(i.E_k2_h_rx=BigInt(n.E_k2_h_rx)),n.hasOwnProperty("Signature")&&n.Signature!==null&&(i.Signature=new vn.Signature(BigInt(n.Signature.r),BigInt(n.Signature.s))),t.set(r,i)}return t}oi.cvtObjToEcdsaMap=BH;function PH(e){let t=Object.fromEntries(e.entries()),r={};for(let n of Object.keys(t)){let i={},s=t[n];if(s.CmtC!=null&&(i.CmtC=s.CmtC.toString(10)),s.Witness!=null){i.Witness=[];for(let o of s.Witness)i.Witness.push(o.toString(10))}s.Proof!=null&&(i.Proof={R:{Curve:vn.CurveName.Secp256k1,X:s.Proof.R.X,Y:s.Proof.R.Y},S:s.Proof.S.toString(10)}),s.R2!=null&&(i.R2={Curve:vn.CurveName.Secp256k1,X:s.R2.X,Y:s.R2.Y}),s.E_k2_h_rx!=null&&(i.E_k2_h_rx=s.E_k2_h_rx.toString()),s.Signature!=null&&(i.Signature={r:s.Signature.r,s:s.Signature.s}),r[n]=i}return r}oi.cvtEcdsaMapToObj=PH;function IH(e){let t=new Map;for(let r of Object.keys(e)){let n=e[r],i={};if(n.hasOwnProperty("OutputDataMap")&&n.OutputDataMap!=null){i.TssInput=[];for(let s of Object.keys(n.OutputDataMap))Number(s)===vn.DeviceNumber.P2_No&&i.TssInput.push(MH(n.OutputDataMap[s]))}n.hasOwnProperty("Signature")&&n.Signature!=null&&(i.Signature=new vn.Signature(BigInt(n.Signature.r),BigInt(n.Signature.s))),t.set(r,i)}return t}oi.cvtObjToEd25519Map=IH;function MH(e){let t={};if(e==null)return t;t.from=e.From,t.to=e.To;let r=(0,vn.JsonParseBigInt)(e.Data);if(t.data={},r.C!==void 0&&(t.data.c=r.C),r.Witness!==void 0){let n=[];if(r.hasOwnProperty("Witness"))for(let i of r.Witness)n.push(i);t.data.witness=n}return r.Proof!==void 0&&(t.data.proof=new AH.Proof(new vn.ECPoint(vn.CurveName.Ed25519.toString(),BigInt(r.Proof.R.X),BigInt(r.Proof.R.Y)),BigInt(r.Proof.S))),t}function CH(e){let t={};for(let[r,n]of e.entries()){let i={};if(n.OutputDataMap!=null){let s=[];for(let[o,a]of n.OutputDataMap.entries())o===vn.DeviceNumber.P1_No&&s.push({From:vn.DeviceNumber.P2_No,To:vn.DeviceNumber.P1_No,Data:FH(a.data)});i.TssInput=s}n.Signature!=null&&(i.Signature={r:n.Signature.r,s:n.Signature.s}),t[r]=i}return t}oi.cvtEd25519MapToObj=CH;function FH(e){let t={};if(e.c!==void 0)t.C=e.c.toString(10);else if(e.witness!==void 0&&e.proof!==void 0){let r=[];for(let n of e.witness)r.push(n.toString(10));t.Witness=r,t.Proof={R:{Curve:vn.CurveName.Ed25519,X:e.proof.R.X,Y:e.proof.R.Y},S:e.proof.S}}return z7(t)}function z7(e){return JSON.stringify(e,(n,i)=>typeof i=="bigint"?i.toString():i).replace(/"(\d{16,})"/g,(n,i)=>i)}oi.bigintStringify=z7});var Ib=U(ee=>{H();k();var au={};au.userAgent=!1;var Rf={},NH="10.9.0",RH="jsrsasign(all) 10.9.0 (2023-11-27) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license";var ne=ne||function(e,t){var r={},n=r.lib={},i=n.Base=function(){function h(){}return{extend:function(b){h.prototype=this;var d=new h;return b&&d.mixIn(b),d.hasOwnProperty("init")||(d.init=function(){d.$super.init.apply(this,arguments)}),d.init.prototype=d,d.$super=this,d},create:function(){var b=this.extend();return b.init.apply(b,arguments),b},init:function(){},mixIn:function(b){for(var d in b)b.hasOwnProperty(d)&&(this[d]=b[d]);b.hasOwnProperty("toString")&&(this.toString=b.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=n.WordArray=i.extend({init:function(h,b){h=this.words=h||[],b!=t?this.sigBytes=b:this.sigBytes=h.length*4},toString:function(h){return(h||a).stringify(this)},concat:function(h){var b=this.words,d=h.words,y=this.sigBytes,w=h.sigBytes;if(this.clamp(),y%4)for(var _=0;_<w;_++){var I=d[_>>>2]>>>24-_%4*8&255;b[y+_>>>2]|=I<<24-(y+_)%4*8}else for(var _=0;_<w;_+=4)b[y+_>>>2]=d[_>>>2];return this.sigBytes+=w,this},clamp:function(){var h=this.words,b=this.sigBytes;h[b>>>2]&=4294967295<<32-b%4*8,h.length=e.ceil(b/4)},clone:function(){var h=i.clone.call(this);return h.words=this.words.slice(0),h},random:function(h){for(var b=[],d=0;d<h;d+=4)b.push(e.random()*4294967296|0);return new s.init(b,h)}}),o=r.enc={},a=o.Hex={stringify:function(h){for(var b=h.words,d=h.sigBytes,y=[],w=0;w<d;w++){var _=b[w>>>2]>>>24-w%4*8&255;y.push((_>>>4).toString(16)),y.push((_&15).toString(16))}return y.join("")},parse:function(h){for(var b=h.length,d=[],y=0;y<b;y+=2)d[y>>>3]|=parseInt(h.substr(y,2),16)<<24-y%8*4;return new s.init(d,b/2)}},f=o.Latin1={stringify:function(h){for(var b=h.words,d=h.sigBytes,y=[],w=0;w<d;w++){var _=b[w>>>2]>>>24-w%4*8&255;y.push(String.fromCharCode(_))}return y.join("")},parse:function(h){for(var b=h.length,d=[],y=0;y<b;y++)d[y>>>2]|=(h.charCodeAt(y)&255)<<24-y%4*8;return new s.init(d,b)}},l=o.Utf8={stringify:function(h){try{return decodeURIComponent(escape(f.stringify(h)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(h){return f.parse(unescape(encodeURIComponent(h)))}},v=n.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(h){typeof h=="string"&&(h=l.parse(h)),this._data.concat(h),this._nDataBytes+=h.sigBytes},_process:function(h){var b=this._data,d=b.words,y=b.sigBytes,w=this.blockSize,_=w*4,I=y/_;h?I=e.ceil(I):I=e.max((I|0)-this._minBufferSize,0);var N=I*w,F=e.min(N*4,y);if(N){for(var O=0;O<N;O+=w)this._doProcessBlock(d,O);var q=d.splice(0,N);b.sigBytes-=F}return new s.init(q,F)},clone:function(){var h=i.clone.call(this);return h._data=this._data.clone(),h},_minBufferSize:0}),p=n.Hasher=v.extend({cfg:i.extend(),init:function(h){this.cfg=this.cfg.extend(h),this.reset()},reset:function(){v.reset.call(this),this._doReset()},update:function(h){return this._append(h),this._process(),this},finalize:function(h){h&&this._append(h);var b=this._doFinalize();return b},blockSize:512/32,_createHelper:function(h){return function(b,d){return new h.init(d).finalize(b)}},_createHmacHelper:function(h){return function(b,d){return new u.HMAC.init(h,d).finalize(b)}}}),u=r.algo={};return r}(Math);(function(e){var i=ne,t=i.lib,r=t.Base,n=t.WordArray,i=i.x64={};i.Word=r.extend({init:function(s,o){this.high=s,this.low=o}}),i.WordArray=r.extend({init:function(s,o){s=this.words=s||[],this.sigBytes=o!=e?o:8*s.length},toX32:function(){for(var s=this.words,o=s.length,a=[],f=0;f<o;f++){var l=s[f];a.push(l.high),a.push(l.low)}return n.create(a,this.sigBytes)},clone:function(){for(var s=r.clone.call(this),o=s.words=this.words.slice(0),a=o.length,f=0;f<a;f++)o[f]=o[f].clone();return s}})})();ne.lib.Cipher||function(e){var h=ne,t=h.lib,r=t.Base,n=t.WordArray,i=t.BufferedBlockAlgorithm,s=h.enc.Base64,o=h.algo.EvpKDF,a=t.Cipher=i.extend({cfg:r.extend(),createEncryptor:function(d,y){return this.create(this._ENC_XFORM_MODE,d,y)},createDecryptor:function(d,y){return this.create(this._DEC_XFORM_MODE,d,y)},init:function(d,y,w){this.cfg=this.cfg.extend(w),this._xformMode=d,this._key=y,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(d){return this._append(d),this._process()},finalize:function(d){return d&&this._append(d),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(d){return{encrypt:function(y,w,_){return(typeof w=="string"?b:u).encrypt(d,y,w,_)},decrypt:function(y,w,_){return(typeof w=="string"?b:u).decrypt(d,y,w,_)}}}});t.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var p=h.mode={},f=function(d,y,w){var _=this._iv;_?this._iv=e:_=this._prevBlock;for(var I=0;I<w;I++)d[y+I]^=_[I]},l=(t.BlockCipherMode=r.extend({createEncryptor:function(d,y){return this.Encryptor.create(d,y)},createDecryptor:function(d,y){return this.Decryptor.create(d,y)},init:function(d,y){this._cipher=d,this._iv=y}})).extend();l.Encryptor=l.extend({processBlock:function(d,y){var w=this._cipher,_=w.blockSize;f.call(this,d,y,_),w.encryptBlock(d,y),this._prevBlock=d.slice(y,y+_)}}),l.Decryptor=l.extend({processBlock:function(d,y){var w=this._cipher,_=w.blockSize,I=d.slice(y,y+_);w.decryptBlock(d,y),f.call(this,d,y,_),this._prevBlock=I}}),p=p.CBC=l,l=(h.pad={}).Pkcs7={pad:function(d,y){for(var w=4*y,w=w-d.sigBytes%w,_=w<<24|w<<16|w<<8|w,I=[],N=0;N<w;N+=4)I.push(_);w=n.create(I,w),d.concat(w)},unpad:function(d){d.sigBytes-=d.words[d.sigBytes-1>>>2]&255}},t.BlockCipher=a.extend({cfg:a.cfg.extend({mode:p,padding:l}),reset:function(){a.reset.call(this);var y=this.cfg,d=y.iv,y=y.mode;if(this._xformMode==this._ENC_XFORM_MODE)var w=y.createEncryptor;else w=y.createDecryptor,this._minBufferSize=1;this._mode=w.call(y,this,d&&d.words)},_doProcessBlock:function(d,y){this._mode.processBlock(d,y)},_doFinalize:function(){var d=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){d.pad(this._data,this.blockSize);var y=this._process(!0)}else y=this._process(!0),d.unpad(y);return y},blockSize:4});var v=t.CipherParams=r.extend({init:function(d){this.mixIn(d)},toString:function(d){return(d||this.formatter).stringify(this)}}),p=(h.format={}).OpenSSL={stringify:function(d){var y=d.ciphertext;return d=d.salt,(d?n.create([1398893684,1701076831]).concat(d).concat(y):y).toString(s)},parse:function(d){d=s.parse(d);var y=d.words;if(y[0]==1398893684&&y[1]==1701076831){var w=n.create(y.slice(2,4));y.splice(0,4),d.sigBytes-=16}return v.create({ciphertext:d,salt:w})}},u=t.SerializableCipher=r.extend({cfg:r.extend({format:p}),encrypt:function(d,y,w,_){_=this.cfg.extend(_);var I=d.createEncryptor(w,_);return y=I.finalize(y),I=I.cfg,v.create({ciphertext:y,key:w,iv:I.iv,algorithm:d,mode:I.mode,padding:I.padding,blockSize:d.blockSize,formatter:_.format})},decrypt:function(d,y,w,_){return _=this.cfg.extend(_),y=this._parse(y,_.format),d.createDecryptor(w,_).finalize(y.ciphertext)},_parse:function(d,y){return typeof d=="string"?y.parse(d,this):d}}),h=(h.kdf={}).OpenSSL={execute:function(d,y,w,_){return _||(_=n.random(8)),d=o.create({keySize:y+w}).compute(d,_),w=n.create(d.words.slice(y),4*w),d.sigBytes=4*y,v.create({key:d,iv:w,salt:_})}},b=t.PasswordBasedCipher=u.extend({cfg:u.cfg.extend({kdf:h}),encrypt:function(d,y,w,_){return _=this.cfg.extend(_),w=_.kdf.execute(w,d.keySize,d.ivSize),_.iv=w.iv,d=u.encrypt.call(this,d,y,w.key,_),d.mixIn(w),d},decrypt:function(d,y,w,_){return _=this.cfg.extend(_),y=this._parse(y,_.format),w=_.kdf.execute(w,d.keySize,d.ivSize,y.salt),_.iv=w.iv,u.decrypt.call(this,d,y,w.key,_)}})}();(function(){for(var e=ne,t=e.lib.BlockCipher,O=e.algo,r=[],n=[],i=[],s=[],o=[],a=[],f=[],l=[],v=[],p=[],u=[],h=0;256>h;h++)u[h]=128>h?h<<1:h<<1^283;for(var b=0,d=0,h=0;256>h;h++){var y=d^d<<1^d<<2^d<<3^d<<4,y=y>>>8^y&255^99;r[b]=y,n[y]=b;var w=u[b],_=u[w],I=u[_],N=257*u[y]^16843008*y;i[b]=N<<24|N>>>8,s[b]=N<<16|N>>>16,o[b]=N<<8|N>>>24,a[b]=N,N=16843009*I^65537*_^257*w^16843008*b,f[y]=N<<24|N>>>8,l[y]=N<<16|N>>>16,v[y]=N<<8|N>>>24,p[y]=N,b?(b=w^u[u[u[I^w]]],d^=u[u[d]]):b=d=1}var F=[0,1,2,4,8,16,32,64,128,27,54],O=O.AES=t.extend({_doReset:function(){for(var D=this._key,q=D.words,P=D.sigBytes/4,D=4*((this._nRounds=P+6)+1),A=this._keySchedule=[],c=0;c<D;c++)if(c<P)A[c]=q[c];else{var m=A[c-1];c%P?6<P&&c%P==4&&(m=r[m>>>24]<<24|r[m>>>16&255]<<16|r[m>>>8&255]<<8|r[m&255]):(m=m<<8|m>>>24,m=r[m>>>24]<<24|r[m>>>16&255]<<16|r[m>>>8&255]<<8|r[m&255],m^=F[c/P|0]<<24),A[c]=A[c-P]^m}for(q=this._invKeySchedule=[],P=0;P<D;P++)c=D-P,m=P%4?A[c]:A[c-4],q[P]=4>P||4>=c?m:f[r[m>>>24]]^l[r[m>>>16&255]]^v[r[m>>>8&255]]^p[r[m&255]]},encryptBlock:function(q,P){this._doCryptBlock(q,P,this._keySchedule,i,s,o,a,r)},decryptBlock:function(q,P){var D=q[P+1];q[P+1]=q[P+3],q[P+3]=D,this._doCryptBlock(q,P,this._invKeySchedule,f,l,v,p,n),D=q[P+1],q[P+1]=q[P+3],q[P+3]=D},_doCryptBlock:function(q,P,D,A,c,m,S,g){for(var E=this._nRounds,L=q[P]^D[0],V=q[P+1]^D[1],z=q[P+2]^D[2],K=q[P+3]^D[3],M=4,T=1;T<E;T++)var R=A[L>>>24]^c[V>>>16&255]^m[z>>>8&255]^S[K&255]^D[M++],x=A[V>>>24]^c[z>>>16&255]^m[K>>>8&255]^S[L&255]^D[M++],C=A[z>>>24]^c[K>>>16&255]^m[L>>>8&255]^S[V&255]^D[M++],K=A[K>>>24]^c[L>>>16&255]^m[V>>>8&255]^S[z&255]^D[M++],L=R,V=x,z=C;R=(g[L>>>24]<<24|g[V>>>16&255]<<16|g[z>>>8&255]<<8|g[K&255])^D[M++],x=(g[V>>>24]<<24|g[z>>>16&255]<<16|g[K>>>8&255]<<8|g[L&255])^D[M++],C=(g[z>>>24]<<24|g[K>>>16&255]<<16|g[L>>>8&255]<<8|g[V&255])^D[M++],K=(g[K>>>24]<<24|g[L>>>16&255]<<16|g[V>>>8&255]<<8|g[z&255])^D[M++],q[P]=R,q[P+1]=x,q[P+2]=C,q[P+3]=K},keySize:8});e.AES=t._createHelper(O)})();(function(){function e(u,h){var b=(this._lBlock>>>u^this._rBlock)&h;this._rBlock^=b,this._lBlock^=b<<u}function t(u,h){var b=(this._rBlock>>>u^this._lBlock)&h;this._lBlock^=b,this._rBlock^=b<<u}var r=ne,i=r.lib,n=i.WordArray,i=i.BlockCipher,s=r.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],f=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],v=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=s.DES=i.extend({_doReset:function(){for(var u=this._key.words,h=[],b=0;56>b;b++){var d=o[b]-1;h[b]=u[d>>>5]>>>31-d%32&1}for(u=this._subKeys=[],d=0;16>d;d++){for(var y=u[d]=[],w=f[d],b=0;24>b;b++)y[b/6|0]|=h[(a[b]-1+w)%28]<<31-b%6,y[4+(b/6|0)]|=h[28+(a[b+24]-1+w)%28]<<31-b%6;for(y[0]=y[0]<<1|y[0]>>>31,b=1;7>b;b++)y[b]>>>=4*(b-1)+3;y[7]=y[7]<<5|y[7]>>>27}for(h=this._invSubKeys=[],b=0;16>b;b++)h[b]=u[15-b]},encryptBlock:function(u,h){this._doCryptBlock(u,h,this._subKeys)},decryptBlock:function(u,h){this._doCryptBlock(u,h,this._invSubKeys)},_doCryptBlock:function(u,h,b){this._lBlock=u[h],this._rBlock=u[h+1],e.call(this,4,252645135),e.call(this,16,65535),t.call(this,2,858993459),t.call(this,8,16711935),e.call(this,1,1431655765);for(var d=0;16>d;d++){for(var y=b[d],w=this._lBlock,_=this._rBlock,I=0,N=0;8>N;N++)I|=l[N][((_^y[N])&v[N])>>>0];this._lBlock=_,this._rBlock=w^I}b=this._lBlock,this._lBlock=this._rBlock,this._rBlock=b,e.call(this,1,1431655765),t.call(this,8,16711935),t.call(this,2,858993459),e.call(this,16,65535),e.call(this,4,252645135),u[h]=this._lBlock,u[h+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});r.DES=i._createHelper(p),s=s.TripleDES=i.extend({_doReset:function(){var u=this._key.words;this._des1=p.createEncryptor(n.create(u.slice(0,2))),this._des2=p.createEncryptor(n.create(u.slice(2,4))),this._des3=p.createEncryptor(n.create(u.slice(4,6)))},encryptBlock:function(u,h){this._des1.encryptBlock(u,h),this._des2.decryptBlock(u,h),this._des3.encryptBlock(u,h)},decryptBlock:function(u,h){this._des3.decryptBlock(u,h),this._des2.encryptBlock(u,h),this._des1.decryptBlock(u,h)},keySize:6,ivSize:2,blockSize:2}),r.TripleDES=i._createHelper(s)})();(function(){var e=ne,t=e.lib.WordArray;e.enc.Base64={stringify:function(r){var n=r.words,i=r.sigBytes,s=this._map;r.clamp(),r=[];for(var o=0;o<i;o+=3)for(var a=(n[o>>>2]>>>24-8*(o%4)&255)<<16|(n[o+1>>>2]>>>24-8*((o+1)%4)&255)<<8|n[o+2>>>2]>>>24-8*((o+2)%4)&255,f=0;4>f&&o+.75*f<i;f++)r.push(s.charAt(a>>>6*(3-f)&63));if(n=s.charAt(64))for(;r.length%4;)r.push(n);return r.join("")},parse:function(r){var n=r.length,i=this._map,s=i.charAt(64);s&&(s=r.indexOf(s),s!=-1&&(n=s));for(var s=[],o=0,a=0;a<n;a++)if(a%4){var f=i.indexOf(r.charAt(a-1))<<2*(a%4),l=i.indexOf(r.charAt(a))>>>6-2*(a%4);s[o>>>2]|=(f|l)<<24-8*(o%4),o++}return t.create(s,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(e){function t(p,u,h,b,d,y,w){return p=p+(u&h|~u&b)+d+w,(p<<y|p>>>32-y)+u}function r(p,u,h,b,d,y,w){return p=p+(u&b|h&~b)+d+w,(p<<y|p>>>32-y)+u}function n(p,u,h,b,d,y,w){return p=p+(u^h^b)+d+w,(p<<y|p>>>32-y)+u}function i(p,u,h,b,d,y,w){return p=p+(h^(u|~b))+d+w,(p<<y|p>>>32-y)+u}for(var s=ne,f=s.lib,o=f.WordArray,a=f.Hasher,f=s.algo,l=[],v=0;64>v;v++)l[v]=4294967296*e.abs(e.sin(v+1))|0;f=f.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(p,u){for(var h=0;16>h;h++){var b=u+h,d=p[b];p[b]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360}var h=this._hash.words,b=p[u+0],d=p[u+1],y=p[u+2],w=p[u+3],_=p[u+4],I=p[u+5],N=p[u+6],F=p[u+7],O=p[u+8],q=p[u+9],P=p[u+10],D=p[u+11],A=p[u+12],c=p[u+13],m=p[u+14],S=p[u+15],g=h[0],T=h[1],M=h[2],E=h[3],g=t(g,T,M,E,b,7,l[0]),E=t(E,g,T,M,d,12,l[1]),M=t(M,E,g,T,y,17,l[2]),T=t(T,M,E,g,w,22,l[3]),g=t(g,T,M,E,_,7,l[4]),E=t(E,g,T,M,I,12,l[5]),M=t(M,E,g,T,N,17,l[6]),T=t(T,M,E,g,F,22,l[7]),g=t(g,T,M,E,O,7,l[8]),E=t(E,g,T,M,q,12,l[9]),M=t(M,E,g,T,P,17,l[10]),T=t(T,M,E,g,D,22,l[11]),g=t(g,T,M,E,A,7,l[12]),E=t(E,g,T,M,c,12,l[13]),M=t(M,E,g,T,m,17,l[14]),T=t(T,M,E,g,S,22,l[15]),g=r(g,T,M,E,d,5,l[16]),E=r(E,g,T,M,N,9,l[17]),M=r(M,E,g,T,D,14,l[18]),T=r(T,M,E,g,b,20,l[19]),g=r(g,T,M,E,I,5,l[20]),E=r(E,g,T,M,P,9,l[21]),M=r(M,E,g,T,S,14,l[22]),T=r(T,M,E,g,_,20,l[23]),g=r(g,T,M,E,q,5,l[24]),E=r(E,g,T,M,m,9,l[25]),M=r(M,E,g,T,w,14,l[26]),T=r(T,M,E,g,O,20,l[27]),g=r(g,T,M,E,c,5,l[28]),E=r(E,g,T,M,y,9,l[29]),M=r(M,E,g,T,F,14,l[30]),T=r(T,M,E,g,A,20,l[31]),g=n(g,T,M,E,I,4,l[32]),E=n(E,g,T,M,O,11,l[33]),M=n(M,E,g,T,D,16,l[34]),T=n(T,M,E,g,m,23,l[35]),g=n(g,T,M,E,d,4,l[36]),E=n(E,g,T,M,_,11,l[37]),M=n(M,E,g,T,F,16,l[38]),T=n(T,M,E,g,P,23,l[39]),g=n(g,T,M,E,c,4,l[40]),E=n(E,g,T,M,b,11,l[41]),M=n(M,E,g,T,w,16,l[42]),T=n(T,M,E,g,N,23,l[43]),g=n(g,T,M,E,q,4,l[44]),E=n(E,g,T,M,A,11,l[45]),M=n(M,E,g,T,S,16,l[46]),T=n(T,M,E,g,y,23,l[47]),g=i(g,T,M,E,b,6,l[48]),E=i(E,g,T,M,F,10,l[49]),M=i(M,E,g,T,m,15,l[50]),T=i(T,M,E,g,I,21,l[51]),g=i(g,T,M,E,A,6,l[52]),E=i(E,g,T,M,w,10,l[53]),M=i(M,E,g,T,P,15,l[54]),T=i(T,M,E,g,d,21,l[55]),g=i(g,T,M,E,O,6,l[56]),E=i(E,g,T,M,S,10,l[57]),M=i(M,E,g,T,N,15,l[58]),T=i(T,M,E,g,c,21,l[59]),g=i(g,T,M,E,_,6,l[60]),E=i(E,g,T,M,D,10,l[61]),M=i(M,E,g,T,y,15,l[62]),T=i(T,M,E,g,q,21,l[63]);h[0]=h[0]+g|0,h[1]=h[1]+T|0,h[2]=h[2]+M|0,h[3]=h[3]+E|0},_doFinalize:function(){var p=this._data,u=p.words,h=8*this._nDataBytes,b=8*p.sigBytes;u[b>>>5]|=128<<24-b%32;var d=e.floor(h/4294967296);for(u[(b+64>>>9<<4)+15]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,u[(b+64>>>9<<4)+14]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360,p.sigBytes=4*(u.length+1),this._process(),p=this._hash,u=p.words,h=0;4>h;h++)b=u[h],u[h]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360;return p},clone:function(){var p=a.clone.call(this);return p._hash=this._hash.clone(),p}}),s.MD5=a._createHelper(f),s.HmacMD5=a._createHmacHelper(f)})(Math);(function(){var e=ne,i=e.lib,t=i.WordArray,r=i.Hasher,n=[],i=e.algo.SHA1=r.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(s,o){for(var a=this._hash.words,f=a[0],l=a[1],v=a[2],p=a[3],u=a[4],h=0;80>h;h++){if(16>h)n[h]=s[o+h]|0;else{var b=n[h-3]^n[h-8]^n[h-14]^n[h-16];n[h]=b<<1|b>>>31}b=(f<<5|f>>>27)+u+n[h],b=20>h?b+((l&v|~l&p)+1518500249):40>h?b+((l^v^p)+1859775393):60>h?b+((l&v|l&p|v&p)-1894007588):b+((l^v^p)-899497514),u=p,p=v,v=l<<30|l>>>2,l=f,f=b}a[0]=a[0]+f|0,a[1]=a[1]+l|0,a[2]=a[2]+v|0,a[3]=a[3]+p|0,a[4]=a[4]+u|0},_doFinalize:function(){var s=this._data,o=s.words,a=8*this._nDataBytes,f=8*s.sigBytes;return o[f>>>5]|=128<<24-f%32,o[(f+64>>>9<<4)+14]=Math.floor(a/4294967296),o[(f+64>>>9<<4)+15]=a,s.sigBytes=4*o.length,this._process(),this._hash},clone:function(){var s=r.clone.call(this);return s._hash=this._hash.clone(),s}});e.SHA1=r._createHelper(i),e.HmacSHA1=r._createHmacHelper(i)})();(function(e){for(var t=ne,h=t.lib,r=h.WordArray,n=h.Hasher,h=t.algo,i=[],s=[],o=function(d){return 4294967296*(d-(d|0))|0},a=2,f=0;64>f;){var l;e:{l=a;for(var v=e.sqrt(l),p=2;p<=v;p++)if(!(l%p)){l=!1;break e}l=!0}l&&(8>f&&(i[f]=o(e.pow(a,.5))),s[f]=o(e.pow(a,1/3)),f++),a++}var u=[],h=h.SHA256=n.extend({_doReset:function(){this._hash=new r.init(i.slice(0))},_doProcessBlock:function(b,d){for(var y=this._hash.words,w=y[0],_=y[1],I=y[2],N=y[3],F=y[4],O=y[5],q=y[6],P=y[7],D=0;64>D;D++){if(16>D)u[D]=b[d+D]|0;else{var A=u[D-15],c=u[D-2];u[D]=((A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3)+u[D-7]+((c<<15|c>>>17)^(c<<13|c>>>19)^c>>>10)+u[D-16]}A=P+((F<<26|F>>>6)^(F<<21|F>>>11)^(F<<7|F>>>25))+(F&O^~F&q)+s[D]+u[D],c=((w<<30|w>>>2)^(w<<19|w>>>13)^(w<<10|w>>>22))+(w&_^w&I^_&I),P=q,q=O,O=F,F=N+A|0,N=I,I=_,_=w,w=A+c|0}y[0]=y[0]+w|0,y[1]=y[1]+_|0,y[2]=y[2]+I|0,y[3]=y[3]+N|0,y[4]=y[4]+F|0,y[5]=y[5]+O|0,y[6]=y[6]+q|0,y[7]=y[7]+P|0},_doFinalize:function(){var b=this._data,d=b.words,y=8*this._nDataBytes,w=8*b.sigBytes;return d[w>>>5]|=128<<24-w%32,d[(w+64>>>9<<4)+14]=e.floor(y/4294967296),d[(w+64>>>9<<4)+15]=y,b.sigBytes=4*d.length,this._process(),this._hash},clone:function(){var b=n.clone.call(this);return b._hash=this._hash.clone(),b}});t.SHA256=n._createHelper(h),t.HmacSHA256=n._createHmacHelper(h)})(Math);(function(){var e=ne,t=e.lib.WordArray,n=e.algo,r=n.SHA256,n=n.SHA224=r.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var i=r._doFinalize.call(this);return i.sigBytes-=4,i}});e.SHA224=r._createHelper(n),e.HmacSHA224=r._createHmacHelper(n)})();(function(){function e(){return n.create.apply(n,arguments)}for(var t=ne,r=t.lib.Hasher,s=t.x64,n=s.Word,i=s.WordArray,s=t.algo,o=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],a=[],f=0;80>f;f++)a[f]=e();s=s.SHA512=r.extend({_doReset:function(){this._hash=new i.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(l,v){for(var _=this._hash.words,p=_[0],u=_[1],h=_[2],b=_[3],d=_[4],y=_[5],w=_[6],_=_[7],I=p.high,N=p.low,F=u.high,O=u.low,q=h.high,P=h.low,D=b.high,A=b.low,c=d.high,m=d.low,S=y.high,g=y.low,E=w.high,M=w.low,T=_.high,R=_.low,x=I,C=N,K=F,L=O,V=q,z=P,G=D,$=A,oe=c,Q=m,te=S,ve=g,J=E,Z=M,Ce=T,se=R,re=0;80>re;re++){var Ee=a[re];if(16>re)var ft=Ee.high=l[v+2*re]|0,ae=Ee.low=l[v+2*re+1]|0;else{var ft=a[re-15],ae=ft.high,ge=ft.low,ft=(ae>>>1|ge<<31)^(ae>>>8|ge<<24)^ae>>>7,ge=(ge>>>1|ae<<31)^(ge>>>8|ae<<24)^(ge>>>7|ae<<25),pe=a[re-2],ae=pe.high,ie=pe.low,pe=(ae>>>19|ie<<13)^(ae<<3|ie>>>29)^ae>>>6,ie=(ie>>>19|ae<<13)^(ie<<3|ae>>>29)^(ie>>>6|ae<<26),ae=a[re-7],_e=ae.high,be=a[re-16],Rt=be.high,be=be.low,ae=ge+ae.low,ft=ft+_e+(ae>>>0<ge>>>0?1:0),ae=ae+ie,ft=ft+pe+(ae>>>0<ie>>>0?1:0),ae=ae+be,ft=ft+Rt+(ae>>>0<be>>>0?1:0);Ee.high=ft,Ee.low=ae}var _e=oe&te^~oe&J,be=Q&ve^~Q&Z,Ee=x&K^x&V^K&V,Bt=C&L^C&z^L&z,ge=(x>>>28|C<<4)^(x<<30|C>>>2)^(x<<25|C>>>7),pe=(C>>>28|x<<4)^(C<<30|x>>>2)^(C<<25|x>>>7),ie=o[re],Pt=ie.high,Fe=ie.low,ie=se+((Q>>>14|oe<<18)^(Q>>>18|oe<<14)^(Q<<23|oe>>>9)),Rt=Ce+((oe>>>14|Q<<18)^(oe>>>18|Q<<14)^(oe<<23|Q>>>9))+(ie>>>0<se>>>0?1:0),ie=ie+be,Rt=Rt+_e+(ie>>>0<be>>>0?1:0),ie=ie+Fe,Rt=Rt+Pt+(ie>>>0<Fe>>>0?1:0),ie=ie+ae,Rt=Rt+ft+(ie>>>0<ae>>>0?1:0),ae=pe+Bt,Ee=ge+Ee+(ae>>>0<pe>>>0?1:0),Ce=J,se=Z,J=te,Z=ve,te=oe,ve=Q,Q=$+ie|0,oe=G+Rt+(Q>>>0<$>>>0?1:0)|0,G=V,$=z,V=K,z=L,K=x,L=C,C=ie+ae|0,x=Rt+Ee+(C>>>0<ie>>>0?1:0)|0}N=p.low=N+C,p.high=I+x+(N>>>0<C>>>0?1:0),O=u.low=O+L,u.high=F+K+(O>>>0<L>>>0?1:0),P=h.low=P+z,h.high=q+V+(P>>>0<z>>>0?1:0),A=b.low=A+$,b.high=D+G+(A>>>0<$>>>0?1:0),m=d.low=m+Q,d.high=c+oe+(m>>>0<Q>>>0?1:0),g=y.low=g+ve,y.high=S+te+(g>>>0<ve>>>0?1:0),M=w.low=M+Z,w.high=E+J+(M>>>0<Z>>>0?1:0),R=_.low=R+se,_.high=T+Ce+(R>>>0<se>>>0?1:0)},_doFinalize:function(){var l=this._data,v=l.words,p=8*this._nDataBytes,u=8*l.sigBytes;return v[u>>>5]|=128<<24-u%32,v[(u+128>>>10<<5)+30]=Math.floor(p/4294967296),v[(u+128>>>10<<5)+31]=p,l.sigBytes=4*v.length,this._process(),this._hash.toX32()},clone:function(){var l=r.clone.call(this);return l._hash=this._hash.clone(),l},blockSize:32}),t.SHA512=r._createHelper(s),t.HmacSHA512=r._createHmacHelper(s)})();(function(){var e=ne,i=e.x64,t=i.Word,r=i.WordArray,i=e.algo,n=i.SHA512,i=i.SHA384=n.extend({_doReset:function(){this._hash=new r.init([new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)])},_doFinalize:function(){var s=n._doFinalize.call(this);return s.sigBytes-=16,s}});e.SHA384=n._createHelper(i),e.HmacSHA384=n._createHmacHelper(i)})();(function(){var e=ne,l=e.lib,t=l.WordArray,r=l.Hasher,l=e.algo,n=t.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),i=t.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),s=t.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),o=t.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),a=t.create([0,1518500249,1859775393,2400959708,2840853838]),f=t.create([1352829926,1548603684,1836072691,2053994217,0]),l=l.RIPEMD160=r.extend({_doReset:function(){this._hash=t.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(v,p){for(var u=0;16>u;u++){var h=p+u,b=v[h];v[h]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360}var h=this._hash.words,b=a.words,d=f.words,y=n.words,w=i.words,_=s.words,I=o.words,N,F,O,q,P,D,A,c,m,S;D=N=h[0],A=F=h[1],c=O=h[2],m=q=h[3],S=P=h[4];for(var g,u=0;80>u;u+=1)g=N+v[p+y[u]]|0,g=16>u?g+((F^O^q)+b[0]):32>u?g+((F&O|~F&q)+b[1]):48>u?g+(((F|~O)^q)+b[2]):64>u?g+((F&q|O&~q)+b[3]):g+((F^(O|~q))+b[4]),g|=0,g=g<<_[u]|g>>>32-_[u],g=g+P|0,N=P,P=q,q=O<<10|O>>>22,O=F,F=g,g=D+v[p+w[u]]|0,g=16>u?g+((A^(c|~m))+d[0]):32>u?g+((A&m|c&~m)+d[1]):48>u?g+(((A|~c)^m)+d[2]):64>u?g+((A&c|~A&m)+d[3]):g+((A^c^m)+d[4]),g|=0,g=g<<I[u]|g>>>32-I[u],g=g+S|0,D=S,S=m,m=c<<10|c>>>22,c=A,A=g;g=h[1]+O+m|0,h[1]=h[2]+q+S|0,h[2]=h[3]+P+D|0,h[3]=h[4]+N+A|0,h[4]=h[0]+F+c|0,h[0]=g},_doFinalize:function(){var v=this._data,p=v.words,u=8*this._nDataBytes,h=8*v.sigBytes;for(p[h>>>5]|=128<<24-h%32,p[(h+64>>>9<<4)+14]=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360,v.sigBytes=4*(p.length+1),this._process(),v=this._hash,p=v.words,u=0;5>u;u++)h=p[u],p[u]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360;return v},clone:function(){var v=r.clone.call(this);return v._hash=this._hash.clone(),v}});e.RIPEMD160=r._createHelper(l),e.HmacRIPEMD160=r._createHmacHelper(l)})(Math);(function(){var e=ne,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(r,n){r=this._hasher=new r.init,typeof n=="string"&&(n=t.parse(n));var i=r.blockSize,s=4*i;n.sigBytes>s&&(n=r.finalize(n)),n.clamp();for(var o=this._oKey=n.clone(),a=this._iKey=n.clone(),f=o.words,l=a.words,v=0;v<i;v++)f[v]^=1549556828,l[v]^=909522486;o.sigBytes=a.sigBytes=s,this.reset()},reset:function(){var r=this._hasher;r.reset(),r.update(this._iKey)},update:function(r){return this._hasher.update(r),this},finalize:function(r){var n=this._hasher;return r=n.finalize(r),n.reset(),n.finalize(this._oKey.clone().concat(r))}})})();(function(){var e=ne,n=e.lib,t=n.Base,r=n.WordArray,n=e.algo,i=n.HMAC,s=n.PBKDF2=t.extend({cfg:t.extend({keySize:4,hasher:n.SHA1,iterations:1}),init:function(o){this.cfg=this.cfg.extend(o)},compute:function(o,a){for(var b=this.cfg,f=i.create(b.hasher,o),l=r.create(),v=r.create([1]),p=l.words,u=v.words,h=b.keySize,b=b.iterations;p.length<h;){var d=f.update(a).finalize(v);f.reset();for(var y=d.words,w=y.length,_=d,I=1;I<b;I++){_=f.finalize(_),f.reset();for(var N=_.words,F=0;F<w;F++)y[F]^=N[F]}l.concat(d),u[0]++}return l.sigBytes=4*h,l}});e.PBKDF2=function(o,a,f){return s.create(f).compute(o,a)}})();var Of="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pb="=";function ks(e){var t,r,n="";for(t=0;t+3<=e.length;t+=3)r=parseInt(e.substring(t,t+3),16),n+=Of.charAt(r>>6)+Of.charAt(r&63);if(t+1==e.length?(r=parseInt(e.substring(t,t+1),16),n+=Of.charAt(r<<2)):t+2==e.length&&(r=parseInt(e.substring(t,t+2),16),n+=Of.charAt(r>>2)+Of.charAt((r&3)<<4)),pb)for(;(n.length&3)>0;)n+=pb;return n}function Tf(e){var t="",r,n=0,i,s;for(r=0;r<e.length&&e.charAt(r)!=pb;++r)s=Of.indexOf(e.charAt(r)),!(s<0)&&(n==0?(t+=Hs(s>>2),i=s&3,n=1):n==1?(t+=Hs(i<<2|s>>4),i=s&15,n=2):n==2?(t+=Hs(i),t+=Hs(s>>2),i=s&3,n=3):(t+=Hs(i<<2|s>>4),t+=Hs(s&15),n=0));return n==1&&(t+=Hs(i<<2)),t}function J7(e){var t=Tf(e),r,n=new Array;for(r=0;2*r<t.length;++r)n[r]=parseInt(t.substring(2*r,2*r+2),16);return n}var Wa,OH=0xdeadbeefcafe,$7=(OH&16777215)==15715070;function W(e,t,r){e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}function pt(){return new W(null)}function DH(e,t,r,n,i,s){for(;--s>=0;){var o=t*this[e++]+r[n]+i;i=Math.floor(o/67108864),r[n++]=o&67108863}return i}function TH(e,t,r,n,i,s){for(var o=t&32767,a=t>>15;--s>=0;){var f=this[e]&32767,l=this[e++]>>15,v=a*f+l*o;f=o*f+((v&32767)<<15)+r[n]+(i&1073741823),i=(f>>>30)+(v>>>15)+a*l+(i>>>30),r[n++]=f&1073741823}return i}function qH(e,t,r,n,i,s){for(var o=t&16383,a=t>>14;--s>=0;){var f=this[e]&16383,l=this[e++]>>14,v=a*f+l*o;f=o*f+((v&16383)<<14)+r[n]+i,i=(f>>28)+(v>>14)+a*l,r[n++]=f&268435455}return i}$7&&au.appName=="Microsoft Internet Explorer"?(W.prototype.am=TH,Wa=30):$7&&au.appName!="Netscape"?(W.prototype.am=DH,Wa=26):(W.prototype.am=qH,Wa=28);W.prototype.DB=Wa;W.prototype.DM=(1<<Wa)-1;W.prototype.DV=1<<Wa;var xb=52;W.prototype.FV=Math.pow(2,xb);W.prototype.F1=xb-Wa;W.prototype.F2=2*Wa-xb;var HH="0123456789abcdefghijklmnopqrstuvwxyz",Dl=new Array,qf,ci;qf="0".charCodeAt(0);for(ci=0;ci<=9;++ci)Dl[qf++]=ci;qf="a".charCodeAt(0);for(ci=10;ci<36;++ci)Dl[qf++]=ci;qf="A".charCodeAt(0);for(ci=10;ci<36;++ci)Dl[qf++]=ci;function Hs(e){return HH.charAt(e)}function Q7(e,t){var r=Dl[e.charCodeAt(t)];return r??-1}function kH(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function jH(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function za(e){var t=pt();return t.fromInt(e),t}function LH(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var o=r==8?e[n]&255:Q7(e,n);if(o<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this[this.t++]=o:s+r>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(e[0]&128)!=0&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&W.ZERO.subTo(this,this)}function KH(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function UH(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(n=this[o]>>a)>0&&(i=!0,s=Hs(n));o>=0;)a<t?(n=(this[o]&(1<<a)-1)<<t-a,n|=this[--o]>>(a+=this.DB-t)):(n=this[o]>>(a-=t)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=Hs(n));return i?s:"0"}function VH(){var e=pt();return W.ZERO.subTo(this,e),e}function zH(){return this.s<0?this.negate():this}function WH(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this[r]-e[r])!=0)return t;return 0}function Tl(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function $H(){return this.t<=0?0:this.DB*(this.t-1)+Tl(this[this.t-1]^this.s&this.DM)}function GH(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s}function XH(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s}function ZH(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)t[a+s+1]=this[a]>>n|o,o=(this[a]&i)<<r;for(a=s-1;a>=0;--a)t[a]=0;t[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function YH(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t[0]=this[r]>>n;for(var o=r+1;o<this.t;++o)t[o-r-1]|=(this[o]&s)<<i,t[o-r]=this[o]>>n;n>0&&(t[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}function JH(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()}function QH(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t[i]=0;for(i=0;i<n.t;++i)t[i+r.t]=r.am(0,n[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&W.ZERO.subTo(t,t)}function ek(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()}function tk(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=pt());var s=pt(),o=this.s,a=e.s,f=this.DB-Tl(n[n.t-1]);f>0?(n.lShiftTo(f,s),i.lShiftTo(f,r)):(n.copyTo(s),i.copyTo(r));var l=s.t,v=s[l-1];if(v!=0){var p=v*(1<<this.F1)+(l>1?s[l-2]>>this.F2:0),u=this.FV/p,h=(1<<this.F1)/p,b=1<<this.F2,d=r.t,y=d-l,w=t??pt();for(s.dlShiftTo(y,w),r.compareTo(w)>=0&&(r[r.t++]=1,r.subTo(w,r)),W.ONE.dlShiftTo(l,w),w.subTo(s,s);s.t<l;)s[s.t++]=0;for(;--y>=0;){var _=r[--d]==v?this.DM:Math.floor(r[d]*u+(r[d-1]+b)*h);if((r[d]+=s.am(0,_,r,y,0,l))<_)for(s.dlShiftTo(y,w),r.subTo(w,r);r[d]<--_;)r.subTo(w,r)}t!=null&&(r.drShiftTo(l,t),o!=a&&W.ZERO.subTo(t,t)),r.t=l,r.clamp(),f>0&&r.rShiftTo(f,r),o<0&&W.ZERO.subTo(r,r)}}}function rk(e){var t=pt();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(W.ZERO)>0&&e.subTo(t,t),t}function uo(e){this.m=e}function nk(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function ik(e){return e}function sk(e){e.divRemTo(this.m,null,e)}function ak(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function ok(e,t){e.squareTo(t),this.reduce(t)}uo.prototype.convert=nk;uo.prototype.revert=ik;uo.prototype.reduce=sk;uo.prototype.mulTo=ak;uo.prototype.sqrTo=ok;function fk(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function ho(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function ck(e){var t=pt();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(W.ZERO)>0&&this.m.subTo(t,t),t}function uk(e){var t=pt();return e.copyTo(t),this.reduce(t),t}function dk(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e[t]&32767,n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e[r]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function hk(e,t){e.squareTo(t),this.reduce(t)}function lk(e,t,r){e.multiplyTo(t,r),this.reduce(r)}ho.prototype.convert=ck;ho.prototype.revert=uk;ho.prototype.reduce=dk;ho.prototype.mulTo=lk;ho.prototype.sqrTo=hk;function pk(){return(this.t>0?this[0]&1:this.s)==0}function vk(e,t){if(e>4294967295||e<1)return W.ONE;var r=pt(),n=pt(),i=t.convert(this),s=Tl(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var o=r;r=n,n=o}return t.revert(r)}function bk(e,t){var r;return e<256||t.isEven()?r=new uo(t):r=new ho(t),this.exp(e,r)}W.prototype.copyTo=kH;W.prototype.fromInt=jH;W.prototype.fromString=LH;W.prototype.clamp=KH;W.prototype.dlShiftTo=GH;W.prototype.drShiftTo=XH;W.prototype.lShiftTo=ZH;W.prototype.rShiftTo=YH;W.prototype.subTo=JH;W.prototype.multiplyTo=QH;W.prototype.squareTo=ek;W.prototype.divRemTo=tk;W.prototype.invDigit=fk;W.prototype.isEven=pk;W.prototype.exp=vk;W.prototype.toString=UH;W.prototype.negate=VH;W.prototype.abs=zH;W.prototype.compareTo=WH;W.prototype.bitLength=$H;W.prototype.mod=rk;W.prototype.modPowInt=bk;W.ZERO=za(0);W.ONE=za(1);function gk(){var e=pt();return this.copyTo(e),e}function yk(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function xk(){return this.t==0?this.s:this[0]<<24>>24}function mk(){return this.t==0?this.s:this[0]<<16>>16}function wk(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function Sk(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Ek(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=za(r),i=pt(),s=pt(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(e).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(e)+o}function _k(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,o=0,a=0;a<e.length;++a){var f=Q7(e,a);if(f<0){e.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=t*o+f,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(o,0)),i&&W.ZERO.subTo(this,this)}function Ak(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(W.ONE.shiftLeft(e-1),mb,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(W.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Bk(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=this.DB-8)):(n=this[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function Pk(e){return this.compareTo(e)==0}function Ik(e){return this.compareTo(e)<0?this:e}function Mk(e){return this.compareTo(e)>0?this:e}function Ck(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r[n]=t(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r[n]=t(i,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function Fk(e,t){return e&t}function Nk(e){var t=pt();return this.bitwiseTo(e,Fk,t),t}function mb(e,t){return e|t}function Rk(e){var t=pt();return this.bitwiseTo(e,mb,t),t}function e9(e,t){return e^t}function Ok(e){var t=pt();return this.bitwiseTo(e,e9,t),t}function t9(e,t){return e&~t}function Dk(e){var t=pt();return this.bitwiseTo(e,t9,t),t}function Tk(){for(var e=pt(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e}function qk(e){var t=pt();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Hk(e){var t=pt();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function kk(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function jk(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+kk(this[e]);return this.s<0?this.t*this.DB:-1}function Lk(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function Kk(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Lk(this[r]^t);return e}function Uk(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this[t]&1<<e%this.DB)!=0}function Vk(e,t){var r=W.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function zk(e){return this.changeBit(e,mb)}function Wk(e){return this.changeBit(e,t9)}function $k(e){return this.changeBit(e,e9)}function Gk(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()}function Xk(e){var t=pt();return this.addTo(e,t),t}function Zk(e){var t=pt();return this.subTo(e,t),t}function Yk(e){var t=pt();return this.multiplyTo(e,t),t}function Jk(){var e=pt();return this.squareTo(e),e}function Qk(e){var t=pt();return this.divRemTo(e,t,null),t}function ej(e){var t=pt();return this.divRemTo(e,null,t),t}function tj(e){var t=pt(),r=pt();return this.divRemTo(e,t,r),new Array(t,r)}function rj(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function nj(e,t){if(e!=0){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}}function fu(){}function r9(e){return e}function ij(e,t,r){e.multiplyTo(t,r)}function sj(e,t){e.squareTo(t)}fu.prototype.convert=r9;fu.prototype.revert=r9;fu.prototype.mulTo=ij;fu.prototype.sqrTo=sj;function aj(e){return this.exp(e,new fu)}function oj(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()}function fj(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function Hf(e){this.r2=pt(),this.q3=pt(),W.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function cj(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=pt();return e.copyTo(t),this.reduce(t),t}function uj(e){return e}function dj(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function hj(e,t){e.squareTo(t),this.reduce(t)}function lj(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Hf.prototype.convert=cj;Hf.prototype.revert=uj;Hf.prototype.reduce=dj;Hf.prototype.mulTo=lj;Hf.prototype.sqrTo=hj;function pj(e,t){var r=e.bitLength(),n,i=za(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new uo(t):t.isEven()?s=new Hf(t):s=new ho(t);var o=new Array,a=3,f=n-1,l=(1<<n)-1;if(o[1]=s.convert(this),n>1){var v=pt();for(s.sqrTo(o[1],v);a<=l;)o[a]=pt(),s.mulTo(v,o[a-2],o[a]),a+=2}var p=e.t-1,u,h=!0,b=pt(),d;for(r=Tl(e[p])-1;p>=0;){for(r>=f?u=e[p]>>r-f&l:(u=(e[p]&(1<<r+1)-1)<<f-r,p>0&&(u|=e[p-1]>>this.DB+r-f)),a=n;(u&1)==0;)u>>=1,--a;if((r-=a)<0&&(r+=this.DB,--p),h)o[u].copyTo(i),h=!1;else{for(;a>1;)s.sqrTo(i,b),s.sqrTo(b,i),a-=2;a>0?s.sqrTo(i,b):(d=i,i=b,b=d),s.mulTo(b,o[u],i)}for(;p>=0&&(e[p]&1<<r)==0;)s.sqrTo(i,b),d=i,i=b,b=d,--r<0&&(r=this.DB-1,--p)}return s.revert(i)}function vj(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function bj(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r}function gj(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return W.ZERO;for(var r=e.clone(),n=this.clone(),i=za(1),s=za(0),o=za(0),a=za(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(e,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),t&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(W.ONE)!=0)return W.ZERO;if(a.compareTo(e)>=0)return a.subtract(e);if(a.signum()<0)a.addTo(e,a);else return a;return a.signum()<0?a.add(e):a}var An=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],yj=(1<<26)/An[An.length-1];function xj(e){var t,r=this.abs();if(r.t==1&&r[0]<=An[An.length-1]){for(t=0;t<An.length;++t)if(r[0]==An[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<An.length;){for(var n=An[t],i=t+1;i<An.length&&n<yj;)n*=An[i++];for(n=r.modInt(n);t<i;)if(n%An[t++]==0)return!1}return r.millerRabin(e)}function mj(e){var t=this.subtract(W.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);e=e+1>>1,e>An.length&&(e=An.length);for(var i=pt(),s=0;s<e;++s){i.fromInt(An[Math.floor(Math.random()*An.length)]);var o=i.modPow(n,this);if(o.compareTo(W.ONE)!=0&&o.compareTo(t)!=0){for(var a=1;a++<r&&o.compareTo(t)!=0;)if(o=o.modPowInt(2,this),o.compareTo(W.ONE)==0)return!1;if(o.compareTo(t)!=0)return!1}}return!0}W.prototype.chunkSize=wk;W.prototype.toRadix=Ek;W.prototype.fromRadix=_k;W.prototype.fromNumber=Ak;W.prototype.bitwiseTo=Ck;W.prototype.changeBit=Vk;W.prototype.addTo=Gk;W.prototype.dMultiply=rj;W.prototype.dAddOffset=nj;W.prototype.multiplyLowerTo=oj;W.prototype.multiplyUpperTo=fj;W.prototype.modInt=bj;W.prototype.millerRabin=mj;W.prototype.clone=gk;W.prototype.intValue=yk;W.prototype.byteValue=xk;W.prototype.shortValue=mk;W.prototype.signum=Sk;W.prototype.toByteArray=Bk;W.prototype.equals=Pk;W.prototype.min=Ik;W.prototype.max=Mk;W.prototype.and=Nk;W.prototype.or=Rk;W.prototype.xor=Ok;W.prototype.andNot=Dk;W.prototype.not=Tk;W.prototype.shiftLeft=qk;W.prototype.shiftRight=Hk;W.prototype.getLowestSetBit=jk;W.prototype.bitCount=Kk;W.prototype.testBit=Uk;W.prototype.setBit=zk;W.prototype.clearBit=Wk;W.prototype.flipBit=$k;W.prototype.add=Xk;W.prototype.subtract=Zk;W.prototype.multiply=Yk;W.prototype.divide=Qk;W.prototype.remainder=ej;W.prototype.divideAndRemainder=tj;W.prototype.modPow=pj;W.prototype.modInverse=gj;W.prototype.pow=aj;W.prototype.gcd=vj;W.prototype.isProbablePrime=xj;W.prototype.square=Jk;function wb(){this.i=0,this.j=0,this.S=new Array}function wj(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0}function Sj(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]}wb.prototype.init=wj;wb.prototype.next=Sj;function Ej(){return new wb}var vb=256;var Fl,Tn,Kr;function _j(e){Tn[Kr++]^=e&255,Tn[Kr++]^=e>>8&255,Tn[Kr++]^=e>>16&255,Tn[Kr++]^=e>>24&255,Kr>=vb&&(Kr-=vb)}function Sb(){_j(new Date().getTime())}if(Tn==null){if(Tn=new Array,Kr=0,Rf!==void 0&&(Rf.crypto!==void 0||Rf.msCrypto!==void 0)){if(db=Rf.crypto||Rf.msCrypto,db.getRandomValues)for(hb=new Uint8Array(32),db.getRandomValues(hb),fi=0;fi<32;++fi)Tn[Kr++]=hb[fi];else if(au.appName=="Netscape"&&au.appVersion<"5")for(lb=Rf.crypto.random(32),fi=0;fi<lb.length;++fi)Tn[Kr++]=lb.charCodeAt(fi)&255}for(;Kr<vb;)fi=Math.floor(65536*Math.random()),Tn[Kr++]=fi>>>8,Tn[Kr++]=fi&255;Kr=0,Sb()}var fi,db,hb,lb;function Aj(){if(Fl==null){for(Sb(),Fl=Ej(),Fl.init(Tn),Kr=0;Kr<Tn.length;++Kr)Tn[Kr]=0;Kr=0}return Fl.next()}function Bj(e){var t;for(t=0;t<e.length;++t)e[t]=Aj()}function $a(){}$a.prototype.nextBytes=Bj;function gn(e,t){return new W(e,t)}function Pj(e,t){if(t<e.length+11)throw"Message too long for RSA";for(var r=new Array,n=e.length-1;n>=0&&t>0;){var i=e.charCodeAt(n--);i<128?r[--t]=i:i>127&&i<2048?(r[--t]=i&63|128,r[--t]=i>>6|192):(r[--t]=i&63|128,r[--t]=i>>6&63|128,r[--t]=i>>12|224)}r[--t]=0;for(var s=new $a,o=new Array;t>2;){for(o[0]=0;o[0]==0;)s.nextBytes(o);r[--t]=o[0]}return r[--t]=2,r[--t]=0,new W(r)}function G7(e,t,r){for(var n="",i=0;n.length<t;)n+=r(String.fromCharCode.apply(String,e.concat([(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255]))),i+=1;return n}function Ij(e,t,r,n){var i=B.crypto.MessageDigest,s=B.crypto.Util,o=null;if(r||(r="sha1"),typeof r=="string"&&(o=i.getCanonicalAlgName(r),n=i.getHashLength(o),r=function(d){return yn(s.hashHex(ui(d),o))}),e.length+2*n+2>t)throw"Message too long for RSA";var a="",f;for(f=0;f<t-e.length-2*n-2;f+=1)a+="\0";var l=r("")+a+""+e,v=new Array(n);new $a().nextBytes(v);var p=G7(v,l.length,r),u=[];for(f=0;f<l.length;f+=1)u[f]=l.charCodeAt(f)^p.charCodeAt(f);var h=G7(u,v.length,r),b=[0];for(f=0;f<v.length;f+=1)b[f+1]=v[f]^h.charCodeAt(f);return new W(b.concat(u))}function Pe(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Mj(e,t){if(this.isPublic=!0,this.isPrivate=!1,typeof e!="string")this.n=e,this.e=t;else if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=gn(e,16),this.e=parseInt(t,16);else throw"Invalid RSA public key"}function Cj(e){return e.modPowInt(this.e,this.n)}function Fj(e){var t=Pj(e,this.n.bitLength()+7>>3);if(t==null)return null;var r=this.doPublic(t);if(r==null)return null;var n=r.toString(16);return(n.length&1)==0?n:"0"+n}function Nj(e,t,r){var n=this.n.bitLength()+7>>3,i=Ij(e,n,t,r);if(i==null)return null;var s=this.doPublic(i);if(s==null)return null;for(var o=s.toString(16);o.length<n*2;)o="0"+o;return o}Pe.prototype.doPublic=Cj;Pe.prototype.setPublic=Mj;Pe.prototype.encrypt=Fj;Pe.prototype.encryptOAEP=Nj;Pe.prototype.type="RSA";function Rj(e,t){for(var r=e.toByteArray(),n=0;n<r.length&&r[n]==0;)++n;if(r.length-n!=t-1||r[n]!=2)return null;for(++n;r[n]!=0;)if(++n>=r.length)return null;for(var i="";++n<r.length;){var s=r[n]&255;s<128?i+=String.fromCharCode(s):s>191&&s<224?(i+=String.fromCharCode((s&31)<<6|r[n+1]&63),++n):(i+=String.fromCharCode((s&15)<<12|(r[n+1]&63)<<6|r[n+2]&63),n+=2)}return i}function X7(e,t,r){for(var n="",i=0;n.length<t;)n+=r(e+String.fromCharCode.apply(String,[(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255])),i+=1;return n}function Oj(e,t,r,n){var i=B.crypto.MessageDigest,s=B.crypto.Util,o=null;r||(r="sha1"),typeof r=="string"&&(o=i.getCanonicalAlgName(r),n=i.getHashLength(o),r=function(y){return yn(s.hashHex(ui(y),o))}),e=e.toByteArray();var p;for(p=0;p<e.length;p+=1)e[p]&=255;for(;e.length<t;)e.unshift(0);if(e=String.fromCharCode.apply(String,e),e.length<2*n+2)throw"Cipher too short";var a=e.substr(1,n),f=e.substr(n+1),l=X7(f,n,r),v=[],p;for(p=0;p<a.length;p+=1)v[p]=a.charCodeAt(p)^l.charCodeAt(p);var u=X7(String.fromCharCode.apply(String,v),e.length-n,r),h=[];for(p=0;p<f.length;p+=1)h[p]=f.charCodeAt(p)^u.charCodeAt(p);if(h=String.fromCharCode.apply(String,h),h.substr(0,n)!==r(""))throw"Hash mismatch";h=h.substr(n);var b=h.indexOf(""),d=b!=-1?h.substr(0,b).lastIndexOf("\0"):-1;if(d+1!=b)throw"Malformed data";return h.substr(b+1)}function Dj(e,t,r){if(this.isPrivate=!0,typeof e!="string")this.n=e,this.e=t,this.d=r;else if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=gn(e,16),this.e=parseInt(t,16),this.d=gn(r,16);else throw"Invalid RSA private key"}function Tj(e,t,r,n,i,s,o,a){if(this.isPrivate=!0,this.isPublic=!1,e==null)throw"RSASetPrivateEx N == null";if(t==null)throw"RSASetPrivateEx E == null";if(e.length==0)throw"RSASetPrivateEx N.length == 0";if(t.length==0)throw"RSASetPrivateEx E.length == 0";if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=gn(e,16),this.e=parseInt(t,16),this.d=gn(r,16),this.p=gn(n,16),this.q=gn(i,16),this.dmp1=gn(s,16),this.dmq1=gn(o,16),this.coeff=gn(a,16);else throw"Invalid RSA private key in RSASetPrivateEx"}function qj(e,t){var r=new $a,n=e>>1;this.e=parseInt(t,16);for(var i=new W(t,16),s=e/2-100,o=W.ONE.shiftLeft(s);;){for(;this.p=new W(e-n,1,r),!(this.p.subtract(W.ONE).gcd(i).compareTo(W.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new W(n,1,r),!(this.q.subtract(W.ONE).gcd(i).compareTo(W.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var a=this.p;this.p=this.q,this.q=a}var f=this.q.subtract(this.p).abs();if(!(f.bitLength()<s||f.compareTo(o)<=0)){var l=this.p.subtract(W.ONE),v=this.q.subtract(W.ONE),p=l.multiply(v);if(p.gcd(i).compareTo(W.ONE)==0&&(this.n=this.p.multiply(this.q),this.n.bitLength()==e)){this.d=i.modInverse(p),this.dmp1=this.d.mod(l),this.dmq1=this.d.mod(v),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0}function Hj(e){if(this.p==null||this.q==null)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),r=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(r)<0;)t=t.add(this.p);return t.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)}function kj(e){if(e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var t=gn(e,16),r=this.doPrivate(t);return r==null?null:Rj(r,this.n.bitLength()+7>>3)}function jj(e,t,r){if(e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var n=gn(e,16),i=this.doPrivate(n);return i==null?null:Oj(i,this.n.bitLength()+7>>3,t,r)}Pe.prototype.doPrivate=Hj;Pe.prototype.setPrivate=Dj;Pe.prototype.setPrivateEx=Tj;Pe.prototype.generate=qj;Pe.prototype.decrypt=kj;Pe.prototype.decryptOAEP=jj;function Cr(e,t){this.x=t,this.q=e}function Lj(e){return e==this?!0:this.q.equals(e.q)&&this.x.equals(e.x)}function Kj(){return this.x}function Uj(){return new Cr(this.q,this.x.negate().mod(this.q))}function Vj(e){return new Cr(this.q,this.x.add(e.toBigInteger()).mod(this.q))}function zj(e){return new Cr(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))}function Wj(e){return new Cr(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))}function $j(){return new Cr(this.q,this.x.square().mod(this.q))}function Gj(e){return new Cr(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))}Cr.prototype.equals=Lj;Cr.prototype.toBigInteger=Kj;Cr.prototype.negate=Uj;Cr.prototype.add=Vj;Cr.prototype.subtract=zj;Cr.prototype.multiply=Wj;Cr.prototype.square=$j;Cr.prototype.divide=Gj;Cr.prototype.sqrt=function(){return new Cr(this.q,this.x.sqrt().mod(this.q))};function At(e,t,r,n){this.curve=e,this.x=t,this.y=r,n==null?this.z=W.ONE:this.z=n,this.zinv=null}function Xj(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function Zj(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function Yj(e){if(e==this)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return this.isInfinity();var t,r;return t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),t.equals(W.ZERO)?(r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q),r.equals(W.ZERO)):!1}function Jj(){return this.x==null&&this.y==null?!0:this.z.equals(W.ZERO)&&!this.y.toBigInteger().equals(W.ZERO)}function Qj(){return new At(this.curve,this.x,this.y.negate(),this.z)}function eL(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(W.ZERO.equals(r))return W.ZERO.equals(t)?this.twice():this.curve.getInfinity();var n=new W("3"),i=this.x.toBigInteger(),s=this.y.toBigInteger(),o=e.x.toBigInteger(),a=e.y.toBigInteger(),f=r.square(),l=f.multiply(r),v=i.multiply(f),p=t.square().multiply(this.z),u=p.subtract(v.shiftLeft(1)).multiply(e.z).subtract(l).multiply(r).mod(this.curve.q),h=v.multiply(n).multiply(t).subtract(s.multiply(l)).subtract(p.multiply(t)).multiply(e.z).add(t.multiply(l)).mod(this.curve.q),b=l.multiply(this.z).multiply(e.z).mod(this.curve.q);return new At(this.curve,this.curve.fromBigInteger(u),this.curve.fromBigInteger(h),b)}function tL(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var e=new W("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),i=n.multiply(r).mod(this.curve.q),s=this.curve.a.toBigInteger(),o=t.square().multiply(e);W.ZERO.equals(s)||(o=o.add(this.z.square().multiply(s))),o=o.mod(this.curve.q);var a=o.square().subtract(t.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(n).mod(this.curve.q),f=o.multiply(e).multiply(t).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(o.square().multiply(o)).mod(this.curve.q),l=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new At(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(f),l)}function rL(e){if(this.isInfinity())return this;if(e.signum()==0)return this.curve.getInfinity();var t=e,r=t.multiply(new W("3")),n=this.negate(),i=this,s=this.curve.q.subtract(e),o=s.multiply(new W("3")),a=new At(this.curve,this.x,this.y),f=a.negate(),l;for(l=r.bitLength()-2;l>0;--l){i=i.twice();var v=r.testBit(l),p=t.testBit(l);v!=p&&(i=i.add(v?this:n))}for(l=o.bitLength()-2;l>0;--l){a=a.twice();var u=o.testBit(l),h=s.testBit(l);u!=h&&(a=a.add(u?a:f))}return i}function nL(e,t,r){var n;e.bitLength()>r.bitLength()?n=e.bitLength()-1:n=r.bitLength()-1;for(var i=this.curve.getInfinity(),s=this.add(t);n>=0;)i=i.twice(),e.testBit(n)?r.testBit(n)?i=i.add(s):i=i.add(this):r.testBit(n)&&(i=i.add(t)),--n;return i}At.prototype.getX=Xj;At.prototype.getY=Zj;At.prototype.equals=Yj;At.prototype.isInfinity=Jj;At.prototype.negate=Qj;At.prototype.add=eL;At.prototype.twice=tL;At.prototype.multiply=rL;At.prototype.multiplyTwo=nL;function js(e,t,r){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new At(this,null,null)}function iL(){return this.q}function sL(){return this.a}function aL(){return this.b}function oL(e){return e==this?!0:this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)}function fL(){return this.infinity}function cL(e){return new Cr(this.q,e)}function uL(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var t=e.substr(0,2),r=e.substr(2),n=this.fromBigInteger(new W(l,16)),i=this.getA(),s=this.getB(),o=n.square().add(i).multiply(n).add(s),a=o.sqrt();return t=="03"&&(a=a.negate()),new At(this,n,a);case 4:case 6:case 7:var f=(e.length-2)/2,l=e.substr(2,f),v=e.substr(f+2,f);return new At(this,this.fromBigInteger(new W(l,16)),this.fromBigInteger(new W(v,16)));default:return null}}js.prototype.getQ=iL;js.prototype.getA=sL;js.prototype.getB=aL;js.prototype.equals=oL;js.prototype.getInfinity=fL;js.prototype.fromBigInteger=cL;js.prototype.decodePointHex=uL;Cr.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};At.prototype.getEncoded=function(e){var t=function(s,o){var a=s.toByteArrayUnsigned();if(o<a.length)a=a.slice(a.length-o);else for(;o>a.length;)a.unshift(0);return a},r=this.getX().toBigInteger(),n=this.getY().toBigInteger(),i=t(r,32);return e?n.isEven()?i.unshift(2):i.unshift(3):(i.unshift(4),i=i.concat(t(n,32))),i};At.decodeFrom=function(e,t){var r=t[0],n=t.length-1,i=t.slice(1,1+n/2),s=t.slice(1+n/2,1+n);i.unshift(0),s.unshift(0);var o=new W(i),a=new W(s);return new At(e,e.fromBigInteger(o),e.fromBigInteger(a))};At.decodeFromHex=function(e,t){var r=t.substr(0,2),n=t.length-2,i=t.substr(2,n/2),s=t.substr(2+n/2,n/2),o=new W(i,16),a=new W(s,16);return new At(e,e.fromBigInteger(o),e.fromBigInteger(a))};At.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),r=e.y.subtract(this.y),n=r.divide(t),i=n.square().subtract(this.x).subtract(e.x),s=n.multiply(this.x.subtract(i)).subtract(this.y);return new At(this.curve,i,s)};At.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var e=this.curve.fromBigInteger(W.valueOf(2)),t=this.curve.fromBigInteger(W.valueOf(3)),r=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),n=r.square().subtract(this.x.multiply(e)),i=r.multiply(this.x.subtract(n)).subtract(this.y);return new At(this.curve,n,i)};At.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(e.signum()==0)return this.curve.getInfinity();var t=e,r=t.multiply(new W("3")),n=this.negate(),i=this,s;for(s=r.bitLength()-2;s>0;--s){i=i.twice();var o=r.testBit(s),a=t.testBit(s);o!=a&&(i=i.add2D(o?this:n))}return i};At.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),r=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),i=this.curve.getQ(),s=t.multiply(t).mod(i),o=e.multiply(e).multiply(e).add(r.multiply(e)).add(n).mod(i);return s.equals(o)};At.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};At.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),r=this.getY().toBigInteger();if(t.compareTo(W.ONE)<0||t.compareTo(e.subtract(W.ONE))>0)throw new Error("x coordinate out of bounds");if(r.compareTo(W.ONE)<0||r.compareTo(e.subtract(W.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var n9=function(){var e="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",t='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',r='(?:"'+t+'*")',n=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+e+"|"+r+")","g"),i=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),s={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function o(p,u,h){return u?s[u]:String.fromCharCode(parseInt(h,16))}var a=new String(""),f="\\",l={"{":Object,"[":Array},v=Object.hasOwnProperty;return function(p,u){var h=p.match(n),b,d=h[0],y=!1;d==="{"?b={}:d==="["?b=[]:(b=[],y=!0);for(var w,_=[b],I=1-y,N=h.length;I<N;++I){d=h[I];var F;switch(d.charCodeAt(0)){default:F=_[0],F[w||F.length]=+d,w=void 0;break;case 34:if(d=d.substring(1,d.length-1),d.indexOf(f)!==-1&&(d=d.replace(i,o)),F=_[0],!w)if(F instanceof Array)w=F.length;else{w=d||a;break}F[w]=d,w=void 0;break;case 91:F=_[0],_.unshift(F[w||F.length]=[]),w=void 0;break;case 93:_.shift();break;case 102:F=_[0],F[w||F.length]=!1,w=void 0;break;case 110:F=_[0],F[w||F.length]=null,w=void 0;break;case 116:F=_[0],F[w||F.length]=!0,w=void 0;break;case 123:F=_[0],_.unshift(F[w||F.length]={}),w=void 0;break;case 125:_.shift();break}}if(y){if(_.length!==1)throw new Error;b=b[0]}else if(_.length)throw new Error;if(u){var O=function(q,P){var D=q[P];if(D&&typeof D=="object"){var A=null;for(var c in D)if(v.call(D,c)&&D!==q){var m=O(D,c);m!==void 0?D[c]=m:(A||(A=[]),A.push(c))}if(A)for(var S=A.length;--S>=0;)delete D[A[S]]}return u.call(q,P,D)};b=O({"":b},"")}return b}}();(typeof B>"u"||!B)&&(B={});(typeof B.asn1>"u"||!B.asn1)&&(B.asn1={});B.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){return uu(e)},this.getPEMStringFromHex=function(e,t){return bn(e,t)},this.newObject=function(e){var t=B,r=t.asn1,n=r.ASN1Object,i=r.DERBoolean,s=r.DERInteger,o=r.DERBitString,a=r.DEROctetString,f=r.DERNull,l=r.DERObjectIdentifier,v=r.DEREnumerated,p=r.DERUTF8String,u=r.DERNumericString,h=r.DERPrintableString,b=r.DERTeletexString,d=r.DERIA5String,y=r.DERUTCTime,w=r.DERGeneralizedTime,_=r.DERVisibleString,I=r.DERBMPString,N=r.DERSequence,F=r.DERSet,O=r.DERTaggedObject,q=r.ASN1Util.newObject;if(e instanceof r.ASN1Object)return e;var P=Object.keys(e);if(P.length!=1)throw new Error("key of param shall be only one.");var D=P[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+D+":")==-1)throw new Error("undefined key: "+D);if(D=="bool")return new i(e[D]);if(D=="int")return new s(e[D]);if(D=="bitstr")return new o(e[D]);if(D=="octstr")return new a(e[D]);if(D=="null")return new f(e[D]);if(D=="oid")return new l(e[D]);if(D=="enum")return new v(e[D]);if(D=="utf8str")return new p(e[D]);if(D=="numstr")return new u(e[D]);if(D=="prnstr")return new h(e[D]);if(D=="telstr")return new b(e[D]);if(D=="ia5str")return new d(e[D]);if(D=="utctime")return new y(e[D]);if(D=="gentime")return new w(e[D]);if(D=="visstr")return new _(e[D]);if(D=="bmpstr")return new I(e[D]);if(D=="asn1")return new n(e[D]);if(D=="seq"){for(var A=e[D],c=[],m=0;m<A.length;m++){var S=q(A[m]);c.push(S)}return new N({array:c})}if(D=="set"){for(var A=e[D],c=[],m=0;m<A.length;m++){var S=q(A[m]);c.push(S)}return new F({array:c})}if(D=="tag"){var g=e[D];if(Object.prototype.toString.call(g)==="[object Array]"&&g.length==3){var E=q(g[2]);return new O({tag:g[0],explicit:g[1],obj:E})}else return new O(g)}},this.jsonToASN1HEX=function(e){var t=this.newObject(e);return t.tohex()}};B.asn1.ASN1Util.oidHexToInt=function(e){for(var i="",t=parseInt(e.substr(0,2),16),r=Math.floor(t/40),n=t%40,i=r+"."+n,s="",o=2;o<e.length;o+=2){var a=parseInt(e.substr(o,2),16),f=("00000000"+a.toString(2)).slice(-8);if(s=s+f.substr(1,7),f.substr(0,1)=="0"){var l=new W(s,2);i=i+"."+l.toString(10),s=""}}return i};B.asn1.ASN1Util.oidIntToHex=function(e){var t=function(a){var f=a.toString(16);return f.length==1&&(f="0"+f),f},r=function(a){var f="",l=new W(a,10),v=l.toString(2),p=7-v.length%7;p==7&&(p=0);for(var u="",h=0;h<p;h++)u+="0";v=u+v;for(var h=0;h<v.length-1;h+=7){var b=v.substr(h,7);h!=v.length-7&&(b="1"+b),f+=t(parseInt(b,2))}return f};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var n="",i=e.split("."),s=parseInt(i[0])*40+parseInt(i[1]);n+=t(s),i.splice(0,2);for(var o=0;o<i.length;o++)n+=r(i[o]);return n};B.asn1.ASN1Object=function(e){var t=!0,r=null,n="00",i="00",s="";this.params=null,this.getLengthHexFromValue=function(){if(typeof this.hV>"u"||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+s.length+",v="+this.hV);var o=this.hV.length/2,a=o.toString(16);if(a.length%2==1&&(a="0"+a),o<128)return a;var f=a.length/2;if(f>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+o.toString(16));var l=128+f;return l.toString(16)+a},this.tohex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(o){this.params=o},e!=null&&e.tlv!=null&&(this.hTLV=e.tlv,this.isModified=!1)};B.asn1.DERAbstractString=function(e){B.asn1.DERAbstractString.superclass.constructor.call(this);var t=null,r=null;this.getString=function(){return this.s},this.setString=function(n){this.hTLV=null,this.isModified=!0,this.s=n,this.hV=Hl(this.s).toLowerCase()},this.setStringHex=function(n){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e=="string"?this.setString(e):typeof e.str<"u"?this.setString(e.str):typeof e.hex<"u"&&this.setStringHex(e.hex))};X(B.asn1.DERAbstractString,B.asn1.ASN1Object);B.asn1.DERAbstractTime=function(e){B.asn1.DERAbstractTime.superclass.constructor.call(this);var t=null,r=null;this.localDateToUTC=function(n){var i=n.getTime()+n.getTimezoneOffset()*6e4,s=new Date(i);return s},this.formatDate=function(n,i,s){var o=this.zeroPadding,a=this.localDateToUTC(n),f=String(a.getFullYear());i=="utc"&&(f=f.substr(2,2));var l=o(String(a.getMonth()+1),2),v=o(String(a.getDate()),2),p=o(String(a.getHours()),2),u=o(String(a.getMinutes()),2),h=o(String(a.getSeconds()),2),b=f+l+v+p+u+h;if(s===!0){var d=a.getMilliseconds();if(d!=0){var y=o(String(d),3);y=y.replace(/[0]+$/,""),b=b+"."+y}}return b+"Z"},this.zeroPadding=function(n,i){return n.length>=i?n:new Array(i-n.length+1).join("0")+n},this.setByParam=function(n){this.hV=null,this.hTLV=null,this.params=n},this.getString=function(){},this.setString=function(n){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.str=n},this.setByDate=function(n){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.date=n},this.setByDateValue=function(n,i,s,o,a,f){var l=new Date(Date.UTC(n,i-1,s,o,a,f,0));this.setByDate(l)},this.getFreshValueHex=function(){return this.hV}};X(B.asn1.DERAbstractTime,B.asn1.ASN1Object);B.asn1.DERAbstractStructured=function(e){B.asn1.DERAbstractString.superclass.constructor.call(this);var t=null;this.setByASN1ObjectArray=function(r){this.hTLV=null,this.isModified=!0,this.asn1Array=r},this.appendASN1Object=function(r){this.hTLV=null,this.isModified=!0,this.asn1Array.push(r)},this.asn1Array=new Array,typeof e<"u"&&typeof e.array<"u"&&(this.asn1Array=e.array)};X(B.asn1.DERAbstractStructured,B.asn1.ASN1Object);B.asn1.DERBoolean=function(e){B.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",e==!1?this.hTLV="010100":this.hTLV="0101ff"};X(B.asn1.DERBoolean,B.asn1.ASN1Object);B.asn1.DERInteger=function(e){B.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var t=uu;this.setByBigInteger=function(r){this.isModified=!0,this.params={bigint:r}},this.setByInteger=function(r){this.isModified=!0,this.params=r},this.setValueHex=function(r){this.isModified=!0,this.params={hex:r}},this.getFreshValueHex=function(){var r=this.params,n=null;if(r==null)throw new Error("value not set");if(typeof r=="object"&&r.hex!=null)return this.hV=r.hex,this.hV;if(typeof r=="number")n=new W(String(r),10);else if(r.int!=null)n=new W(String(r.int),10);else if(r.bigint!=null)n=r.bigint;else throw new Error("wrong parameter");return this.hV=t(n),this.hV},e!=null&&(this.params=e)};X(B.asn1.DERInteger,B.asn1.ASN1Object);B.asn1.DERBitString=function(e){if(e!==void 0&&typeof e.obj<"u"){var t=B.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.tohex()}B.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(r){this.hTLV=null,this.isModified=!0,this.hV=r},this.setUnusedBitsAndHexValue=function(r,n){if(r<0||7<r)throw"unused bits shall be from 0 to 7: u = "+r;var i="0"+r;this.hTLV=null,this.isModified=!0,this.hV=i+n},this.setByBinaryString=function(r){r=r.replace(/0+$/,"");var n=8-r.length%8;n==8&&(n=0),r+="0000000".substr(0,n);for(var i="",s=0;s<r.length-1;s+=8){var o=r.substr(s,8),a=parseInt(o,2).toString(16);a.length==1&&(a="0"+a),i+=a}this.hTLV=null,this.isModified=!0,this.hV="0"+n+i},this.setByBooleanArray=function(r){for(var n="",i=0;i<r.length;i++)r[i]==!0?n+="1":n+="0";this.setByBinaryString(n)},this.newFalseArray=function(r){for(var n=new Array(r),i=0;i<r;i++)n[i]=!1;return n},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e=="string"&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):typeof e.hex<"u"?this.setHexValueIncludingUnusedBits(e.hex):typeof e.bin<"u"?this.setByBinaryString(e.bin):typeof e.array<"u"&&this.setByBooleanArray(e.array))};X(B.asn1.DERBitString,B.asn1.ASN1Object);B.asn1.DEROctetString=function(e){if(e!==void 0&&typeof e.obj<"u"){var t=B.asn1.ASN1Util.newObject(e.obj);e.hex=t.tohex()}B.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"};X(B.asn1.DEROctetString,B.asn1.DERAbstractString);B.asn1.DERNull=function(){B.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"};X(B.asn1.DERNull,B.asn1.ASN1Object);B.asn1.DERObjectIdentifier=function(e){B.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){var r=u9(t);if(r==null)throw new Error("malformed oid string: "+t);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(t){var r=B.asn1.x509.OID.name2oid(t);if(r!=="")this.setValueOidString(r);else throw new Error("DERObjectIdentifier oidName undefined: "+t)},this.setValueNameOrOid=function(t){t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(t){typeof t=="string"?this.setValueNameOrOid(t):t.oid!==void 0?this.setValueNameOrOid(t.oid):t.name!==void 0?this.setValueNameOrOid(t.name):t.hex!==void 0&&this.setValueHex(t.hex)},e!==void 0&&this.setByParam(e)};X(B.asn1.DERObjectIdentifier,B.asn1.ASN1Object);B.asn1.DEREnumerated=function(e){B.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=uu(t)},this.setByInteger=function(t){var r=new W(String(t),10);this.setByBigInteger(r)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e.int<"u"?this.setByInteger(e.int):typeof e=="number"?this.setByInteger(e):typeof e.hex<"u"&&this.setValueHex(e.hex))};X(B.asn1.DEREnumerated,B.asn1.ASN1Object);B.asn1.DERUTF8String=function(e){B.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"};X(B.asn1.DERUTF8String,B.asn1.DERAbstractString);B.asn1.DERNumericString=function(e){B.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"};X(B.asn1.DERNumericString,B.asn1.DERAbstractString);B.asn1.DERPrintableString=function(e){B.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"};X(B.asn1.DERPrintableString,B.asn1.DERAbstractString);B.asn1.DERTeletexString=function(e){B.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"};X(B.asn1.DERTeletexString,B.asn1.DERAbstractString);B.asn1.DERIA5String=function(e){B.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"};X(B.asn1.DERIA5String,B.asn1.DERAbstractString);B.asn1.DERVisibleString=function(e){B.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="1a"};X(B.asn1.DERVisibleString,B.asn1.DERAbstractString);B.asn1.DERBMPString=function(e){B.asn1.DERBMPString.superclass.constructor.call(this,e),this.hT="1e"};X(B.asn1.DERBMPString,B.asn1.DERAbstractString);B.asn1.DERUTCTime=function(e){B.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var t=this.params;if(this.params==null&&(t={date:new Date}),typeof t=="string")if(t.match(/^[0-9]{12}Z$/)||t.match(/^[0-9]{12}\.[0-9]+Z$/))this.hV=Nn(t);else throw new Error("malformed string for UTCTime: "+t);else if(t.str!=null)this.hV=Nn(t.str);else if(t.date==null&&t.millis==!0){var r=new Date;this.hV=Nn(this.formatDate(r,"utc",!0))}else if(t.date!=null&&t.date instanceof Date){var n=t.millis===!0;this.hV=Nn(this.formatDate(t.date,"utc",n))}else t instanceof Date&&(this.hV=Nn(this.formatDate(t,"utc")));if(this.hV==null)throw new Error("parameter not specified properly for UTCTime");return this.hV},e!=null&&this.setByParam(e)};X(B.asn1.DERUTCTime,B.asn1.DERAbstractTime);B.asn1.DERGeneralizedTime=function(e){B.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.params=e,this.getFreshValueHex=function(){var t=this.params;if(this.params==null&&(t={date:new Date}),typeof t=="string")if(t.match(/^[0-9]{14}Z$/)||t.match(/^[0-9]{14}\.[0-9]+Z$/))this.hV=Nn(t);else throw new Error("malformed string for GeneralizedTime: "+t);else if(t.str!=null)this.hV=Nn(t.str);else if(t.date==null&&t.millis==!0){var r=new Date;this.hV=Nn(this.formatDate(r,"gen",!0))}else if(t.date!=null&&t.date instanceof Date){var n=t.millis===!0;this.hV=Nn(this.formatDate(t.date,"gen",n))}else t instanceof Date&&(this.hV=Nn(this.formatDate(t,"gen")));if(this.hV==null)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},e!=null&&this.setByParam(e)};X(B.asn1.DERGeneralizedTime,B.asn1.DERAbstractTime);B.asn1.DERSequence=function(e){B.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var t="",r=0;r<this.asn1Array.length;r++){var n=this.asn1Array[r];t+=n.tohex()}return this.hV=t,this.hV}};X(B.asn1.DERSequence,B.asn1.DERAbstractStructured);B.asn1.DERSet=function(e){B.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,r=0;r<this.asn1Array.length;r++){var n=this.asn1Array[r];t.push(n.tohex())}return this.sortFlag==!0&&t.sort(),this.hV=t.join(""),this.hV},typeof e<"u"&&typeof e.sortflag<"u"&&e.sortflag==!1&&(this.sortFlag=!1)};X(B.asn1.DERSet,B.asn1.DERAbstractStructured);B.asn1.DERTaggedObject=function(e){B.asn1.DERTaggedObject.superclass.constructor.call(this);var t=B.asn1,r=Y,n=r.getV,i=r.isASN1HEX,s=t.ASN1Util.newObject;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(o,a,f){this.params={tag:a,explicit:o,obj:f}},this.getFreshValueHex=function(){var o=this.params;if(o.explicit==null&&(o.explicit=!0),o.tage!=null&&(o.tag=o.tage,o.explicit=!0),o.tagi!=null&&(o.tag=o.tagi,o.explicit=!1),o.str!=null)this.hV=Hl(o.str);else if(o.hex!=null)this.hV=o.hex;else if(o.obj!=null){var a;o.obj instanceof t.ASN1Object?a=o.obj.tohex():typeof o.obj=="object"&&(a=s(o.obj).tohex()),o.explicit?this.hV=a:this.hV=n(a,0)}else throw new Error("str, hex nor obj not specified");return o.tag==null&&(o.tag="a0"),this.hT=o.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(o){this.params=o},e!==void 0&&this.setByParam(e)};X(B.asn1.DERTaggedObject,B.asn1.ASN1Object);var Y=new function(){};Y.getLblen=function(e,t){if(e.substr(t+2,1)!="8")return 1;var r=parseInt(e.substr(t+3,1));return r==0?-1:0<r&&r<10?r+1:-2};Y.getL=function(e,t){var r=Y.getLblen(e,t);return r<1?"":e.substr(t+2,r*2)};Y.getVblen=function(e,t){var r,n;return r=Y.getL(e,t),r==""?-1:(r.substr(0,1)==="8"?n=new W(r.substr(2),16):n=new W(r,16),n.intValue())};Y.getVidx=function(e,t){var r=Y.getLblen(e,t);return r<0?r:t+(r+1)*2};Y.getV=function(e,t){var r=Y.getVidx(e,t),n=Y.getVblen(e,t);return e.substr(r,n*2)};Y.getTLV=function(e,t){return e.substr(t,2)+Y.getL(e,t)+Y.getV(e,t)};Y.getTLVblen=function(e,t){return 2+Y.getLblen(e,t)*2+Y.getVblen(e,t)*2};Y.getNextSiblingIdx=function(e,t){var r=Y.getVidx(e,t),n=Y.getVblen(e,t);return r+n*2};Y.getChildIdx=function(e,t){var r=Y,n=[],i,s,o;i=r.getVidx(e,t),s=r.getVblen(e,t)*2,e.substr(t,2)=="03"&&(i+=2,s-=2),o=0;for(var a=i;o<=s;){var f=r.getTLVblen(e,a);if(o+=f,o<=s&&n.push(a),a+=f,o>=s)break}return n};Y.getNthChildIdx=function(e,t,r){var n=Y.getChildIdx(e,t);return n[r]};Y.getIdxbyList=function(e,t,r,n){var i=Y,s,o;return r.length==0?n!==void 0&&e.substr(t,2)!==n?-1:t:(s=r.shift(),o=i.getChildIdx(e,t),s>=o.length?-1:i.getIdxbyList(e,o[s],r,n))};Y.getIdxbyListEx=function(e,t,r,n){var i=Y,s,o;if(r.length==0)return n!==void 0&&e.substr(t,2)!==n?-1:t;s=r.shift(),o=i.getChildIdx(e,t);for(var a=0,f=0;f<o.length;f++){var l=e.substr(o[f],2);if(typeof s=="number"&&!i.isContextTag(l)&&a==s||typeof s=="string"&&i.isContextTag(l,s))return i.getIdxbyListEx(e,o[f],r,n);i.isContextTag(l)||a++}return-1};Y.getTLVbyList=function(e,t,r,n){var i=Y,s=i.getIdxbyList(e,t,r,n);return s==-1||s>=e.length?null:i.getTLV(e,s)};Y.getTLVbyListEx=function(e,t,r,n){var i=Y,s=i.getIdxbyListEx(e,t,r,n);return s==-1?null:i.getTLV(e,s)};Y.getVbyList=function(e,t,r,n,i){var s=Y,o,a;return o=s.getIdxbyList(e,t,r,n),o==-1||o>=e.length?null:(a=s.getV(e,o),i===!0&&(a=a.substr(2)),a)};Y.getVbyListEx=function(e,t,r,n,i){var s=Y,o,a,f;return o=s.getIdxbyListEx(e,t,r,n),o==-1?null:(f=s.getV(e,o),e.substr(o,2)=="03"&&i!==!1&&(f=f.substr(2)),f)};Y.getInt=function(e,t,r){r==null&&(r=-1);try{var n=e.substr(t,2);if(n!="02"&&n!="03")return r;var i=Y.getV(e,t);return n=="02"?parseInt(i,16):h9(i)}catch{return r}};Y.getOID=function(e,t,r){r==null&&(r=null);try{if(e.substr(t,2)!="06")return r;var n=Y.getV(e,t);return Ul(n)}catch{return r}};Y.getOIDName=function(e,t,r){r==null&&(r=null);try{var n=Y.getOID(e,t,r);if(n==r)return r;var i=B.asn1.x509.OID.oid2name(n);return i==""?n:i}catch{return r}};Y.getString=function(e,t,r){r==null&&(r=null);try{var n=Y.getV(e,t);return yn(n)}catch{return r}};Y.hextooidstr=function(e){var t=function(p,u){return p.length>=u?p:new Array(u-p.length+1).join("0")+p},r=[],n=e.substr(0,2),i=parseInt(n,16);r[0]=new String(Math.floor(i/40)),r[1]=new String(i%40);for(var s=e.substr(2),o=[],a=0;a<s.length/2;a++)o.push(parseInt(s.substr(a*2,2),16));for(var f=[],l="",a=0;a<o.length;a++)o[a]&128?l=l+t((o[a]&127).toString(2),7):(l=l+t((o[a]&127).toString(2),7),f.push(new String(parseInt(l,2))),l="");var v=r.join(".");return f.length>0&&(v=v+"."+f.join(".")),v};Y.dump=function(e,t,r,n){var i=Y,s=i.getV,o=i.dump,a=i.getChildIdx,f=e;e instanceof B.asn1.ASN1Object&&(f=e.tohex());var l=function(q,P){if(q.length<=P*2)return q;var D=q.substr(0,P)+"..(total "+q.length/2+"bytes).."+q.substr(q.length-P,P);return D};t===void 0&&(t={ommit_long_octet:32}),r===void 0&&(r=0),n===void 0&&(n="");var v=t.ommit_long_octet,F=f.substr(r,2);if(F=="01"){var p=s(f,r);return p=="00"?n+`BOOLEAN FALSE
`:n+`BOOLEAN TRUE
`}if(F=="02"){var p=s(f,r);return n+"INTEGER "+l(p,v)+`
`}if(F=="03"){var p=s(f,r);if(i.isASN1HEX(p.substr(2))){var u=n+`BITSTRING, encapsulates
`;return u=u+o(p.substr(2),t,0,n+"  "),u}else return n+"BITSTRING "+l(p,v)+`
`}if(F=="04"){var p=s(f,r);if(i.isASN1HEX(p)){var u=n+`OCTETSTRING, encapsulates
`;return u=u+o(p,t,0,n+"  "),u}else return n+"OCTETSTRING "+l(p,v)+`
`}if(F=="05")return n+`NULL
`;if(F=="06"){var h=s(f,r),b=B.asn1.ASN1Util.oidHexToInt(h),d=B.asn1.x509.OID.oid2name(b),y=b.replace(/\./g," ");return d!=""?n+"ObjectIdentifier "+d+" ("+y+`)
`:n+"ObjectIdentifier ("+y+`)
`}if(F=="0a")return n+"ENUMERATED "+parseInt(s(f,r))+`
`;if(F=="0c")return n+"UTF8String '"+Nt(s(f,r))+`'
`;if(F=="13")return n+"PrintableString '"+Nt(s(f,r))+`'
`;if(F=="14")return n+"TeletexString '"+Nt(s(f,r))+`'
`;if(F=="16")return n+"IA5String '"+Nt(s(f,r))+`'
`;if(F=="17")return n+"UTCTime "+Nt(s(f,r))+`
`;if(F=="18")return n+"GeneralizedTime "+Nt(s(f,r))+`
`;if(F=="1a")return n+"VisualString '"+Nt(s(f,r))+`'
`;if(F=="1e")return n+"BMPString '"+Bb(s(f,r))+`'
`;if(F=="30"){if(f.substr(r,4)=="3000")return n+`SEQUENCE {}
`;var u=n+`SEQUENCE
`,w=a(f,r),_=t;if((w.length==2||w.length==3)&&f.substr(w[0],2)=="06"&&f.substr(w[w.length-1],2)=="04"){var d=i.oidname(s(f,w[0])),I=JSON.parse(JSON.stringify(t));I.x509ExtName=d,_=I}for(var N=0;N<w.length;N++)u=u+o(f,_,w[N],n+"  ");return u}if(F=="31"){for(var u=n+`SET
`,w=a(f,r),N=0;N<w.length;N++)u=u+o(f,t,w[N],n+"  ");return u}var F=parseInt(F,16);if((F&128)!=0){var O=F&31;if((F&32)!=0){for(var u=n+"["+O+`]
`,w=a(f,r),N=0;N<w.length;N++)u=u+o(f,t,w[N],n+"  ");return u}else{var p=s(f,r);if(Y.isASN1HEX(p)){var u=n+"["+O+`]
`;return u=u+o(p,t,0,n+"  "),u}else(p.substr(0,8)=="68747470"||t.x509ExtName==="subjectAltName"&&O==2)&&(p=Nt(p));var u=n+"["+O+"] "+p+`
`;return u}}return n+"UNKNOWN("+F+") "+s(f,r)+`
`};Y.parse=function(e){var t=Y,r=t.parse,n=t.isASN1HEX,i=t.getV,s=t.getTLV,o=t.getChildIdx,a=B.asn1,f=a.ASN1Util.oidHexToInt,l=a.x509.OID.oid2name,v=Nt,p=Bb,u=bL,h={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},b=function(D){for(var A=[],c=o(D,0),m=0;m<c.length;m++){var S=c[m],g=s(D,S),E=r(g);A.push(E)}return A},d=e.substr(0,2),y={},w=i(e,0);if(d=="01")return e=="0101ff"?{bool:!0}:{bool:!1};if(d=="02")return{int:{hex:w}};if(d=="03")try{if(w.substr(0,2)!="00")throw"not encap";var _=w.substr(2);if(!n(_))throw"not encap";return{bitstr:{obj:r(_)}}}catch{var I=null;return w.length<=10&&(I=p9(w)),I==null?{bitstr:{hex:w}}:{bitstr:{bin:I}}}else if(d=="04")try{if(!n(w))throw"not encap";return{octstr:{obj:r(w)}}}catch{return{octstr:{hex:w}}}else{if(d=="05")return{null:""};if(d=="06"){var N=f(w),F=l(N);return F==""?{oid:N}:{oid:F}}else{if(d=="0a")return w.length>4?{enum:{hex:w}}:{enum:parseInt(w,16)};if(d=="30"||d=="31")return y[h[d]]=b(e),y;if(d=="14"){var O=u(w);return y[h[d]]={str:O},y}else if(d=="1e"){var O=p(w);return y[h[d]]={str:O},y}else if(":0c:12:13:16:17:18:1a:".indexOf(d)!=-1){var O=v(w);return y[h[d]]={str:O},y}else if(d.match(/^8[0-9]$/)){var O=v(w);return O==null|O==""?{tag:{tag:d,explicit:!1,hex:w}}:O.match(/[\x00-\x1F\x7F-\x9F]/)!=null||O.match(/[\u0000-\u001F\u0080–\u009F]/)!=null?{tag:{tag:d,explicit:!1,hex:w}}:{tag:{tag:d,explicit:!1,str:O}}}else if(d.match(/^a[0-9]$/))try{if(!n(w))throw new Error("not encap");return{tag:{tag:d,explicit:!0,obj:r(w)}}}catch{return{tag:{tag:d,explicit:!0,hex:w}}}else{var q=new B.asn1.ASN1Object;q.hV=w;var P=q.getLengthHexFromValue();return{asn1:{tlv:d+P+w}}}}}};Y.isContextTag=function(e,t){e=e.toLowerCase();var r,n;try{r=parseInt(e,16)}catch{return-1}if(t===void 0)return(r&192)==128;try{var i=t.match(/^\[[0-9]+\]$/);return i==null||(n=parseInt(t.substr(1,t.length-1),10),n>31)?!1:(r&192)==128&&(r&31)==n}catch{return!1}};Y.isASN1HEX=function(e){var t=Y;if(e.length%2==1)return!1;var r=t.getVblen(e,0),n=e.substr(0,2),i=t.getL(e,0),s=e.length-n.length-i.length;return s==r*2};Y.checkStrictDER=function(e,t,r,n,i){var s=Y;if(r===void 0){if(typeof e!="string")throw new Error("not hex string");if(e=e.toLowerCase(),!B.lang.String.isHex(e))throw new Error("not hex string");r=e.length,n=e.length/2,n<128?i=1:i=Math.ceil(n.toString(16))+1}var o=s.getL(e,t);if(o.length>i*2)throw new Error("L of TLV too long: idx="+t);var a=s.getVblen(e,t);if(a>n)throw new Error("value of L too long than hex: idx="+t);var f=s.getTLV(e,t),l=f.length-2-s.getL(e,t).length;if(l!==a*2)throw new Error("V string length and L's value not the same:"+l+"/"+a*2);if(t===0&&e.length!=f.length)throw new Error("total length and TLV length unmatch:"+e.length+"!="+f.length);var v=e.substr(t,2);if(v==="02"){var p=s.getVidx(e,t);if(e.substr(p,2)=="00"&&e.charCodeAt(p+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(v,16)&32){for(var u=s.getVblen(e,t),h=0,b=s.getChildIdx(e,t),d=0;d<b.length;d++){var y=s.getTLV(e,b[d]);h+=y.length,s.checkStrictDER(e,b[d],r,n,i)}if(u*2!=h)throw new Error("sum of children's TLV length and L unmatch: "+u*2+"!="+h)}};Y.oidname=function(e){var t=B.asn1;B.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var r=t.x509.OID.oid2name(e);return r===""&&(r=e),r};(typeof B>"u"||!B)&&(B={});(typeof B.asn1>"u"||!B.asn1)&&(B.asn1={});(typeof B.asn1.x509>"u"||!B.asn1.x509)&&(B.asn1.x509={});B.asn1.x509.Certificate=function(e){B.asn1.x509.Certificate.superclass.constructor.call(this);var t=B,r=t.asn1,n=r.DERBitString,i=r.DERSequence,s=r.x509,o=s.TBSCertificate,a=s.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(f){this.params=f},this.sign=function(){var f=this.params,l=f.sigalg;f.sigalg.name!=null&&(l=f.sigalg.name);var v=f.tbsobj.tohex(),p=new B.crypto.Signature({alg:l});p.init(f.cakey),p.updateHex(v),f.sighex=p.sign()},this.getPEM=function(){return bn(this.tohex(),"CERTIFICATE")},this.tohex=function(){var f=this.params;if((f.tbsobj==null||f.tbsobj==null)&&(f.tbsobj=new o(f)),f.sighex==null&&f.cakey!=null&&this.sign(),f.sighex==null)throw new Error("sighex or cakey parameter not defined");var l=[];l.push(f.tbsobj),l.push(new a({name:f.sigalg})),l.push(new n({hex:"00"+f.sighex}));var v=new i({array:l});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&(this.params=e)};X(B.asn1.x509.Certificate,B.asn1.ASN1Object);B.asn1.x509.TBSCertificate=function(e){B.asn1.x509.TBSCertificate.superclass.constructor.call(this);var t=B,r=t.asn1,n=r.x509,i=r.DERTaggedObject,s=r.DERInteger,o=r.DERSequence,a=n.AlgorithmIdentifier,f=n.Time,l=n.X500Name,v=n.Extensions,p=n.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(u){this.params=u},this.tohex=function(){var u=[],h=this.params;if(h.version!=null||h.version!=1){var b=2;h.version!=null&&(b=h.version-1);var d=new i({obj:new s({int:b})});u.push(d)}u.push(new s(h.serial)),u.push(new a({name:h.sigalg})),u.push(new l(h.issuer)),u.push(new o({array:[new f(h.notbefore),new f(h.notafter)]})),u.push(new l(h.subject)),u.push(new p(ct.getKey(h.sbjpubkey))),h.ext!==void 0&&h.ext.length>0&&u.push(new i({tag:"a3",obj:new v(h.ext)}));var y=new B.asn1.DERSequence({array:u});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.x509.TBSCertificate,B.asn1.ASN1Object);B.asn1.x509.Extensions=function(e){B.asn1.x509.Extensions.superclass.constructor.call(this);var t=B,r=t.asn1,n=r.DERSequence,i=r.x509;this.aParam=[],this.setByParam=function(s){this.aParam=s},this.tohex=function(){for(var s=[],o=0;o<this.aParam.length;o++){var a=this.aParam[o],f=a.extname,l=null;if(a.extn!=null)l=new i.PrivateExtension(a);else if(f=="subjectKeyIdentifier")l=new i.SubjectKeyIdentifier(a);else if(f=="keyUsage")l=new i.KeyUsage(a);else if(f=="subjectAltName")l=new i.SubjectAltName(a);else if(f=="issuerAltName")l=new i.IssuerAltName(a);else if(f=="basicConstraints")l=new i.BasicConstraints(a);else if(f=="nameConstraints")l=new i.NameConstraints(a);else if(f=="cRLDistributionPoints")l=new i.CRLDistributionPoints(a);else if(f=="certificatePolicies")l=new i.CertificatePolicies(a);else if(f=="policyMappings")l=new i.PolicyMappings(a);else if(f=="policyConstraints")l=new i.PolicyConstraints(a);else if(f=="inhibitAnyPolicy")l=new i.InhibitAnyPolicy(a);else if(f=="authorityKeyIdentifier")l=new i.AuthorityKeyIdentifier(a);else if(f=="extKeyUsage")l=new i.ExtKeyUsage(a);else if(f=="authorityInfoAccess")l=new i.AuthorityInfoAccess(a);else if(f=="cRLNumber")l=new i.CRLNumber(a);else if(f=="cRLReason")l=new i.CRLReason(a);else if(f=="ocspNonce")l=new i.OCSPNonce(a);else if(f=="ocspNoCheck")l=new i.OCSPNoCheck(a);else if(f=="adobeTimeStamp")l=new i.AdobeTimeStamp(a);else if(f=="subjectDirectoryAttributes")l=new i.SubjectDirectoryAttributes(a);else throw new Error("extension not supported:"+JSON.stringify(a));l!=null&&s.push(l)}var v=new n({array:s});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.x509.Extensions,B.asn1.ASN1Object);B.asn1.x509.Extension=function(e){B.asn1.x509.Extension.superclass.constructor.call(this);var t=null,r=B,n=r.asn1,i=n.DERObjectIdentifier,s=n.DEROctetString,o=n.DERBitString,a=n.DERBoolean,f=n.DERSequence;this.tohex=function(){var l=new i({oid:this.oid}),v=new s({hex:this.getExtnValueHex()}),p=new Array;p.push(l),this.critical&&p.push(new a),p.push(v);var u=new f({array:p});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,e!==void 0&&e.critical!==void 0&&(this.critical=e.critical)};X(B.asn1.x509.Extension,B.asn1.ASN1Object);B.asn1.x509.KeyUsage=function(e){B.asn1.x509.KeyUsage.superclass.constructor.call(this,e);var t=Error,r={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var n=this.getBinValue();return this.asn1ExtnValue=new B.asn1.DERBitString({bin:n}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var n=this.params;if(typeof n!="object"||typeof n.names!="object"&&typeof n.bin!="string")throw new t("parameter not yet set");if(n.names!=null)return Ol(n.names,r);if(n.bin!=null)return n.bin;throw new t("parameter not set properly")},this.oid="2.5.29.15",e!==void 0&&(this.params=e)};X(B.asn1.x509.KeyUsage,B.asn1.x509.Extension);B.asn1.x509.BasicConstraints=function(e){B.asn1.x509.BasicConstraints.superclass.constructor.call(this,e);var t=B.asn1,r=t.DERBoolean,n=t.DERInteger,i=t.DERSequence,s=!1,o=-1;this.getExtnValueHex=function(){var a=new Array;this.cA&&a.push(new r),this.pathLen>-1&&a.push(new n({int:this.pathLen}));var f=new i({array:a});return this.asn1ExtnValue=f,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,e!==void 0&&(e.cA!==void 0&&(this.cA=e.cA),e.pathLen!==void 0&&(this.pathLen=e.pathLen))};X(B.asn1.x509.BasicConstraints,B.asn1.x509.Extension);B.asn1.x509.CRLDistributionPoints=function(e){B.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,e);var t=B,r=t.asn1,n=r.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(i){for(var s=[],o=0;o<i.length;o++)if(i[o]instanceof B.asn1.ASN1Object)s.push(i[o]);else{var a=new n.DistributionPoint(i[o]);s.push(a)}this.asn1ExtnValue=new r.DERSequence({array:s})},this.setByOneURI=function(i){var s=new n.DistributionPoint({fulluri:i});this.setByDPArray([s])},this.oid="2.5.29.31",e!==void 0&&(e.array!==void 0?this.setByDPArray(e.array):e.uri!==void 0&&this.setByOneURI(e.uri))};X(B.asn1.x509.CRLDistributionPoints,B.asn1.x509.Extension);B.asn1.x509.DistributionPoint=function(e){B.asn1.x509.DistributionPoint.superclass.constructor.call(this);var t=null,r=B,n=r.asn1,i=n.x509.DistributionPointName;this.tohex=function(){var s=new n.DERSequence;if(this.asn1DP!=null){var o=new n.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});s.appendASN1Object(o)}return this.hTLV=s.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.dpobj!==void 0?this.asn1DP=e.dpobj:e.dpname!==void 0?this.asn1DP=new i(e.dpname):e.fulluri!==void 0&&(this.asn1DP=new i({full:[{uri:e.fulluri}]})))};X(B.asn1.x509.DistributionPoint,B.asn1.ASN1Object);B.asn1.x509.DistributionPointName=function(e){B.asn1.x509.DistributionPointName.superclass.constructor.call(this);var t=null,r=null,n=null,i=null,s=B,o=s.asn1,a=o.DERTaggedObject;if(this.tohex=function(){if(this.type!="full")throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new a({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0)if(o.x509.GeneralNames.prototype.isPrototypeOf(e))this.type="full",this.tag="a0",this.asn1V=e;else if(e.full!==void 0)this.type="full",this.tag="a0",this.asn1V=new o.x509.GeneralNames(e.full);else throw new Error("This class supports GeneralNames only as argument")};X(B.asn1.x509.DistributionPointName,B.asn1.ASN1Object);B.asn1.x509.CertificatePolicies=function(e){B.asn1.x509.CertificatePolicies.superclass.constructor.call(this,e);var t=B,r=t.asn1,n=r.x509,i=r.DERSequence,s=n.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var o=[],a=0;a<this.params.array.length;a++)o.push(new s(this.params.array[a]));var f=new i({array:o});return this.asn1ExtnValue=f,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",e!==void 0&&(this.params=e)};X(B.asn1.x509.CertificatePolicies,B.asn1.x509.Extension);B.asn1.x509.PolicyInformation=function(e){B.asn1.x509.PolicyInformation.superclass.constructor.call(this,e);var t=B.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,i=t.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0)throw new Error("parameter oid and array missing");var s=[new n(this.params.policyoid)];if(this.params.array!==void 0){for(var o=[],a=0;a<this.params.array.length;a++)o.push(new i(this.params.array[a]));o.length>0&&s.push(new r({array:o}))}var f=new r({array:s});return f.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};X(B.asn1.x509.PolicyInformation,B.asn1.ASN1Object);B.asn1.x509.PolicyQualifierInfo=function(e){B.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,e);var t=B.asn1,r=t.DERSequence,n=t.DERIA5String,i=t.DERObjectIdentifier,s=t.x509.UserNotice;this.params=null,this.tohex=function(){if(this.params.cps!==void 0){var o=new r({array:[new i({oid:"1.3.6.1.5.5.7.2.1"}),new n({str:this.params.cps})]});return o.tohex()}if(this.params.unotice!=null){var o=new r({array:[new i({oid:"1.3.6.1.5.5.7.2.2"}),new s(this.params.unotice)]});return o.tohex()}},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};X(B.asn1.x509.PolicyQualifierInfo,B.asn1.ASN1Object);B.asn1.x509.UserNotice=function(e){B.asn1.x509.UserNotice.superclass.constructor.call(this,e);var t=B.asn1.DERSequence,r=B.asn1.DERInteger,n=B.asn1.x509.DisplayText,i=B.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var s=[];this.params.noticeref!==void 0&&s.push(new i(this.params.noticeref)),this.params.exptext!==void 0&&s.push(new n(this.params.exptext));var o=new t({array:s});return o.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};X(B.asn1.x509.UserNotice,B.asn1.ASN1Object);B.asn1.x509.NoticeReference=function(e){B.asn1.x509.NoticeReference.superclass.constructor.call(this,e);var t=B.asn1.DERSequence,r=B.asn1.DERInteger,n=B.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var i=[];if(this.params.org!==void 0&&i.push(new n(this.params.org)),this.params.noticenum!==void 0){for(var s=[],o=this.params.noticenum,a=0;a<o.length;a++)s.push(new r(o[a]));i.push(new t({array:s}))}if(i.length==0)throw new Error("parameter is empty");var f=new t({array:i});return f.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};X(B.asn1.x509.NoticeReference,B.asn1.ASN1Object);B.asn1.x509.DisplayText=function(e){B.asn1.x509.DisplayText.superclass.constructor.call(this,e),this.hT="0c",e!==void 0&&(e.type==="ia5"?this.hT="16":e.type==="vis"?this.hT="1a":e.type==="bmp"&&(this.hT="1e"))};X(B.asn1.x509.DisplayText,B.asn1.DERAbstractString);B.asn1.x509.PolicyMappings=function(e){B.asn1.x509.PolicyMappings.superclass.constructor.call(this,e);var t=B,r=t.asn1,n=r.x509,i=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){for(var s=this.params,o=[],a=0;a<s.array.length;a++){var f=s.array[a];o.push({seq:[{oid:f[0]},{oid:f[1]}]})}return this.asn1ExtnValue=i({seq:o}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",e!==void 0&&(this.params=e)};X(B.asn1.x509.PolicyMappings,B.asn1.x509.Extension);B.asn1.x509.PolicyConstraints=function(e){B.asn1.x509.PolicyConstraints.superclass.constructor.call(this,e);var t=B,r=t.asn1,n=r.x509,i=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){var s=this.params,o=[];return s.reqexp!=null&&o.push({tag:{tagi:"80",obj:{int:s.reqexp}}}),s.inhibit!=null&&o.push({tag:{tagi:"81",obj:{int:s.inhibit}}}),this.asn1ExtnValue=i({seq:o}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",e!==void 0&&(this.params=e)};X(B.asn1.x509.PolicyConstraints,B.asn1.x509.Extension);B.asn1.x509.InhibitAnyPolicy=function(e){B.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,e);var t=B,r=t.asn1,n=r.x509,i=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=i({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",e!==void 0&&(this.params=e)};X(B.asn1.x509.InhibitAnyPolicy,B.asn1.x509.Extension);B.asn1.x509.NameConstraints=function(e){B.asn1.x509.NameConstraints.superclass.constructor.call(this,e);var t=B,r=t.asn1,n=r.x509,i=r.ASN1Util.newObject,s=n.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var o=this.params,a=[];if(o.permit!=null&&o.permit.length!=null){for(var f=[],l=0;l<o.permit.length;l++)f.push(new s(o.permit[l]));a.push({tag:{tagi:"a0",obj:{seq:f}}})}if(o.exclude!=null&&o.exclude.length!=null){for(var v=[],l=0;l<o.exclude.length;l++)v.push(new s(o.exclude[l]));a.push({tag:{tagi:"a1",obj:{seq:v}}})}return this.asn1ExtnValue=i({seq:a}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",e!==void 0&&(this.params=e)};X(B.asn1.x509.NameConstraints,B.asn1.x509.Extension);B.asn1.x509.GeneralSubtree=function(e){B.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var t=B.asn1,r=t.x509,n=r.GeneralName,i=t.ASN1Util.newObject;this.params=null,this.setByParam=function(s){this.params=s},this.tohex=function(){var s=this.params,o=[new n(s)];s.min!=null&&o.push({tag:{tagi:"80",obj:{int:s.min}}}),s.max!=null&&o.push({tag:{tagi:"81",obj:{int:s.max}}});var a=i({seq:o});return a.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.x509.GeneralSubtree,B.asn1.ASN1Object);B.asn1.x509.ExtKeyUsage=function(e){B.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,e);var t=B,r=t.asn1;this.setPurposeArray=function(n){this.asn1ExtnValue=new r.DERSequence;for(var i=0;i<n.length;i++){var s=new r.DERObjectIdentifier(n[i]);this.asn1ExtnValue.appendASN1Object(s)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",e!==void 0&&e.array!==void 0&&this.setPurposeArray(e.array)};X(B.asn1.x509.ExtKeyUsage,B.asn1.x509.Extension);B.asn1.x509.AuthorityKeyIdentifier=function(e){B.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,e);var t=B,r=t.asn1,n=r.DERTaggedObject,i=r.x509.GeneralNames,s=t.crypto.Util.isKey;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var o=new Array;this.asn1KID&&o.push(new n({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&o.push(new n({explicit:!1,tag:"a1",obj:new i([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&o.push(new n({explicit:!1,tag:"82",obj:this.asn1CertSN}));var a=new r.DERSequence({array:o});return this.asn1ExtnValue=a,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(o){if(o.str!==void 0||o.hex!==void 0)this.asn1KID=new B.asn1.DEROctetString(o);else if(typeof o=="object"&&B.crypto.Util.isKey(o)||typeof o=="string"&&o.indexOf("BEGIN ")!=-1){var a=o;typeof o=="string"&&(a=ct.getKey(o));var f=ct.getKeyID(a);this.asn1KID=new B.asn1.DEROctetString({hex:f})}},this.setCertIssuerByParam=function(o){o.str!==void 0||o.ldapstr!==void 0||o.hex!==void 0||o.certsubject!==void 0||o.certissuer!==void 0?this.asn1CertIssuer=new B.asn1.x509.X500Name(o):typeof o=="string"&&o.indexOf("BEGIN ")!=-1&&o.indexOf("CERTIFICATE")!=-1&&(this.asn1CertIssuer=new B.asn1.x509.X500Name({certissuer:o}))},this.setCertSNByParam=function(o){if(o.str!==void 0||o.bigint!==void 0||o.hex!==void 0)this.asn1CertSN=new B.asn1.DERInteger(o);else if(typeof o=="string"&&o.indexOf("BEGIN ")!=-1&&o.indexOf("CERTIFICATE")){var a=new Me;a.readCertPEM(o);var f=a.getSerialNumberHex();this.asn1CertSN=new B.asn1.DERInteger({hex:f})}},this.oid="2.5.29.35",e!==void 0&&(e.kid!==void 0&&this.setKIDByParam(e.kid),e.issuer!==void 0&&this.setCertIssuerByParam(e.issuer),e.sn!==void 0&&this.setCertSNByParam(e.sn),e.issuersn!==void 0&&typeof e.issuersn=="string"&&e.issuersn.indexOf("BEGIN ")!=-1&&e.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(e.issuersn),this.setCertIssuerByParam(e.issuersn)))};X(B.asn1.x509.AuthorityKeyIdentifier,B.asn1.x509.Extension);B.asn1.x509.SubjectKeyIdentifier=function(e){B.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,e);var t=B,r=t.asn1,n=r.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(i){if(i.str!==void 0||i.hex!==void 0)this.asn1KID=new n(i);else if(typeof i=="object"&&B.crypto.Util.isKey(i)||typeof i=="string"&&i.indexOf("BEGIN")!=-1){var s=i;typeof i=="string"&&(s=ct.getKey(i));var o=ct.getKeyID(s);this.asn1KID=new B.asn1.DEROctetString({hex:o})}},this.oid="2.5.29.14",e!==void 0&&e.kid!==void 0&&this.setKIDByParam(e.kid)};X(B.asn1.x509.SubjectKeyIdentifier,B.asn1.x509.Extension);B.asn1.x509.AuthorityInfoAccess=function(e){B.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,e),this.setAccessDescriptionArray=function(t){for(var r=new Array,n=B,i=n.asn1,s=i.DERSequence,o=i.DERObjectIdentifier,a=i.x509.GeneralName,f=0;f<t.length;f++){var l,v=t[f];if(v.ocsp!==void 0)l=new s({array:[new o({oid:"1.3.6.1.5.5.7.48.1"}),new a({uri:v.ocsp})]});else if(v.caissuer!==void 0)l=new s({array:[new o({oid:"1.3.6.1.5.5.7.48.2"}),new a({uri:v.caissuer})]});else throw new Error("unknown AccessMethod parameter: "+JSON.stringify(v));r.push(l)}this.asn1ExtnValue=new s({array:r})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",e!==void 0&&e.array!==void 0&&this.setAccessDescriptionArray(e.array)};X(B.asn1.x509.AuthorityInfoAccess,B.asn1.x509.Extension);B.asn1.x509.SubjectAltName=function(e){B.asn1.x509.SubjectAltName.superclass.constructor.call(this,e),this.setNameArray=function(t){this.asn1ExtnValue=new B.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",e!==void 0&&e.array!==void 0&&this.setNameArray(e.array)};X(B.asn1.x509.SubjectAltName,B.asn1.x509.Extension);B.asn1.x509.IssuerAltName=function(e){B.asn1.x509.IssuerAltName.superclass.constructor.call(this,e),this.setNameArray=function(t){this.asn1ExtnValue=new B.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",e!==void 0&&e.array!==void 0&&this.setNameArray(e.array)};X(B.asn1.x509.IssuerAltName,B.asn1.x509.Extension);B.asn1.x509.SubjectDirectoryAttributes=function(e){B.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,e);var t=B.asn1,r=t.DERSequence,n=t.ASN1Util.newObject,i=t.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var s=[],o=0;o<this.params.array.length;o++){var a=this.params.array[o];if(a.attr!=null&&a.array!=null){var f={seq:[{oid:a.attr},{set:a.array}]};s.push(n(f));continue}var l={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(a.attr=="dateOfBirth")l.seq[0].oid=i(a.attr),l.seq[1].set[0]={gentime:a.str};else if(a.attr=="placeOfBirth")l.seq[0].oid=i(a.attr),l.seq[1].set[0]={utf8str:a.str};else if(a.attr=="gender")l.seq[0].oid=i(a.attr),l.seq[1].set[0]={prnstr:a.str};else if(a.attr=="countryOfCitizenship")l.seq[0].oid=i(a.attr),l.seq[1].set[0]={prnstr:a.str};else if(a.attr=="countryOfResidence")l.seq[0].oid=i(a.attr),l.seq[1].set[0]={prnstr:a.str};else throw new Error("unsupported attribute: "+a.attr);s.push(new n(l))}var v=new r({array:s});return this.asn1ExtnValue=v,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",e!==void 0&&(this.params=e)};X(B.asn1.x509.SubjectDirectoryAttributes,B.asn1.x509.Extension);B.asn1.x509.PrivateExtension=function(e){B.asn1.x509.PrivateExtension.superclass.constructor.call(this,e);var t=B,r=t.lang.String.isHex,n=t.asn1,i=n.x509.OID.name2oid,s=n.ASN1Util.newObject;this.params=null,this.setByParam=function(o){this.oid=i(o.extname),this.params=o},this.getExtnValueHex=function(){if(this.params.extname==null||this.params.extn==null)throw new Error("extname or extnhex not specified");var o=this.params.extn;if(typeof o=="string"&&r(o))return o;if(typeof o=="object")try{return s(o).tohex()}catch{}throw new Error("unsupported extn value")},e!=null&&this.setByParam(e)};X(B.asn1.x509.PrivateExtension,B.asn1.x509.Extension);B.asn1.x509.CRL=function(e){B.asn1.x509.CRL.superclass.constructor.call(this);var t=B,r=t.asn1,n=r.DERSequence,i=r.DERBitString,s=r.x509,o=s.AlgorithmIdentifier,a=s.TBSCertList;this.params=void 0,this.setByParam=function(f){this.params=f},this.sign=function(){var f=new a(this.params).tohex(),l=new B.crypto.Signature({alg:this.params.sigalg});l.init(this.params.cakey),l.updateHex(f);var v=l.sign();this.params.sighex=v},this.getPEM=function(){return bn(this.tohex(),"X509 CRL")},this.tohex=function(){var f=this.params;if(f.tbsobj==null&&(f.tbsobj=new a(f)),f.sighex==null&&f.cakey!=null&&this.sign(),f.sighex==null)throw new Error("sighex or cakey parameter not defined");var l=[];l.push(f.tbsobj),l.push(new o({name:f.sigalg})),l.push(new i({hex:"00"+f.sighex}));var v=new n({array:l});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&(this.params=e)};X(B.asn1.x509.CRL,B.asn1.ASN1Object);B.asn1.x509.TBSCertList=function(e){B.asn1.x509.TBSCertList.superclass.constructor.call(this);var t=B,r=t.asn1,n=r.DERInteger,i=r.DERSequence,s=r.DERTaggedObject,o=r.DERObjectIdentifier,a=r.x509,f=a.AlgorithmIdentifier,l=a.Time,v=a.Extensions,p=a.X500Name;this.params=null,this.setByParam=function(u){this.params=u},this.getRevCertSequence=function(){for(var u=[],h=this.params.revcert,b=0;b<h.length;b++){var d=[new n(h[b].sn),new l(h[b].date)];h[b].ext!=null&&d.push(new v(h[b].ext)),u.push(new i({array:d}))}return new i({array:u})},this.tohex=function(){var u=[],h=this.params;if(h.version!=null){var b=h.version-1,d=new n({int:b});u.push(d)}if(u.push(new f({name:h.sigalg})),u.push(new p(h.issuer)),u.push(new l(h.thisupdate)),h.nextupdate!=null&&u.push(new l(h.nextupdate)),h.revcert!=null&&u.push(this.getRevCertSequence()),h.ext!=null){var y=new v(h.ext);u.push(new s({tag:"a0",explicit:!0,obj:y}))}var w=new i({array:u});return w.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.x509.TBSCertList,B.asn1.ASN1Object);B.asn1.x509.CRLEntry=function(e){B.asn1.x509.CRLEntry.superclass.constructor.call(this);var t=null,r=null,n=B,i=n.asn1;this.setCertSerial=function(s){this.sn=new i.DERInteger(s)},this.setRevocationDate=function(s){this.time=new i.x509.Time(s)},this.tohex=function(){var s=new i.DERSequence({array:[this.sn,this.time]});return this.TLV=s.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.time!==void 0&&this.setRevocationDate(e.time),e.sn!==void 0&&this.setCertSerial(e.sn))};X(B.asn1.x509.CRLEntry,B.asn1.ASN1Object);B.asn1.x509.CRLNumber=function(e){B.asn1.x509.CRLNumber.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new B.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",e!=null&&(this.params=e)};X(B.asn1.x509.CRLNumber,B.asn1.x509.Extension);B.asn1.x509.CRLReason=function(e){B.asn1.x509.CRLReason.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new B.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",e!=null&&(this.params=e)};X(B.asn1.x509.CRLReason,B.asn1.x509.Extension);B.asn1.x509.OCSPNonce=function(e){B.asn1.x509.OCSPNonce.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new B.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",e!=null&&(this.params=e)};X(B.asn1.x509.OCSPNonce,B.asn1.x509.Extension);B.asn1.x509.OCSPNoCheck=function(e){B.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new B.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",e!=null&&(this.params=e)};X(B.asn1.x509.OCSPNoCheck,B.asn1.x509.Extension);B.asn1.x509.AdobeTimeStamp=function(e){B.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,e);var t=B,r=t.asn1,n=r.DERInteger,i=r.DERBoolean,s=r.DERSequence,o=r.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var a=this.params,f=[new n(1)];return f.push(new o({uri:a.uri})),a.reqauth!=null&&f.push(new i(a.reqauth)),this.asn1ExtnValue=new s({array:f}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",e!==void 0&&this.setByParam(e)};X(B.asn1.x509.AdobeTimeStamp,B.asn1.x509.Extension);B.asn1.x509.X500Name=function(e){B.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=B,r=t.asn1,n=r.x509,i=n.RDN,s=tr;this.setByString=function(o,a){a!==void 0&&(this.sRule=a);var f=o.split("/");f.shift();for(var l=[],v=0;v<f.length;v++)if(f[v].match(/^[^=]+=.+$/))l.push(f[v]);else{var p=l.length-1;l[p]=l[p]+"/"+f[v]}for(var v=0;v<l.length;v++)this.asn1Array.push(new i({str:l[v],rule:this.sRule}))},this.setByLdapString=function(o,a){a!==void 0&&(this.sRule=a);var f=n.X500Name.ldapToCompat(o);this.setByString(f,a)},this.setByObject=function(o,a){a!==void 0&&(this.sRule=a);for(var f in o)if(o.hasOwnProperty(f)){var l=new i({str:f+"="+o[f],rule:this.sRule});this.asn1Array?this.asn1Array.push(l):this.asn1Array=[l]}},this.setByParam=function(o){if(o.rule!==void 0&&(this.sRule=o.rule),o.array!==void 0)this.paramArray=o.array;else if(o.str!==void 0)this.setByString(o.str);else if(o.ldapstr!==void 0)this.setByLdapString(o.ldapstr);else if(o.hex!==void 0)this.hTLV=o.hex;else if(o.certissuer!==void 0){var a=new Me;a.readCertPEM(o.certissuer),this.hTLV=a.getIssuerHex()}else if(o.certsubject!==void 0){var a=new Me;a.readCertPEM(o.certsubject),this.hTLV=a.getSubjectHex()}else typeof o=="object"&&o.certsubject===void 0&&o.certissuer===void 0&&this.setByObject(o)},this.tohex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.asn1Array.length==0&&this.paramArray.length>0)for(var o=0;o<this.paramArray.length;o++){var a={array:this.paramArray[o]};this.sRule!="utf8"&&(a.rule=this.sRule);var f=new i(a);this.asn1Array.push(f)}var l=new r.DERSequence({array:this.asn1Array});return this.hTLV=l.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.x509.X500Name,B.asn1.ASN1Object);B.asn1.x509.X500Name.compatToLDAP=function(e){if(e.substr(0,1)!=="/")throw"malformed input";var t="";e=e.substr(1);var r=e.split("/");return r.reverse(),r=r.map(function(n){return n.replace(/,/,"\\,")}),r.join(",")};B.asn1.x509.X500Name.onelineToLDAP=function(e){return B.asn1.x509.X500Name.compatToLDAP(e)};B.asn1.x509.X500Name.ldapToCompat=function(e){for(var t=e.split(","),r=!1,n=[],i=0;t.length>0;i++){var s=t.shift();if(r===!0){var o=n.pop(),a=(o+","+s).replace(/\\,/g,",");n.push(a),r=!1}else n.push(s);s.substr(-1,1)==="\\"&&(r=!0)}return n=n.map(function(f){return f.replace("/","\\/")}),n.reverse(),"/"+n.join("/")};B.asn1.x509.X500Name.ldapToOneline=function(e){return B.asn1.x509.X500Name.ldapToCompat(e)};B.asn1.x509.RDN=function(e){B.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=B.asn1.x509.AttributeTypeAndValue;this.setByParam=function(r){r.rule!==void 0&&(this.sRule=r.rule),r.str!==void 0&&this.addByMultiValuedString(r.str),r.array!==void 0&&(this.paramArray=r.array)},this.addByString=function(r){this.asn1Array.push(new B.asn1.x509.AttributeTypeAndValue({str:r,rule:this.sRule}))},this.addByMultiValuedString=function(r){for(var n=B.asn1.x509.RDN.parseString(r),i=0;i<n.length;i++)this.addByString(n[i])},this.tohex=function(){if(this.asn1Array.length==0&&this.paramArray.length>0)for(var r=0;r<this.paramArray.length;r++){var n=this.paramArray[r];n.rule!==void 0&&this.sRule!="utf8"&&(n.rule=this.sRule);var i=new t(n);this.asn1Array.push(i)}var s=new B.asn1.DERSet({array:this.asn1Array});return this.TLV=s.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.x509.RDN,B.asn1.ASN1Object);B.asn1.x509.RDN.parseString=function(e){for(var t=e.split(/\+/),r=!1,n=[],i=0;t.length>0;i++){var s=t.shift();if(r===!0){var o=n.pop(),a=(o+"+"+s).replace(/\\\+/g,"+");n.push(a),r=!1}else n.push(s);s.substr(-1,1)==="\\"&&(r=!0)}for(var f=!1,l=[],i=0;n.length>0;i++){var s=n.shift();if(f===!0){var v=l.pop();if(s.match(/"$/)){var a=(v+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2");l.push(a),f=!1}else l.push(v+"+"+s)}else l.push(s);s.match(/^[^=]+="/)&&(f=!0)}return l};B.asn1.x509.AttributeTypeAndValue=function(e){B.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var t=B,r=t.asn1,n=r.DERSequence,i=r.DERUTF8String,s=r.DERPrintableString,o=r.DERTeletexString,a=r.DERIA5String,f=r.DERVisibleString,l=r.DERBMPString,v=t.lang.String.isMail,p=t.lang.String.isPrintable;this.setByParam=function(u){if(u.rule!==void 0&&(this.sRule=u.rule),u.ds!==void 0&&(this.dsType=u.ds),u.value===void 0&&u.str!==void 0){var h=u.str,b=h.match(/^([^=]+)=(.+)$/);if(b)this.sType=b[1],this.sValue=b[2];else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}else this.sType=u.type,this.sValue=u.value},this.setByString=function(u,h){h!==void 0&&(this.sRule=h);var b=u.match(/^([^=]+)=(.+)$/);if(b)this.setByAttrTypeAndValueStr(b[1],b[2]);else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)},this._getDsType=function(){var u=this.sType,h=this.sValue,b=this.sRule;return b==="prn"?u=="CN"&&v(h)?"ia5":p(h)?"prn":"utf8":b==="utf8"?u=="CN"&&v(h)?"ia5":u=="C"?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(u,h,b){b!==void 0&&(this.sRule=b),this.sType=u,this.sValue=h},this.getValueObj=function(u,h){if(u=="utf8")return new i({str:h});if(u=="prn")return new s({str:h});if(u=="tel")return new o({str:h});if(u=="ia5")return new a({str:h});if(u=="vis")return new f({str:h});if(u=="bmp")return new l({str:h});throw new Error("unsupported directory string type: type="+u+" value="+h)},this.tohex=function(){this.dsType==null&&(this.dsType=this._getDsType());var u=B.asn1.x509.OID.atype2obj(this.sType),h=this.getValueObj(this.dsType,this.sValue),b=new n({array:[u,h]});return this.TLV=b.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.x509.AttributeTypeAndValue,B.asn1.ASN1Object);B.asn1.x509.SubjectPublicKeyInfo=function(e){B.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var t=null,r=null,n=B,i=n.asn1,s=i.DERInteger,o=i.DERBitString,a=i.DERObjectIdentifier,f=i.DERSequence,l=i.ASN1Util.newObject,v=i.x509,p=v.AlgorithmIdentifier,u=n.crypto,h=u.ECDSA,b=u.DSA;this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";var d=new f({array:[this.asn1AlgId,this.asn1SubjPKey]});return d},this.tohex=function(){var d=this.getASN1Object();return this.hTLV=d.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(d){try{if(d instanceof Pe){var y=l({seq:[{int:{bigint:d.n}},{int:{int:d.e}}]}),w=y.tohex();this.asn1AlgId=new p({name:"rsaEncryption"}),this.asn1SubjPKey=new o({hex:"00"+w})}}catch{}try{if(d instanceof B.crypto.ECDSA){var _=new a({name:d.curveName});this.asn1AlgId=new p({name:"ecPublicKey",asn1params:_}),this.asn1SubjPKey=new o({hex:"00"+d.pubKeyHex})}}catch{}try{if(d instanceof B.crypto.DSA){var _=new l({seq:[{int:{bigint:d.p}},{int:{bigint:d.q}},{int:{bigint:d.g}}]});this.asn1AlgId=new p({name:"dsa",asn1params:_});var I=new s({bigint:d.y});this.asn1SubjPKey=new o({hex:"00"+I.tohex()})}}catch{}},e!==void 0&&this.setPubKey(e)};X(B.asn1.x509.SubjectPublicKeyInfo,B.asn1.ASN1Object);B.asn1.x509.Time=function(e){B.asn1.x509.Time.superclass.constructor.call(this);var t=null,r=null,n=B,i=n.asn1,s=i.DERUTCTime,o=i.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(a){this.timeParams=a},this.setByParam=function(a){this.params=a},this.getType=function(a){return a.match(/^[0-9]{12}Z$/)?"utc":a.match(/^[0-9]{14}Z$/)?"gen":a.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":a.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var a=this.params,f=null;if(typeof a=="string"&&(a={str:a}),a!=null&&a.str&&(a.type==null||a.type==null)&&(a.type=this.getType(a.str)),a!=null&&a.str?(a.type=="utc"&&(f=new s(a.str)),a.type=="gen"&&(f=new o(a.str))):this.type=="gen"?f=new o:f=new s,f==null)throw new Error("wrong setting for Time");return this.TLV=f.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};B.asn1.x509.Time_bak=function(e){B.asn1.x509.Time_bak.superclass.constructor.call(this);var t=null,r=null,n=B,i=n.asn1,s=i.DERUTCTime,o=i.DERGeneralizedTime;this.setTimeParams=function(a){this.timeParams=a},this.tohex=function(){var a=null;return this.timeParams!=null?this.type=="utc"?a=new s(this.timeParams):a=new o(this.timeParams):this.type=="utc"?a=new s:a=new o,this.TLV=a.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",e!==void 0&&(e.type!==void 0?this.type=e.type:e.str!==void 0&&(e.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),e.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=e)};X(B.asn1.x509.Time,B.asn1.ASN1Object);B.asn1.x509.AlgorithmIdentifier=function(e){B.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var t=B,r=t.asn1,n=r.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw new Error("algorithm not specified");if(this.nameAlg!==null){var s=null;for(var o in n)o===this.nameAlg&&(s=n[o]);if(s!==null)return this.hTLV=s,this.hTLV}this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=r.x509.OID.name2obj(this.nameAlg));var a=[this.asn1Alg];this.asn1Params!==null&&a.push(this.asn1Params);var f=new r.DERSequence({array:a});return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.name!==void 0&&(this.nameAlg=e.name),e.asn1params!==void 0&&(this.asn1Params=e.asn1params),e.paramempty!==void 0&&(this.paramEmpty=e.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){this.nameAlg.name!==void 0&&(this.nameAlg=this.nameAlg.name);var i=this.nameAlg.toLowerCase();i.substr(-7,7)!=="withdsa"&&i.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new r.DERNull)}};X(B.asn1.x509.AlgorithmIdentifier,B.asn1.ASN1Object);B.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"};B.asn1.x509.GeneralName=function(e){B.asn1.x509.GeneralName.superclass.constructor.call(this);var t={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87",otherName:"a0"},r=B,n=r.asn1,i=n.x509,s=i.X500Name,o=i.OtherName,a=n.DERIA5String,f=n.DERPrintableString,l=n.DEROctetString,v=n.DERTaggedObject,p=n.ASN1Object,u=Error;this.params=null,this.setByParam=function(h){this.params=h},this.tohex=function(){var h=this.params,b,y,d,y=!1;if(h.other!==void 0)b="a0",d=new o(h.other);else if(h.rfc822!==void 0)b="81",d=new a({str:h.rfc822});else if(h.dns!==void 0)b="82",d=new a({str:h.dns});else if(h.dn!==void 0)b="a4",y=!0,typeof h.dn=="string"?d=new s({str:h.dn}):h.dn instanceof B.asn1.x509.X500Name?d=h.dn:d=new s(h.dn);else if(h.ldapdn!==void 0)b="a4",y=!0,d=new s({ldapstr:h.ldapdn});else if(h.certissuer!==void 0||h.certsubj!==void 0){b="a4",y=!0;var w,_,I=null;if(h.certsubj!==void 0?(w=!1,_=h.certsubj):(w=!0,_=h.certissuer),_.match(/^[0-9A-Fa-f]+$/)&&I==_,_.indexOf("-----BEGIN ")!=-1&&(I=tr(_)),I==null)throw new Error("certsubj/certissuer not cert");var N=new Me;N.hex=I;var F;w?F=N.getIssuerHex():F=N.getSubjectHex(),d=new p,d.hTLV=F}else if(h.uri!==void 0)b="86",d=new a({str:h.uri});else if(h.ip!==void 0){b="87";var O,q=h.ip;try{if(q.match(/^[0-9a-f]+$/)){var P=q.length;if(P==8||P==16||P==32||P==64)O=q;else throw"err"}else O=Ab(q)}catch(A){throw new u("malformed IP address: "+h.ip+":"+A.message)}d=new l({hex:O})}else throw new u("improper params");var D=new v({tag:b,explicit:y,obj:d});return D.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.x509.GeneralName,B.asn1.ASN1Object);B.asn1.x509.GeneralNames=function(e){B.asn1.x509.GeneralNames.superclass.constructor.call(this);var t=null,r=B,n=r.asn1;this.setByParamArray=function(i){for(var s=0;s<i.length;s++){var o=new n.x509.GeneralName(i[s]);this.asn1Array.push(o)}},this.tohex=function(){var i=new n.DERSequence({array:this.asn1Array});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,typeof e<"u"&&this.setByParamArray(e)};X(B.asn1.x509.GeneralNames,B.asn1.ASN1Object);B.asn1.x509.OtherName=function(e){B.asn1.x509.OtherName.superclass.constructor.call(this);var t=null,r=null,n=B,i=n.asn1,s=i.DERObjectIdentifier,o=i.DERSequence,a=i.ASN1Util.newObject;this.params=null,this.setByParam=function(f){this.params=f},this.tohex=function(){var f=this.params;if(f.oid==null||f.value==null)throw new Error("oid or value not specified");var l=new s({oid:f.oid}),v=a({tag:{tag:"a0",explicit:!0,obj:f.value}}),p=new o({array:[l,v]});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.x509.OtherName,B.asn1.ASN1Object);B.asn1.x509.OID=new function(){var e=B.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(t){if(typeof this.objCache[t]<"u")return this.objCache[t];if(typeof this.name2oidList[t]>"u")throw"Name of ObjectIdentifier not defined: "+t;var r=this.name2oidList[t],n=new e({oid:r});return this.objCache[t]=n,n},this.atype2obj=function(t){if(this.objCache[t]!==void 0)return this.objCache[t];var r;if(t.match(/^\d+\.\d+\.[0-9.]+$/))r=t;else if(this.atype2oidList[t]!==void 0)r=this.atype2oidList[t];else if(this.name2oidList[t]!==void 0)r=this.name2oidList[t];else throw new Error("AttributeType name undefined: "+t);var n=new e({oid:r});return this.objCache[t]=n,n},this.registerOIDs=function(t){if(!!this.checkOIDs(t))for(var r in t)this.name2oidList[r]=t[r]},this.checkOIDs=function(t){try{var r=Object.keys(t);return r.length==0?!1:(r.map(function(n,i,s){var o=this[n];if(!o.match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")},t),!0)}catch{return!1}}};B.asn1.x509.OID.oid2name=function(e){var t=B.asn1.x509.OID.name2oidList;for(var r in t)if(t[r]==e)return r;return""};B.asn1.x509.OID.oid2atype=function(e){var t=B.asn1.x509.OID.atype2oidList;for(var r in t)if(t[r]==e)return r;return e};B.asn1.x509.OID.name2oid=function(e){if(e.match(/^[0-9.]+$/))return e;var t=B.asn1.x509.OID.name2oidList;return t[e]===void 0?"":t[e]};B.asn1.x509.X509Util={};B.asn1.x509.X509Util.newCertPEM=function(e){var t=B.asn1.x509,r=t.TBSCertificate,n=t.Certificate,i=new n(e);return i.getPEM()};(typeof B>"u"||!B)&&(B={});(typeof B.asn1>"u"||!B.asn1)&&(B.asn1={});(typeof B.asn1.cms>"u"||!B.asn1.cms)&&(B.asn1.cms={});B.asn1.cms.Attribute=function(e){var t=Error,r=B,n=r.asn1,i=n.DERSequence,s=n.DERSet,o=n.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(a){this.params=a},this.getValueArray=function(){throw new t("not yet implemented abstract")},this.tohex=function(){var a=new o({oid:this.typeOid}),f=new s({array:this.getValueArray()}),l=new i({array:[a,f]});return l.tohex()},this.getEncodedHex=function(){return this.tohex()}};X(B.asn1.cms.Attribute,B.asn1.ASN1Object);B.asn1.cms.ContentType=function(e){var t=B,r=t.asn1;r.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){var n=new r.DERObjectIdentifier(this.params.type);return[n]},e!=null&&this.setByParam(e)};X(B.asn1.cms.ContentType,B.asn1.cms.Attribute);B.asn1.cms.MessageDigest=function(e){var t=B,r=t.asn1,n=r.DEROctetString,i=r.cms;i.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){var s=new n(this.params);return[s]},e!=null&&this.setByParam(e)};X(B.asn1.cms.MessageDigest,B.asn1.cms.Attribute);B.asn1.cms.SigningTime=function(e){var t=B,r=t.asn1;r.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){var n=new r.x509.Time(this.params);return[n]},e!=null&&this.setByParam(e)};X(B.asn1.cms.SigningTime,B.asn1.cms.Attribute);B.asn1.cms.SigningCertificate=function(e){var t=Error,r=B,n=r.asn1,i=n.DERSequence,s=n.cms,o=s.ESSCertID,a=r.crypto;s.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new t("parameter 'array' not specified");for(var f=this.params.array,l=[],v=0;v<f.length;v++){var p=f[v];e.hasis==!1&&typeof p=="string"&&(p.indexOf("-----BEGIN")!=-1||Y.isASN1HEX(p))&&(p={cert:p}),p.hasis!=!1&&e.hasis==!1&&(p.hasis=!1),l.push(new o(p))}var u=new i({array:l}),h=new i({array:[u]});return[h]},e!=null&&this.setByParam(e)};X(B.asn1.cms.SigningCertificate,B.asn1.cms.Attribute);B.asn1.cms.ESSCertID=function(e){B.asn1.cms.ESSCertID.superclass.constructor.call(this);var t=Error,r=B,n=r.asn1,i=n.DEROctetString,s=n.DERSequence,o=n.cms.IssuerSerial;this.params=null,this.getCertHash=function(a,f){if(a.hash!=null)return a.hash;if(typeof a=="string"&&a.indexOf("-----BEGIN")==-1&&!Y.isASN1HEX(a))return a;var l;if(typeof a=="string")l=a;else if(a.cert!=null)l=a.cert;else throw new t("hash nor cert unspecified");var v;l.indexOf("-----BEGIN")!=-1?v=tr(l):v=l,typeof a=="string"&&(a.indexOf("-----BEGIN")!=-1?v=tr(a):Y.isASN1HEX(a)&&(v=a));var p;if(a.alg!=null)p=a.alg;else if(f!=null)p=f;else throw new t("hash alg unspecified");return r.crypto.Util.hashHex(v,p)},this.tohex=function(){var a=this.params,f=this.getCertHash(a,"sha1"),l=[];l.push(new i({hex:f})),(typeof a=="string"&&a.indexOf("-----BEGIN")!=-1||a.cert!=null&&a.hasis!=!1||a.issuer!=null&&a.serial!=null)&&l.push(new o(a));var v=new s({array:l});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cms.ESSCertID,B.asn1.ASN1Object);B.asn1.cms.SigningCertificateV2=function(e){var t=Error,r=B,n=r.asn1,i=n.DERSequence,s=n.x509,o=n.cms,a=o.ESSCertIDv2,f=r.crypto;o.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new t("parameter 'array' not specified");for(var l=this.params.array,v=[],p=0;p<l.length;p++){var u=l[p];(e.alg!=null||e.hasis==!1)&&typeof u=="string"&&(u.indexOf("-----BEGIN")!=-1||Y.isASN1HEX(u))&&(u={cert:u}),u.alg==null&&e.alg!=null&&(u.alg=e.alg),u.hasis!=!1&&e.hasis==!1&&(u.hasis=!1),v.push(new a(u))}var h=new i({array:v}),b=new i({array:[h]});return[b]},e!=null&&this.setByParam(e)};X(B.asn1.cms.SigningCertificateV2,B.asn1.cms.Attribute);B.asn1.cms.ESSCertIDv2=function(e){B.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var t=Error,r=B,n=r.asn1,i=n.DEROctetString,s=n.DERSequence,o=n.cms.IssuerSerial,a=n.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var f=this.params,l=this.getCertHash(f,"sha256"),v=[];f.alg!=null&&f.alg!="sha256"&&v.push(new a({name:f.alg})),v.push(new i({hex:l})),(typeof f=="string"&&f.indexOf("-----BEGIN")!=-1||f.cert!=null&&f.hasis!=!1||f.issuer!=null&&f.serial!=null)&&v.push(new o(f));var p=new s({array:v});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cms.ESSCertIDv2,B.asn1.cms.ESSCertID);B.asn1.cms.IssuerSerial=function(e){var t=Error,r=B,n=r.asn1,i=n.DERInteger,s=n.DERSequence,o=n.cms,a=n.x509,f=a.GeneralNames,l=Me;o.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(v){this.params=v},this.tohex=function(){var v=this.params,p,u;if(typeof v=="string"&&v.indexOf("-----BEGIN")!=-1||v.cert!=null){var h;v.cert!=null?h=v.cert:h=v;var b=new l;b.readCertPEM(h),p=b.getIssuer(),u={hex:b.getSerialNumberHex()}}else if(v.issuer!=null&&v.serial)p=v.issuer,u=v.serial;else throw new t("cert or issuer and serial parameter not specified");var d=new f([{dn:p}]),y=new i(u),w=new s({array:[d,y]});return w.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cms.IssuerSerial,B.asn1.ASN1Object);B.asn1.cms.SignerIdentifier=function(e){var t=B,r=t.asn1,n=r.DERInteger,i=r.DERSequence,s=r.cms,o=s.IssuerAndSerialNumber,a=s.SubjectKeyIdentifier,f=r.x509,l=f.X500Name,v=Me,p=Error;s.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var u=this.params;if(u.type=="isssn"){var h=new o(u);return h.tohex()}else if(u.type=="skid"){var b=new a(u);return b.tohex()}else throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cms.SignerIdentifier,B.asn1.ASN1Object);B.asn1.cms.IssuerAndSerialNumber=function(e){var t=B,r=t.asn1,n=r.DERInteger,i=r.DERSequence,s=r.cms,o=r.x509,a=o.X500Name,f=Me,l=Error;s.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var v=this.params,p,u;if(typeof v=="string"&&v.indexOf("-----BEGIN")!=-1||v.cert!=null){var h;v.cert!=null?h=v.cert:h=v;var b=new f;b.readCertPEM(h),p=b.getIssuer(),u={hex:b.getSerialNumberHex()}}else if(v.issuer!=null&&v.serial)p=v.issuer,u=v.serial;else throw new l("cert or issuer and serial parameter not specified");var d=new a(p),y=new n(u),w=new i({array:[d,y]});return w.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(v){this.params=v},e!=null&&this.setByParam(e)};X(B.asn1.cms.IssuerAndSerialNumber,B.asn1.ASN1Object);B.asn1.cms.SubjectKeyIdentifier=function(e){var t=B,r=t.asn1,n=r.DERInteger,i=r.DERSequence,s=r.ASN1Util.newObject,o=r.cms,a=o.IssuerAndSerialName,f=o.SubjectKeyIdentifier,l=r.x509,v=l.X500Name,p=Me,u=Error;o.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var h=this.params;if(h.cert==null&&h.skid==null)throw new u("property cert nor skid undefined");var b;if(h.cert!=null){var d=new p(h.cert),y=d.getExtSubjectKeyIdentifier();b=y.kid.hex}else h.skid!=null&&(b=h.skid);var w=s({tag:{tage:"a0",obj:{octstr:{hex:b}}}});return w.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cms.SubjectKeyIdentifier,B.asn1.ASN1Object);B.asn1.cms.AttributeList=function(e){var t=Error,r=B,n=r.asn1,i=n.DERSet,s=n.cms;s.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(o){this.params=o},this.tohex=function(){var o=this.params;if(this.hTLV!=null)return this.hTLV;var a=!0;o.sortflag!=null&&(a=o.sortflag);for(var f=o.array,l=[],v=0;v<f.length;v++){var p=f[v],u=p.attr;if(u=="contentType")l.push(new s.ContentType(p));else if(u=="messageDigest")l.push(new s.MessageDigest(p));else if(u=="signingTime")l.push(new s.SigningTime(p));else if(u=="signingCertificate")l.push(new s.SigningCertificate(p));else if(u=="signingCertificateV2")l.push(new s.SigningCertificateV2(p));else if(u=="signaturePolicyIdentifier")l.push(new B.asn1.cades.SignaturePolicyIdentifier(p));else if(u=="signatureTimeStamp"||u=="timeStampToken")l.push(new B.asn1.cades.SignatureTimeStamp(p));else throw new t("unknown attr: "+u)}var h=new i({array:l,sortflag:a});return this.hTLV=h.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cms.AttributeList,B.asn1.ASN1Object);B.asn1.cms.SignerInfo=function(e){var t=Error,r=B,n=r.asn1,i=n.DERInteger,s=n.DEROctetString,o=n.DERSequence,a=n.DERTaggedObject,f=n.cms,l=f.SignerIdentifier,v=f.AttributeList,p=f.ContentType,u=f.EncapsulatedContentInfo,h=f.MessageDigest,b=f.SignedData,d=n.x509,y=d.AlgorithmIdentifier,w=r.crypto,_=ct;f.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var I=this.params,N=I.sigalg,F=new v(I.sattrs).tohex(),O=_.getKey(I.signkey),q=new w.Signature({alg:N});q.init(O),q.updateHex(F);var P=q.sign();I.sighex=P},this.tohex=function(){var I=this.params,N=[];if(N.push(new i({int:I.version})),N.push(new l(I.id)),N.push(new y({name:I.hashalg})),I.sattrs!=null){var F=new v(I.sattrs);try{N.push(new a({tag:"a0",explicit:!1,obj:F}))}catch(q){throw new t("si sattr error: "+q)}}if(I.sigalgfield!=null?N.push(new y({name:I.sigalgfield})):N.push(new y({name:I.sigalg})),I.sighex==null&&I.signkey!=null&&this.sign(),N.push(new s({hex:I.sighex})),I.uattrs!=null){var F=new v(I.uattrs);try{N.push(new a({tag:"a1",explicit:!1,obj:F}))}catch(P){throw new t("si uattr error: "+P)}}var O=new o({array:N});return O.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cms.SignerInfo,B.asn1.ASN1Object);B.asn1.cms.EncapsulatedContentInfo=function(e){var t=B,r=t.asn1,n=r.DERTaggedObject,i=r.DERSequence,s=r.DERObjectIdentifier,o=r.DEROctetString,a=r.cms;a.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var f=this.params,l=[];if(l.push(new s(f.type)),f.content!=null&&(f.content.hex!=null||f.content.str!=null)&&f.isDetached!=!0){var v=new o(f.content),p=new n({tag:"a0",explicit:!0,obj:v});l.push(p)}var u=new i({array:l});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(f){this.params=f},e!=null&&this.setByParam(e)};X(B.asn1.cms.EncapsulatedContentInfo,B.asn1.ASN1Object);B.asn1.cms.ContentInfo=function(e){var t=B,r=t.asn1,n=r.DERTaggedObject,i=r.DERSequence,s=r.DERObjectIdentifier,o=r.x509,a=o.OID.name2obj;B.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var f=this.params,l=[];l.push(new s(f.type));var v=new n({tag:"a0",explicit:!0,obj:f.obj});l.push(v);var p=new i({array:l});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(f){this.params=f},e!=null&&this.setByParam(e)};X(B.asn1.cms.ContentInfo,B.asn1.ASN1Object);B.asn1.cms.SignedData=function(e){var t=Error,r=B,n=r.asn1,i=n.ASN1Object,s=n.DERInteger,o=n.DERSet,a=n.DERSequence,f=n.DERTaggedObject,l=n.cms,v=l.EncapsulatedContentInfo,p=l.SignerInfo,u=l.ContentInfo,h=l.CertificateSet,b=l.RevocationInfoChoices,d=n.x509,y=d.AlgorithmIdentifier;B.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var w=this.params;this._setDigestAlgs(w),this._setContentTypeByEContent(w),this._setMessageDigestByEContent(w),this._setSignerInfoVersion(w),this._setSignedDataVersion(w)},this._setDigestAlgs=function(w){for(var _={},I=w.sinfos,N=0;N<I.length;N++){var F=I[N];_[F.hashalg]=1}w.hashalgs=Object.keys(_).sort()},this._setContentTypeByEContent=function(w){for(var _=w.econtent.type,I=w.sinfos,N=0;N<I.length;N++){var F=I[N],O=this._getAttrParamByName(F,"contentType");O.type=_}},this._setMessageDigestByEContent=function(w){var _=w.econtent,I=w.econtent.type,N=_.content.hex;N==null&&_.type=="data"&&_.content.str!=null&&(N=ui(_.content.str));for(var F=w.sinfos,O=0;O<F.length;O++){var q=F[O],P=q.hashalg,D=this._getAttrParamByName(q,"messageDigest"),A=B.crypto.Util.hashHex(N,P);D.hex=A}},this._getAttrParamByName=function(w,_){for(var I=w.sattrs.array,N=0;N<I.length;N++)if(I[N].attr==_)return I[N]},this._setSignerInfoVersion=function(w){for(var _=w.sinfos,I=0;I<_.length;I++){var N=_[I],F=1;N.id.type=="skid"&&(F=3),N.version=F}},this._setSignedDataVersion=function(w){var _=this._getSignedDataVersion(w);w.version=_},this._getSignedDataVersion=function(w){if(w.revinfos!=null)for(var _=w.revinfos,I=0;I<_.length;I++){var N=_[I];if(N.ocsp!=null)return 5}for(var F=w.sinfos,I=0;I<F.length;I++){var O=w.sinfos[I];if(O.version==3)return 3}return w.econtent.type!="data"?3:1},this.tohex=function(){var w=this.params;this.getEncodedHexPrepare!=null&&this.getEncodedHexPrepare(),w.fixed!=!0&&this.checkAndFixParam();var _=[];_.push(new s({int:w.version}));for(var I=[],N=0;N<w.hashalgs.length;N++){var F=w.hashalgs[N];I.push(new y({name:F}))}_.push(new o({array:I})),_.push(new v(w.econtent)),w.certs!=null&&_.push(new h(w.certs)),w.revinfos!=null&&_.push(new b(w.revinfos));for(var O=[],N=0;N<w.sinfos.length;N++){var q=w.sinfos[N];O.push(new p(q))}_.push(new o({array:O}));var P=new a({array:_});return P.tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){var w=new u({type:"signed-data",obj:this});return w},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cms.SignedData,B.asn1.ASN1Object);B.asn1.cms.CertificateSet=function(e){B.asn1.cms.CertificateSet.superclass.constructor.call(this);var t=Error,r=B.asn1,n=r.DERTaggedObject,i=r.DERSet,s=r.ASN1Object;this.params=null,this.tohex=function(){var o=this.params,a=[],f;if(o instanceof Array)f=o;else if(o.array!=null)f=o.array;else throw new t("cert array not specified");for(var l=0;l<f.length;l++){var v=f[l],p=tr(v),u=new s;u.hTLV=p,a.push(u)}var h={array:a};o.sortflag==!1&&(h.sortflag=!1);var b=new i(h),d=new n({tag:"a0",explicit:!1,obj:b});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cms.CertificateSet,B.asn1.ASN1Object);B.asn1.cms.RevocationInfoChoices=function(e){B.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(!t instanceof Array)throw new Error("params is not array");for(var r=[],n=0;n<t.length;n++)r.push(new B.asn1.cms.RevocationInfoChoice(t[n]));var i=B.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:r}}});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cms.RevocationInfoChoices,B.asn1.ASN1Object);B.asn1.cms.RevocationInfoChoice=function(e){B.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(t.crl!=null&&typeof t.crl=="string"){var r=t.crl;return t.crl.indexOf("-----BEGIN")!=-1&&(r=tr(t.crl)),r}else if(t.ocsp!=null){var n=B.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new B.asn1.cms.OtherRevocationFormat(t)}});return n.tohex()}else throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cms.RevocationInfoChoice,B.asn1.ASN1Object);B.asn1.cms.OtherRevocationFormat=function(e){B.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var t=Error,r=B,n=r.asn1,i=n.ASN1Util.newObject,s=r.lang.String.isHex;this.params=null,this.tohex=function(){var o=this.params;if(o.ocsp==null)throw new t("property ocsp not specified");if(!s(o.ocsp)||!Y.isASN1HEX(o.ocsp))throw new t("ocsp value not ASN.1 hex string");var a=i({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:o.ocsp}}]});return a.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cms.OtherRevocationFormat,B.asn1.ASN1Object);B.asn1.cms.CMSUtil=new function(){};B.asn1.cms.CMSUtil.newSignedData=function(e){return new B.asn1.cms.SignedData(e)};B.asn1.cms.CMSUtil.verifySignedData=function(e){var t=B,r=t.asn1,n=r.cms,i=n.SignerInfo,s=n.SignedData,o=n.SigningTime,a=n.SigningCertificate,f=n.SigningCertificateV2,l=r.cades,v=l.SignaturePolicyIdentifier,p=t.lang.String.isHex,u=Y,h=u.getVbyList,b=u.getTLVbyList,d=u.getIdxbyList,y=u.getChildIdx,w=u.getTLV,_=u.oidname,I=t.crypto.Util.hashHex;e.cms===void 0&&p(e.cms);var N=e.cms,F=function(E,M){for(var T,R=3;R<6;R++)if(T=d(E,0,[1,0,R]),T!==void 0){var x=E.substr(T,2);x==="a0"&&(M.certsIdx=T),x==="a1"&&(M.revinfosIdx=T),x==="31"&&(M.signerinfosIdx=T)}},O=function(E,M){var T=M.signerinfosIdx;if(T!==void 0){var R=y(E,T);M.signerInfoIdxList=R;for(var x=0;x<R.length;x++){var C=R[x],K={idx:C};q(E,K),M.signerInfos.push(K)}}},q=function(E,M){var T=M.idx;M.signerid_issuer1=b(E,T,[1,0],"30"),M.signerid_serial1=h(E,T,[1,1],"02"),M.hashalg=_(h(E,T,[2,0],"06"));var R=d(E,T,[3],"a0");M.idxSignedAttrs=R,P(E,M,R);var x=y(E,T),C=x.length;if(C<6)throw"malformed SignerInfo";M.sigalg=_(h(E,T,[C-2,0],"06")),M.sigval=h(E,T,[C-1],"04")},P=function(E,M,T){var R=y(E,T);M.signedAttrIdxList=R;for(var x=0;x<R.length;x++){var C=R[x],K=h(E,C,[0],"06"),L;K==="2a864886f70d010905"?(L=Nt(h(E,C,[1,0])),M.saSigningTime=L):K==="2a864886f70d010904"&&(L=h(E,C,[1,0],"04"),M.saMessageDigest=L)}},D=function(E,M){if(h(E,0,[0],"06")!=="2a864886f70d010702")return M;M.cmsType="signedData",M.econtent=h(E,0,[1,0,2,1,0]),F(E,M),M.signerInfos=[],O(E,M)},A=function(E,M){for(var T=M.parse.signerInfos,R=T.length,x=!0,C=0;C<R;C++){var K=T[C];m(E,M,K,C),K.isValid||(x=!1)}M.isValid=x},c=function(E,M,T,R){var x=M.parse.certsIdx,C;if(M.certs===void 0){C=[],M.certkeys=[];for(var K=y(E,x),L=0;L<K.length;L++){var V=w(E,K[L]),z=new Me;z.readCertHex(V),C[L]=z,M.certkeys[L]=z.getPublicKey()}M.certs=C}else C=M.certs;M.cccc=C.length,M.cccci=K.length;for(var L=0;L<C.length;L++){var G=z.getIssuerHex(),$=z.getSerialNumberHex();T.signerid_issuer1===G&&T.signerid_serial1===$&&(T.certkey_idx=L)}},m=function(E,M,T,R){T.verifyDetail={};var x=T.verifyDetail,C=M.parse.econtent,K=T.hashalg,L=T.saMessageDigest;x.validMessageDigest=!1,I(C,K)===L&&(x.validMessageDigest=!0),c(E,M,T,R),x.validSignatureValue=!1;var V=T.sigalg,z="31"+w(E,T.idxSignedAttrs).substr(2);T.signedattrshex=z;var G=M.certs[T.certkey_idx].getPublicKey(),$=new B.crypto.Signature({alg:V});$.init(G),$.updateHex(z);var oe=$.verify(T.sigval);x.validSignatureValue_isValid=oe,oe===!0&&(x.validSignatureValue=!0),T.isValid=!1,x.validMessageDigest&&x.validSignatureValue&&(T.isValid=!0)},S=function(){},g={isValid:!1,parse:{}};return D(N,g.parse),A(N,g),g};B.asn1.cms.CMSParser=function(){var e=Error,t=Me,r=new t,n=Y,i=n.getV,s=n.getTLV,o=n.getIdxbyList,a=n.getTLVbyList,f=n.getTLVbyListEx,l=n.getVbyList,v=n.getVbyListEx,p=n.getChildIdx;this.getCMSSignedData=function(u){var h=a(u,0,[1,0]),b=this.getSignedData(h);return b},this.getSignedData=function(u){var h=p(u,0),b={},d=i(u,h[0]),y=parseInt(d,16);b.version=y;var w=s(u,h[1]);b.hashalgs=this.getHashAlgArray(w);var _=s(u,h[2]);b.econtent=this.getEContent(_);var I=f(u,0,["[0]"]);I!=null&&(b.certs=this.getCertificateSet(I));var N=f(u,0,["[1]"]);N!=null;var F=f(u,0,[3]);return b.sinfos=this.getSignerInfos(F),b},this.getHashAlgArray=function(u){for(var h=p(u,0),b=new t,d=[],y=0;y<h.length;y++){var w=s(u,h[y]),_=b.getAlgorithmIdentifierName(w);d.push(_)}return d},this.getEContent=function(u){var h={},b=l(u,0,[0]),d=l(u,0,[1,0]);return h.type=B.asn1.x509.OID.oid2name(Y.hextooidstr(b)),h.content={hex:d},h},this.getSignerInfos=function(u){for(var h=[],b=p(u,0),d=0;d<b.length;d++){var y=s(u,b[d]),w=this.getSignerInfo(y);h.push(w)}return h},this.getSignerInfo=function(u){var h={},b=p(u,0),d=n.getInt(u,b[0],-1);d!=-1&&(h.version=d);var y=s(u,b[1]),w=this.getIssuerAndSerialNumber(y);h.id=w;var _=s(u,b[2]),I=r.getAlgorithmIdentifierName(_);h.hashalg=I;var N=f(u,0,["[0]"]);if(N!=null){var F=this.getAttributeList(N);h.sattrs=F}var O=f(u,0,[3]),q=r.getAlgorithmIdentifierName(O);h.sigalg=q;var P=v(u,0,[4]);h.sighex=P;var D=f(u,0,["[1]"]);if(D!=null){var A=this.getAttributeList(D);h.uattrs=A}return h},this.getSignerIdentifier=function(u){if(u.substr(0,2)=="30")return this.getIssuerAndSerialNumber(u);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(u){var h={type:"isssn"},b=p(u,0),d=s(u,b[0]);h.issuer=r.getX500Name(d);var y=i(u,b[1]);return h.serial={hex:y},h},this.getAttributeList=function(u){for(var h=[],b=p(u,0),d=0;d<b.length;d++){var y=s(u,b[d]),w=this.getAttribute(y);h.push(w)}return{array:h}},this.getAttribute=function(u){var h={},b=p(u,0),d=n.getOID(u,b[0]),y=B.asn1.x509.OID.oid2name(d);h.attr=y;var w=s(u,b[1]),_=p(w,0);if(_.length==1)h.valhex=s(w,_[0]);else{for(var I=[],N=0;N<_.length;N++)I.push(s(w,_[N]));h.valhex=I}return y=="contentType"?this.setContentType(h):y=="messageDigest"?this.setMessageDigest(h):y=="signingTime"?this.setSigningTime(h):y=="signingCertificate"?this.setSigningCertificate(h):y=="signingCertificateV2"?this.setSigningCertificateV2(h):y=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(h),h},this.setContentType=function(u){var h=n.getOIDName(u.valhex,0,null);h!=null&&(u.type=h,delete u.valhex)},this.setSigningTime=function(u){var h=i(u.valhex,0),b=Nt(h);u.str=b,delete u.valhex},this.setMessageDigest=function(u){var h=i(u.valhex,0);u.hex=h,delete u.valhex},this.setSigningCertificate=function(u){var h=p(u.valhex,0);if(h.length>0){for(var b=s(u.valhex,h[0]),d=p(b,0),y=[],w=0;w<d.length;w++){var _=s(b,d[w]),I=this.getESSCertID(_);y.push(I)}u.array=y}if(h.length>1){var N=s(u.valhex,h[1]);u.polhex=N}delete u.valhex},this.setSignaturePolicyIdentifier=function(u){var h=p(u.valhex,0);if(h.length>0){var b=n.getOID(u.valhex,h[0]);u.oid=b}if(h.length>1){var d=new t,y=p(u.valhex,h[1]),w=s(u.valhex,y[0]),_=d.getAlgorithmIdentifierName(w);u.alg=_;var I=i(u.valhex,y[1]);u.hash=I}delete u.valhex},this.setSigningCertificateV2=function(u){var h=p(u.valhex,0);if(h.length>0){for(var b=s(u.valhex,h[0]),d=p(b,0),y=[],w=0;w<d.length;w++){var _=s(b,d[w]),I=this.getESSCertIDv2(_);y.push(I)}u.array=y}if(h.length>1){var N=s(u.valhex,h[1]);u.polhex=N}delete u.valhex},this.getESSCertID=function(u){var h={},b=p(u,0);if(b.length>0){var d=i(u,b[0]);h.hash=d}if(b.length>1){var y=s(u,b[1]),w=this.getIssuerSerial(y);w.serial!=null&&(h.serial=w.serial),w.issuer!=null&&(h.issuer=w.issuer)}return h},this.getESSCertIDv2=function(u){var h={},b=p(u,0);if(b.length<1||3<b.length)throw new e("wrong number of elements");var d=0;if(u.substr(b[0],2)=="30"){var y=s(u,b[0]);h.alg=r.getAlgorithmIdentifierName(y),d++}else h.alg="sha256";var w=i(u,b[d]);if(h.hash=w,b.length>d+1){var _=s(u,b[d+1]),I=this.getIssuerSerial(_);h.issuer=I.issuer,h.serial=I.serial}return h},this.getIssuerSerial=function(u){var h={},b=p(u,0),d=s(u,b[0]),y=r.getGeneralNames(d),w=y[0].dn;h.issuer=w;var _=i(u,b[1]);return h.serial={hex:_},h},this.getCertificateSet=function(u){for(var h=p(u,0),b=[],d=0;d<h.length;d++){var y=s(u,h[d]);if(y.substr(0,2)=="30"){var w=bn(y,"CERTIFICATE");b.push(w)}}return{array:b,sortflag:!1}}};(typeof B>"u"||!B)&&(B={});(typeof B.asn1>"u"||!B.asn1)&&(B.asn1={});(typeof B.asn1.tsp>"u"||!B.asn1.tsp)&&(B.asn1.tsp={});B.asn1.tsp.TimeStampToken=function(e){var t=B,r=t.asn1,n=r.tsp;n.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var i=new n.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=i.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.tsp.TimeStampToken,B.asn1.cms.SignedData);B.asn1.tsp.TSTInfo=function(e){var t=Error,r=B,n=r.asn1,i=n.DERSequence,s=n.DERInteger,o=n.DERBoolean,a=n.DERGeneralizedTime,f=n.DERObjectIdentifier,l=n.DERTaggedObject,v=n.tsp,p=v.MessageImprint,u=v.Accuracy,h=n.x509.X500Name,b=n.x509.GeneralName;if(v.TSTInfo.superclass.constructor.call(this),this.dVersion=new s({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var d=[this.dVersion];if(this.dPolicy==null)throw new Error("policy shall be specified.");if(d.push(this.dPolicy),this.dMessageImprint==null)throw new Error("messageImprint shall be specified.");if(d.push(this.dMessageImprint),this.dSerial==null)throw new Error("serialNumber shall be specified.");if(d.push(this.dSerial),this.dGenTime==null)throw new Error("genTime shall be specified.");d.push(this.dGenTime),this.dAccuracy!=null&&d.push(this.dAccuracy),this.dOrdering!=null&&d.push(this.dOrdering),this.dNonce!=null&&d.push(this.dNonce),this.dTsa!=null&&d.push(this.dTsa);var y=new i({array:d});return this.hTLV=y.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0){if(typeof e.policy=="string"){if(!e.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new f({oid:e.policy})}e.messageImprint!==void 0&&(this.dMessageImprint=new p(e.messageImprint)),e.serial!==void 0&&(this.dSerial=new s(e.serial)),e.genTime!==void 0&&(this.dGenTime=new a(e.genTime)),e.accuracy!==void 0&&(this.dAccuracy=new u(e.accuracy)),e.ordering!==void 0&&e.ordering==!0&&(this.dOrdering=new o),e.nonce!==void 0&&(this.dNonce=new s(e.nonce)),e.tsa!==void 0&&(this.dTsa=new l({tag:"a0",explicit:!0,obj:new b({dn:e.tsa})}))}};X(B.asn1.tsp.TSTInfo,B.asn1.ASN1Object);B.asn1.tsp.Accuracy=function(e){var t=B,r=t.asn1,n=r.ASN1Util.newObject;r.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var i=this.params,s=[];return i.seconds!=null&&typeof i.seconds=="number"&&s.push({int:i.seconds}),i.millis!=null&&typeof i.millis=="number"&&s.push({tag:{tagi:"80",obj:{int:i.millis}}}),i.micros!=null&&typeof i.micros=="number"&&s.push({tag:{tagi:"81",obj:{int:i.micros}}}),n({seq:s}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.tsp.Accuracy,B.asn1.ASN1Object);B.asn1.tsp.MessageImprint=function(e){var t=B,r=t.asn1,n=r.DERSequence,i=r.DEROctetString,s=r.x509,o=s.AlgorithmIdentifier;r.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,f=new o({name:a.alg}),l=new i({hex:a.hash}),v=new n({array:[f,l]});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.tsp.MessageImprint,B.asn1.ASN1Object);B.asn1.tsp.TimeStampReq=function(e){var t=B,r=t.asn1,n=r.DERSequence,i=r.DERInteger,s=r.DERBoolean,o=r.ASN1Object,a=r.DERObjectIdentifier,f=r.tsp,l=f.MessageImprint;f.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var v=this.params,p=[];p.push(new i({int:1})),v.messageImprint instanceof B.asn1.ASN1Object?p.push(v.messageImprint):p.push(new l(v.messageImprint)),v.policy!=null&&p.push(new a(v.policy)),v.nonce!=null&&p.push(new i(v.nonce)),v.certreq==!0&&p.push(new s);var u=new n({array:p});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.tsp.TimeStampReq,B.asn1.ASN1Object);B.asn1.tsp.TimeStampResp=function(e){var t=B,r=t.asn1,n=r.DERSequence,i=r.ASN1Object,s=r.tsp,o=s.PKIStatusInfo;s.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,f=[];if(a.econtent!=null||a.tst!=null)if(a.statusinfo!=null?f.push(new o(a.statusinfo)):f.push(new o("granted")),a.econtent!=null)f.push(new s.TimeStampToken(a).getContentInfo());else if(a.tst instanceof r.ASN1Object)f.push(a.tst);else throw new Error("improper member tst value");else if(a.statusinfo!=null)f.push(new o(a.statusinfo));else throw new Error("parameter for token nor statusinfo not specified");var l=new n({array:f});return l.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.tsp.TimeStampResp,B.asn1.ASN1Object);B.asn1.tsp.PKIStatusInfo=function(e){var t=Error,r=B,n=r.asn1,i=n.DERSequence,s=n.tsp,o=s.PKIStatus,a=s.PKIFreeText,f=s.PKIFailureInfo;s.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var l=this.params,v=[];if(typeof l=="string")v.push(new o(l));else{if(l.status==null)throw new t("property 'status' unspecified");v.push(new o(l.status)),l.statusstr!=null&&v.push(new a(l.statusstr)),l.failinfo!=null&&v.push(new f(l.failinfo))}var p=new i({array:v});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.tsp.PKIStatusInfo,B.asn1.ASN1Object);B.asn1.tsp.PKIStatus=function(e){var t=Error,r=B,n=r.asn1,i=n.DERInteger,s=n.tsp;s.PKIStatus.superclass.constructor.call(this);var o={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var a=this.params,f,l;if(typeof a=="string")try{l=o[a]}catch{throw new t("undefined name: "+a)}else if(typeof a=="number")l=a;else throw new t("unsupported params");return new i({int:l}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.tsp.PKIStatus,B.asn1.ASN1Object);B.asn1.tsp.PKIFreeText=function(e){var t=Error,r=B,n=r.asn1,i=n.DERSequence,s=n.DERUTF8String,o=n.tsp;o.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if(!a instanceof Array)throw new t("wrong params: not array");for(var f=[],l=0;l<a.length;l++)f.push(new s({str:a[l]}));var v=new i({array:f});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.tsp.PKIFreeText,B.asn1.ASN1Object);B.asn1.tsp.PKIFailureInfo=function(e){var t=Error,r=B,n=r.asn1,i=n.DERBitString,s=n.tsp,o=s.PKIFailureInfo,a={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};o.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var f=this.params,l=0;if(typeof f=="number"&&0<=f&&f<=25){l|=1<<f;for(var v=l.toString(2),p="",u=v.length-1;u>=0;u--)p+=v[u];return p}else{if(typeof f=="string"&&a[f]!=null)return Ol([f],a);if(typeof f=="object"&&f.length!=null)return Ol(f,a);throw new t("wrong params")}},this.tohex=function(){var f=this.params,l=this.getBinValue();return new i({bin:l}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.tsp.PKIFailureInfo,B.asn1.ASN1Object);B.asn1.tsp.AbstractTSAAdapter=function(e){this.getTSTHex=function(t,r){throw"not implemented yet"}};B.asn1.tsp.SimpleTSAAdapter=function(e){var t=B,r=t.asn1,n=r.tsp,i=t.crypto.Util.hashHex;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(s,o){var a=i(s,o);this.params.econtent.content.messageImprint={alg:o,hash:a},this.params.econtent.content.serial={int:this.serial++};var f=Math.floor(Math.random()*1e9);this.params.econtent.content.nonce={int:f};var l=new n.TimeStampToken(this.params);return l.getContentInfoEncodedHex()},e!==void 0&&(this.params=e)};X(B.asn1.tsp.SimpleTSAAdapter,B.asn1.tsp.AbstractTSAAdapter);B.asn1.tsp.FixedTSAAdapter=function(e){var t=B,r=t.asn1,n=r.tsp,i=t.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(s,o){var a=i(s,o);this.params.econtent.content.messageImprint={alg:o,hash:a};var f=new n.TimeStampToken(this.params);return f.getContentInfoEncodedHex()},e!==void 0&&(this.params=e)};X(B.asn1.tsp.FixedTSAAdapter,B.asn1.tsp.AbstractTSAAdapter);B.asn1.tsp.TSPUtil=new function(){};B.asn1.tsp.TSPUtil.newTimeStampToken=function(e){return new B.asn1.tsp.TimeStampToken(e)};B.asn1.tsp.TSPUtil.parseTimeStampReq=function(e){var t=new B.asn1.tsp.TSPParser;return t.getTimeStampReq(e)};B.asn1.tsp.TSPUtil.parseMessageImprint=function(e){var t=new B.asn1.tsp.TSPParser;return t.getMessageImprint(e)};B.asn1.tsp.TSPParser=function(){var e=Error,t=Me,r=new t,n=Y,i=n.getV,s=n.getTLV,o=n.getIdxbyList,a=n.getTLVbyListEx,f=n.getChildIdx,l=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],v={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(p){var u=f(p,0);if(u.length==1)return this.getPKIStatusInfo(s(p,u[0]));if(u.length>1){var h=this.getPKIStatusInfo(s(p,u[0])),b=s(p,u[1]),d=this.getToken(b);return d.statusinfo=h,d}},this.getToken=function(p){var u=new B.asn1.cms.CMSParser,h=u.getCMSSignedData(p);return this.setTSTInfo(h),h},this.setTSTInfo=function(p){var u=p.econtent;if(u.type=="tstinfo"){var h=u.content.hex,b=this.getTSTInfo(h);u.content=b}},this.getTSTInfo=function(p){var u={},h=f(p,0),b=i(p,h[1]);u.policy=Ul(b);var d=s(p,h[2]);u.messageImprint=this.getMessageImprint(d);var y=i(p,h[3]);u.serial={hex:y};var w=i(p,h[4]);u.genTime={str:Nt(w)};var _=0;if(h.length>5&&p.substr(h[5],2)=="30"){var I=s(p,h[5]);u.accuracy=this.getAccuracy(I),_++}if(h.length>5+_&&p.substr(h[5+_],2)=="01"){var N=i(p,h[5+_]);N=="ff"&&(u.ordering=!0),_++}if(h.length>5+_&&p.substr(h[5+_],2)=="02"){var F=i(p,h[5+_]);u.nonce={hex:F},_++}if(h.length>5+_&&p.substr(h[5+_],2)=="a0"){var O=s(p,h[5+_]);O="30"+O.substr(2),pGeneralNames=r.getGeneralNames(O);var q=pGeneralNames[0].dn;u.tsa=q,_++}if(h.length>5+_&&p.substr(h[5+_],2)=="a1"){var P=s(p,h[5+_]);P="30"+P.substr(2);var D=r.getExtParamArray(P);u.ext=D,_++}return u},this.getAccuracy=function(p){for(var u={},h=f(p,0),b=0;b<h.length;b++){var d=p.substr(h[b],2),y=i(p,h[b]),w=parseInt(y,16);d=="02"?u.seconds=w:d=="80"?u.millis=w:d=="81"&&(u.micros=w)}return u},this.getMessageImprint=function(p){if(p.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var u={},h=f(p,0),b=o(p,0,[0,0]),d=i(p,b),y=n.hextooidstr(d),w=B.asn1.x509.OID.oid2name(y);if(w=="")throw new Error("hashAlg name undefined: "+y);var _=w,I=o(p,0,[1]);return u.alg=_,u.hash=i(p,I),u},this.getPKIStatusInfo=function(p){var u={},h=f(p,0),b=0;try{var d=i(p,h[0]),y=parseInt(d,16);u.status=l[y]}catch{}if(h.length>1&&p.substr(h[1],2)=="30"){var w=s(p,h[1]);u.statusstr=this.getPKIFreeText(w),b++}if(h.length>b&&p.substr(h[1+b],2)=="03"){var _=s(p,h[1+b]);u.failinfo=this.getPKIFailureInfo(_)}return u},this.getPKIFreeText=function(p){for(var u=[],h=f(p,0),b=0;b<h.length;b++)u.push(n.getString(p,h[b]));return u},this.getPKIFailureInfo=function(p){var u=n.getInt(p,0);return v[u]!=null?v[u]:u},this.getTimeStampReq=function(p){var u={};u.certreq=!1;var h=f(p,0);if(h.length<2)throw new Error("TimeStampReq must have at least 2 items");var b=s(p,h[1]);u.messageImprint=B.asn1.tsp.TSPUtil.parseMessageImprint(b);for(var d=2;d<h.length;d++){var y=h[d],w=p.substr(y,2);if(w=="06"){var _=i(p,y);u.policy=n.hextooidstr(_)}w=="02"&&(u.nonce=i(p,y)),w=="01"&&(u.certreq=!0)}return u}};(typeof B>"u"||!B)&&(B={});(typeof B.asn1>"u"||!B.asn1)&&(B.asn1={});(typeof B.asn1.cades>"u"||!B.asn1.cades)&&(B.asn1.cades={});B.asn1.cades.SignaturePolicyIdentifier=function(e){var t=B,r=t.asn1,n=r.cades,i=n.SignaturePolicyId;n.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new i(this.params)]},this.setByParam=function(s){this.params=s},e!=null&&this.setByParam(e)};X(B.asn1.cades.SignaturePolicyIdentifier,B.asn1.cms.Attribute);B.asn1.cades.SignaturePolicyId=function(e){var t=B,r=t.asn1,n=r.DERSequence,i=r.DERObjectIdentifier,s=r.x509,o=s.AlgorithmIdentifier,a=r.cades,f=a.SignaturePolicyId,l=a.OtherHashAlgAndValue;f.superclass.constructor.call(this),this.params=null,this.tohex=function(){var v=this.params,p=[];p.push(new i(v.oid)),p.push(new l(v));var u=new n({array:p});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(v){this.params=v},e!=null&&this.setByParam(e)};X(B.asn1.cades.SignaturePolicyId,B.asn1.ASN1Object);B.asn1.cades.OtherHashAlgAndValue=function(e){var t=Error,r=B,n=r.asn1,i=n.DERSequence,s=n.DEROctetString,o=n.x509,a=o.AlgorithmIdentifier,f=n.cades,l=f.OtherHashAlgAndValue;l.superclass.constructor.call(this),this.params=null,this.tohex=function(){var v=this.params;if(v.alg==null)throw new t("property 'alg' not specified");if(v.hash==null&&v.cert==null)throw new t("property 'hash' nor 'cert' not specified");var p=null;if(v.hash!=null)p=v.hash;else if(v.cert!=null){if(typeof v.cert!="string")throw new t("cert not string");var u=v.cert;v.cert.indexOf("-----BEGIN")!=-1&&(u=tr(v.cert)),p=B.crypto.Util.hashHex(u,v.alg)}var h=[];h.push(new a({name:v.alg})),h.push(new s({hex:p}));var b=new i({array:h});return b.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cades.OtherHashAlgAndValue,B.asn1.ASN1Object);B.asn1.cades.OtherHashValue=function(e){B.asn1.cades.OtherHashValue.superclass.constructor.call(this);var t=Error,r=B,n=r.lang.String.isHex,i=r.asn1,s=i.DEROctetString,o=r.crypto.Util.hashHex;this.params=null,this.tohex=function(){var a=this.params;if(a.hash==null&&a.cert==null)throw new t("hash or cert not specified");var f=null;if(a.hash!=null)f=a.hash;else if(a.cert!=null){if(typeof a.cert!="string")throw new t("cert not string");var l=a.cert;a.cert.indexOf("-----BEGIN")!=-1&&(l=tr(a.cert)),f=B.crypto.Util.hashHex(l,"sha1")}return new s({hex:f}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cades.OtherHashValue,B.asn1.ASN1Object);B.asn1.cades.SignatureTimeStamp=function(e){var t=Error,r=B,n=r.lang.String.isHex,i=r.asn1,s=i.ASN1Object,o=i.x509,a=i.cades;a.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var f=this.params;if(f.tst!=null)if(n(f.tst)){var l=new s;return l.hTLV=f.tst,[l]}else{if(f.tst instanceof s)return[f.tst];throw new t("params.tst has wrong value")}else if(f.res!=null){var v=f.res;if(v instanceof s&&(v=v.tohex()),typeof v!="string"||!n(v))throw new t("params.res has wrong value");var p=Y.getTLVbyList(v,0,[1]),l=new s;return l.hTLV=f.tst,[l]}},e!=null&&this.setByParam(e)};X(B.asn1.cades.SignatureTimeStamp,B.asn1.cms.Attribute);B.asn1.cades.CompleteCertificateRefs=function(e){var t=Error,r=B,n=r.asn1,i=n.DERSequence,s=n.cades,o=s.OtherCertID,a=r.lang.String.isHex;s.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var f=this.params,l=[],v=0;v<f.array.length;v++){var p=f.array[v];if(typeof p=="string")if(p.indexOf("-----BEGIN")!=-1)p={cert:p};else if(a(p))p={hash:p};else throw new t("unsupported value: "+p);f.alg!=null&&p.alg==null&&(p.alg=f.alg),f.hasis!=null&&p.hasis==null&&(p.hasis=f.hasis);var u=new o(p);l.push(u)}var h=new i({array:l});return[h]},e!=null&&this.setByParam(e)};X(B.asn1.cades.CompleteCertificateRefs,B.asn1.cms.Attribute);B.asn1.cades.OtherCertID=function(e){var t=B,r=t.asn1,n=r.DERSequence,i=r.cms,s=i.IssuerSerial,o=r.cades,a=o.OtherHashValue,f=o.OtherHashAlgAndValue;o.OtherCertID.superclass.constructor.call(this),this.params=e,this.tohex=function(){var l=this.params;typeof l=="string"&&(l.indexOf("-----BEGIN")!=-1?l={cert:l}:_isHex(l)&&(l={hash:l}));var v=[],p=null;if(l.alg!=null?p=new f(l):p=new a(l),v.push(p),l.cert!=null&&l.hasis==!0||l.issuer!=null&&l.serial!=null){var u=new s(l);v.push(u)}var h=new n({array:v});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cades.OtherCertID,B.asn1.ASN1Object);B.asn1.cades.OtherHash=function(e){var t=Error,r=B,n=r.asn1,i=n.cms,s=n.cades,o=s.OtherHashAlgAndValue,a=s.OtherHashValue,f=r.crypto.Util.hashHex,l=r.lang.String.isHex;s.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var v=this.params;typeof v=="string"&&(v.indexOf("-----BEGIN")!=-1?v={cert:v}:l(v)&&(v={hash:v}));var p=null;return v.alg!=null?p=new o(v):p=new a(v),p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};X(B.asn1.cades.OtherHash,B.asn1.ASN1Object);B.asn1.cades.CAdESUtil=new function(){};B.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(e){var t=new B.asn1.cms.CMSParser,r=t.getCMSSignedData(e);return r};B.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(e,t,r){var n=Y,i=n.getChildIdx,s=n.getTLV,o=n.getV,a=B,f=a.asn1,l=f.ASN1Object,v=f.cms,p=v.AttributeList,u=v.SignerInfo,h={},b=i(e,t);if(b.length!=6)throw"not supported items for SignerInfo (!=6)";var d=b.shift();h.version=s(e,d);var y=b.shift();h.si=s(e,y);var w=b.shift();h.digalg=s(e,w);var _=b.shift();h.sattrs=s(e,_);var I=b.shift();h.sigalg=s(e,I);var N=b.shift();h.sig=s(e,N),h.sigval=o(e,N);var F=null;return h.obj=new u,F=new l,F.hTLV=h.version,h.obj.dCMSVersion=F,F=new l,F.hTLV=h.si,h.obj.dSignerIdentifier=F,F=new l,F.hTLV=h.digalg,h.obj.dDigestAlgorithm=F,F=new l,F.hTLV=h.sattrs,h.obj.dSignedAttrs=F,F=new l,F.hTLV=h.sigalg,h.obj.dSigAlg=F,F=new l,F.hTLV=h.sig,h.obj.dSig=F,h.obj.dUnsignedAttrs=new p,h};(typeof B.asn1.csr>"u"||!B.asn1.csr)&&(B.asn1.csr={});B.asn1.csr.CertificationRequest=function(e){var t=B,r=t.asn1,n=r.DERBitString,i=r.DERSequence,s=r.csr,o=r.x509,a=s.CertificationRequestInfo;s.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(f){this.params=f},this.sign=function(){var f=new a(this.params).tohex(),l=new B.crypto.Signature({alg:this.params.sigalg});l.init(this.params.sbjprvkey),l.updateHex(f);var v=l.sign();this.params.sighex=v},this.getPEM=function(){return bn(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var f=this.params,l=new B.asn1.csr.CertificationRequestInfo(this.params),v=new B.asn1.x509.AlgorithmIdentifier({name:f.sigalg});if(f.sighex==null&&f.sbjprvkey!=null&&this.sign(),f.sighex==null)throw new Error("sighex or sbjprvkey parameter not defined");var p=new n({hex:"00"+f.sighex}),u=new i({array:[l,v,p]});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.csr.CertificationRequest,B.asn1.ASN1Object);B.asn1.csr.CertificationRequestInfo=function(e){var t=B,r=t.asn1,n=r.DERBitString,i=r.DERSequence,s=r.DERInteger,o=r.DERUTF8String,a=r.DERTaggedObject,f=r.ASN1Util.newObject,l=r.csr,v=r.x509,p=v.X500Name,u=v.Extensions,h=v.SubjectPublicKeyInfo,b=l.AttributeList;l.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(y){y!=null&&(this.params=y)},this.tohex=function(){var y=this.params,w=[];if(w.push(new s({int:0})),w.push(new p(y.subject)),w.push(new h(ct.getKey(y.sbjpubkey))),y.attrs!=null){var _=d(y.attrs),I=f({tag:{tage:"a0",obj:_}});w.push(I)}else if(y.extreq!=null){var N=new u(y.extreq),I=f({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[N]}]}}});w.push(I)}else w.push(new a({tag:"a0",explicit:!1,obj:new o({str:""})}));var F=new i({array:w});return F.tohex()},this.getEncodedHex=function(){return this.tohex()};function d(y){for(var w=Error,_=B.asn1.x509.Extensions,I=[],N=0;N<y.length;N++){var F=y[N],O=F.attr;if(O=="extensionRequest"){var q=new _(F.ext),P={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[q]}]};I.push(P)}else if(O=="unstructuredName"){var P={seq:[{oid:"1.2.840.113549.1.9.2"},{set:F.names}]};I.push(P)}else if(O=="challengePassword"){var P={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:F.password}]}]};I.push(P)}else throw new w("unknown CSR attribute")}return{set:I}}e!=null&&this.setByParam(e)};X(B.asn1.csr.CertificationRequestInfo,B.asn1.ASN1Object);B.asn1.csr.AttributeList=function(e){function t(r){}};X(B.asn1.csr.AttributeList,B.asn1.ASN1Object);B.asn1.csr.CSRUtil=new function(){};B.asn1.csr.CSRUtil.newCSRPEM=function(e){var t=ct,r=B.asn1.csr,n=new r.CertificationRequest(e),i=n.getPEM();return i};B.asn1.csr.CSRUtil.getParam=function(e,t){var r=Y,n=r.getV,i=r.getIdxbyList,s=r.getTLVbyList,o=r.getTLVbyListEx,a=r.getVbyListEx,f=function(_){var I=i(_,0,[0,3,0,0],"06");return n(_,I)!="2a864886f70d01090e"?null:s(_,0,[0,3,0,1,0],"30")},l={};if(e.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var v=tr(e,"CERTIFICATE REQUEST");t&&(l.tbs=s(v,0,[0]));try{var p=o(v,0,[0,1]);if(p=="3000")l.subject={};else{var d=new Me;l.subject=d.getX500Name(p)}}catch{}var u=o(v,0,[0,2]),h=ct.getKey(u,null,"pkcs8pub");l.sbjpubkey=ct.getPEM(h,"PKCS8PUB");var b=f(v),d=new Me;b!=null&&(l.extreq=d.getExtParamArray(b));try{var y=o(v,0,[1],"30"),d=new Me;l.sigalg=d.getAlgorithmIdentifierName(y)}catch{}try{var w=a(v,0,[2]);l.sighex=w}catch{}return l};B.asn1.csr.CSRUtil.verifySignature=function(e){try{var t=null;if(typeof e=="string"&&e.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?t=B.asn1.csr.CSRUtil.getParam(e,!0):typeof e=="object"&&e.sbjpubkey!=null&&e.sigalg!=null&&e.sighex!=null&&e.tbs!=null&&(t=e),t==null)return!1;var r=new B.crypto.Signature({alg:t.sigalg});return r.init(t.sbjpubkey),r.updateHex(t.tbs),r.verify(t.sighex)}catch(n){return alert(n),!1}};(typeof B>"u"||!B)&&(B={});(typeof B.asn1>"u"||!B.asn1)&&(B.asn1={});(typeof B.asn1.ocsp>"u"||!B.asn1.ocsp)&&(B.asn1.ocsp={});B.asn1.ocsp.DEFAULT_HASH="sha1";B.asn1.ocsp.OCSPResponse=function(e){B.asn1.ocsp.OCSPResponse.superclass.constructor.call(this);var t=B.asn1.DEREnumerated,r=B.asn1.ASN1Util.newObject,n=B.asn1.ocsp.ResponseBytes,i=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var s=this.params.resstatus;return typeof s=="number"?s:typeof s!="string"?-1:i.indexOf(s)},this.setByParam=function(s){this.params=s},this.tohex=function(){var s=this.params,o=this._getStatusCode();if(o==-1)throw new Error("responseStatus not supported: "+s.resstatus);if(o!=0)return r({seq:[{enum:{int:o}}]}).tohex();var a=new n(s);return r({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:a}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.ocsp.OCSPResponse,B.asn1.ASN1Object);B.asn1.ocsp.ResponseBytes=function(e){B.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var t=B.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,i=t.DEROctetString,s=t.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(o){this.params=o},this.tohex=function(){var o=this.params;if(o.restype!="ocspBasic")throw new Error("not supported responseType: "+o.restype);var a=new s(o),f=[];f.push(new n({name:"ocspBasic"})),f.push(new i({hex:a.tohex()}));var l=new r({array:f});return l.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.ocsp.ResponseBytes,B.asn1.ASN1Object);B.asn1.ocsp.BasicOCSPResponse=function(e){B.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var t=Error,r=B.asn1,n=r.ASN1Object,i=r.DERSequence,s=r.DERGeneralizedTime,o=r.DERTaggedObject,a=r.DERBitString,f=r.x509.Extensions,l=r.x509.AlgorithmIdentifier,v=r.ocsp,p=v.ResponderID;_SingleResponseList=v.SingleResponseList,_ResponseData=v.ResponseData,this.params=null,this.setByParam=function(u){this.params=u},this.sign=function(){var u=this.params,h=u.tbsresp.tohex(),b=new B.crypto.Signature({alg:u.sigalg});b.init(u.reskey),b.updateHex(h),u.sighex=b.sign()},this.tohex=function(){var u=this.params;u.tbsresp==null&&(u.tbsresp=new _ResponseData(u)),u.sighex==null&&u.reskey!=null&&this.sign();var h=[];if(h.push(u.tbsresp),h.push(new l({name:u.sigalg})),h.push(new a({hex:"00"+u.sighex})),u.certs!=null&&u.certs.length!=null){for(var b=[],d=0;d<u.certs.length;d++){var y=u.certs[d],w=null;if(Y.isASN1HEX(y))w=y;else if(y.match(/-----BEGIN/))w=tr(y);else throw new t("certs["+d+"] not hex or PEM");b.push(new n({tlv:w}))}var _=new i({array:b});h.push(new o({tag:"a0",explicit:!0,obj:_}))}var I=new i({array:h});return I.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.ocsp.BasicOCSPResponse,B.asn1.ASN1Object);B.asn1.ocsp.ResponseData=function(e){B.asn1.ocsp.ResponseData.superclass.constructor.call(this);var t=Error,r=B.asn1,n=r.DERSequence,i=r.DERGeneralizedTime,s=r.DERTaggedObject,o=r.x509.Extensions,a=r.ocsp,f=a.ResponderID;_SingleResponseList=a.SingleResponseList,this.params=null,this.tohex=function(){var l=this.params;l.respid!=null&&new t("respid not specified"),l.prodat!=null&&new t("prodat not specified"),l.array!=null&&new t("array not specified");var v=[];if(v.push(new f(l.respid)),v.push(new i(l.prodat)),v.push(new _SingleResponseList(l.array)),l.ext!=null){var p=new o(l.ext);v.push(new s({tag:"a1",explicit:!0,obj:p}))}var u=new n({array:v});return u.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(l){this.params=l},e!==void 0&&this.setByParam(e)};X(B.asn1.ocsp.ResponseData,B.asn1.ASN1Object);B.asn1.ocsp.ResponderID=function(e){B.asn1.ocsp.ResponderID.superclass.constructor.call(this);var t=B,r=t.asn1,n=r.ASN1Util.newObject,i=r.x509.X500Name,s=t.lang.String.isHex,o=Error;this.params=null,this.tohex=function(){var a=this.params;if(a.key!=null){var f=null;if(typeof a.key=="string"){if(s(a.key)&&(f=a.key),a.key.match(/-----BEGIN CERTIFICATE/)){var l=new Me(a.key),v=l.getExtSubjectKeyIdentifier();v!=null&&(f=v.kid.hex)}}else if(a.key instanceof Me){var v=a.key.getExtSubjectKeyIdentifier();v!=null&&(f=v.kid.hex)}if(f==null)throw new o("wrong key member value");var p=n({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:f}}}});return p.tohex()}else if(a.name!=null){var u=null;if(typeof a.name=="string"&&a.name.match(/-----BEGIN CERTIFICATE/)){var l=new Me(a.name);u=l.getSubject()}else a.name instanceof Me?u=a.name.getSubject():typeof a.name=="object"&&(a.name.array!=null||a.name.str!=null)&&(u=a.name);if(u==null)throw new o("wrong name member value");var p=n({tag:{tag:"a1",explicit:!0,obj:new i(u)}});return p.tohex()}throw new o("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},e!==void 0&&this.setByParam(e)};X(B.asn1.ocsp.ResponderID,B.asn1.ASN1Object);B.asn1.ocsp.SingleResponseList=function(e){B.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var t=B.asn1,r=t.DERSequence,n=t.ocsp.SingleResponse;this.params=null,this.tohex=function(){var i=this.params;if(typeof i!="object"||i.length==null)throw new Error("params not specified properly");for(var s=[],o=0;o<i.length;o++)s.push(new n(i[o]));var a=new r({array:s});return a.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(i){this.params=i},e!==void 0&&this.setByParam(e)};X(B.asn1.ocsp.SingleResponseList,B.asn1.ASN1Object);B.asn1.ocsp.SingleResponse=function(e){var t=Error,r=B,n=r.asn1,i=n.DERSequence,s=n.DERGeneralizedTime,o=n.DERTaggedObject,a=n.ocsp,f=a.CertID,l=a.CertStatus,v=n.x509,p=v.Extensions;a.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var u=this.params,h=[];if(u.certid==null)throw new t("certid unspecified");if(u.status==null)throw new t("status unspecified");if(u.thisupdate==null)throw new t("thisupdate unspecified");if(h.push(new f(u.certid)),h.push(new l(u.status)),h.push(new s(u.thisupdate)),u.nextupdate!=null){var b=new s(u.nextupdate);h.push(new o({tag:"a0",explicit:!0,obj:b}))}if(u.ext!=null){var d=new p(u.ext);h.push(new o({tag:"a1",explicit:!0,obj:d}))}var y=new i({array:h});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(u){this.params=u},e!==void 0&&this.setByParam(e)};X(B.asn1.ocsp.SingleResponse,B.asn1.ASN1Object);B.asn1.ocsp.CertID=function(e){var t=B,r=t.asn1,n=r.DEROctetString,i=r.DERInteger,s=r.DERSequence,o=r.x509,a=o.AlgorithmIdentifier,f=r.ocsp,l=f.DEFAULT_HASH,v=t.crypto,p=v.Util.hashHex,u=Me,h=Y,b=h.getVbyList;f.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(d,y,w,_){_==null&&(_=this.DEFAULT_HASH),this.params={alg:_,issname:d,isskey:y,sbjsn:w}},this.setByCert=function(d,y,w){w==null&&(w=this.DEFAULT_HASH),this.params={alg:w,issuerCert:d,subjectCert:y}},this.getParamByCerts=function(d,y,w){w==null&&(w=this.DEFAULT_HASH);var _=new u(d),I=new u(y),N=p(_.getSubjectHex(),w),F=_.getPublicKeyHex(),O=p(b(F,0,[1],"03",!0),w),q=I.getSerialNumberHex(),P={alg:w,issname:N,isskey:O,sbjsn:q};return P},this.tohex=function(){if(typeof this.params!="object")throw new Error("params not set");var d=this.params,y,w,_,I;if(d.alg==null?I=this.DEFAULT_HASH:I=d.alg,d.issuerCert!=null&&d.subjectCert!=null){var N=this.getParamByCerts(d.issuerCert,d.subjectCert,I);y=N.issname,w=N.isskey,_=N.sbjsn}else if(d.issname!=null&&d.isskey!=null&&d.sbjsn!=null)y=d.issname,w=d.isskey,_=d.sbjsn;else throw new Error("required param members not defined");var F=new a({name:I}),O=new n({hex:y}),q=new n({hex:w}),P=new i({hex:_}),D=new s({array:[F,O,q,P]});return this.hTLV=D.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};X(B.asn1.ocsp.CertID,B.asn1.ASN1Object);B.asn1.ocsp.CertStatus=function(e){B.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(t.status=="good")return"8000";if(t.status=="unknown")return"8200";if(t.status=="revoked"){var r=[{gentime:{str:t.time}}];t.reason!=null&&r.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:t.reason}}}});var n={tag:"a1",explicit:!1,obj:{seq:r}};return B.asn1.ASN1Util.newObject({tag:n}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(t){this.params=t},e!==void 0&&this.setByParam(e)};X(B.asn1.ocsp.CertStatus,B.asn1.ASN1Object);B.asn1.ocsp.Request=function(e){var t=B,r=t.asn1,n=r.DERSequence,i=r.ocsp;if(i.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var o=[];if(this.dReqCert===null)throw"reqCert not set";o.push(this.dReqCert);var a=new n({array:o});return this.hTLV=a.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},typeof e<"u"){var s=new i.CertID(e);this.dReqCert=s}};X(B.asn1.ocsp.Request,B.asn1.ASN1Object);B.asn1.ocsp.TBSRequest=function(e){var t=B,r=t.asn1,n=r.DERSequence,i=r.ocsp;i.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(s){for(var o=[],a=0;a<s.length;a++){var f=new i.Request(s[0]);o.push(f)}this.dRequestList=o},this.tohex=function(){var s=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var o=new n({array:this.dRequestList});if(s.push(o),this.dRequestExt!==null)throw"requestExtensions not supported";var a=new n({array:s});return this.hTLV=a.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&e.reqList!==void 0&&this.setRequestListByParam(e.reqList)};X(B.asn1.ocsp.TBSRequest,B.asn1.ASN1Object);B.asn1.ocsp.OCSPRequest=function(e){var t=B,r=t.asn1,n=r.DERSequence,i=r.ocsp;if(i.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var o=[];if(this.dTbsRequest!==null)o.push(this.dTbsRequest);else throw"tbsRequest not set";if(this.dOptionalSignature!==null)throw"optionalSignature not supported";var a=new n({array:o});return this.hTLV=a.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&e.reqList!==void 0){var s=new i.TBSRequest(e);this.dTbsRequest=s}};X(B.asn1.ocsp.OCSPRequest,B.asn1.ASN1Object);B.asn1.ocsp.OCSPUtil={};B.asn1.ocsp.OCSPUtil.getRequestHex=function(e,t,r){var n=B,i=n.asn1,s=i.ocsp;r===void 0&&(r=s.DEFAULT_HASH);var o={alg:r,issuerCert:e,subjectCert:t},a=new s.OCSPRequest({reqList:[o]});return a.tohex()};B.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(e){var t=Y,r=t.getVbyList,n=t.getVbyListEx,i=t.getIdxbyList,s=t.getIdxbyListEx,o=t.getV,a={};try{var f=n(e,0,[0],"0a");a.responseStatus=parseInt(f,16)}catch{}if(a.responseStatus!==0)return a;try{var l=i(e,0,[1,0,1,0,0,2,0,1]);e.substr(l,2)==="80"?a.certStatus="good":e.substr(l,2)==="a1"?(a.certStatus="revoked",a.revocationTime=Nt(r(e,l,[0]))):e.substr(l,2)==="82"&&(a.certStatus="unknown")}catch{}try{var v=i(e,0,[1,0,1,0,0,2,0,2]);a.thisUpdate=Nt(o(e,v))}catch{}try{var p=i(e,0,[1,0,1,0,0,2,0,3]);e.substr(p,2)==="a0"&&(a.nextUpdate=Nt(r(e,p,[0])))}catch{}return a};B.asn1.ocsp.OCSPParser=function(){var e=Error,t=Me,r=new t,n=Y,i=n.getV,s=n.getTLV,o=n.getIdxbyList,a=n.getVbyList,f=n.getTLVbyList,l=n.getVbyListEx,v=n.getTLVbyListEx,p=n.getChildIdx;this.getOCSPRequest=function(u){var h=p(u,0);if(h.length!=1&&h.length!=2)throw new e("wrong number elements: "+h.length);var b=this.getTBSRequest(s(u,h[0]));return b},this.getTBSRequest=function(u){var h={},b=v(u,0,[0],"30");h.array=this.getRequestList(b);var d=v(u,0,["[2]",0],"30");return d!=null&&(h.ext=r.getExtParamArray(d)),h},this.getRequestList=function(u){for(var h=[],b=p(u,0),d=0;d<b.length;d++){var u=s(u,b[d]);h.push(this.getRequest(u))}return h},this.getRequest=function(u){var h=p(u,0);if(h.length!=1&&h.length!=2)throw new e("wrong number elements: "+h.length);var b=this.getCertID(s(u,h[0]));if(h.length==2){var d=o(u,0,[1,0]);b.ext=r.getExtParamArray(s(u,d))}return b},this.getCertID=function(u){var h=p(u,0);if(h.length!=4)throw new e("wrong number elements: "+h.length);var b=new t,d={};return d.alg=b.getAlgorithmIdentifierName(s(u,h[0])),d.issname=i(u,h[1]),d.isskey=i(u,h[2]),d.sbjsn=i(u,h[3]),d},this.getOCSPResponse=function(u){var h=p(u,0),b,d=i(u,h[0]),y=parseInt(d);if(h.length==1)return{resstatus:y};var w=f(u,0,[1,0]);return b=this.getResponseBytes(w),b.resstatus=y,b},this.getResponseBytes=function(u){var h=p(u,0),b,d=f(u,0,[1,0]);b=this.getBasicOCSPResponse(d);var y=i(u,h[0]);return b.restype=B.asn1.x509.OID.oid2name(Ul(y)),b},this.getBasicOCSPResponse=function(u){var h=p(u,0),b;b=this.getResponseData(s(u,h[0]));var d=new Me;b.alg=d.getAlgorithmIdentifierName(s(u,h[1]));var y=i(u,h[2]);b.sighex=y.substr(2);var w=l(u,0,["[0]"]);if(w!=null){for(var _=p(w,0),I=[],N=0;N<_.length;N++){var F=s(w,_[N]);I.push(F)}b.certs=I}return b},this.getResponseData=function(u){var h=p(u,0),b=h.length,d={},y=0;u.substr(h[0],2)=="a0"&&y++,d.respid=this.getResponderID(s(u,h[y++]));var w=i(u,h[y++]);if(d.prodat=Nt(w),d.array=this.getSingleResponseList(s(u,h[y++])),u.substr(h[b-1],2)=="a1"){var _=f(u,h[b-1],[0]),I=new Me;d.ext=I.getExtParamArray(_)}return d},this.getResponderID=function(u){var h={};if(u.substr(0,2)=="a2"){var b=a(u,0,[0]);h.key=b}if(u.substr(0,2)=="a1"){var d=f(u,0,[0]),y=new Me;h.name=y.getX500Name(d)}return h},this.getSingleResponseList=function(u){for(var h=p(u,0),b=[],d=0;d<h.length;d++){var y=this.getSingleResponse(s(u,h[d]));b.push(y)}return b},this.getSingleResponse=function(u){var h=p(u,0),b={},d=this.getCertID(s(u,h[0]));b.certid=d;var y=this.getCertStatus(s(u,h[1]));if(b.status=y,u.substr(h[2],2)=="18"){var w=i(u,h[2]);b.thisupdate=Nt(w)}for(var _=3;_<h.length;_++){if(u.substr(h[_],2)=="a0"){var I=a(u,h[_],[0],"18");b.nextupdate=Nt(I)}if(u.substr(h[_],2)=="a1"){var N=new Me,F=f(u,0,[_,0]);b.ext=N.getExtParamArray(F)}}return b},this.getCertStatus=function(u){var h={};if(u=="8000")return{status:"good"};if(u=="8200")return{status:"unknown"};if(u.substr(0,2)=="a1"){h.status="revoked";var b=a(u,0,[0]),d=Nt(b);h.time=d}return h}};var B;(typeof B>"u"||!B)&&(B={});(typeof B.lang>"u"||!B.lang)&&(B.lang={});B.lang.String=function(){};function i9(e){for(var t=new Array,r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function s9(e){for(var t="",r=0;r<e.length;r++)t=t+String.fromCharCode(e[r]);return t}function ql(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);n.length==1&&(n="0"+n),t=t+n}return t}function Nn(e){return ql(i9(e))}function dL(e){return ks(Nn(e))}function hL(e){return Df(ks(Nn(e)))}function lL(e){return s9(J7(cu(e)))}function Df(e){return e=e.replace(/\=/g,""),e=e.replace(/\+/g,"-"),e=e.replace(/\//g,"_"),e}function cu(e){return e.length%4==2?e=e+"==":e.length%4==3&&(e=e+"="),e=e.replace(/-/g,"+"),e=e.replace(/_/g,"/"),e}function Mr(e){return e.length%2==1&&(e="0"+e),Df(ks(e))}function Wt(e){return Tf(cu(e))}var ou,ki;typeof j.Buffer=="function"?(ou=function(e){return Df(j.Buffer.from(e,"utf8").toString("base64"))},ki=function(e){return j.Buffer.from(cu(e),"base64").toString("utf8")}):(ou=function(e){return Mr(jl(Kl(e)))},ki=function(e){return decodeURIComponent(Ll(Wt(e)))});function pL(e){return ks(jl(Kl(e)))}function vL(e){return decodeURIComponent(Ll(Tf(e)))}function Hl(e){return jl(Kl(e)).toLowerCase()}function Nt(e){try{return decodeURIComponent(Ll(e))}catch{return null}}function bL(e){return Nt(gL(e))}function gL(e){for(var t=e.match(/.{1,2}/g),r=[],n=0;n<t.length;n++){var i=parseInt(t[n],16);161<=i&&i<=191?(r.push("c2"),r.push(t[n])):192<=i&&i<=255?(r.push("c3"),r.push((i-64).toString(16))):r.push(t[n])}return r.join("")}function yn(e){for(var t="",r=0;r<e.length-1;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t}function ui(e){for(var t="",r=0;r<e.length;r++)t+=("0"+e.charCodeAt(r).toString(16)).slice(-2);return t}function Eb(e){return ks(e)}function yL(e){return kl(Eb(e),64)}function kl(e,t){return e=e.replace(new RegExp("(.{"+t+"})","g"),`$1\r
`),e=e.replace(/\s+$/,""),e}function a9(e){var t=e.replace(/[^0-9A-Za-z\/+=]*/g,""),r=Tf(t);return r}function xL(e,t){return"-----BEGIN "+t+`-----\r
`+kl(e,64)+`\r
-----END `+t+`-----\r
`}function bn(e,t){return"-----BEGIN "+t+`-----\r
`+kl(Eb(e),64)+`\r
-----END `+t+`-----\r
`}function tr(e,t){if(e.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");return t!==void 0?(e=e.replace(new RegExp("^[^]*-----BEGIN "+t+"-----"),""),e=e.replace(new RegExp("-----END "+t+"-----[^]*$"),"")):(e=e.replace(/^[^]*-----BEGIN [^-]+-----/,""),e=e.replace(/-----END [^-]+-----[^]*$/,"")),a9(e)}function mL(e){return e.indexOf("-----BEGIN ")==-1||e.indexOf("-----END ")==-1?null:(e=e.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,""),e=e.replace(/-----END [\s\S]+$/m,""),e=e.replace(/\s+/g,""),e.match(/^[0-9a-zA-Z+/=]+$/)?e:null)}function wL(e){if(e.length%2!=0)throw"input is not even length";if(e.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var t=new ArrayBuffer(e.length/2),r=new DataView(t),n=0;n<e.length/2;n++)r.setUint8(n,parseInt(e.substr(n*2,2),16));return t}function SL(e){for(var t="",r=new DataView(e),n=0;n<e.byteLength;n++)t+=("00"+r.getUint8(n).toString(16)).slice(-2);return t}function _b(e){var t,r,n,i,s,o,a,f,l,v,p,u;if(e=f9(e),u=e.match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/),u)return t=parseInt(u[1]),r=parseInt(u[2])-1,n=parseInt(u[3]),i=parseInt(u[4]),s=parseInt(u[5]),o=parseInt(u[6]),a=0,v=u[7],v!==""&&(p=(v.substr(1)+"00").substr(0,3),a=parseInt(p)),Date.UTC(t,r,n,i,s,o,a);throw new Error("unsupported zulu format: "+e)}function EL(e){var t=new Date(e),r=("0000"+t.getUTCFullYear()).slice(-4),n=("00"+(t.getUTCMonth()+1)).slice(-2),i=("00"+t.getUTCDate()).slice(-2),s=("00"+t.getUTCHours()).slice(-2),o=("00"+t.getUTCMinutes()).slice(-2),a=("00"+t.getUTCSeconds()).slice(-2),f=("000"+t.getUTCMilliseconds()).slice(-3);return f=f.replace(/0+$/,""),f=f!=""?"."+f:f,r+n+i+s+o+a+f+"Z"}function o9(e){return Math.round(_b(e)/1e3)}function _L(e){return new Date(_b(e))}function AL(e,t,r){var n,i=e.getUTCFullYear();if(t){if(i<1950||2049<i)throw"not proper year for UTCTime: "+i;n=(""+i).slice(-2)}else n=("000"+i).slice(-4);if(n+=("0"+(e.getUTCMonth()+1)).slice(-2),n+=("0"+e.getUTCDate()).slice(-2),n+=("0"+e.getUTCHours()).slice(-2),n+=("0"+e.getUTCMinutes()).slice(-2),n+=("0"+e.getUTCSeconds()).slice(-2),r){var s=e.getUTCMilliseconds();s!==0&&(s=("00"+s).slice(-3),s=s.replace(/0+$/g,""),n+="."+s)}return n+="Z",n}function f9(e){return e.match(/^[0-9]{12}Z$/)||e.match(/^[0-9]{12}[.][0-9]*Z$/)?e.match(/^[0-4]/)?"20"+e:"19"+e:e}function jl(e){return e.replace(/%/g,"")}function Ll(e){return e.replace(/(..)/g,"%$1")}function bb(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;e=e.toLowerCase();var r=e.split(":").length-1;if(r<2)throw t;var n=":".repeat(7-r+2);e=e.replace("::",n);var i=e.split(":");if(i.length!=8)throw t;for(var s=0;s<8;s++)i[s]=("0000"+i[s]).slice(-4);return i.join("")}function gb(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+e);e=e.toLowerCase();var t=e.match(/.{1,4}/g);t=t.map(function(i){return i.replace(/^0+/,"")}),t=t.map(function(i){return i==""?"0":i}),e=":"+t.join(":")+":";var r=e.match(/:(0:){2,}/g);if(r==null)return e.slice(1,-1);var n=r.sort().slice(-1)[0];return e=e.replace(n.substr(0,n.length-1),":"),e.substr(0,2)!="::"&&(e=e.substr(1)),e.substr(-2,2)!="::"&&(e=e.substr(0,e.length-1)),e}function Nl(e){var t=new Error("malformed hex value");if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(e.length==8){var r;try{return r=parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16),r}catch{throw t}}else if(e.length==16)try{return Nl(e.substr(0,8))+"/"+Z7(e.substr(8))}catch{throw t}else{if(e.length==32)return gb(e);if(e.length==64){try{return gb(e.substr(0,32))+"/"+Z7(e.substr(32))}catch{throw t}return}else return e}}function Z7(e){var t=new Error("malformed mask"),r;try{r=new W(e,16).toString(2)}catch{throw t}if(!r.match(/^1*0*$/))throw t;return r.replace(/0+$/,"").length}function Ab(e){var t=new Error("malformed IP address");if(e=e.toLowerCase(e),!e.match(/^[0-9a-f.:/]+$/))throw t;if(e.match(/^[0-9.]+$/)){var r=e.split(".");if(r.length!==4)throw t;var n="";try{for(var i=0;i<4;i++){var s=parseInt(r[i]);n+=("0"+s.toString(16)).slice(-2)}return n}catch{throw t}}else if(e.match(/^[0-9.]+\/[0-9]+$/)){var o=e.split("/");return Ab(o[0])+Y7(parseInt(o[1]),32)}else{if(e.match(/^[0-9a-f:]+$/)&&e.indexOf(":")!==-1)return bb(e);if(e.match(/^[0-9a-f:]+\/[0-9]+$/)&&e.indexOf(":")!==-1){var o=e.split("/");return bb(o[0])+Y7(parseInt(o[1]),128)}else throw t}}function Y7(e,t){if(t==32&&e==0)return"00000000";if(t==128&&e==0)return"00000000000000000000000000000000";var r=Array(e+1).join("1")+Array(t-e+1).join("0");return new W(r,2).toString(16)}function Bb(e){function t(i){var s=parseInt(i.substr(0,2),16),o=parseInt(i.substr(2),16);if(s==0&o<128)return String.fromCharCode(o);if(s<8){var a=192|(s&7)<<3|(o&192)>>6,f=128|o&63;return Nt(a.toString(16)+f.toString(16))}var a=224|(s&240)>>4,f=128|(s&15)<<2|(o&192)>>6,l=128|o&63;return Nt(a.toString(16)+f.toString(16)+l.toString(16))}var r=e.match(/.{4}/g),n=r.map(t);return n.join("")}function Kl(e){for(var t=encodeURIComponent(e),r="",n=0;n<t.length;n++)t[n]=="%"?(r=r+t.substr(n,3),n=n+2):r=r+"%"+Nn(t[n]);return r}function BL(e){return e=e.replace(/\r\n/mg,`
`),e}function PL(e){return e=e.replace(/\r\n/mg,`
`),e=e.replace(/\n/mg,`\r
`),e}B.lang.String.isInteger=function(e){return e.match(/^[0-9]+$/)?!0:!!e.match(/^-[0-9]+$/)};B.lang.String.isHex=function(e){return c9(e)};function c9(e){return!!(e.length%2==0&&(e.match(/^[0-9a-f]+$/)||e.match(/^[0-9A-F]+$/)))}B.lang.String.isBase64=function(e){return e=e.replace(/\s+/g,""),!!(e.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&e.length%4==0)};B.lang.String.isBase64URL=function(e){return e.match(/[+/=]/)?!1:(e=cu(e),B.lang.String.isBase64(e))};function Pb(e){return!!e.match(/^[0-9A-Za-z-_.]+$/)}B.lang.String.isIntegerArray=function(e){return e=e.replace(/\s+/g,""),!!e.match(/^\[[0-9,]+\]$/)};B.lang.String.isPrintable=function(e){return e.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null};B.lang.String.isIA5=function(e){return e.match(/^[\x20-\x21\x23-\x7f]*$/)!==null};B.lang.String.isMail=function(e){return e.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};function yb(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}function IL(e){e=e.replace(/^\s*\[\s*/,""),e=e.replace(/\s*\]\s*$/,""),e=e.replace(/\s*/g,"");try{var t=e.split(/,/).map(function(r,n,i){var s=parseInt(r);if(s<0||255<s)throw"integer not in range 0-255";var o=("00"+s.toString(16)).slice(-2);return o}).join("");return t}catch(r){throw"malformed integer array string: "+r}}var ML=function(e,t){var r=e.length;e.length>t.length&&(r=t.length);for(var n=0;n<r;n++)if(e.charCodeAt(n)!=t.charCodeAt(n))return n;return e.length!=t.length?r:-1};function u9(e){var t=function(a){var f=a.toString(16);return f.length==1&&(f="0"+f),f},r=function(a){var f="",l=parseInt(a,10),v=l.toString(2),p=7-v.length%7;p==7&&(p=0);for(var u="",h=0;h<p;h++)u+="0";v=u+v;for(var h=0;h<v.length-1;h+=7){var b=v.substr(h,7);h!=v.length-7&&(b="1"+b),f+=t(parseInt(b,2))}return f};try{if(!e.match(/^[0-9.]+$/))return null;var n="",i=e.split("."),s=parseInt(i[0],10)*40+parseInt(i[1],10);n+=t(s),i.splice(0,2);for(var o=0;o<i.length;o++)n+=r(i[o]);return n}catch{return null}}function Ul(e){if(!c9(e))return null;try{var t=[],r=e.substr(0,2),n=parseInt(r,16);t[0]=new String(Math.floor(n/40)),t[1]=new String(n%40);for(var i=e.substr(2),s=[],o=0;o<i.length/2;o++)s.push(parseInt(i.substr(o*2,2),16));for(var a=[],f="",o=0;o<s.length;o++)s[o]&128?f=f+Rl((s[o]&127).toString(2),7):(f=f+Rl((s[o]&127).toString(2),7),a.push(new String(parseInt(f,2))),f="");var l=t.join(".");return a.length>0&&(l=l+"."+a.join(".")),l}catch{return null}}function d9(e){var t=new W(String(e),10);return uu(t)}function uu(e){var t=e.toString(16);if(t.substr(0,1)!="-")return t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t),t;var r=t.substr(1),n=r.length;n%2==1?n+=1:t.match(/^[0-7]/)||(n+=2);for(var i="",s=0;s<n;s++)i+="f";var o=new W(i,16),a=o.xor(e).add(W.ONE);return t=a.toString(16).replace(/^-/,""),t}var Rl=function(e,t,r){return r==null&&(r="0"),e.length>=t?e:new Array(t-e.length+1).join(r)+e};function h9(e){if(e.length%2!=0||(e=e.toLowerCase(),e.match(/^[0-9a-f]+$/)==null))return-1;try{var t=e.substr(0,2);if(t=="00")return parseInt(e.substr(2),16);var r=parseInt(t,16);if(r>7)return-1;var n=e.substr(2),i=parseInt(n,16).toString(2);i=="0"&&(i="00000000"),i=i.slice(0,0-r);var s=parseInt(i,2);return s==NaN?-1:s}catch{return-1}}function l9(e){if(typeof e!="number"||e<0)return null;var t=Number(e).toString(2),r=8-t.length%8;r==8&&(r=0),t=t+Rl("",r,"0");var n=parseInt(t,2).toString(16);n.length%2==1&&(n="0"+n);var i="0"+r;return i+n}function p9(e){if(typeof e!="string"||e.length%2!=0||!e.match(/^[0-9a-f]+$/))return null;try{var t=parseInt(e.substr(0,2),16);if(t<0||7<t)return null;for(var r=e.substr(2),n="",i=0;i<r.length;i+=2){var s=r.substr(i,2),o=parseInt(s,16).toString(2);o=("0000000"+o).slice(-8),n+=o}return n.substr(0,n.length-t)}catch{return null}}function CL(e){if(typeof e!="string"||e.match(/^[01]+$/)==null)return null;try{var t=parseInt(e,2);return l9(t)}catch{return null}}function Ol(e,t){for(var r=0,n=0;n<e.length;n++)r|=1<<t[e[n]];for(var i=r.toString(2),s="",n=i.length-1;n>=0;n--)s+=i[n];return s}function Ot(e,n,r){if(typeof e=="object"){for(var n=String(n).split("."),i=0;i<n.length&&e;i++){var s=n[i];s.match(/^[0-9]+$/)&&(s=parseInt(s)),e=e[s]}return e||e===!1?e:r}}function X(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t)}(typeof B>"u"||!B)&&(B={});(typeof B.crypto>"u"||!B.crypto)&&(B.crypto={});B.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:ne.algo.MD5,sha1:ne.algo.SHA1,sha224:ne.algo.SHA224,sha256:ne.algo.SHA256,sha384:ne.algo.SHA384,sha512:ne.algo.SHA512,ripemd160:ne.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(typeof this.DIGESTINFOHEAD[t]>"u")throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,r){var n=this.getDigestInfoHex(e,t),i=r/4;if(n.length+22>i)throw"key is too short for SigAlg: keylen="+r+","+t;for(var s="0001",o="00"+n,a="",f=i-s.length-o.length,l=0;l<f;l+=2)a+="ff";var v=s+a+o;return v},this.hashString=function(e,t){var r=new B.crypto.MessageDigest({alg:t});return r.digestString(e)},this.hashHex=function(e,t){var r=new B.crypto.MessageDigest({alg:t});return r.digestHex(e)},this.sha1=function(e){return this.hashString(e,"sha1")},this.sha256=function(e){return this.hashString(e,"sha256")},this.sha256Hex=function(e){return this.hashHex(e,"sha256")},this.sha512=function(e){return this.hashString(e,"sha512")},this.sha512Hex=function(e){return this.hashHex(e,"sha512")},this.isKey=function(e){return e instanceof Pe||e instanceof B.crypto.DSA||e instanceof B.crypto.ECDSA}};B.crypto.Util.md5=function(e){var t=new B.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return t.digestString(e)};B.crypto.Util.ripemd160=function(e){var t=new B.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return t.digestString(e)};B.crypto.Util.SECURERANDOMGEN=new $a;B.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return B.crypto.Util.SECURERANDOMGEN.nextBytes(t),ql(t)};B.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new W(B.crypto.Util.getRandomHexOfNbytes(e),16)};B.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,r=(e-t)/8,n=new Array(r+1);return B.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<t&255^255)&n[0],ql(n)};B.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new W(B.crypto.Util.getRandomHexOfNbits(e),16)};B.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var r=B.crypto.Util.getRandomBigIntegerOfNbits(t);if(e.compareTo(r)!=-1)return r}};B.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var r=e.compareTo(t);if(r==1)throw"biMin is greater than biMax";if(r==0)return e;var n=t.subtract(e),i=B.crypto.Util.getRandomBigIntegerZeroToMax(n);return i.add(e)};B.crypto.MessageDigest=function(e){var t=null,r=null,n=null;this.setAlgAndProvider=function(i,s){if(i=B.crypto.MessageDigest.getCanonicalAlgName(i),i!==null&&s===void 0&&(s=B.crypto.Util.DEFAULTPROVIDER[i]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(i)!=-1&&s=="cryptojs"){try{this.md=B.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[i].create()}catch(o){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+o}this.updateString=function(o){this.md.update(o)},this.updateHex=function(o){var a=ne.enc.Hex.parse(o);this.md.update(a)},this.digest=function(){var o=this.md.finalize();return o.toString(ne.enc.Hex)},this.digestString=function(o){return this.updateString(o),this.digest()},this.digestHex=function(o){return this.updateHex(o),this.digest()}}if(":sha256:".indexOf(i)!=-1&&s=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(o){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+o}this.updateString=function(o){this.md.update(o)},this.updateHex=function(o){var a=sjcl.codec.hex.toBits(o);this.md.update(a)},this.digest=function(){var o=this.md.finalize();return sjcl.codec.hex.fromBits(o)},this.digestString=function(o){return this.updateString(o),this.digest()},this.digestHex=function(o){return this.updateHex(o),this.digest()}}},this.updateString=function(i){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(i){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(i){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(i){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},e!==void 0&&e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0&&(this.provName=B.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))};B.crypto.MessageDigest.getCanonicalAlgName=function(e){return typeof e=="string"&&(e=e.toLowerCase(),e=e.replace(/-/,"")),e};B.crypto.MessageDigest.getHashLength=function(e){var t=B.crypto.MessageDigest,r=t.getCanonicalAlgName(e);if(t.HASHLENGTH[r]===void 0)throw"not supported algorithm: "+e;return t.HASHLENGTH[r]};B.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};B.crypto.Mac=function(e){var t=null,r=null,n=null,i=null,s=null;this.setAlgAndProvider=function(o,a){if(o=o.toLowerCase(),o==null&&(o="hmacsha1"),o=o.toLowerCase(),o.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+o;a===void 0&&(a=B.crypto.Util.DEFAULTPROVIDER[o]),this.algProv=o+"/"+a;var f=o.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(f)!=-1&&a=="cryptojs"){try{var l=B.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[f];this.mac=ne.algo.HMAC.create(l,this.pass)}catch(v){throw"setAlgAndProvider hash alg set fail hashAlg="+f+"/"+v}this.updateString=function(v){this.mac.update(v)},this.updateHex=function(v){var p=ne.enc.Hex.parse(v);this.mac.update(p)},this.doFinal=function(){var v=this.mac.finalize();return v.toString(ne.enc.Hex)},this.doFinalString=function(v){return this.updateString(v),this.doFinal()},this.doFinalHex=function(v){return this.updateHex(v),this.doFinal()}}},this.updateString=function(o){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(o){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(o){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(o){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(o){if(typeof o=="string"){var a=o;(o.length%2==1||!o.match(/^[0-9A-Fa-f]+$/))&&(a=ui(o)),this.pass=ne.enc.Hex.parse(a);return}if(typeof o!="object")throw"KJUR.crypto.Mac unsupported password type: "+o;var a=null;if(o.hex!==void 0){if(o.hex.length%2!=0||!o.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+o.hex;a=o.hex}if(o.utf8!==void 0&&(a=Hl(o.utf8)),o.rstr!==void 0&&(a=ui(o.rstr)),o.b64!==void 0&&(a=Tf(o.b64)),o.b64u!==void 0&&(a=Wt(o.b64u)),a==null)throw"KJUR.crypto.Mac unsupported password type: "+o;this.pass=ne.enc.Hex.parse(a)},e!==void 0&&(e.pass!==void 0&&this.setPassword(e.pass),e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0&&(this.provName=B.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))};B.crypto.Signature=function(e){var t=null,r=null,n=null,i=null,s=null,o=null,a=null,f=null,l=null,v=null,p=-1,u=null,h=null,b=null,d=null,y=null;if(this._setAlgNames=function(){var w=this.algName.match(/^(.+)with(.+)$/);w&&(this.mdAlgName=w[1].toLowerCase(),this.pubkeyAlgName=w[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(w,_){for(var I="",N=_/4-w.length,F=0;F<N;F++)I=I+"0";return I+w},this.setAlgAndProvider=function(w,_){if(this._setAlgNames(),_!="cryptojs/jsrsa")throw new Error("provider not supported: "+_);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new B.crypto.MessageDigest({alg:this.mdAlgName})}catch(I){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+I)}this.init=function(I,N){var F=null;try{N===void 0?F=ct.getKey(I):F=ct.getKey(I,N)}catch(O){throw"init failed:"+O}if(F.isPrivate===!0)this.prvKey=F,this.state="SIGN";else if(F.isPublic===!0)this.pubKey=F,this.state="VERIFY";else throw"init failed.:"+F},this.updateString=function(I){this.md.updateString(I)},this.updateHex=function(I){this.md.updateHex(I)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&B.crypto.ECDSA!==void 0&&(this.prvKey=new B.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof Pe&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof Pe&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof B.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof B.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(I){return this.updateString(I),this.sign()},this.signHex=function(I){return this.updateHex(I),this.sign()},this.verify=function(I){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&B.crypto.ECDSA!==void 0&&(this.pubKey=new B.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof Pe&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,I,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof Pe&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,I);if(B.crypto.ECDSA!==void 0&&this.pubKey instanceof B.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,I);if(B.crypto.DSA!==void 0&&this.pubKey instanceof B.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,I);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(w,_){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(w){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(w){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(w){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(w){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(w){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,e!==void 0&&(e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0?this.provName=B.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),e.psssaltlen!==void 0&&(this.pssSaltLen=e.psssaltlen),e.prvkeypem!==void 0)){if(e.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{var t=ct.getKey(e.prvkeypem);this.init(t)}catch(w){throw"fatal error to load pem private key: "+w}}};B.crypto.Cipher=function(e){};B.crypto.Cipher.encrypt=function(e,t,r,n){if(Ot(n,"enclag")!=null&&(r=n.encalg),typeof r=="string"&&r.substr(-4)=="-CBC"){var i=t,s=e;Ot(n,"key")!=null&&(i=n.key),Ot(n,"enc")!=null&&(hEnc=n.enc);var o=ne.enc.Hex.parse(i),a=ne.enc.Hex.parse(s),f=ne.enc.Hex.parse(n.iv),l;if(r=="des-EDE3-CBC")l=ne.TripleDES.encrypt(a,o,{iv:f});else if(r=="aes128-CBC"||r=="aes256-CBC")l=ne.AES.encrypt(a,o,{iv:f});else throw new Error("unsupported algorithm: "+r);return l+""}else if(t instanceof Pe&&t.isPublic){var v=B.crypto.Cipher.getAlgByKeyAndName(t,r);if(v==="RSA")return t.encrypt(e);if(v==="RSAOAEP")return t.encryptOAEP(e,"sha1");var p=v.match(/^RSAOAEP(\d+)$/);if(p!==null)return t.encryptOAEP(e,"sha"+p[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+r}else throw"Cipher.encrypt: unsupported key or algorithm"};B.crypto.Cipher.decrypt=function(e,t,r,n){if(Ot(n,"enclag")!=null&&(r=n.encalg),typeof r=="string"&&r.substr(-4)=="-CBC"){var i=t,s=e;Ot(n,"key")!=null&&(i=n.key),Ot(n,"enc")!=null&&(s=n.enc);var o=ne.enc.Hex.parse(i),a=ne.enc.Hex.parse(s),f=ne.enc.Hex.parse(n.iv),l;if(r=="des-EDE3-CBC")l=ne.TripleDES.decrypt({ciphertext:a},o,{iv:f});else if(r=="aes128-CBC"||r=="aes256-CBC")l=ne.AES.decrypt({ciphertext:a},o,{iv:f});else throw new Error("unsupported algorithm: "+r);return ne.enc.Hex.stringify(l)}else if(t instanceof Pe&&t.isPrivate){var v=B.crypto.Cipher.getAlgByKeyAndName(t,r);if(v==="RSA")return t.decrypt(e);if(v==="RSAOAEP")return t.decryptOAEP(e,"sha1");var p=v.match(/^RSAOAEP(\d+)$/);if(p!==null)return t.decryptOAEP(e,"sha"+p[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+r}else throw"Cipher.decrypt: unsupported key or algorithm"};B.crypto.Cipher.getAlgByKeyAndName=function(e,t){if(e instanceof Pe){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(t)!=-1)return t;if(t==null)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+t}throw"getAlgByKeyAndName: not supported algorithm name: "+t};B.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};(typeof B>"u"||!B)&&(B={});(typeof B.crypto>"u"||!B.crypto)&&(B.crypto={});B.crypto.ECDSA=function(e){var t="secp256r1",r=null,n=null,i=null,s=Error,o=W,a=At,f=B.crypto.ECDSA,l=B.crypto.ECParameterDB,v=f.getName,p=Y,u=p.getVbyListEx,h=p.isASN1HEX,b=new $a,d=null;this.type="EC",this.isPrivate=!1,this.isPublic=!1;function y(w,_,I,N){for(var F=Math.max(_.bitLength(),N.bitLength()),O=w.add2D(I),q=w.curve.getInfinity(),P=F-1;P>=0;--P)q=q.twice2D(),q.z=o.ONE,_.testBit(P)?N.testBit(P)?q=q.add2D(O):q=q.add2D(w):N.testBit(P)&&(q=q.add2D(I));return q}this.getBigRandom=function(w){return new o(w.bitLength(),b).mod(w.subtract(o.ONE)).add(o.ONE)},this.setNamedCurve=function(w){this.ecparams=l.getByName(w),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=w},this.setPrivateKeyHex=function(w){this.isPrivate=!0,this.prvKeyHex=w},this.setPublicKeyHex=function(w){this.isPublic=!0,this.pubKeyHex=w},this.getPublicKeyXYHex=function(){var w=this.pubKeyHex;if(w.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var _=this.ecparams.keycharlen;if(w.length!==2+_*2)throw"malformed public key hex length";var I={};return I.x=w.substr(2,_),I.y=w.substr(2+_),I},this.getShortNISTPCurveName=function(){var w=this.curveName;return w==="secp256r1"||w==="NIST P-256"||w==="P-256"||w==="prime256v1"?"P-256":w==="secp384r1"||w==="NIST P-384"||w==="P-384"?"P-384":w==="secp521r1"||w==="NIST P-521"||w==="P-521"?"P-521":null},this.generateKeyPairHex=function(){var w=this.ecparams.n,_=this.getBigRandom(w),I=this.ecparams.keycharlen,N=("0000000000"+_.toString(16)).slice(-I);this.setPrivateKeyHex(N);var F=this.generatePublicKeyHex();return{ecprvhex:N,ecpubhex:F}},this.generatePublicKeyHex=function(){var w=new o(this.prvKeyHex,16),_=this.ecparams.G.multiply(w),I=_.getX().toBigInteger(),N=_.getY().toBigInteger(),F=this.ecparams.keycharlen,O=("0000000000"+I.toString(16)).slice(-F),q=("0000000000"+N.toString(16)).slice(-F),P="04"+O+q;return this.setPublicKeyHex(P),P},this.signWithMessageHash=function(w){return this.signHex(w,this.prvKeyHex)},this.signHex=function(w,_){var I=new o(_,16),N=this.ecparams.n,F=new o(w.substring(0,this.ecparams.keycharlen),16);do var O=this.getBigRandom(N),q=this.ecparams.G,P=q.multiply(O),D=P.getX().toBigInteger().mod(N);while(D.compareTo(o.ZERO)<=0);var A=O.modInverse(N).multiply(F.add(I.multiply(D))).mod(N);return f.biRSSigToASN1Sig(D,A)},this.sign=function(w,_){var I=_,N=this.ecparams.n,F=o.fromByteArrayUnsigned(w);do var O=this.getBigRandom(N),q=this.ecparams.G,P=q.multiply(O),D=P.getX().toBigInteger().mod(N);while(D.compareTo(W.ZERO)<=0);var A=O.modInverse(N).multiply(F.add(I.multiply(D))).mod(N);return this.serializeSig(D,A)},this.verifyWithMessageHash=function(w,_){return this.verifyHex(w,_,this.pubKeyHex)},this.verifyHex=function(w,_,I){try{var N,F,O=f.parseSigHex(_);N=O.r,F=O.s;var q=a.decodeFromHex(this.ecparams.curve,I),P=new o(w.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(P,N,F,q)}catch{return!1}},this.verify=function(w,_,I){var N,F;if(Bitcoin.Util.isArray(_)){var O=this.parseSig(_);N=O.r,F=O.s}else if(typeof _=="object"&&_.r&&_.s)N=_.r,F=_.s;else throw"Invalid value for signature";var q;if(I instanceof At)q=I;else if(Bitcoin.Util.isArray(I))q=a.decodeFrom(this.ecparams.curve,I);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var P=o.fromByteArrayUnsigned(w);return this.verifyRaw(P,N,F,q)},this.verifyRaw=function(w,_,I,N){var F=this.ecparams.n,O=this.ecparams.G;if(_.compareTo(o.ONE)<0||_.compareTo(F)>=0||I.compareTo(o.ONE)<0||I.compareTo(F)>=0)return!1;var q=I.modInverse(F),P=w.multiply(q).mod(F),D=_.multiply(q).mod(F),A=O.multiply(P).add(N.multiply(D)),c=A.getX().toBigInteger().mod(F);return c.equals(_)},this.serializeSig=function(w,_){var I=w.toByteArraySigned(),N=_.toByteArraySigned(),F=[];return F.push(2),F.push(I.length),F=F.concat(I),F.push(2),F.push(N.length),F=F.concat(N),F.unshift(F.length),F.unshift(48),F},this.parseSig=function(w){var _;if(w[0]!=48)throw new Error("Signature not a valid DERSequence");if(_=2,w[_]!=2)throw new Error("First element in signature must be a DERInteger");var I=w.slice(_+2,_+2+w[_+1]);if(_+=2+w[_+1],w[_]!=2)throw new Error("Second element in signature must be a DERInteger");var N=w.slice(_+2,_+2+w[_+1]);_+=2+w[_+1];var F=o.fromByteArrayUnsigned(I),O=o.fromByteArrayUnsigned(N);return{r:F,s:O}},this.parseSigCompact=function(w){if(w.length!==65)throw"Signature has the wrong length";var _=w[0]-27;if(_<0||_>7)throw"Invalid signature type";var I=this.ecparams.n,N=o.fromByteArrayUnsigned(w.slice(1,33)).mod(I),F=o.fromByteArrayUnsigned(w.slice(33,65)).mod(I);return{r:N,s:F,i:_}},this.readPKCS5PrvKeyHex=function(w){if(h(w)===!1)throw new Error("not ASN.1 hex string");var _,I,N;try{_=u(w,0,["[0]",0],"06"),I=u(w,0,[1],"04");try{N=u(w,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=v(_),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(N),this.setPrivateKeyHex(I),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(w){if(h(w)===!1)throw new s("not ASN.1 hex string");var _,I,N,F;try{_=u(w,0,[1,0],"06"),I=u(w,0,[1,1],"06"),N=u(w,0,[2,0,1],"04");try{F=u(w,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new s("malformed PKCS#8 plain ECC private key")}if(this.curveName=v(I),this.curveName===void 0)throw new s("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(F),this.setPrivateKeyHex(N),this.isPublic=!1},this.readPKCS8PubKeyHex=function(w){if(h(w)===!1)throw new s("not ASN.1 hex string");var _,I,N;try{_=u(w,0,[0,0],"06"),I=u(w,0,[0,1],"06"),N=u(w,0,[1],"03")}catch{throw new s("malformed PKCS#8 ECC public key")}if(this.curveName=v(I),this.curveName===null)throw new s("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(N)},this.readCertPubKeyHex=function(w,_){if(h(w)===!1)throw new s("not ASN.1 hex string");var I,N;try{I=u(w,0,[0,5,0,1],"06"),N=u(w,0,[0,5,1],"03")}catch{throw new s("malformed X.509 certificate ECC public key")}if(this.curveName=v(I),this.curveName===null)throw new s("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(N)},e!==void 0&&e.curve!==void 0&&(this.curveName=e.curve),this.curveName===void 0&&(this.curveName=t),this.setNamedCurve(this.curveName),e!==void 0&&(e.prv!==void 0&&this.setPrivateKeyHex(e.prv),e.pub!==void 0&&this.setPublicKeyHex(e.pub))};B.crypto.ECDSA.parseSigHex=function(e){var t=B.crypto.ECDSA.parseSigHexInHexRS(e),r=new W(t.r,16),n=new W(t.s,16);return{r,s:n}};B.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=Y,r=t.getChildIdx,n=t.getV;if(t.checkStrictDER(e,0),e.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var i=r(e,0);if(i.length!=2)throw new Error("signature shall have two elements");var s=i[0],o=i[1];if(e.substr(s,2)!="02")throw new Error("1st item not ASN.1 integer");if(e.substr(o,2)!="02")throw new Error("2nd item not ASN.1 integer");var a=n(e,s),f=n(e,o);return{r:a,s:f}};B.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=B.crypto.ECDSA.parseSigHexInHexRS(e),r=t.r,n=t.s;if(r.length>=130&&r.length<=134){if(r.length%2!=0)throw Error("unknown ECDSA sig r length error");if(n.length%2!=0)throw Error("unknown ECDSA sig s length error");r.substr(0,2)=="00"&&(r=r.substr(2)),n.substr(0,2)=="00"&&(n=n.substr(2));var i=Math.max(r.length,n.length);return r=("000000"+r).slice(-i),n=("000000"+n).slice(-i),r+n}if(r.substr(0,2)=="00"&&r.length%32==2&&(r=r.substr(2)),n.substr(0,2)=="00"&&n.length%32==2&&(n=n.substr(2)),r.length%32==30&&(r="00"+r),n.length%32==30&&(n="00"+n),r.length%32!=0)throw Error("unknown ECDSA sig r length error");if(n.length%32!=0)throw Error("unknown ECDSA sig s length error");return r+n};B.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var t=e.substr(0,e.length/2),r=e.substr(e.length/2);return B.crypto.ECDSA.hexRSSigToASN1Sig(t,r)};B.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var r=new W(e,16),n=new W(t,16);return B.crypto.ECDSA.biRSSigToASN1Sig(r,n)};B.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var r=B.asn1,n=new r.DERInteger({bigint:e}),i=new r.DERInteger({bigint:t}),s=new r.DERSequence({array:[n,i]});return s.tohex()};B.crypto.ECDSA.getName=function(e){return e==="2b8104001f"?"secp192k1":e==="2a8648ce3d030107"?"secp256r1":e==="2b8104000a"?"secp256k1":e==="2b81040021"?"secp224r1":e==="2b81040022"?"secp384r1":e==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)!==-1?"secp256r1":"|secp256k1|".indexOf(e)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(e)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(e)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(e)!==-1?"secp521r1":null};(typeof B>"u"||!B)&&(B={});(typeof B.crypto>"u"||!B.crypto)&&(B.crypto={});B.crypto.ECParameterDB=new function(){var e={},t={};function r(n){return new W(n,16)}this.getByName=function(n){var i=n;if(typeof t[i]<"u"&&(i=t[n]),typeof e[i]<"u")return e[i];throw"unregistered EC curve name: "+i},this.regist=function(n,i,s,o,a,f,l,v,p,u,h,b){e[n]={};var d=r(s),y=r(o),w=r(a),_=r(f),I=r(l),N=new js(d,y,w),F=N.decodePointHex("04"+v+p);e[n].name=n,e[n].keylen=i,e[n].keycharlen=Math.ceil(i/8)*2,e[n].curve=N,e[n].G=F,e[n].n=_,e[n].h=I,e[n].oid=h,e[n].info=b;for(var O=0;O<u.length;O++)t[u[O]]=n}};B.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");B.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");B.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");B.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);B.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);B.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);B.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);B.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);B.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);B.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);(typeof B>"u"||!B)&&(B={});(typeof B.crypto>"u"||!B.crypto)&&(B.crypto={});B.crypto.DSA=function(){var e=Y,t=e.getVbyList,r=e.getVbyListEx,n=e.isASN1HEX,i=W;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(s,o,a,f,l){this.isPrivate=!0,this.p=s,this.q=o,this.g=a,this.y=f,this.x=l},this.setPrivateHex=function(s,o,a,f,l){var v,p,u,h,b;v=new W(s,16),p=new W(o,16),u=new W(a,16),typeof f=="string"&&f.length>1?h=new W(f,16):h=null,b=new W(l,16),this.setPrivate(v,p,u,h,b)},this.setPublic=function(s,o,a,f){this.isPublic=!0,this.p=s,this.q=o,this.g=a,this.y=f,this.x=null},this.setPublicHex=function(s,o,a,f){var l,v,p,u;l=new W(s,16),v=new W(o,16),p=new W(a,16),u=new W(f,16),this.setPublic(l,v,p,u)},this.signWithMessageHash=function(s){var o=this.p,a=this.q,f=this.g,l=this.y,v=this.x,p=B.crypto.Util.getRandomBigIntegerMinToMax(W.ONE.add(W.ONE),a.subtract(W.ONE)),u=s.substr(0,a.bitLength()/4),h=new W(u,16),b=f.modPow(p,o).mod(a),d=p.modInverse(a).multiply(h.add(v.multiply(b))).mod(a),y=B.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:b}},{int:{bigint:d}}]});return y},this.verifyWithMessageHash=function(s,o){var a=this.p,f=this.q,l=this.g,v=this.y,p=this.parseASN1Signature(o),u=p[0],h=p[1],b=s.substr(0,f.bitLength()/4),d=new W(b,16);if(W.ZERO.compareTo(u)>0||u.compareTo(f)>0||W.ZERO.compareTo(h)>=0||h.compareTo(f)>0)throw"invalid DSA signature";var y=h.modInverse(f),w=d.multiply(y).mod(f),_=u.multiply(y).mod(f),I=l.modPow(w,a).multiply(v.modPow(_,a)).mod(a).mod(f);return I.compareTo(u)==0},this.parseASN1Signature=function(s){try{var o=new i(r(s,0,[0],"02"),16),a=new i(r(s,0,[1],"02"),16);return[o,a]}catch{throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(s){var o,a,f,l,v;if(n(s)===!1)throw new Error("not ASN.1 hex string");try{o=r(s,0,[1],"02"),a=r(s,0,[2],"02"),f=r(s,0,[3],"02"),l=r(s,0,[4],"02"),v=r(s,0,[5],"02")}catch{throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(o,a,f,l,v)},this.readPKCS8PrvKeyHex=function(s){var o,a,f,l;if(n(s)===!1)throw new Error("not ASN.1 hex string");try{o=r(s,0,[1,1,0],"02"),a=r(s,0,[1,1,1],"02"),f=r(s,0,[1,1,2],"02"),l=r(s,0,[2,0],"02")}catch{throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(o,a,f,null,l)},this.readPKCS8PubKeyHex=function(s){var o,a,f,l;if(n(s)===!1)throw new Error("not ASN.1 hex string");try{o=r(s,0,[0,1,0],"02"),a=r(s,0,[0,1,1],"02"),f=r(s,0,[0,1,2],"02"),l=r(s,0,[1,0],"02")}catch{throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(o,a,f,l)},this.readCertPubKeyHex=function(s,o){var a,f,l,v;if(n(s)===!1)throw new Error("not ASN.1 hex string");try{a=r(s,0,[0,5,0,1,0],"02"),f=r(s,0,[0,5,0,1,1],"02"),l=r(s,0,[0,5,0,1,2],"02"),v=r(s,0,[0,5,1,0],"02")}catch{throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(a,f,l,v)}};var ct=function(){var e=function(d,y,w){return n(ne.AES,d,y,w)},t=function(d,y,w){return n(ne.TripleDES,d,y,w)},r=function(d,y,w){return n(ne.DES,d,y,w)},n=function(d,y,w,_){var I=ne.enc.Hex.parse(y),N=ne.enc.Hex.parse(w),F=ne.enc.Hex.parse(_),O={};O.key=N,O.iv=F,O.ciphertext=I;var q=d.decrypt(O,N,{iv:F});return ne.enc.Hex.stringify(q)},i=function(d,y,w){return a(ne.AES,d,y,w)},s=function(d,y,w){return a(ne.TripleDES,d,y,w)},o=function(d,y,w){return a(ne.DES,d,y,w)},a=function(d,y,w,_){var I=ne.enc.Hex.parse(y),N=ne.enc.Hex.parse(w),F=ne.enc.Hex.parse(_),O=d.encrypt(I,N,{iv:F}),q=ne.enc.Hex.parse(O.toString()),P=ne.enc.Base64.stringify(q);return P},f={"AES-256-CBC":{proc:e,eproc:i,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:i,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:i,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:t,eproc:s,keylen:24,ivlen:8},"DES-CBC":{proc:r,eproc:o,keylen:8,ivlen:8}},l=function(d){return f[d].proc},v=function(d){var y=ne.lib.WordArray.random(d),w=ne.enc.Hex.stringify(y);return w},p=function(d){var y={},w=d.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));w&&(y.cipher=w[1],y.ivsalt=w[2]);var _=d.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));_&&(y.type=_[1]);var I=-1,N=0;d.indexOf(`\r
\r
`)!=-1&&(I=d.indexOf(`\r
\r
`),N=2),d.indexOf(`

`)!=-1&&(I=d.indexOf(`

`),N=1);var F=d.indexOf("-----END");if(I!=-1&&F!=-1){var O=d.substring(I+N*2,F-N);O=O.replace(/\s+/g,""),y.data=O}return y},u=function(d,y,w){for(var _=w.substring(0,16),I=ne.enc.Hex.parse(_),N=ne.enc.Utf8.parse(y),F=f[d].keylen+f[d].ivlen,O="",q=null;;){var P=ne.algo.MD5.create();if(q!=null&&P.update(q),P.update(N),P.update(I),q=P.finalize(),O=O+ne.enc.Hex.stringify(q),O.length>=F*2)break}var D={};return D.keyhex=O.substr(0,f[d].keylen*2),D.ivhex=O.substr(f[d].keylen*2,f[d].ivlen*2),D},h=function(d,y,w,_){var I=ne.enc.Base64.parse(d),N=ne.enc.Hex.stringify(I),F=f[y].proc,O=F(N,w,_);return O},b=function(d,y,w,_){var I=f[y].eproc,N=I(d,w,_);return N};return{version:"1.0.0",parsePKCS5PEM:function(d){return p(d)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(d,y,w){return u(d,y,w)},decryptKeyB64:function(d,y,w,_){return h(d,y,w,_)},getDecryptedKeyHex:function(d,y){var w=p(d),_=w.type,I=w.cipher,N=w.ivsalt,F=w.data,O=u(I,y,N),q=O.keyhex,P=h(F,I,q,N);return P},getEncryptedPKCS5PEMFromPrvKeyHex:function(d,y,w,_,I){var A="";if((typeof _>"u"||_==null)&&(_="AES-256-CBC"),typeof f[_]>"u")throw new Error("KEYUTIL unsupported algorithm: "+_);if(typeof I>"u"||I==null){var N=f[_].ivlen,F=v(N);I=F.toUpperCase()}var O=u(_,w,I),q=O.keyhex,P=b(y,_,q,I),D=P.replace(/(.{64})/g,`$1\r
`),A="-----BEGIN "+d+` PRIVATE KEY-----\r
`;return A+=`Proc-Type: 4,ENCRYPTED\r
`,A+="DEK-Info: "+_+","+I+`\r
`,A+=`\r
`,A+=D,A+=`\r
-----END `+d+` PRIVATE KEY-----\r
`,A},getEncryptedPKCS8PEM:function(d,y,w){var _=this.getEncryptedPKCS8Hex(d,y,w);return bn(_,"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(d,y,w){var _;w==null||w==null?_={}:_=JSON.parse(JSON.stringify(w)),_.plain=d,this.initPBES2Param(_),this.encryptPBES2Param(_,y);var I=this.generatePBES2ASN1Param(_);return B.asn1.ASN1Util.newObject(I).tohex()},initPBES2Param:function(d){if(Ot(d,"encalg")==null&&(d.encalg="aes256-CBC"),Ot(d,"iter")==null&&(d.iter=2048),Ot(d,"prf")==null&&(d.prf="hmacWithSHA256"),Ot(d,"salt")==null&&(d.salt=ne.enc.Hex.stringify(ne.lib.WordArray.random(8))),Ot(d,"enciv")==null){var y;d.encalg=="des-EDE3-CBC"&&(y=8),d.encalg=="aes128-CBC"&&(y=16),d.encalg=="aes256-CBC"&&(y=16),d.enciv=ne.enc.Hex.stringify(ne.lib.WordArray.random(y))}},encryptPBES2Param:function(d,y){var w=ct.getDKFromPBES2Param(d,y);try{var _=B.crypto.Cipher.encrypt(d.plain,w,d.encalg,{iv:d.enciv})}catch{throw new Error("encrypt error: "+d.plain+" "+w+" "+d.encalg+" "+d.enciv)}d.enc=_},generatePBES2ASN1Param:function(d){var y={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:d.salt}},{int:{hex:d9(d.iter)}}]}]},{seq:[{oid:d.encalg},{octstr:{hex:d.enciv}}]}]}]},{octstr:{hex:d.enc}}]};return d.prf!="hmacWithSHA1"&&y.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:d.prf},{null:""}]}),y},parseHexOfEncryptedPKCS8:function(d){var y=Y,w=y.getChildIdx,_=y.getV,I={},N=w(d,0);if(N.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+N.length);I.ciphertext=_(d,N[1]);var F=w(d,N[0]);if(F.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+F.length);if(_(d,F[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var O=w(d,F[1]);if(F.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+O.length);var q=w(d,O[1]);if(q.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+q.length);if(_(d,q[0])!="2a864886f70d0307")throw"this only supports TripleDES";I.encryptionSchemeAlg="TripleDES",I.encryptionSchemeIV=_(d,q[1]);var P=w(d,O[0]);if(P.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+P.length);if(_(d,P[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var D=w(d,P[1]);if(D.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+D.length);I.pbkdf2Salt=_(d,D[0]);var A=_(d,D[1]);try{I.pbkdf2Iter=parseInt(A,16)}catch{throw new Error("malformed format pbkdf2Iter: "+A)}return I},getPBKDF2KeyHexFromParam:function(d,y){var w=ne.enc.Hex.parse(d.pbkdf2Salt),_=d.pbkdf2Iter,I=ne.PBKDF2(y,w,{keySize:192/32,iterations:_}),N=ne.enc.Hex.stringify(I);return N},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(d,y){var w=tr(d,"ENCRYPTED PRIVATE KEY"),_=this.parseHexOfEncryptedPKCS8(w),I=ct.getPBKDF2KeyHexFromParam(_,y),N={};N.ciphertext=ne.enc.Hex.parse(_.ciphertext);var F=ne.enc.Hex.parse(I),O=ne.enc.Hex.parse(_.encryptionSchemeIV),q=ne.TripleDES.decrypt(N,F,{iv:O}),P=ne.enc.Hex.stringify(q);return P},parsePBES2:function(d){var y=Y.parse(d);if(Ot(y,"seq.0.seq.0.oid")!="pkcs5PBES2"||Ot(y,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var w=Ot(y,"seq.0.seq.1.seq.0.seq.1.seq");if(w==null)throw new Error("PBKDF2 parameter not found");var _=Ot(w,"0.octstr.hex"),I=Ot(w,"1.int.hex"),N=Ot(w,"2.seq.0.oid","hmacWithSHA1"),F=-1;try{F=parseInt(I,16)}catch{throw new Error("iter not proper value")}var O=Ot(y,"seq.0.seq.1.seq.1.seq.0.oid"),q=Ot(y,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),P=Ot(y,"seq.1.octstr.hex");if(O==null||q==null||P==null)throw new Error("encalg, enciv or enc is undefined");var D={salt:_,iter:F,prf:N,encalg:O,enciv:q,enc:P};return D},getDKFromPBES2Param:function(d,y){var w={hmacWithSHA1:ne.algo.SHA1,hmacWithSHA224:ne.algo.SHA224,hmacWithSHA256:ne.algo.SHA256,hmacWithSHA384:ne.algo.SHA384,hmacWithSHA512:ne.algo.SHA512},_={"des-EDE3-CBC":192/32,"aes128-CBC":128/32,"aes256-CBC":256/32},I=w[d.prf];if(I==null)throw new Error("unsupported prf");var N=_[d.encalg];if(N==null)throw new Error("unsupported encalg");var F=ne.enc.Hex.parse(d.salt),O=d.iter;try{var q=ne.PBKDF2(y,F,{keySize:N,iterations:O,hasher:I});return ne.enc.Hex.stringify(q)}catch(P){throw new Error("PBKDF2 error: "+P+" "+JSON.stringify(d)+" "+y)}},getPlainHexFromEncryptedPKCS8PEM:function(d,y){if(d.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var w=tr(d),_;try{_=ct.parsePBES2(w)}catch(N){throw new Error("malformed PBES2 format: "+N.message)}var I=ct.getDKFromPBES2Param(_,y);return B.crypto.Cipher.decrypt(_.enc,I,_.encalg,{iv:_.enciv})},getKeyFromEncryptedPKCS8PEM:function(d,y){var w=this.getPlainHexFromEncryptedPKCS8PEM(d,y),_=this.getKeyFromPlainPrivatePKCS8Hex(w);return _},parsePlainPrivatePKCS8Hex:function(d){var y=Y,w=y.getChildIdx,_=y.getV,I={};if(I.algparam=null,d.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var N=w(d,0);if(N.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(d.substr(N[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var F=w(d,N[1]);if(F.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(d.substr(F[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(I.algoid=_(d,F[0]),d.substr(F[1],2)=="06"&&(I.algparam=_(d,F[1])),d.substr(N[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return I.keyidx=y.getVidx(d,N[2]),I},getKeyFromPlainPrivatePKCS8PEM:function(d){var y=tr(d,"PRIVATE KEY"),w=this.getKeyFromPlainPrivatePKCS8Hex(y);return w},getKeyFromPlainPrivatePKCS8Hex:function(d){var y=this.parsePlainPrivatePKCS8Hex(d),w;if(y.algoid=="2a864886f70d010101")w=new Pe;else if(y.algoid=="2a8648ce380401")w=new B.crypto.DSA;else if(y.algoid=="2a8648ce3d0201")w=new B.crypto.ECDSA;else throw new Error("unsupported private key algorithm");return w.readPKCS8PrvKeyHex(d),w},_getKeyFromPublicPKCS8Hex:function(d){var y,w=Y.getVbyList(d,0,[0,0],"06");if(w==="2a864886f70d010101")y=new Pe;else if(w==="2a8648ce380401")y=new B.crypto.DSA;else if(w==="2a8648ce3d0201")y=new B.crypto.ECDSA;else throw new Error("unsupported PKCS#8 public key hex");return y.readPKCS8PubKeyHex(d),y},parsePublicRawRSAKeyHex:function(d){var y=Y,w=y.getChildIdx,_=y.getV,I={};if(d.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var N=w(d,0);if(N.length!=2)throw new Error("malformed RSA key(code:002)");if(d.substr(N[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(I.n=_(d,N[0]),d.substr(N[1],2)!="02")throw new Error("malformed RSA key(code:004)");return I.e=_(d,N[1]),I},parsePublicPKCS8Hex:function(d){var y=Y,w=y.getChildIdx,_=y.getV,I={};I.algparam=null;var N=w(d,0);if(N.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+N.length);var F=N[0];if(d.substr(F,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var O=w(d,F);if(O.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(d.substr(O[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(I.algoid=_(d,O[0]),d.substr(O[1],2)=="06"?I.algparam=_(d,O[1]):d.substr(O[1],2)=="30"&&(I.algparam={},I.algparam.p=y.getVbyList(d,O[1],[0],"02"),I.algparam.q=y.getVbyList(d,O[1],[1],"02"),I.algparam.g=y.getVbyList(d,O[1],[2],"02")),d.substr(N[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return I.key=_(d,N[1]).substr(2),I}}}();ct.getKey=function(e,t,r){var n=Y,i=n.getChildIdx,s=n.getV,o=n.getVbyList,a=B.crypto,f=a.ECDSA,l=a.DSA,v=Pe,p=tr,u=ct;if(typeof v<"u"&&e instanceof v||typeof f<"u"&&e instanceof f||typeof l<"u"&&e instanceof l)return e;if(e.curve!==void 0&&e.xy!==void 0&&e.d===void 0)return new f({pub:e.xy,curve:e.curve});if(e.curve!==void 0&&e.d!==void 0)return new f({prv:e.d,curve:e.curve});if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d===void 0){var h=new v;return h.setPublic(e.n,e.e),h}if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p!==void 0&&e.q!==void 0&&e.dp!==void 0&&e.dq!==void 0&&e.co!==void 0&&e.qi===void 0){var h=new v;return h.setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),h}if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p===void 0){var h=new v;return h.setPrivate(e.n,e.e,e.d),h}if(e.p!==void 0&&e.q!==void 0&&e.g!==void 0&&e.y!==void 0&&e.x===void 0){var h=new l;return h.setPublic(e.p,e.q,e.g,e.y),h}if(e.p!==void 0&&e.q!==void 0&&e.g!==void 0&&e.y!==void 0&&e.x!==void 0){var h=new l;return h.setPrivate(e.p,e.q,e.g,e.y,e.x),h}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d===void 0){var h=new v;return h.setPublic(Wt(e.n),Wt(e.e)),h}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p!==void 0&&e.q!==void 0&&e.dp!==void 0&&e.dq!==void 0&&e.qi!==void 0){var h=new v;return h.setPrivateEx(Wt(e.n),Wt(e.e),Wt(e.d),Wt(e.p),Wt(e.q),Wt(e.dp),Wt(e.dq),Wt(e.qi)),h}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0){var h=new v;return h.setPrivate(Wt(e.n),Wt(e.e),Wt(e.d)),h}if(e.kty==="EC"&&e.crv!==void 0&&e.x!==void 0&&e.y!==void 0&&e.d===void 0){var b=new f({curve:e.crv}),d=b.ecparams.keycharlen,y=("0000000000"+Wt(e.x)).slice(-d),w=("0000000000"+Wt(e.y)).slice(-d),_="04"+y+w;return b.setPublicKeyHex(_),b}if(e.kty==="EC"&&e.crv!==void 0&&e.x!==void 0&&e.y!==void 0&&e.d!==void 0){var b=new f({curve:e.crv}),d=b.ecparams.keycharlen,y=("0000000000"+Wt(e.x)).slice(-d),w=("0000000000"+Wt(e.y)).slice(-d),_="04"+y+w,I=("0000000000"+Wt(e.d)).slice(-d);return b.setPublicKeyHex(_),b.setPrivateKeyHex(I),b}if(r==="pkcs5prv"){var N=e,n=Y,F,h;if(F=i(N,0),F.length===9)h=new v,h.readPKCS5PrvKeyHex(N);else if(F.length===6)h=new l,h.readPKCS5PrvKeyHex(N);else if(F.length>2&&N.substr(F[1],2)==="04")h=new f,h.readPKCS5PrvKeyHex(N);else throw new Error("unsupported PKCS#1/5 hexadecimal key");return h}if(r==="pkcs8prv"){var h=u.getKeyFromPlainPrivatePKCS8Hex(e);return h}if(r==="pkcs8pub")return u._getKeyFromPublicPKCS8Hex(e);if(r==="x509pub")return Me.getPublicKeyFromCertHex(e);if(e.indexOf("-END CERTIFICATE-",0)!=-1||e.indexOf("-END X509 CERTIFICATE-",0)!=-1||e.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return Me.getPublicKeyFromCertPEM(e);if(e.indexOf("-END PUBLIC KEY-")!=-1){var O=tr(e,"PUBLIC KEY");return u._getKeyFromPublicPKCS8Hex(O)}if(e.indexOf("-END RSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var q=p(e,"RSA PRIVATE KEY");return u.getKey(q,null,"pkcs5prv")}if(e.indexOf("-END DSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var P=p(e,"DSA PRIVATE KEY"),D=o(P,0,[1],"02"),A=o(P,0,[2],"02"),c=o(P,0,[3],"02"),m=o(P,0,[4],"02"),S=o(P,0,[5],"02"),h=new l;return h.setPrivate(new W(D,16),new W(A,16),new W(c,16),new W(m,16),new W(S,16)),h}if(e.indexOf("-END EC PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var q=p(e,"EC PRIVATE KEY");return u.getKey(q,null,"pkcs5prv")}if(e.indexOf("-END PRIVATE KEY-")!=-1)return u.getKeyFromPlainPrivatePKCS8PEM(e);if(e.indexOf("-END RSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var g=u.getDecryptedKeyHex(e,t),E=new Pe;return E.readPKCS5PrvKeyHex(g),E}if(e.indexOf("-END EC PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var P=u.getDecryptedKeyHex(e,t),h=o(P,0,[1],"04"),M=o(P,0,[2,0],"06"),T=o(P,0,[3,0],"03").substr(2),R="";if(B.crypto.OID.oidhex2name[M]!==void 0)R=B.crypto.OID.oidhex2name[M];else throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+M);var b=new f({curve:R});return b.setPublicKeyHex(T),b.setPrivateKeyHex(h),b.isPublic=!1,b}if(e.indexOf("-END DSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var P=u.getDecryptedKeyHex(e,t),D=o(P,0,[1],"02"),A=o(P,0,[2],"02"),c=o(P,0,[3],"02"),m=o(P,0,[4],"02"),S=o(P,0,[5],"02"),h=new l;return h.setPrivate(new W(D,16),new W(A,16),new W(c,16),new W(m,16),new W(S,16)),h}if(e.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return u.getKeyFromEncryptedPKCS8PEM(e,t);throw new Error("not supported argument")};ct.generateKeypair=function(e,t){if(e=="RSA"){var r=t,n=new Pe;n.generate(r,"10001"),n.isPrivate=!0,n.isPublic=!0;var i=new Pe,s=n.n.toString(16),o=n.e.toString(16);i.setPublic(s,o),i.isPrivate=!1,i.isPublic=!0;var a={};return a.prvKeyObj=n,a.pubKeyObj=i,a}else if(e=="EC"){var f=t,l=new B.crypto.ECDSA({curve:f}),v=l.generateKeyPairHex(),n=new B.crypto.ECDSA({curve:f});n.setPublicKeyHex(v.ecpubhex),n.setPrivateKeyHex(v.ecprvhex),n.isPrivate=!0,n.isPublic=!1;var i=new B.crypto.ECDSA({curve:f});i.setPublicKeyHex(v.ecpubhex),i.isPrivate=!1,i.isPublic=!0;var a={};return a.prvKeyObj=n,a.pubKeyObj=i,a}else throw new Error("unknown algorithm: "+e)};ct.getPEM=function(e,t,r,n,i,s){var o=B,a=o.asn1,f=a.DERObjectIdentifier,l=a.DERInteger,v=a.ASN1Util.newObject,p=a.x509,u=p.SubjectPublicKeyInfo,h=o.crypto,b=h.DSA,d=h.ECDSA,y=Pe;function w(E){var M=v({seq:[{int:0},{int:{bigint:E.n}},{int:E.e},{int:{bigint:E.d}},{int:{bigint:E.p}},{int:{bigint:E.q}},{int:{bigint:E.dmp1}},{int:{bigint:E.dmq1}},{int:{bigint:E.coeff}}]});return M}function _(E){var M=v({seq:[{int:1},{octstr:{hex:E.prvKeyHex}},{tag:["a0",!0,{oid:{name:E.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+E.pubKeyHex}}]}]});return M}function I(E){var M=v({seq:[{int:0},{int:{bigint:E.p}},{int:{bigint:E.q}},{int:{bigint:E.g}},{int:{bigint:E.y}},{int:{bigint:E.x}}]});return M}if((y!==void 0&&e instanceof y||b!==void 0&&e instanceof b||d!==void 0&&e instanceof d)&&e.isPublic==!0&&(t===void 0||t=="PKCS8PUB")){var N=new u(e),F=N.tohex();return bn(F,"PUBLIC KEY")}if(t=="PKCS1PRV"&&y!==void 0&&e instanceof y&&(r===void 0||r==null)&&e.isPrivate==!0){var N=w(e),F=N.tohex();return bn(F,"RSA PRIVATE KEY")}if(t=="PKCS1PRV"&&d!==void 0&&e instanceof d&&(r===void 0||r==null)&&e.isPrivate==!0){var O=new f({name:e.curveName}),q=O.tohex(),P=_(e),D=P.tohex(),A="";return A+=bn(q,"EC PARAMETERS"),A+=bn(D,"EC PRIVATE KEY"),A}if(t=="PKCS1PRV"&&b!==void 0&&e instanceof b&&(r===void 0||r==null)&&e.isPrivate==!0){var N=I(e),F=N.tohex();return bn(F,"DSA PRIVATE KEY")}if(t=="PKCS5PRV"&&y!==void 0&&e instanceof y&&r!==void 0&&r!=null&&e.isPrivate==!0){var N=w(e),F=N.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",F,r,n,s)}if(t=="PKCS5PRV"&&d!==void 0&&e instanceof d&&r!==void 0&&r!=null&&e.isPrivate==!0){var N=_(e),F=N.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",F,r,n,s)}if(t=="PKCS5PRV"&&b!==void 0&&e instanceof b&&r!==void 0&&r!=null&&e.isPrivate==!0){var N=I(e),F=N.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",F,r,n,s)}var c=function(E,M){if(typeof M=="string")return ct.getEncryptedPKCS8PEM(E,M);if(typeof M=="object"&&Ot(M,"passcode")!=null){var T=JSON.parse(JSON.stringify(M)),R=T.passcode;return delete T.passcode,ct.getEncryptedPKCS8PEM(E,R,T)}};if(t=="PKCS8PRV"&&y!=null&&e instanceof y&&e.isPrivate==!0){var m=w(e),S=m.tohex(),N=v({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:S}}]}),F=N.tohex();return r===void 0||r==null?bn(F,"PRIVATE KEY"):c(F,r)}if(t=="PKCS8PRV"&&d!==void 0&&e instanceof d&&e.isPrivate==!0){var g={seq:[{int:1},{octstr:{hex:e.prvKeyHex}}]};typeof e.pubKeyHex=="string"&&g.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]});var m=new v(g),S=m.tohex(),N=v({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:S}}]}),F=N.tohex();return r===void 0||r==null?bn(F,"PRIVATE KEY"):c(F,r)}if(t=="PKCS8PRV"&&b!==void 0&&e instanceof b&&e.isPrivate==!0){var m=new l({bigint:e.x}),S=m.tohex(),N=v({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:S}}]}),F=N.tohex();return r===void 0||r==null?bn(F,"PRIVATE KEY"):c(F,r)}throw new Error("unsupported object nor format")};ct.getKeyFromCSRPEM=function(e){var t=tr(e,"CERTIFICATE REQUEST"),r=ct.getKeyFromCSRHex(t);return r};ct.getKeyFromCSRHex=function(e){var t=ct.parseCSRHex(e),r=ct.getKey(t.p8pubkeyhex,null,"pkcs8pub");return r};ct.parseCSRHex=function(e){var t=Y,r=t.getChildIdx,n=t.getTLV,i={},s=e;if(s.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var o=r(s,0);if(o.length<1)throw new Error("malformed CSR(code:002)");if(s.substr(o[0],2)!="30")throw new Error("malformed CSR(code:003)");var a=r(s,o[0]);if(a.length<3)throw new Error("malformed CSR(code:004)");return i.p8pubkeyhex=n(s,a[2]),i};ct.getKeyID=function(e){var t=ct,r=Y;typeof e=="string"&&e.indexOf("BEGIN ")!=-1&&(e=t.getKey(e));var n=tr(t.getPEM(e)),i=r.getIdxbyList(n,0,[1]),s=r.getV(n,i).substring(2);return B.crypto.Util.hashHex(s,"sha1")};ct.getJWK=function(e,t,r,n,i){var s,o={},a,f=B.crypto.Util.hashHex;if(typeof e=="string")s=ct.getKey(e),e.indexOf("CERTIFICATE")!=-1&&(a=tr(e));else if(typeof e=="object")e instanceof Me?(s=e.getPublicKey(),a=e.hex):s=e;else throw new Error("unsupported keyinfo type");if(s instanceof Pe&&s.isPrivate)o.kty="RSA",o.n=Mr(s.n.toString(16)),o.e=Mr(s.e.toString(16)),o.d=Mr(s.d.toString(16)),o.p=Mr(s.p.toString(16)),o.q=Mr(s.q.toString(16)),o.dp=Mr(s.dmp1.toString(16)),o.dq=Mr(s.dmq1.toString(16)),o.qi=Mr(s.coeff.toString(16));else if(s instanceof Pe&&s.isPublic)o.kty="RSA",o.n=Mr(s.n.toString(16)),o.e=Mr(s.e.toString(16));else if(s instanceof B.crypto.ECDSA&&s.isPrivate){var l=s.getShortNISTPCurveName();if(l!=="P-256"&&l!=="P-384"&&l!=="P-521")throw new Error("unsupported curve name for JWT: "+l);var v=s.getPublicKeyXYHex();o.kty="EC",o.crv=l,o.x=Mr(v.x),o.y=Mr(v.y),o.d=Mr(s.prvKeyHex)}else if(s instanceof B.crypto.ECDSA&&s.isPublic){var l=s.getShortNISTPCurveName();if(l!=="P-256"&&l!=="P-384"&&l!=="P-521")throw new Error("unsupported curve name for JWT: "+l);var v=s.getPublicKeyXYHex();o.kty="EC",o.crv=l,o.x=Mr(v.x),o.y=Mr(v.y)}if(o.kty==null)throw new Error("unsupported keyinfo");return!s.isPrivate&&t!=!0&&(o.kid=B.jws.JWS.getJWKthumbprint(o)),a!=null&&r!=!0&&(o.x5c=[ks(a)]),a!=null&&n!=!0&&(o.x5t=Df(ks(f(a,"sha1")))),a!=null&&i!=!0&&(o["x5t#S256"]=Df(ks(f(a,"sha256")))),o};ct.getJWKFromKey=function(e){return ct.getJWK(e,!0,!0,!0,!0)};Pe.getPosArrayOfChildrenFromHex=function(e){return Y.getChildIdx(e,0)};Pe.getHexValueArrayOfChildrenFromHex=function(e){var t=Y,r=t.getV,u=Pe.getPosArrayOfChildrenFromHex(e),n=r(e,u[0]),i=r(e,u[1]),s=r(e,u[2]),o=r(e,u[3]),a=r(e,u[4]),f=r(e,u[5]),l=r(e,u[6]),v=r(e,u[7]),p=r(e,u[8]),u=new Array;return u.push(n,i,s,o,a,f,l,v,p),u};Pe.prototype.readPrivateKeyFromPEMString=function(e){var t=tr(e),r=Pe.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])};Pe.prototype.readPKCS5PrvKeyHex=function(e){var t=Pe.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])};Pe.prototype.readPKCS8PrvKeyHex=function(e){var t,r,n,i,s,o,a,f,l=Y,v=l.getVbyListEx;if(l.isASN1HEX(e)===!1)throw new Error("not ASN.1 hex string");try{t=v(e,0,[2,0,1],"02"),r=v(e,0,[2,0,2],"02"),n=v(e,0,[2,0,3],"02"),i=v(e,0,[2,0,4],"02"),s=v(e,0,[2,0,5],"02"),o=v(e,0,[2,0,6],"02"),a=v(e,0,[2,0,7],"02"),f=v(e,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(t,r,n,i,s,o,a,f)};Pe.prototype.readPKCS5PubKeyHex=function(e){var t=Y,r=t.getV;if(t.isASN1HEX(e)===!1)throw new Error("keyHex is not ASN.1 hex string");var n=t.getChildIdx(e,0);if(n.length!==2||e.substr(n[0],2)!=="02"||e.substr(n[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var i=r(e,n[0]),s=r(e,n[1]);this.setPublic(i,s)};Pe.prototype.readPKCS8PubKeyHex=function(e){var t=Y;if(t.isASN1HEX(e)===!1)throw new Error("not ASN.1 hex string");if(t.getTLVbyListEx(e,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var r=t.getTLVbyListEx(e,0,[1,0]);this.readPKCS5PubKeyHex(r)};Pe.prototype.readCertPubKeyHex=function(e,t){var r,n;r=new Me,r.readCertHex(e),n=r.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)};var uee=new RegExp("[^0-9a-f]","gi");function v9(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r=r+"0";return r+e}Pe.prototype.sign=function(e,t){var r=function(i){return B.crypto.Util.hashString(i,t)},n=r(e);return this.signWithMessageHash(n,t)};Pe.prototype.signWithMessageHash=function(e,t){var r=B.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),n=gn(r,16),i=this.doPrivate(n),s=i.toString(16);return v9(s,this.n.bitLength())};function b9(e,t,r){for(var n="",i=0;n.length<t;)n+=yn(r(ui(e+String.fromCharCode.apply(String,[(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255])))),i+=1;return n}Pe.prototype.signPSS=function(e,t,r){var n=function(s){return B.crypto.Util.hashHex(s,t)},i=n(ui(e));return r===void 0&&(r=-1),this.signWithMessageHashPSS(i,t,r)};Pe.prototype.signWithMessageHashPSS=function(e,t,r){var n=yn(e),i=n.length,s=this.n.bitLength()-1,o=Math.ceil(s/8),a,f=function(y){return B.crypto.Util.hashHex(y,t)};if(r===-1||r===void 0)r=i;else if(r===-2)r=o-i-2;else if(r<-2)throw new Error("invalid salt length");if(o<i+r+2)throw new Error("data too long");var l="";r>0&&(l=new Array(r),new $a().nextBytes(l),l=String.fromCharCode.apply(String,l));var v=yn(f(ui("\0\0\0\0\0\0\0\0"+n+l))),p=[];for(a=0;a<o-r-i-2;a+=1)p[a]=0;var u=String.fromCharCode.apply(String,p)+""+l,h=b9(v,u.length,f),b=[];for(a=0;a<u.length;a+=1)b[a]=u.charCodeAt(a)^h.charCodeAt(a);var d=65280>>8*o-s&255;for(b[0]&=~d,a=0;a<i;a++)b.push(v.charCodeAt(a));return b.push(188),v9(this.doPrivate(new W(b)).toString(16),this.n.bitLength())};function g9(e){for(var t in B.crypto.Util.DIGESTINFOHEAD){var r=B.crypto.Util.DIGESTINFOHEAD[t],n=r.length;if(e.substring(0,n)==r){var i=[t,e.substring(n)];return i}}return[]}Pe.prototype.verify=function(e,t){if(t=t.toLowerCase(),t.match(/^[0-9a-f]+$/)==null)return!1;var r=gn(t,16),n=this.n.bitLength();if(r.bitLength()>n)return!1;var i=this.doPublic(r),s=i.toString(16);if(s.length+3!=n/4)return!1;var o=s.replace(/^1f+00/,""),a=g9(o);if(a.length==0)return!1;var f=a[0],l=a[1],v=function(u){return B.crypto.Util.hashString(u,f)},p=v(e);return l==p};Pe.prototype.verifyWithMessageHash=function(e,t){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var r=gn(t,16);if(r.bitLength()>this.n.bitLength())return 0;var n=this.doPublic(r),i=n.toString(16).replace(/^1f+00/,""),s=g9(i);if(s.length==0)return!1;var o=s[0],a=s[1];return a==e};Pe.prototype.verifyPSS=function(e,t,r,n){var i=function(o){return B.crypto.Util.hashHex(o,r)},s=i(ui(e));return n===void 0&&(n=-1),this.verifyWithMessageHashPSS(s,t,r,n)};Pe.prototype.verifyWithMessageHashPSS=function(e,t,r,n){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var i=new W(t,16),s=function(_){return B.crypto.Util.hashHex(_,r)},o=yn(e),a=o.length,f=this.n.bitLength()-1,l=Math.ceil(f/8),v;if(n===-1||n===void 0)n=a;else if(n===-2)n=l-a-2;else if(n<-2)throw new Error("invalid salt length");if(l<a+n+2)throw new Error("data too long");var p=this.doPublic(i).toByteArray();for(v=0;v<p.length;v+=1)p[v]&=255;for(;p.length<l;)p.unshift(0);if(p[l-1]!==188)throw new Error("encoded message does not end in 0xbc");p=String.fromCharCode.apply(String,p);var u=p.substr(0,l-a-1),h=p.substr(u.length,a),b=65280>>8*l-f&255;if((u.charCodeAt(0)&b)!==0)throw new Error("bits beyond keysize not zero");var d=b9(h,u.length,s),y=[];for(v=0;v<u.length;v+=1)y[v]=u.charCodeAt(v)^d.charCodeAt(v);y[0]&=~b;var w=l-a-n-2;for(v=0;v<w;v+=1)if(y[v]!==0)throw new Error("leftmost octets not zero");if(y[w]!==1)throw new Error("0x01 marker not found");return h===yn(s(ui("\0\0\0\0\0\0\0\0"+o+String.fromCharCode.apply(String,y.slice(-n)))))};Pe.SALT_LEN_HLEN=-1;Pe.SALT_LEN_MAX=-2;Pe.SALT_LEN_RECOVER=-2;function Me(e){var t=Y,r=t.getChildIdx,n=t.getV,i=t.dump,s=t.parse,o=t.getTLV,a=t.getVbyList,f=t.getVbyListEx,l=t.getTLVbyList,v=t.getTLVbyListEx,p=t.getIdxbyList,u=t.getIdxbyListEx,h=t.getVidx,b=t.getInt,d=t.oidname,y=t.hextooidstr,w=Me,_=tr,I,N=Error;try{I=B.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var P=l(this.hex,0,[0,0]);if(P.substr(0,2)=="a0"){var D=l(P,0,[0]),A=b(D,0);if(A<0||2<A)throw new Error("malformed version field");return this.version=A+1,this.version}else return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return f(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var P=v(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(P)},this.getAlgorithmIdentifierName=function(P){for(var D in I)if(P===I[D])return D;return d(f(P,0,[0],"06"))},this.getIssuer=function(P,D){return this.getX500Name(this.getIssuerHex(),P,D)},this.getIssuerHex=function(){return l(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){var P=this.getIssuer();return P.str},this.getSubject=function(P,D){return this.getX500Name(this.getSubjectHex(),P,D)},this.getSubjectHex=function(){return l(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){var P=this.getSubject();return P.str},this.getNotBefore=function(){var P=a(this.hex,0,[0,4+this.foffset,0]);return P=P.replace(/(..)/g,"%$1"),P=decodeURIComponent(P),P},this.getNotAfter=function(){var P=a(this.hex,0,[0,4+this.foffset,1]);return P=P.replace(/(..)/g,"%$1"),P=decodeURIComponent(P),P},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return l(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var P=this.getSPKI();return P==null?null:a(P,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return p(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var P=this.getPublicKeyIdx();return p(this.hex,P,[1,0],"30")},this.getPublicKey=function(){return ct.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var P=l(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(P)},this.getSignatureValueHex=function(){return a(this.hex,0,[2],"03",!0)},this.verifySignature=function(P){var D=this.getSignatureAlgorithmField(),A=this.getSignatureValueHex(),c=l(this.hex,0,[0],"30"),m=new B.crypto.Signature({alg:D});return m.init(P),m.updateHex(c),m.verify(A)},this.parseExt=function(P){var D,A,c;if(P===void 0){if(c=this.hex,this.version!==3)return-1;D=p(c,0,[0,7,0],"30"),A=r(c,D)}else{c=tr(P);var m=p(c,0,[0,3,0,0],"06");if(n(c,m)!="2a864886f70d01090e"){this.aExtInfo=new Array;return}D=p(c,0,[0,3,0,1,0],"30"),A=r(c,D),this.hex=c}this.aExtInfo=new Array;for(var S=0;S<A.length;S++){var g={};g.critical=!1;var E=r(c,A[S]),M=0;E.length===3&&(g.critical=!0,M=1),g.oid=t.hextooidstr(a(c,A[S],[0],"06"));var T=p(c,A[S],[1+M]);g.vidx=h(c,T),this.aExtInfo.push(g)}},this.getExtInfo=function(P){var D=this.aExtInfo,A=P;if(P.match(/^[0-9.]+$/)||(A=B.asn1.x509.OID.name2oid(P)),A!==""){for(var c=0;c<D.length;c++)if(D[c].oid===A)return D[c]}},this.getCriticalExtV=function(P,D,A){if(D!=null)return[D,A];var c=this.getExtInfo(P);return c==null?[null,null]:[o(this.hex,c.vidx),c.critical]},this.getExtBasicConstraints=function(P,D){if(P===void 0&&D===void 0){var A=this.getExtInfo("basicConstraints");if(A===void 0)return;P=o(this.hex,A.vidx),D=A.critical}var c={extname:"basicConstraints"};if(D&&(c.critical=!0),P==="3000")return c;if(P==="30030101ff")return c.cA=!0,c;if(P.substr(0,12)==="30060101ff02"){var m=n(P,10),S=parseInt(m,16);return c.cA=!0,c.pathLen=S,c}throw new Error("hExtV parse error: "+P)},this.getExtNameConstraints=function(P,D){var A=this.getCriticalExtV("nameConstraints",P,D);if(P=A[0],D=A[1],P!=null){var c={extname:"nameConstraints"};D&&(c.critical=!0);for(var m=r(P,0),S=0;S<m.length;S++){for(var g=[],E=r(P,m[S]),M=0;M<E.length;M++){var T=o(P,E[M]),R=this.getGeneralSubtree(T);g.push(R)}var x=P.substr(m[S],2);x=="a0"?c.permit=g:x=="a1"&&(c.exclude=g)}return c}},this.getGeneralSubtree=function(P){var D=r(P,0),A=D.length;if(A<1||2<A)throw new Error("wrong num elements");for(var c=this.getGeneralName(o(P,D[0])),m=1;m<A;m++){var S=P.substr(D[m],2),g=n(P,D[m]),E=parseInt(g,16);S=="80"&&(c.min=E),S=="81"&&(c.max=E)}return c},this.getExtKeyUsage=function(P,D){var A=this.getCriticalExtV("keyUsage",P,D);if(P=A[0],D=A[1],P!=null){var c={extname:"keyUsage"};return D&&(c.critical=!0),c.names=this.getExtKeyUsageString(P).split(","),c}},this.getExtKeyUsageBin=function(P){if(P===void 0){var D=this.getExtInfo("keyUsage");if(D===void 0)return"";P=o(this.hex,D.vidx)}if(P.length!=8&&P.length!=10)throw new Error("malformed key usage value: "+P);var A="000000000000000"+parseInt(P.substr(6),16).toString(2);return P.length==8&&(A=A.slice(-8)),P.length==10&&(A=A.slice(-16)),A=A.replace(/0+$/,""),A==""&&(A="0"),A},this.getExtKeyUsageString=function(P){for(var D=this.getExtKeyUsageBin(P),A=new Array,c=0;c<D.length;c++)D.substr(c,1)=="1"&&A.push(Me.KEYUSAGE_NAME[c]);return A.join(",")},this.getExtSubjectKeyIdentifier=function(P,D){if(P===void 0&&D===void 0){var A=this.getExtInfo("subjectKeyIdentifier");if(A===void 0)return;P=o(this.hex,A.vidx),D=A.critical}var c={extname:"subjectKeyIdentifier"};D&&(c.critical=!0);var m=n(P,0);return c.kid={hex:m},c},this.getExtAuthorityKeyIdentifier=function(P,D){if(P===void 0&&D===void 0){var A=this.getExtInfo("authorityKeyIdentifier");if(A===void 0)return;P=o(this.hex,A.vidx),D=A.critical}var c={extname:"authorityKeyIdentifier"};D&&(c.critical=!0);for(var m=r(P,0),S=0;S<m.length;S++){var g=P.substr(m[S],2);if(g==="80"&&(c.kid={hex:n(P,m[S])}),g==="a1"){var E=o(P,m[S]),M=this.getGeneralNames(E);c.issuer=M[0].dn}g==="82"&&(c.sn={hex:n(P,m[S])})}return c},this.getExtExtKeyUsage=function(P,D){if(P===void 0&&D===void 0){var A=this.getExtInfo("extKeyUsage");if(A===void 0)return;P=o(this.hex,A.vidx),D=A.critical}var c={extname:"extKeyUsage",array:[]};D&&(c.critical=!0);for(var m=r(P,0),S=0;S<m.length;S++)c.array.push(d(n(P,m[S])));return c},this.getExtExtKeyUsageName=function(){var P=this.getExtInfo("extKeyUsage");if(P===void 0)return P;var D=new Array,A=o(this.hex,P.vidx);if(A==="")return D;for(var c=r(A,0),m=0;m<c.length;m++)D.push(d(n(A,c[m])));return D},this.getExtSubjectAltName=function(P,D){if(P===void 0&&D===void 0){var A=this.getExtInfo("subjectAltName");if(A===void 0)return;P=o(this.hex,A.vidx),D=A.critical}var c={extname:"subjectAltName",array:[]};return D&&(c.critical=!0),c.array=this.getGeneralNames(P),c},this.getExtIssuerAltName=function(P,D){if(P===void 0&&D===void 0){var A=this.getExtInfo("issuerAltName");if(A===void 0)return;P=o(this.hex,A.vidx),D=A.critical}var c={extname:"issuerAltName",array:[]};return D&&(c.critical=!0),c.array=this.getGeneralNames(P),c},this.getGeneralNames=function(P){for(var D=r(P,0),A=[],c=0;c<D.length;c++){var m=this.getGeneralName(o(P,D[c]));m!==void 0&&A.push(m)}return A},this.getGeneralName=function(P){var D=P.substr(0,2),A=n(P,0),c=yn(A);if(D=="81")return{rfc822:c};if(D=="82")return{dns:c};if(D=="86")return{uri:c};if(D=="87")return{ip:Nl(A)};if(D=="a4")return{dn:this.getX500Name(A)};if(D=="a0")return{other:this.getOtherName(P)}},this.getExtSubjectAltName2=function(){var P,D,A,c=this.getExtInfo("subjectAltName");if(c===void 0)return c;for(var m=new Array,S=o(this.hex,c.vidx),g=r(S,0),E=0;E<g.length;E++)A=S.substr(g[E],2),P=n(S,g[E]),A==="81"&&(D=Nt(P),m.push(["MAIL",D])),A==="82"&&(D=Nt(P),m.push(["DNS",D])),A==="84"&&(D=Me.hex2dn(P,0),m.push(["DN",D])),A==="86"&&(D=Nt(P),m.push(["URI",D])),A==="87"&&(D=Nl(P),m.push(["IP",D]));return m},this.getExtCRLDistributionPoints=function(P,D){if(P===void 0&&D===void 0){var A=this.getExtInfo("cRLDistributionPoints");if(A===void 0)return;P=o(this.hex,A.vidx),D=A.critical}var c={extname:"cRLDistributionPoints",array:[]};D&&(c.critical=!0);for(var m=r(P,0),S=0;S<m.length;S++){var g=o(P,m[S]);c.array.push(this.getDistributionPoint(g))}return c},this.getDistributionPoint=function(P){for(var D={},A=r(P,0),c=0;c<A.length;c++){var m=P.substr(A[c],2),S=o(P,A[c]);m=="a0"&&(D.dpname=this.getDistributionPointName(S))}return D},this.getDistributionPointName=function(P){for(var D={},A=r(P,0),c=0;c<A.length;c++){var m=P.substr(A[c],2),S=o(P,A[c]);m=="a0"&&(D.full=this.getGeneralNames(S))}return D},this.getExtCRLDistributionPointsURI=function(){var P=this.getExtCRLDistributionPoints();if(P==null)return P;for(var D=P.array,A=[],c=0;c<D.length;c++)try{D[c].dpname.full[0].uri!=null&&A.push(D[c].dpname.full[0].uri)}catch{}return A},this.getExtAIAInfo=function(){var P=this.getExtInfo("authorityInfoAccess");if(P===void 0)return P;for(var D={ocsp:[],caissuer:[]},A=r(this.hex,P.vidx),c=0;c<A.length;c++){var m=a(this.hex,A[c],[0],"06"),S=a(this.hex,A[c],[1],"86");m==="2b06010505073001"&&D.ocsp.push(Nt(S)),m==="2b06010505073002"&&D.caissuer.push(Nt(S))}return D},this.getExtAuthorityInfoAccess=function(P,D){if(P===void 0&&D===void 0){var A=this.getExtInfo("authorityInfoAccess");if(A===void 0)return;P=o(this.hex,A.vidx),D=A.critical}var c={extname:"authorityInfoAccess",array:[]};D&&(c.critical=!0);for(var m=r(P,0),S=0;S<m.length;S++){var g=f(P,m[S],[0],"06"),E=a(P,m[S],[1],"86"),M=Nt(E);if(g=="2b06010505073001")c.array.push({ocsp:M});else if(g=="2b06010505073002")c.array.push({caissuer:M});else throw new Error("unknown method: "+g)}return c},this.getExtCertificatePolicies=function(P,D){if(P===void 0&&D===void 0){var A=this.getExtInfo("certificatePolicies");if(A===void 0)return;P=o(this.hex,A.vidx),D=A.critical}var c={extname:"certificatePolicies",array:[]};D&&(c.critical=!0);for(var m=r(P,0),S=0;S<m.length;S++){var g=o(P,m[S]),E=this.getPolicyInformation(g);c.array.push(E)}return c},this.getPolicyInformation=function(P){var D={},A=a(P,0,[0],"06");D.policyoid=d(A);var c=u(P,0,[1],"30");if(c!=-1){D.array=[];for(var m=r(P,c),S=0;S<m.length;S++){var g=o(P,m[S]),E=this.getPolicyQualifierInfo(g);D.array.push(E)}}return D},this.getOtherName=function(P){var D={},A=r(P,0),c=a(P,A[0],[],"06"),m=a(P,A[1],[]);return D.oid=d(c),D.value=s(m),D},this.getPolicyQualifierInfo=function(P){var D={},A=a(P,0,[0],"06");if(A==="2b06010505070201"){var c=f(P,0,[1],"16");D.cps=yn(c)}else if(A==="2b06010505070202"){var m=l(P,0,[1],"30");D.unotice=this.getUserNotice(m)}return D},this.getUserNotice=function(P){var D=null,A={};try{D=t.parse(P);var c=this._asn1ToUnotice(D);return c}catch{return}},this._asn1ToUnotice=function(P){try{for(var D={},A=Ot(P,"seq"),c=0;c<A.length;c++){var m=this._asn1ToNoticeRef(A[c]);m!=null&&(D.noticeref=m);var S=this.asn1ToDisplayText(A[c]);S!=null&&(D.exptext=S)}return Object.keys(D).length>0?D:void 0}catch{return}},this._asn1ToNoticeRef=function(P){try{for(var D={},A=Ot(P,"seq"),c=0;c<A.length;c++){var m=this._asn1ToNoticeNum(A[c]);m!=null&&(D.noticenum=m);var S=this.asn1ToDisplayText(A[c]);S!=null&&(D.org=S)}return Object.keys(D).length>0?D:void 0}catch{return}},this._asn1ToNoticeNum=function(P){try{for(var D=Ot(P,"seq"),A=[],c=0;c<D.length;c++){var m=D[c];A.push(parseInt(Ot(m,"int.hex"),16))}return A}catch{return}},this.getDisplayText=function(P){var D={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"},A={};return A.type=D[P.substr(0,2)],A.str=yn(n(P,0)),A},this.asn1ToDisplayText=function(P){if(P.utf8str!=null)return{type:"utf8",str:P.utf8str.str};if(P.ia5str!=null)return{type:"ia5",str:P.ia5str.str};if(P.visstr!=null)return{type:"vis",str:P.visstr.str};if(P.bmpstr!=null)return{type:"bmp",str:P.bmpstr.str};if(P.prnstr!=null)return{type:"prn",str:P.prnstr.str}},this.getExtPolicyMappings=function(P,D){var A=this.getCriticalExtV("policyMappings",P,D);if(P=A[0],D=A[1],P!=null){var c={extname:"policyMappings"};D&&(c.critical=!0);try{for(var m=s(P),S=m.seq,g=[],E=0;E<S.length;E++){var M=S[E].seq;g.push([M[0].oid,M[1].oid])}c.array=g}catch{throw new N("malformed policyMappings")}return c}},this.getExtPolicyConstraints=function(P,D){var A=this.getCriticalExtV("policyConstraints",P,D);if(P=A[0],D=A[1],P!=null){var c={extname:"policyConstraints"};D&&(c.critical=!0);var m=s(P);try{for(var S=m.seq,g=0;g<S.length;g++){var E=S[g].tag;E.explicit==!1&&(E.tag=="80"&&(c.reqexp=parseInt(E.hex,16)),E.tag=="81"&&(c.inhibit=parseInt(E.hex,16)))}}catch{return new N("malformed policyConstraints value")}return c}},this.getExtInhibitAnyPolicy=function(P,D){var A=this.getCriticalExtV("inhibitAnyPolicy",P,D);if(P=A[0],D=A[1],P!=null){var c={extname:"inhibitAnyPolicy"};D&&(c.critical=!0);var m=b(P,0);return m==-1?new N("wrong value"):(c.skip=m,c)}},this.getExtCRLNumber=function(P,D){var A={extname:"cRLNumber"};if(D&&(A.critical=!0),P.substr(0,2)=="02")return A.num={hex:n(P,0)},A;throw new N("hExtV parse error: "+P)},this.getExtCRLReason=function(P,D){var A={extname:"cRLReason"};if(D&&(A.critical=!0),P.substr(0,2)=="0a")return A.code=parseInt(n(P,0),16),A;throw new Error("hExtV parse error: "+P)},this.getExtOcspNonce=function(P,D){var A={extname:"ocspNonce"};D&&(A.critical=!0);var c=n(P,0);return A.hex=c,A},this.getExtOcspNoCheck=function(P,D){var A={extname:"ocspNoCheck"};return D&&(A.critical=!0),A},this.getExtAdobeTimeStamp=function(P,D){if(P===void 0&&D===void 0){var A=this.getExtInfo("adobeTimeStamp");if(A===void 0)return;P=o(this.hex,A.vidx),D=A.critical}var c={extname:"adobeTimeStamp"};D&&(c.critical=!0);var m=r(P,0);if(m.length>1){var S=o(P,m[1]),g=this.getGeneralName(S);g.uri!=null&&(c.uri=g.uri)}if(m.length>2){var E=o(P,m[2]);E=="0101ff"&&(c.reqauth=!0),E=="010100"&&(c.reqauth=!1)}return c},this.getExtSubjectDirectoryAttributes=function(P,D){if(P===void 0&&D===void 0){var A=this.getExtInfo("subjectDirectoryAttributes");if(A===void 0)return;P=o(this.hex,A.vidx),D=A.critical}var c={extname:"subjectDirectoryAttributes"};D&&(c.critical=!0);try{for(var m=s(P),S=[],g=0;g<m.seq.length;g++){var E=m.seq[g],M=Ot(E,"seq.0.oid"),T=Ot(E,"seq.1.set");if(M==null||T==null)throw"error";S.push({attr:M,array:T})}return c.array=S,c}catch{throw new Error("malformed subjectDirectoryAttributes extension value")}};var F=function(P){var D={};try{var A=P.seq[0].oid,c=B.asn1.x509.OID.name2oid(A);D.type=B.asn1.x509.OID.oid2atype(c);var m=P.seq[1];if(m.utf8str!=null)D.ds="utf8",D.value=m.utf8str.str;else if(m.numstr!=null)D.ds="num",D.value=m.numstr.str;else if(m.telstr!=null)D.ds="tel",D.value=m.telstr.str;else if(m.prnstr!=null)D.ds="prn",D.value=m.prnstr.str;else if(m.ia5str!=null)D.ds="ia5",D.value=m.ia5str.str;else if(m.visstr!=null)D.ds="vis",D.value=m.visstr.str;else if(m.bmpstr!=null)D.ds="bmp",D.value=m.bmpstr.str;else throw"error";return D}catch{throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},O=function(P){try{return P.set.map(function(D){return F(D)})}catch(D){throw new Error("improper ASN.1 parsed RDN: "+D)}},q=function(P){try{return P.seq.map(function(D){return O(D)})}catch(D){throw new Error("improper ASN.1 parsed X500Name: "+D)}};this.getX500NameRule=function(P){for(var D=!0,A=!0,c=!1,m="",S="",g=null,E=[],M=0;M<P.length;M++)for(var T=P[M],R=0;R<T.length;R++)E.push(T[R]);for(var M=0;M<E.length;M++){var x=E[M],C=x.ds,K=x.value,L=x.type;if(m+=":"+C,C!="prn"&&C!="utf8"&&C!="ia5")return"mixed";if(C=="ia5"){if(L!="CN")return"mixed";if(B.lang.String.isMail(K))continue;return"mixed"}if(L=="C"){if(C=="prn")continue;return"mixed"}if(S+=":"+C,g==null)g=C;else if(g!==C)return"mixed"}return g??"prn"},this.getAttrTypeAndValue=function(P){var D=s(P);return F(D)},this.getRDN=function(P){var D=s(P);return O(D)},this.getX500NameArray=function(P){var D=s(P);return q(D)},this.getX500Name=function(P,D,A){var c=this.getX500NameArray(P),m=this.dnarraytostr(c),S={str:m};return S.array=c,A==!0&&(S.hex=P),D==!0&&(S.canon=this.c14nRDNArray(c)),S},this.readCertPEM=function(P){this.readCertHex(_(P))},this.readCertHex=function(P){this.hex=P,this.getVersion();try{p(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(P){var D={};return P==null&&(P={}),D.version=this.getVersion(),D.serial={hex:this.getSerialNumberHex()},D.sigalg=this.getSignatureAlgorithmField(),D.issuer=this.getIssuer(P.dncanon,P.dnhex),D.notbefore=this.getNotBefore(),D.notafter=this.getNotAfter(),D.subject=this.getSubject(P.dncanon,P.dnhex),D.sbjpubkey=bn(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo!=null&&this.aExtInfo.length>0&&(D.ext=this.getExtParamArray()),D.sighex=this.getSignatureValueHex(),P.tbshex==!0&&(D.tbshex=l(this.hex,0,[0])),P.nodnarray==!0&&(delete D.issuer.array,delete D.subject.array),D},this.getExtParamArray=function(P){if(P==null){var D=u(this.hex,0,[0,"[3]"]);D!=-1&&(P=v(this.hex,0,[0,"[3]",0],"30"))}for(var A=[],c=r(P,0),m=0;m<c.length;m++){var S=o(P,c[m]),g=this.getExtParam(S);g!=null&&A.push(g)}return A},this.getExtParam=function(P){var D={},A=r(P,0),c=A.length;if(c!=2&&c!=3)throw new Error("wrong number elements in Extension: "+c+" "+P);var m=y(a(P,0,[0],"06")),S=!1;c==3&&l(P,0,[1])=="0101ff"&&(S=!0);var g=l(P,0,[c-1,0]),E=void 0;if(m=="2.5.29.14"?E=this.getExtSubjectKeyIdentifier(g,S):m=="2.5.29.15"?E=this.getExtKeyUsage(g,S):m=="2.5.29.17"?E=this.getExtSubjectAltName(g,S):m=="2.5.29.18"?E=this.getExtIssuerAltName(g,S):m=="2.5.29.19"?E=this.getExtBasicConstraints(g,S):m=="2.5.29.30"?E=this.getExtNameConstraints(g,S):m=="2.5.29.31"?E=this.getExtCRLDistributionPoints(g,S):m=="2.5.29.32"?E=this.getExtCertificatePolicies(g,S):m=="2.5.29.33"?E=this.getExtPolicyMappings(g,S):m=="2.5.29.35"?E=this.getExtAuthorityKeyIdentifier(g,S):m=="2.5.29.36"?E=this.getExtPolicyConstraints(g,S):m=="2.5.29.37"?E=this.getExtExtKeyUsage(g,S):m=="2.5.29.54"?E=this.getExtInhibitAnyPolicy(g,S):m=="1.3.6.1.5.5.7.1.1"?E=this.getExtAuthorityInfoAccess(g,S):m=="2.5.29.20"?E=this.getExtCRLNumber(g,S):m=="2.5.29.21"?E=this.getExtCRLReason(g,S):m=="2.5.29.9"?E=this.getExtSubjectDirectoryAttributes(g,S):m=="1.3.6.1.5.5.7.48.1.2"?E=this.getExtOcspNonce(g,S):m=="1.3.6.1.5.5.7.48.1.5"?E=this.getExtOcspNoCheck(g,S):m=="1.2.840.113583.1.1.9.1"?E=this.getExtAdobeTimeStamp(g,S):Me.EXT_PARSER[m]!=null&&(E=Me.EXT_PARSER[m](m,S,g)),E!=null)return E;var M={extname:m,extn:g};try{M.extn=s(g)}catch{}return S&&(M.critical=!0),M},this.findExt=function(P,D){for(var A=0;A<P.length;A++)if(P[A].extname==D)return P[A];return null},this.updateExtCDPFullURI=function(P,D){var A=this.findExt(P,"cRLDistributionPoints");if(A!=null&&A.array!=null){for(var c=A.array,m=0;m<c.length;m++)if(c[m].dpname!=null&&c[m].dpname.full!=null)for(var S=c[m].dpname.full,g=0;g<S.length;g++){var E=S[m];E.uri!=null&&(E.uri=D)}}},this.updateExtAIAOCSP=function(P,D){var A=this.findExt(P,"authorityInfoAccess");if(A!=null&&A.array!=null)for(var c=A.array,m=0;m<c.length;m++)c[m].ocsp!=null&&(c[m].ocsp=D)},this.updateExtAIACAIssuer=function(P,D){var A=this.findExt(P,"authorityInfoAccess");if(A!=null&&A.array!=null)for(var c=A.array,m=0;m<c.length;m++)c[m].caissuer!=null&&(c[m].caissuer=D)},this.dnarraytostr=function(P){function D(c){return c.map(function(m){return A(m).replace(/\+/,"\\+")}).join("+")}function A(c){return c.type+"="+c.value}return"/"+P.map(function(c){return D(c).replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(P){var D;if(P.str!=null&&P.array==null){var A=new B.asn1.x509.X500Name({str:P.str}),c=A.tohex();D=this.getX500NameArray(c)}else D=P.array;P.canon==null&&(P.canon=this.c14nRDNArray(D))},this.c14nRDNArray=function(P){for(var D=[],A=0;A<P.length;A++){for(var c=P[A],m=[],S=0;S<c.length;S++){var g=c[S],E=g.value;E=E.replace(/^\s*/,""),E=E.replace(/\s*$/,""),E=E.replace(/\s+/g," "),E=E.toLowerCase(),m.push(g.type.toLowerCase()+"="+E)}D.push(m.join("+"))}return"/"+D.join("/")},this.getInfo=function(){var P=function(te){for(var ve="",J="    ",Z=`
`,Ce=te.array,se=0;se<Ce.length;se++){var re=Ce[se];if(re.dn!=null&&(ve+=J+"dn: "+re.dn.str+Z),re.ip!=null&&(ve+=J+"ip: "+re.ip+Z),re.rfc822!=null&&(ve+=J+"rfc822: "+re.rfc822+Z),re.dns!=null&&(ve+=J+"dns: "+re.dns+Z),re.uri!=null&&(ve+=J+"uri: "+re.uri+Z),re.other!=null){var ft=re.other.oid,_e=JSON.stringify(re.other.value).replace(/\"/g,"");ve+=J+"other: "+ft+"="+_e+Z}}return ve=ve.replace(/\n$/,""),ve},D=function(te){for(var ve="",J=te.array,Z=0;Z<J.length;Z++){var Ce=J[Z];if(ve+="    policy oid: "+Ce.policyoid+`
`,Ce.array!==void 0)for(var se=0;se<Ce.array.length;se++){var re=Ce.array[se];re.cps!==void 0&&(ve+="    cps: "+re.cps+`
`)}}return ve},A=function(te){for(var ve="",J=te.array,Z=0;Z<J.length;Z++){var Ce=J[Z];try{Ce.dpname.full[0].uri!==void 0&&(ve+="    "+Ce.dpname.full[0].uri+`
`)}catch{}try{Ce.dname.full[0].dn.hex!==void 0&&(ve+="    "+Me.hex2dn(Ce.dpname.full[0].dn.hex)+`
`)}catch{}}return ve},c=function(te){for(var ve="",J=te.array,Z=0;Z<J.length;Z++){var Ce=J[Z];Ce.caissuer!==void 0&&(ve+="    caissuer: "+Ce.caissuer+`
`),Ce.ocsp!==void 0&&(ve+="    ocsp: "+Ce.ocsp+`
`)}return ve},m=Me,S,g,E;if(S=`Basic Fields
`,S+="  serial number: "+this.getSerialNumberHex()+`
`,S+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,S+="  issuer: "+this.getIssuerString()+`
`,S+="  notBefore: "+this.getNotBefore()+`
`,S+="  notAfter: "+this.getNotAfter()+`
`,S+="  subject: "+this.getSubjectString()+`
`,S+=`  subject public key info: 
`,g=this.getPublicKey(),S+="    key algorithm: "+g.type+`
`,g.type==="RSA"&&(S+="    n="+yb(g.n.toString(16)).substr(0,16)+`...
`,S+="    e="+yb(g.e.toString(16))+`
`),E=this.aExtInfo,E!=null){S+=`X509v3 Extensions:
`;for(var M=0;M<E.length;M++){var T=E[M],R=B.asn1.x509.OID.oid2name(T.oid);R===""&&(R=T.oid);var x="";if(T.critical===!0&&(x="CRITICAL"),S+="  "+R+" "+x+`:
`,R==="basicConstraints"){var C=this.getExtBasicConstraints();C.cA===void 0?S+=`    {}
`:(S+="    cA=true",C.pathLen!==void 0&&(S+=", pathLen="+C.pathLen),S+=`
`)}else if(R=="policyMappings"){var K=this.getExtPolicyMappings().array,L=K.map(function(te){var ve=te;return ve[0]+":"+ve[1]}).join(", ");S+="    "+L+`
`}else if(R=="policyConstraints"){var V=this.getExtPolicyConstraints();S+="    ",V.reqexp!=null&&(S+=" reqexp="+V.reqexp),V.inhibit!=null&&(S+=" inhibit="+V.inhibit),S+=`
`}else if(R=="inhibitAnyPolicy"){var V=this.getExtInhibitAnyPolicy();S+="    skip="+V.skip+`
`}else if(R=="keyUsage")S+="    "+this.getExtKeyUsageString()+`
`;else if(R=="subjectKeyIdentifier")S+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(R=="authorityKeyIdentifier"){var z=this.getExtAuthorityKeyIdentifier();z.kid!==void 0&&(S+="    kid="+z.kid.hex+`
`)}else if(R=="extKeyUsage"){var G=this.getExtExtKeyUsage().array;S+="    "+G.join(", ")+`
`}else if(R=="subjectAltName"){var $=P(this.getExtSubjectAltName());S+=$+`
`}else if(R=="cRLDistributionPoints"){var oe=this.getExtCRLDistributionPoints();S+=A(oe)}else if(R=="authorityInfoAccess"){var Q=this.getExtAuthorityInfoAccess();S+=c(Q)}else R=="certificatePolicies"&&(S+=D(this.getExtCertificatePolicies()))}}return S+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,S+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`,S},typeof e=="string"&&(e.indexOf("-----BEGIN")!=-1?this.readCertPEM(e):B.lang.String.isHex(e)&&this.readCertHex(e))}Me.EXT_PARSER={};Me.registExtParser=function(e,t){Me.EXT_PARSER[e]=t};Me.hex2dn=function(e,t){t===void 0&&(t=0);var r=new Me,n=Y.getTLV(e,t),i=r.getX500Name(e);return i.str};Me.hex2rdn=function(e,t){if(t===void 0&&(t=0),e.substr(t,2)!=="31")throw new Error("malformed RDN");for(var r=new Array,n=Y.getChildIdx(e,t),i=0;i<n.length;i++)r.push(Me.hex2attrTypeValue(e,n[i]));return r=r.map(function(s){return s.replace("+","\\+")}),r.join("+")};Me.hex2attrTypeValue=function(e,t){var r=Y,n=r.getV;if(t===void 0&&(t=0),e.substr(t,2)!=="30")throw new Error("malformed attribute type and value");var i=r.getChildIdx(e,t);i.length!==2||e.substr(i[0],2);var s=n(e,i[0]),o=B.asn1.ASN1Util.oidHexToInt(s),a=B.asn1.x509.OID.oid2atype(o),f=n(e,i[1]),l=yn(f);return a+"="+l};Me.getPublicKeyFromCertHex=function(e){var t=new Me;return t.readCertHex(e),t.getPublicKey()};Me.getPublicKeyFromCertPEM=function(e){var t=new Me;return t.readCertPEM(e),t.getPublicKey()};Me.getPublicKeyInfoPropOfCertPEM=function(e){var t=Y,r=t.getVbyList,n={},i,s,o;return n.algparam=null,i=new Me,i.readCertPEM(e),s=i.getPublicKeyHex(),n.keyhex=r(s,0,[1],"03").substr(2),n.algoid=r(s,0,[0,0],"06"),n.algoid==="2a8648ce3d0201"&&(n.algparam=r(s,0,[0,1],"06")),n};Me.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];var FL=function(e){var t=B,r=t.lang.String.isHex,n=Y,i=n.getV,s=n.getTLV,o=n.getVbyList,a=n.getTLVbyList,f=n.getTLVbyListEx,l=n.getIdxbyList,v=n.getIdxbyListEx,p=n.getChildIdx,u=new Me;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var h=l(this.hex,0,[0,0]),b=this.hex.substr(h,2);if(b=="02")this.posSigAlg=1;else if(b=="30")this.posSigAlg=0;else throw new Error("malformed 1st item of TBSCertList: "+b);var d=l(this.hex,0,[0,this.posSigAlg+3]),y=this.hex.substr(d,2);if(y=="17"||y=="18"){var w,_;w=l(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,w!=-1&&(_=this.hex.substr(w,2),_=="30"&&(this.posRevCert=this.posSigAlg+4))}else if(y=="30")this.posRevCert=this.posSigAlg+3;else if(y=="a0")this.posRevCert=null;else throw new Error("malformed nextUpdate or revCert tag: "+y)},this.getVersion=function(){return this.posSigAlg==0?null:parseInt(o(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var h=a(this.hex,0,[0,this.posSigAlg],"30");return u.getAlgorithmIdentifierName(h)},this.getIssuer=function(){return u.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return a(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){var h=o(this.hex,0,[0,this.posSigAlg+2]);return result=yn(h)},this.getNextUpdate=function(){var h=l(this.hex,0,[0,this.posSigAlg+3]),b=this.hex.substr(h,2);return b!="17"&&b!="18"?null:yn(i(this.hex,h))},this.getRevCertArray=function(){if(this.posRevCert==null)return null;for(var h=[],b=l(this.hex,0,[0,this.posRevCert]),d=p(this.hex,b),y=0;y<d.length;y++){var w=s(this.hex,d[y]);h.push(this.getRevCert(w))}return h},this.getRevCert=function(h){var b={},d=p(h,0);return b.sn={hex:o(h,0,[0],"02")},b.date=yn(o(h,0,[1])),d.length==3&&(b.ext=u.getExtParamArray(a(h,0,[2]))),b},this.findRevCert=function(h){var b=new Me(h),d=b.getSerialNumberHex();return this.findRevCertBySN(d)},this.findRevCertBySN=function(h){if(this.parsed==null&&this.getParam(),this.parsed.revcert==null)return null;for(var b=this.parsed.revcert,d=0;d<b.length;d++)if(h==b[d].sn.hex)return b[d];return null},this.getSignatureValueHex=function(){return o(this.hex,0,[2],"03",!0)},this.verifySignature=function(h){var b=this.getSignatureAlgorithmField(),d=this.getSignatureValueHex(),y=a(this.hex,0,[0],"30"),w=new B.crypto.Signature({alg:b});return w.init(h),w.updateHex(y),w.verify(d)},this.getParam=function(h){var b={},d=this.getVersion();d!=null&&(b.version=d),b.sigalg=this.getSignatureAlgorithmField(),b.issuer=this.getIssuer(),b.thisupdate=this.getThisUpdate();var y=this.getNextUpdate();y!=null&&(b.nextupdate=y);var w=this.getRevCertArray();w!=null&&(b.revcert=w);var _=v(this.hex,0,[0,"[0]"]);if(_!=-1){var I=f(this.hex,0,[0,"[0]",0]);b.ext=u.getExtParamArray(I)}return b.sighex=this.getSignatureValueHex(),this.parsed=b,typeof h=="object"&&(h.tbshex==!0&&(b.tbshex=a(this.hex,0,[0])),h.nodnarray==!0&&delete b.issuer.array),b},typeof e=="string"&&(r(e)?this.hex=e:e.match(/-----BEGIN X509 CRL/)&&(this.hex=tr(e)),this._setPos())};(typeof B>"u"||!B)&&(B={});(typeof B.jws>"u"||!B.jws)&&(B.jws={});B.jws.JWS=function(){var e=B,t=e.jws.JWS,r=t.isSafeJSONString;this.parseJWS=function(n,i){if(!(this.parsedJWS!==void 0&&(i||this.parsedJWS.sigvalH!==void 0))){var s=n.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(s==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var o=s[1],a=s[2],f=s[3],l=o+"."+a;if(this.parsedJWS={},this.parsedJWS.headB64U=o,this.parsedJWS.payloadB64U=a,this.parsedJWS.sigvalB64U=f,this.parsedJWS.si=l,!i){var v=Wt(f),p=gn(v,16);this.parsedJWS.sigvalH=v,this.parsedJWS.sigvalBI=p}var u=ki(o),h=ki(a);if(this.parsedJWS.headS=u,this.parsedJWS.payloadS=h,!r(u,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+u}}};B.jws.JWS.sign=function(e,t,r,n,i){var s=B,o=s.jws,a=o.JWS,f=a.readSafeJSONString,l=a.isSafeJSONString,v=s.crypto,p=v.ECDSA,u=v.Mac,h=v.Signature,b=JSON,d,y,w;if(typeof t!="string"&&typeof t!="object")throw"spHeader must be JSON string or object: "+t;if(typeof t=="object"&&(y=t,d=b.stringify(y)),typeof t=="string"){if(d=t,!l(d))throw"JWS Head is not safe JSON string: "+d;y=f(d)}if(w=r,typeof r=="object"&&(w=b.stringify(r)),(e==""||e==null)&&y.alg!==void 0&&(e=y.alg),e!=""&&e!=null&&y.alg===void 0&&(y.alg=e,d=b.stringify(y)),e!==y.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+y.alg;var _=null;if(a.jwsalg2sigalg[e]===void 0)throw"unsupported alg name: "+e;_=a.jwsalg2sigalg[e];var I=ou(d),N=ou(w),F=I+"."+N,O="";if(_.substr(0,4)=="Hmac"){if(n===void 0)throw"mac key shall be specified for HS* alg";var q=new u({alg:_,prov:"cryptojs",pass:n});q.updateString(F),O=q.doFinal()}else if(_.indexOf("withECDSA")!=-1){var P=new h({alg:_});P.init(n,i),P.updateString(F);var D=P.sign();O=B.crypto.ECDSA.asn1SigToConcatSig(D)}else if(_!="none"){var P=new h({alg:_});P.init(n,i),P.updateString(F),O=P.sign()}var A=Mr(O);return F+"."+A};B.jws.JWS.verify=function(e,t,r){var n=B,i=n.jws,s=i.JWS,o=s.readSafeJSONString,a=n.crypto,f=a.ECDSA,l=a.Mac,v=a.Signature,p;if(typeof Pe!==void 0&&(p=Pe),!Pb(e))return!1;var u=e.split(".");if(u.length!==3)return!1;var h=u[0],b=u[1],d=h+"."+b,y=Wt(u[2]),w=o(ki(u[0])),_=null,I=null;if(w.alg===void 0)throw"algorithm not specified in header";if(_=w.alg,I=_.substr(0,2),r!=null&&Object.prototype.toString.call(r)==="[object Array]"&&r.length>0){var N=":"+r.join(":")+":";if(N.indexOf(":"+_+":")==-1)throw"algorithm '"+_+"' not accepted in the list"}if(_!="none"&&t===null)throw"key shall be specified to verify.";if(typeof t=="string"&&t.indexOf("-----BEGIN ")!=-1&&(t=ct.getKey(t)),(I=="RS"||I=="PS")&&!(t instanceof p))throw"key shall be a RSAKey obj for RS* and PS* algs";if(I=="ES"&&!(t instanceof f))throw"key shall be a ECDSA obj for ES* algs";_=="none";var F=null;if(s.jwsalg2sigalg[w.alg]===void 0)throw"unsupported alg name: "+_;if(F=s.jwsalg2sigalg[_],F=="none")throw"not supported";if(F.substr(0,4)=="Hmac"){var O=null;if(t===void 0)throw"hexadecimal key shall be specified for HMAC";var q=new l({alg:F,pass:t});return q.updateString(d),O=q.doFinal(),y==O}else if(F.indexOf("withECDSA")!=-1){var P=null;try{P=f.concatSigToASN1Sig(y)}catch{return!1}var D=new v({alg:F});return D.init(t),D.updateString(d),D.verify(P)}else{var D=new v({alg:F});return D.init(t),D.updateString(d),D.verify(y)}};B.jws.JWS.parse=function(e){var t=e.split("."),r={},n,i,s;if(t.length!=2&&t.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return n=t[0],i=t[1],t.length==3&&(s=t[2]),r.headerObj=B.jws.JWS.readSafeJSONString(ki(n)),r.payloadObj=B.jws.JWS.readSafeJSONString(ki(i)),r.headerPP=JSON.stringify(r.headerObj,null,"  "),r.payloadObj==null?r.payloadPP=ki(i):r.payloadPP=JSON.stringify(r.payloadObj,null,"  "),s!==void 0&&(r.sigHex=Wt(s)),r};B.jws.JWS.verifyJWT=function(e,t,r){var n=B,i=n.jws,s=i.JWS,o=s.readSafeJSONString,a=s.inArray,f=s.includedArray;if(!Pb(e))return!1;var l=e.split(".");if(l.length!=3)return!1;var v=l[0],p=l[1],u=v+"."+p,h=Wt(l[2]),b=o(ki(v)),d=o(ki(p));if(b.alg===void 0)return!1;if(r.alg===void 0)throw"acceptField.alg shall be specified";if(!a(b.alg,r.alg)||d.iss!==void 0&&typeof r.iss=="object"&&!a(d.iss,r.iss)||d.sub!==void 0&&typeof r.sub=="object"&&!a(d.sub,r.sub))return!1;if(d.aud!==void 0&&typeof r.aud=="object"){if(typeof d.aud=="string"){if(!a(d.aud,r.aud))return!1}else if(typeof d.aud=="object"&&!f(d.aud,r.aud))return!1}var y=i.IntDate.getNow();return r.verifyAt!==void 0&&typeof r.verifyAt=="number"&&(y=r.verifyAt),(r.gracePeriod===void 0||typeof r.gracePeriod!="number")&&(r.gracePeriod=0),!(d.exp!==void 0&&typeof d.exp=="number"&&d.exp+r.gracePeriod<y||d.nbf!==void 0&&typeof d.nbf=="number"&&y<d.nbf-r.gracePeriod||d.iat!==void 0&&typeof d.iat=="number"&&y<d.iat-r.gracePeriod||d.jti!==void 0&&r.jti!==void 0&&d.jti!==r.jti||!s.verify(e,t,r.alg))};B.jws.JWS.includedArray=function(e,t){var r=B.jws.JWS.inArray;if(e===null||typeof e!="object"||typeof e.length!="number")return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t))return!1;return!0};B.jws.JWS.inArray=function(e,t){if(t===null||typeof t!="object"||typeof t.length!="number")return!1;for(var r=0;r<t.length;r++)if(t[r]==e)return!0;return!1};B.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"};B.jws.JWS.isSafeJSONString=function(e,t,r){var n=null;try{return n=n9(e),typeof n!="object"||n.constructor===Array?0:(t&&(t[r]=n),1)}catch{return 0}};B.jws.JWS.readSafeJSONString=function(e){var t=null;try{return t=n9(e),typeof t!="object"||t.constructor===Array?null:t}catch{return null}};B.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(t==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]};B.jws.JWS.getJWKthumbprint=function(e){if(e.kty!=="RSA"&&e.kty!=="EC"&&e.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var t="{";if(e.kty==="RSA"){if(typeof e.n!="string"||typeof e.e!="string")throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if(e.kty==="EC"){if(typeof e.crv!="string"||typeof e.x!="string"||typeof e.y!="string")throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if(e.kty==="oct"){if(typeof e.k!="string")throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var r=ui(t),n=B.crypto.Util.hashHex(r,"sha256"),i=Mr(n);return i};B.jws.IntDate={};B.jws.IntDate.get=function(e){var t=B.jws.IntDate,r=t.getNow,n=t.getZulu;if(e=="now")return r();if(e=="now + 1hour")return r()+60*60;if(e=="now + 1day")return r()+60*60*24;if(e=="now + 1month")return r()+60*60*24*30;if(e=="now + 1year")return r()+60*60*24*365;if(e.match(/Z$/))return n(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e};B.jws.IntDate.getZulu=function(e){return o9(e)};B.jws.IntDate.getNow=function(){var e=~~(new Date/1e3);return e};B.jws.IntDate.intDate2UTCString=function(e){var t=new Date(e*1e3);return t.toUTCString()};B.jws.IntDate.intDate2Zulu=function(e){var t=new Date(e*1e3),r=("0000"+t.getUTCFullYear()).slice(-4),n=("00"+(t.getUTCMonth()+1)).slice(-2),i=("00"+t.getUTCDate()).slice(-2),s=("00"+t.getUTCHours()).slice(-2),o=("00"+t.getUTCMinutes()).slice(-2),a=("00"+t.getUTCSeconds()).slice(-2);return r+n+i+s+o+a+"Z"};(typeof B>"u"||!B)&&(B={});(typeof B.jws>"u"||!B.jws)&&(B.jws={});B.jws.JWSJS=function(){var e=B,t=e.jws,r=t.JWS,n=r.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(i){this.init();var s=i.split(".");if(s.length!=3)throw"malformed input JWS";this.aHeader.push(s[0]),this.sPayload=s[1],this.aSignature.push(s[2])},this.addSignature=function(i,s,o,a){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var f=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var l=B.jws.JWS.sign(i,s,this.sPayload,o,a),v=l.split("."),p=v[0],u=v[2];this.aHeader.push(v[0]),this.aSignature.push(v[2])}catch(h){throw this.aHeader.length>f&&this.aHeader.pop(),this.aSignature.length>f&&this.aSignature.pop(),"addSignature failed: "+h}},this.verifyAll=function(i){if(this.aHeader.length!==i.length||this.aSignature.length!==i.length)return!1;for(var s=0;s<i.length;s++){var o=i[s];if(o.length!==2)return!1;var a=this.verifyNth(s,o[0],o[1]);if(a===!1)return!1}return!0},this.verifyNth=function(i,s,o){if(this.aHeader.length<=i||this.aSignature.length<=i)return!1;var a=this.aHeader[i],f=this.aSignature[i],l=a+"."+this.sPayload+"."+f,v=!1;try{v=r.verify(l,s,o)}catch{return!1}return v},this.readJWSJS=function(i){if(typeof i=="string"){var s=n(i);if(s==null)throw"argument is not safe JSON object string";this.aHeader=s.headers,this.sPayload=s.payload,this.aSignature=s.signatures}else try{if(i.headers.length>0)this.aHeader=i.headers;else throw"malformed header";if(typeof i.payload=="string")this.sPayload=i.payload;else throw"malformed signatures";if(i.signatures.length>0)this.aSignature=i.signatures;else throw"malformed signatures"}catch(o){throw"malformed JWS-JS JSON object: "+o}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}};ee.SecureRandom=$a;ee.rng_seed_time=Sb;ee.BigInteger=W;ee.RSAKey=Pe;ee.ECDSA=B.crypto.ECDSA;ee.DSA=B.crypto.DSA;ee.Signature=B.crypto.Signature;ee.MessageDigest=B.crypto.MessageDigest;ee.Mac=B.crypto.Mac;ee.Cipher=B.crypto.Cipher;ee.KEYUTIL=ct;ee.ASN1HEX=Y;ee.X509=Me;ee.X509CRL=FL;ee.CryptoJS=ne;ee.b64tohex=Tf;ee.b64toBA=J7;ee.ECFieldElementFp=Cr;ee.ECPointFp=At;ee.ECCurveFp=js;ee.stoBA=i9;ee.BAtos=s9;ee.BAtohex=ql;ee.stohex=Nn;ee.stob64=dL;ee.stob64u=hL;ee.b64utos=lL;ee.b64tob64u=Df;ee.b64utob64=cu;ee.hex2b64=ks;ee.hextob64u=Mr;ee.b64utohex=Wt;ee.utf8tob64u=ou;ee.b64utoutf8=ki;ee.utf8tob64=pL;ee.b64toutf8=vL;ee.utf8tohex=Hl;ee.hextoutf8=Nt;ee.hextorstr=yn;ee.rstrtohex=ui;ee.hextob64=Eb;ee.hextob64nl=yL;ee.b64nltohex=a9;ee.hextopem=bn;ee.pemtohex=tr;ee.hextoArrayBuffer=wL;ee.ArrayBuffertohex=SL;ee.zulutomsec=_b;ee.msectozulu=EL;ee.zulutosec=o9;ee.zulutodate=_L;ee.datetozulu=AL;ee.uricmptohex=jl;ee.hextouricmp=Ll;ee.ipv6tohex=bb;ee.hextoipv6=gb;ee.hextoip=Nl;ee.iptohex=Ab;ee.ucs2hextoutf8=Bb;ee.encodeURIComponentAll=Kl;ee.newline_toUnix=BL;ee.newline_toDos=PL;ee.hextoposhex=yb;ee.intarystrtohex=IL;ee.strdiffidx=ML;ee.oidtohex=u9;ee.hextooid=Ul;ee.strpad=Rl;ee.bitstrtoint=h9;ee.inttobitstr=l9;ee.bitstrtobinstr=p9;ee.binstrtobitstr=CL;ee.isBase64URLDot=Pb;ee.namearraytobinstr=Ol;ee.extendClass=X;ee.foldnl=kl;ee.b64topem=xL;ee.pemtob64=mL;ee.timeogen=f9;ee.aryval=Ot;ee.inttohex=d9;ee.twoscompl=uu;ee.KJUR=B;ee.crypto=B.crypto;ee.asn1=B.asn1;ee.jws=B.jws;ee.lang=B.lang;ee.VERSION=NH;ee.VERSION_FULL=RH});var m9=U(Ur=>{"use strict";H();k();var NL=Ur&&Ur.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),RL=Ur&&Ur.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),OL=Ur&&Ur.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&NL(t,e,r);return RL(t,e),t};Object.defineProperty(Ur,"__esModule",{value:!0});Ur.GenRSAKeyPair=Ur.decodeRsaPublicKey=Ur.decodeRsaPrivateKey=Ur.RSADecode=Ur.RSAEncode=void 0;var Ls=OL(Ib()),gs=hs();function DL(e,t){try{let r=x9(t),n=Ls.KJUR.crypto.Cipher.encrypt(e,r,"RSAOAEP256");return Ls.hextob64(n)}catch(r){throw new gs.MPCError(gs.RSAEncodeError,r)}}Ur.RSAEncode=DL;function TL(e,t){try{let r=y9(t),n=Ls.b64tohex(e);return Ls.KJUR.crypto.Cipher.decrypt(n,r,"RSAOAEP256")}catch(r){throw new gs.MPCError(gs.RSADecodeError,r)}}Ur.RSADecode=TL;function y9(e){try{let t=`-----BEGIN RSA PRIVATE KEY-----
`+e+"-----END RSA PRIVATE KEY-----";return Ls.KEYUTIL.getKey(t,"PKCS1PRV")}catch(t){throw new gs.MPCError(gs.DecodeRSAPrivateKeyError,t)}}Ur.decodeRsaPrivateKey=y9;function x9(e){try{let t=`-----BEGIN PUBLIC KEY-----
`+e+"-----END PUBLIC KEY-----";return Ls.KEYUTIL.getKey(t)}catch(t){throw new gs.MPCError(gs.DecodeRsaPublicKeyError,t)}}Ur.decodeRsaPublicKey=x9;function qL(){try{let e=Ls.KEYUTIL.generateKeypair("RSA",1024),t=Ls.KEYUTIL.getPEM(e.prvKeyObj,"PKCS1PRV"),r=Ls.KEYUTIL.getPEM(e.pubKeyObj),n=t.split(`\r
`),i=r.split(`\r
`),s="",o="";for(let a=0;a<n.length;a++){let f=n[a];f==="-----BEGIN RSA PRIVATE KEY-----"||f==="-----END RSA PRIVATE KEY-----"||(s+=f)}for(let a=0;a<i.length;a++){let f=i[a];f==="-----BEGIN PUBLIC KEY-----"||f==="-----END PUBLIC KEY-----"||(o+=f)}return[s,o]}catch(e){throw new gs.MPCError(gs.GenRSAKeyPairError,e)}}Ur.GenRSAKeyPair=qL});var S9=U(di=>{"use strict";H();k();var HL=di&&di.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),kL=di&&di.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),jL=di&&di.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&HL(t,e,r);return kL(t,e),t};Object.defineProperty(di,"__esModule",{value:!0});di.AESDecrypt=di.AESEncrypt=void 0;var Ks=jL(Kv()),w9=Ml(),Vl=hs();function LL(e,t){try{let r=(0,w9.md5)(t),n=Ks.enc.Utf8.parse(r);return Ks.AES.encrypt(e,n,{iv:n,mode:Ks.mode.CBC,padding:Ks.pad.Pkcs7}).toString()}catch(r){throw new Vl.MPCError(Vl.AESEncryptError,r)}}di.AESEncrypt=LL;function KL(e,t){try{let r=(0,w9.md5)(t),n=Ks.enc.Utf8.parse(r);return Ks.AES.decrypt(e,n,{iv:n,mode:Ks.mode.CBC,padding:Ks.pad.Pkcs7}).toString(Ks.enc.Utf8)}catch(r){throw new Vl.MPCError(Vl.AESDecryptError,r)}}di.AESDecrypt=KL});var _9=U($l=>{"use strict";H();k();Object.defineProperty($l,"__esModule",{value:!0});$l.bip32Derive=void 0;var E9=er(),UL=yl(),VL=tb(),zl=Hi(),Wl=hs();async function zL(e,t,r,n,i){try{if(r.Curve===zl.CurveName.Secp256k1){let[s,o]=await WL(e,t,r.toEcdsaPoint(),n,i);return Promise.resolve([s,zl.ECPoint.fromEcdsaPoint(o)])}else if(r.Curve===zl.CurveName.Ed25519){let[s,o]=await $L(e,t,r.toEd25519Point(),n);return Promise.resolve([s,zl.ECPoint.fromEd25519Point(o)])}return Promise.reject(new Wl.MPCError(Wl.Bip32DeriveError,`bip32Derive un_supported curve type: [${r.Curve}]`))}catch(s){return Promise.reject(new Wl.MPCError(Wl.Bip32DeriveError,s))}}$l.bip32Derive=zL;async function WL(e,t,r,n,i){let s=new UL.TssKey(new E9.BN(t.toString()),r,j.Buffer.from(n,"hex"));return s=await s.NewChildKey(e[0]),s=await s.NewChildKey(e[1]),s=await s.NewChildKey(e[2]),i!=null&&(s=await s.NewChildKey(i)),[BigInt(s.shareI.toString(10)),s.publicKey]}async function $L(e,t,r,n){let i=new VL.TssKey(new E9.BN(t.toString()),r,j.Buffer.from(n,"hex"));return i=await i.NewChildKey(e[0]),i=await i.NewChildKey(e[1]),i=await i.NewChildKey(e[2]),[BigInt(i.shareI.toString(10)),i.publicKey]}});var Mb=U(qn=>{"use strict";H();k();var GL=qn&&qn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),lo=qn&&qn.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&GL(t,e,r)};Object.defineProperty(qn,"__esModule",{value:!0});lo(U7(),qn);lo(V7(),qn);lo(W7(),qn);lo(m9(),qn);lo(S9(),qn);lo(_9(),qn);lo(Ml(),qn)});var A9=U(Xl=>{"use strict";H();k();Object.defineProperty(Xl,"__esModule",{value:!0});Xl.PedersenParameters=void 0;var Gl=(wl(),b0(ml)),du=class{constructor(t,r,n){this.S=t,this.T=r,this.Ntilde=n}static async NewPedersenParameters(){let t=24080463838836201080652082632305534732002063580868256837038210994857729586600268211801279564303369693950429682190326566093932573855509453567393841648357081821880053752774170718047382946252536000678870735515855163646754581081435553356222873770351932852227834667536288582125296651398663163648979543718769199804146918220464587326136530135286945735587984838293187128267423286364628812794385921668573124571396250799658461906690728456458650228465312865048432010152190862532689545798727242877158647292465531176377500682726348426989332482863616802427143787375284653058516335361011466118712811309500705785525375482092098963097n,r=3969445706491109142504463761757113181243720789927116177071520922075525103482617922906331624855888956328960525194513254320803314863178743526851561817509828829014160418629634938441455784583112125465764928720574665390156185396679649272387565016698159745106440263736311759353449267253427424326566011948150894938620330116124058453568512487633908317746279061077639294887980762568955530152514368105906737713994609570534667642479638349602421006214098814038802561220441092513322886567020060969058638935878546693061106757943434742074861416747299644165447889875592530645696214475164899537461943948958136027895218376240993342673n,n=13469185658727475035931073279550075030057497136872025477242105309462997417546940639217444818113817898323930497326722071401088281046063589760494766301417922508037554444807983479412495341757134204363059411424555694916349689713120515929919936432986593339122531838276046180495264783565315603443986101974283074727281432196871144636171331980926684638343639398221779004000968880059122234209774426712142116396474765406158933809440842904102096045102577802122569204376459489609991759029760310331107566518614976666732556835318392772320945696543239652277734046054967196610265022261270041776733838263923439736476965782219187765549n;return new du(r,n,t)}Commit(t,r){let n=(0,Gl.modPow)(this.S,t,this.Ntilde),i=(0,Gl.modPow)(this.T,r,this.Ntilde);return n*i%this.Ntilde}Open(t,r,n){let i=(0,Gl.modPow)(this.S,r,this.Ntilde),s=(0,Gl.modPow)(this.T,n,this.Ntilde);return i*s%this.Ntilde===t}};Xl.PedersenParameters=du});var B9=U(Yl=>{"use strict";H();k();Object.defineProperty(Yl,"__esModule",{value:!0});Yl.ecdsaSign=void 0;var kf=Hi(),Zl=er(),XL=A9(),hu=new Map;async function ZL(e){let t={},r=new Map,n=await XL.PedersenParameters.NewPedersenParameters();for(let i of e.Messages){let s=(0,kf.GetMapKeyTssSign)(e.MpcId,i),o=e.EcdsaMessageMap.get(s);if(e.Step===kf.SignStep.Step1){let a=e.EcdsaShare,f=new kf.P2(new Zl.BN(a.X2.toString()),new Zl.BN(a.E_x1.toString()),a.PaiPubKey,a.PublicKey.toEcdsaPoint(),i,n),[l,v]=await Promise.all(f.step1(o.CmtC));r.set(s,{Proof:l,R2:kf.ECPoint.fromEcdsaPoint(v),E_x1:a.E_x1}),hu.set(s,f)}else if(e.Step===kf.SignStep.Step2){let a=hu.get(s),[f,l]=a.step2(o.Proof,o.Witness);r.set(s,{E_k2_h_rx:BigInt(f.toString()),AffGProof:l})}else if(e.Step==kf.SignStep.Step3){let a=hu.get(s),f=new Zl.secp256k1.Signature(o.Signature.r,o.Signature.s);if(!Zl.secp256k1.verify(f,i,a.publicKey))throw new Error("ecdsa sign verify fail");r.set(s,{Signature:o.Signature}),hu.delete(s)}else throw hu.delete(s),new Error(`un supported step: ${e.Step}`)}return t.EcdsaMessageMap=r,t}Yl.ecdsaSign=ZL});var I9=U(Jl=>{"use strict";H();k();Object.defineProperty(Jl,"__esModule",{value:!0});Jl.ed25519Sign=void 0;var Ga=Hi(),P9=er(),lu=new Map;async function YL(e){let t={},r=new Map;for(let n of e.Messages){let i=(0,Ga.GetMapKeyTssSign)(e.MpcId,n),s=e.Ed25519MessageMap.get(i);if(e.Step===Ga.SignStep.Step1){let o=e.Ed25519Share,a=o.PublicKey,f=new Ga.Ed25519Sign(e.DeviceNumber,o.Threshold,o.PartList,o.ShareI,a.toEd25519Point(),n),l=await f.signStep1();r.set(i,{OutputDataMap:l}),lu.set(i,f)}else if(e.Step===Ga.SignStep.Step2){let a=await lu.get(i).signStep2(s.TssInput);r.set(i,{OutputDataMap:a})}else if(e.Step===Ga.SignStep.Step3){let o=lu.get(i),[a,f]=await o.signStep3(s.TssInput),v=(s.Signature.s+a+P9.ed25519.CURVE.n)%P9.ed25519.CURVE.n,[p,u]=await(0,Ga.Ed25519Verify)(new Ga.Signature(f,v),n,Ga.ECPoint.fromEd25519Point(o.publicKey));if(!u)throw new Error("ed25519 sign verify fail");r.set(i,{Signature:p}),o={},lu.delete(i)}else throw lu.delete(i),new Error(`un supported step: ${e.Step}`)}return t.Ed25519MessageMap=r,t}Jl.ed25519Sign=YL});var C9=U(Ql=>{"use strict";H();k();Object.defineProperty(Ql,"__esModule",{value:!0});Ql.Dispatch=void 0;var Cb=Mb(),M9=If(),JL=B9(),QL=I9(),eK=[Cb.DeviceNumber.P2_No,Cb.DeviceNumber.P3_No];async function tK(e){if(!eK.includes(e.DeviceNumber))throw new Error(`wrong part number: ${e.DeviceNumber}`);if(e.FuncType!==Cb.FuncType.TssSign)throw new Error(`un supported operate: ${e.FuncType}`);switch(e.CurveName){case M9.CurveName.Secp256k1:return await(0,JL.ecdsaSign)(e);case M9.CurveName.Ed25519:return(0,QL.ed25519Sign)(e);default:throw new Error(`un supported curve: ${e.CurveName}`)}}Ql.Dispatch=tK});var N9=U(Xa=>{"use strict";H();k();var rK=Xa&&Xa.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),F9=Xa&&Xa.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&rK(t,e,r)};Object.defineProperty(Xa,"__esModule",{value:!0});F9(C9(),Xa);F9(Mb(),Xa)});var Hi=U(Rn=>{"use strict";H();k();var nK=Rn&&Rn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),e1=Rn&&Rn.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&nK(t,e,r)};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.JSONBigNative=Rn.JsonParseBigInt=void 0;e1(L7(),Rn);e1(If(),Rn);e1(N9(),Rn);e1(hs(),Rn);function iK(e,t){return/\d{16,}/.test(e)&&(e=e.replace(/"(\\?[\s\S])*?"|([+\-\d.eE]{16,})/g,function(r,n,i){return i&&/^\d{16,}$/.test(i)?'"'+r+'"':r})),JSON.parse(e,t)}Rn.JsonParseBigInt=iK;var sK=uS()({useNativeBigInt:!0});Rn.JSONBigNative=sK});var Fb=U(jf=>{"use strict";H();k();Object.defineProperty(jf,"__esModule",{value:!0});jf.EcdsaPData=jf.ShareData=void 0;var R9=ta(),t1=Hi(),pu=class{constructor(t,r,n){this.shareI=t,this.publicKey=r,this.chaincode=n}static parseShareData(t){let r=(0,t1.JsonParseBigInt)(t),n=BigInt(r.ShareI.toString()),i=r.ChainCode.toString(),s=new t1.ECPoint(r.PublicKey.Curve,BigInt(r.PublicKey.X.toString()),BigInt(r.PublicKey.Y.toString()));return new pu(n,s,i)}};jf.ShareData=pu;var vu=class{constructor(t,r,n){this.e_x1=t,this.paiPubKey=r,this.x2=n}static parseEcdsaPShare(t){let r=(0,t1.JsonParseBigInt)(t),n=BigInt(r.E_x1.toString()),i=BigInt(r.X2),s=new R9.BN(r.PaiPubKey.N.toString());return new vu(n,new t1.PailPubKey(new R9.BN(s.toString())),i)}};jf.EcdsaPData=vu});var Nb=U(ys=>{"use strict";H();k();Object.defineProperty(ys,"__esModule",{value:!0});ys.saveContext=ys.loadContext=ys.saveAesKey=ys.loadAesKey=void 0;var O9=new Map,D9=new Map;function aK(e){let t=O9.get(e);if(t===void 0)throw new Error("aesKey miss, please shakeHand first");return t}ys.loadAesKey=aK;function oK(e,t){O9.set(e,t)}ys.saveAesKey=oK;function fK(e){let t=D9.get(e);if(t===void 0)throw new Error("sign context miss, please setup first");return t}ys.loadContext=fK;function cK(e,t){D9.set(e,t)}ys.saveContext=cK});var Db=U(Yt=>{"use strict";H();k();Object.defineProperty(Yt,"__esModule",{value:!0});Yt.extractShare=Yt.ed25519Step3=Yt.ed25519Step2=Yt.ed25519Step1=Yt.ed25519SetUp=Yt.mpcEcdsaStep3=Yt.ecdsaStep3=Yt.ecdsaStep2=Yt.ecdsaStep1=Yt.ecdsaSetUp=Yt.shakeHands=void 0;var r1=go(),Rb=Fb(),n1=Sd(),bu=go(),le=Hi(),T9=ta(),Vr=Nb(),uK=dS(),dK="MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC93PS4MnSbE5pLbXFrgSjphDjG9tqnWfwxgWbaMUhvtMVvSgFhO7JVbrY2AtflD8p3bXpFMIiGOLEp6W73No77rMigEJzbfRKy/vD8YMcdvW8KaoU5b4I7kloC7ItWW+keFWvoBO7OeqlPaMEBb/gXNWlqPvT2Gz5gDfqGJz5HRQIDAQAB";function hK(e){try{let t=T9.base.toHex(T9.base.randomBytes(16));return(0,Vr.saveAesKey)(e,t),(0,le.RSAEncode)(t,dK)}catch(t){throw new le.MPCError(bu.MPCShakeHandsError,t)}}Yt.shakeHands=hK;async function lK(e,t,r,n,i,s,o){try{let a;o!=null&&o.length>0?a={hash:o,raw:""}:a=await(0,n1.getMPCRawTransaction)(i,n);let f=e,l=i,v=s,[p,,u]=Ob(t,"",r),h=[];Array.isArray(a.hash)?a.hash.forEach(_=>h.push(_)):h.push(a.hash);let b={version:le.MpcVersion.Version_v1,messages:h,path:s},d=le.JSONBigNative.stringify(b),y=(0,Vr.loadAesKey)(e),w=(0,le.AESEncrypt)(d,y);return(0,Vr.saveContext)(e,{messages:h,pShareData:u,path:v,shareData:p,currentMpcId:f,mpcRawData:a,currency:l}),Promise.resolve(w)}catch(a){return Promise.reject(new le.MPCError(bu.EcdsaSetupError,a))}}Yt.ecdsaSetUp=lK;async function pK(e,t){let r=(0,Vr.loadContext)(e),n=(0,Vr.loadAesKey)(e),i=r.path,s=r.shareData,o=r.pShareData,a=r.currentMpcId,f=r.messages;try{let l=(0,le.AESDecrypt)(t,n),v=new Map(Object.entries(le.JSONBigNative.parse(l))),[p,u]=await(0,le.bip32Derive)(i,o.x2,s.publicKey,s.chaincode),h=u,b={MpcId:a,DeviceNumber:le.DeviceNumber.P2_No,CurveName:le.CurveName.Secp256k1,FuncType:le.FuncType.TssSign,Step:le.SignStep.Step1,Messages:f,EcdsaShare:{PublicKey:u,X2:p,E_x1:o.e_x1,PaiPubKey:o.paiPubKey},EcdsaMessageMap:v},d=await(0,le.Dispatch)(b),y=le.JSONBigNative.stringify(Object.fromEntries(d.EcdsaMessageMap)),w=(0,le.AESEncrypt)(y,n);return r.childPublicKey=h,r.p2Input=b,Promise.resolve(w)}catch(l){return Promise.reject(new le.MPCError(bu.EcdsaStep1Error,l))}}Yt.ecdsaStep1=pK;async function vK(e,t){let r=(0,Vr.loadContext)(e),n=(0,Vr.loadAesKey)(e),i=r.p2Input;try{let s=(0,le.AESDecrypt)(t,n),o=new Map(Object.entries(le.JSONBigNative.parse(s)));i.Step=le.SignStep.Step2,i.EcdsaMessageMap=o;let a=await(0,le.Dispatch)(i),f=le.JSONBigNative.stringify(Object.fromEntries(a.EcdsaMessageMap)),l=(0,le.AESEncrypt)(f,n);return Promise.resolve(l)}catch(s){return Promise.reject(new le.MPCError(bu.EcdsaStep2Error,s))}}Yt.ecdsaStep2=vK;async function bK(e,t){let r=(0,Vr.loadContext)(e),n=r.messages,i=r.currentMpcId,s=r.mpcRawData,o=r.childPublicKey,a=r.currency;try{let f=await q9(e,t),l=[],v=[];for(let b of n){let d=(0,le.GetMapKeyTssSign)(i,b),y=f.EcdsaMessageMap.get(d).Signature;l.push("0x"+y.r.toString(16).padStart(64,"0")+y.s.toString(16).padStart(64,"0")),v.push(y.r.toString(16).padStart(64,"0")+y.s.toString(16).padStart(64,"0"))}let p=Array.isArray(s.hash)?l:l[0],u={raw:s.raw,sigs:p,publicKey:o.toHex()};if(s?.raw===""&&s?.hash!=null&&s?.hash.length>0){let b={signatures:v};return Promise.resolve(uK.json.stringify(b))}let h=await(0,n1.getMPCTransaction)(a,u);return Promise.resolve(h.toString())}catch(f){return Promise.reject(new le.MPCError(bu.EcdsaStep3Error,f))}}Yt.ecdsaStep3=bK;async function q9(e,t){let r=(0,Vr.loadContext)(e),n=(0,Vr.loadAesKey)(e),i=r.p2Input,s=(0,le.AESDecrypt)(t,n),o=new Map(Object.entries(le.JSONBigNative.parse(s)));i.Step=le.SignStep.Step3,i.EcdsaMessageMap=o;let a=await(0,le.Dispatch)(i);return Promise.resolve(a)}Yt.mpcEcdsaStep3=q9;async function gK(e,t,r,n,i){try{let s=await(0,n1.getMPCRawTransaction)(n,r),o=e,a=n,f=i,[,l]=Ob("",t,""),v=[];Array.isArray(s.hash)?s.hash.forEach(d=>v.push(d)):v.push(s.hash);let p={version:le.MpcVersion.Version_v1,messages:v,path:i,ed25519Share:{threshold:2,partList:[le.DeviceNumber.P1_No,le.DeviceNumber.P2_No]}},u=le.JSONBigNative.stringify(p),h=(0,Vr.loadAesKey)(e),b=(0,le.AESEncrypt)(u,h);return(0,Vr.saveContext)(e,{currency:a,currentMpcId:o,messages:v,mpcRawData:s,path:f,shareData:l}),Promise.resolve(b)}catch(s){return Promise.reject(new le.MPCError(r1.Ed25519SetupError,s))}}Yt.ed25519SetUp=gK;async function yK(e,t){let r=(0,Vr.loadContext)(e),n=(0,Vr.loadAesKey)(e),i=r.path,s=r.currentMpcId,o=r.messages,a=r.shareData;try{let f=(0,le.AESDecrypt)(t,n),l=(0,le.cvtObjToEd25519Map)((0,le.JsonParseBigInt)(f)),[v,p]=await(0,le.bip32Derive)(i,a.shareI,a.publicKey,a.chaincode),u=p,h={MpcId:s,DeviceNumber:le.DeviceNumber.P2_No,CurveName:le.CurveName.Ed25519,FuncType:le.FuncType.TssSign,Step:le.SignStep.Step1,Messages:o,Ed25519Share:{PublicKey:p,Threshold:2,PartList:[le.DeviceNumber.P1_No,le.DeviceNumber.P2_No],ShareI:v},Ed25519MessageMap:l},b=await(0,le.Dispatch)(h),d=(0,le.bigintStringify)((0,le.cvtEd25519MapToObj)(b.Ed25519MessageMap)),y=(0,le.AESEncrypt)(d,n);return r.childPublicKey=u,r.p2Input=h,r.ed25519P1Step1=l,Promise.resolve(y)}catch(f){return Promise.reject(new le.MPCError(r1.Ed25519Step1Error,f))}}Yt.ed25519Step1=yK;async function xK(e,t){let r=(0,Vr.loadContext)(e),n=(0,Vr.loadAesKey)(e),i=r.p2Input,s=r.ed25519P1Step1;try{let o=(0,le.AESDecrypt)(t,n),a=(0,le.cvtObjToEd25519Map)((0,le.JsonParseBigInt)(o));i.Step=le.SignStep.Step2,i.Ed25519MessageMap=s;let f=await(0,le.Dispatch)(i),l=(0,le.bigintStringify)((0,le.cvtEd25519MapToObj)(f.Ed25519MessageMap)),v=(0,le.AESEncrypt)(l,n);return r.ed25519P1Step2=a,Promise.resolve(v)}catch(o){return Promise.reject(new le.MPCError(r1.Ed25519Step2Error,o))}}Yt.ed25519Step2=xK;async function mK(e,t){let r=(0,Vr.loadContext)(e),n=(0,Vr.loadAesKey)(e),i=r.p2Input,s=r.messages,o=r.currentMpcId,a=r.mpcRawData,f=r.childPublicKey,l=r.ed25519P1Step2,v=r.currency;try{let p=(0,le.AESDecrypt)(t,n),u=(0,le.cvtObjToEd25519Map)((0,le.JsonParseBigInt)(p));i.Step=le.SignStep.Step3,i.Ed25519MessageMap=l;for(let[_,I]of u)i.Ed25519MessageMap.get(_).Signature=u.get(_).Signature;let h=await(0,le.Dispatch)(i),b=[];for(let _ of s){let I=(0,le.GetMapKeyTssSign)(o,_),N=h.Ed25519MessageMap.get(I).Signature;b.push("0x"+N.r.toString(16).padStart(64,"0")+N.s.toString(16).padStart(64,"0"))}let d=Array.isArray(a.hash)?b:b[0],y={raw:a.raw,sigs:d,publicKey:f.toHex()},w=await(0,n1.getMPCTransaction)(v,y);return Promise.resolve(w.toString())}catch(p){return Promise.reject(new le.MPCError(r1.Ed25519Step3Error,p))}}Yt.ed25519Step3=mK;function Ob(e,t,r){let n,i,s;return e!==""&&(n=Rb.ShareData.parseShareData(e)),t!==""&&(i=Rb.ShareData.parseShareData(t)),r!==""&&(s=Rb.EcdsaPData.parseEcdsaPShare(r)),[n,i,s]}Yt.extractShare=Ob});var L9=U(Kf=>{"use strict";H();k();Object.defineProperty(Kf,"__esModule",{value:!0});Kf.signMsgStep3=Kf.signMsgSetup=void 0;var H9=go(),k9=Sd(),Tb=Nb(),j9=Db(),Lf=Hi(),wK=ta();async function SK(e,t,r,n,i,s){try{let o=await(0,k9.getMPCRawMessage)(i,n),f=[wK.base.stripHexPrefix(o.hash)],[l,,v]=(0,j9.extractShare)(t,"",r),p={version:Lf.MpcVersion.Version_v1,messages:f,path:s},u=Lf.JSONBigNative.stringify(p),h=(0,Tb.loadAesKey)(e),b=(0,Lf.AESEncrypt)(u,h);return(0,Tb.saveContext)(e,{trxParam:n.data,messages:f,pShareData:v,path:s,shareData:l,currentMpcId:e,mpcRawData:o,currency:i}),Promise.resolve(b)}catch(o){return Promise.reject(new Lf.MPCError(H9.SignMsgSetupError,o))}}Kf.signMsgSetup=SK;async function EK(e,t){let r=(0,Tb.loadContext)(e),n=r.messages,i=r.trxParam,s=r.currentMpcId,o=r.mpcRawData,a=r.childPublicKey,f=r.currency;try{let l=await(0,j9.mpcEcdsaStep3)(e,t),v=[];for(let h of n){let b=(0,Lf.GetMapKeyTssSign)(s,h),d=l.EcdsaMessageMap.get(b).Signature;v.push("0x"+d.r.toString(16).padStart(64,"0")+d.s.toString(16).padStart(64,"0"))}let p={hash:o.hash,sigs:v[0],publicKey:a.toHex(),type:i.type,message:i.message},u=await(0,k9.getMPCSignedMessage)(f,p);return Promise.resolve(u.toString())}catch(l){return Promise.reject(new Lf.MPCError(H9.SignMsgStep3Error,l))}}Kf.signMsgStep3=EK});var K9=U(hi=>{"use strict";H();k();Object.defineProperty(hi,"__esModule",{value:!0});hi.mpcSignMsg=hi.mpcSignEd25519=hi.mpcSignEcdsa=hi.mpcShakeHands=hi.getMPCAddress=void 0;var qb=Hi(),zr=U9(),xs=go();async function _K(e,t,r,n){if(!xs.CoinCurveMap.has(r))return Promise.reject(xs.UnsupportedCoinError);let i,s=xs.CoinCurveMap.get(r);if(s===qb.CurveName.Secp256k1)[i,,]=(0,zr.extractShare)(t,"","");else if(s===qb.CurveName.Ed25519)[,i]=(0,zr.extractShare)("",t,"");else return Promise.reject(xs.UnsupportedCoinError);let[o,a]=await(0,qb.bip32Derive)(e,0n,i.publicKey,i.chaincode),f={publicKey:a.toHex(),hrp:n},l=await(0,zr.getAddressByPublicKey)(r,f);if(xs.MultiAddressCoins.includes(r)){for(let v of l){let p={address:v.address,hrp:n};if(!await(0,zr.validAddress)(r,p))return Promise.reject(xs.ValidAddressError)}return{childPublicKey:a.toHex(),multiAddress:l}}else{let v={address:l,hrp:n};return await(0,zr.validAddress)(r,v)?{childPublicKey:a.toHex(),address:l}:Promise.reject(xs.ValidAddressError)}}hi.getMPCAddress=_K;function AK(e){return(0,zr.shakeHands)(e)}hi.mpcShakeHands=AK;async function BK(e){switch(e.step){case 0:return await(0,zr.ecdsaSetUp)(e.mpcId,e.share,e.pShare,e.txParams,e.currency,e.path,e.signHashList);case 1:return await(0,zr.ecdsaStep1)(e.mpcId,e.serverData);case 2:return await(0,zr.ecdsaStep2)(e.mpcId,e.serverData);case 3:return await(0,zr.ecdsaStep3)(e.mpcId,e.serverData);default:return Promise.reject(xs.MPCStepError)}}hi.mpcSignEcdsa=BK;async function PK(e){switch(e.step){case 0:return await(0,zr.ed25519SetUp)(e.mpcId,e.share,e.txParams,e.currency,e.path);case 1:return await(0,zr.ed25519Step1)(e.mpcId,e.serverData);case 2:return await(0,zr.ed25519Step2)(e.mpcId,e.serverData);case 3:return await(0,zr.ed25519Step3)(e.mpcId,e.serverData);default:return Promise.reject(xs.MPCStepError)}}hi.mpcSignEd25519=PK;async function IK(e){switch(e.step){case 0:return await(0,zr.signMsgSetup)(e.mpcId,e.share,e.pShare,e.txParams,e.currency,e.path);case 1:return await(0,zr.ecdsaStep1)(e.mpcId,e.serverData);case 2:return await(0,zr.ecdsaStep2)(e.mpcId,e.serverData);case 3:return await(0,zr.signMsgStep3)(e.mpcId,e.serverData);default:return Promise.reject(xs.MPCStepError)}}hi.mpcSignMsg=IK});var Hb=U(ms=>{"use strict";H();k();Object.defineProperty(ms,"__esModule",{value:!0});ms.isHexPrefixed=ms.stripHexPrefix=ms.fromHex=ms.toHex=void 0;function MK(e,t=!1){let r=j.Buffer.from(e);return t?"0x"+r.toString("hex"):r.toString("hex")}ms.toHex=MK;function CK(e){return e.startsWith("0x")&&(e=e.substring(2)),j.Buffer.from(e,"hex")}ms.fromHex=CK;function FK(e){return e.startsWith("0x")?e.substring(2):e}ms.stripHexPrefix=FK;function NK(e){return e.startsWith("0x")}ms.isHexPrefixed=NK});var kb=U(Uf=>{"use strict";H();k();Object.defineProperty(Uf,"__esModule",{value:!0});Uf.fromBase64=Uf.toBase64=void 0;var V9=zs();function RK(e){let t=j.Buffer.from(e);return V9.base64.encode(Uint8Array.from(t))}Uf.toBase64=RK;function OK(e){return V9.base64.decode(e)}Uf.fromBase64=OK});var xt=U((i1,z9)=>{H();k();(function(e,t){typeof i1=="object"?z9.exports=i1=t():typeof define=="function"&&define.amd?define([],t):e.CryptoJS=t()})(i1,function(){var e=e||function(t,r){var n=Object.create||function(){function d(){}return function(y){var w;return d.prototype=y,w=new d,d.prototype=null,w}}(),i={},s=i.lib={},o=s.Base=function(){return{extend:function(d){var y=n(this);return d&&y.mixIn(d),(!y.hasOwnProperty("init")||this.init===y.init)&&(y.init=function(){y.$super.init.apply(this,arguments)}),y.init.prototype=y,y.$super=this,y},create:function(){var d=this.extend();return d.init.apply(d,arguments),d},init:function(){},mixIn:function(d){for(var y in d)d.hasOwnProperty(y)&&(this[y]=d[y]);d.hasOwnProperty("toString")&&(this.toString=d.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),a=s.WordArray=o.extend({init:function(d,y){d=this.words=d||[],y!=r?this.sigBytes=y:this.sigBytes=d.length*4},toString:function(d){return(d||l).stringify(this)},concat:function(d){var y=this.words,w=d.words,_=this.sigBytes,I=d.sigBytes;if(this.clamp(),_%4)for(var N=0;N<I;N++){var F=w[N>>>2]>>>24-N%4*8&255;y[_+N>>>2]|=F<<24-(_+N)%4*8}else for(var N=0;N<I;N+=4)y[_+N>>>2]=w[N>>>2];return this.sigBytes+=I,this},clamp:function(){var d=this.words,y=this.sigBytes;d[y>>>2]&=4294967295<<32-y%4*8,d.length=t.ceil(y/4)},clone:function(){var d=o.clone.call(this);return d.words=this.words.slice(0),d},random:function(d){for(var y=[],w=function(O){var O=O,q=987654321,P=4294967295;return function(){q=36969*(q&65535)+(q>>16)&P,O=18e3*(O&65535)+(O>>16)&P;var D=(q<<16)+O&P;return D/=4294967296,D+=.5,D*(t.random()>.5?1:-1)}},_=0,I;_<d;_+=4){var N=w((I||t.random())*4294967296);I=N()*987654071,y.push(N()*4294967296|0)}return new a.init(y,d)}}),f=i.enc={},l=f.Hex={stringify:function(d){for(var y=d.words,w=d.sigBytes,_=[],I=0;I<w;I++){var N=y[I>>>2]>>>24-I%4*8&255;_.push((N>>>4).toString(16)),_.push((N&15).toString(16))}return _.join("")},parse:function(d){for(var y=d.length,w=[],_=0;_<y;_+=2)w[_>>>3]|=parseInt(d.substr(_,2),16)<<24-_%8*4;return new a.init(w,y/2)}},v=f.Latin1={stringify:function(d){for(var y=d.words,w=d.sigBytes,_=[],I=0;I<w;I++){var N=y[I>>>2]>>>24-I%4*8&255;_.push(String.fromCharCode(N))}return _.join("")},parse:function(d){for(var y=d.length,w=[],_=0;_<y;_++)w[_>>>2]|=(d.charCodeAt(_)&255)<<24-_%4*8;return new a.init(w,y)}},p=f.Utf8={stringify:function(d){try{return decodeURIComponent(escape(v.stringify(d)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(d){return v.parse(unescape(encodeURIComponent(d)))}},u=s.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(d){typeof d=="string"&&(d=p.parse(d)),this._data.concat(d),this._nDataBytes+=d.sigBytes},_process:function(d){var y=this._data,w=y.words,_=y.sigBytes,I=this.blockSize,N=I*4,F=_/N;d?F=t.ceil(F):F=t.max((F|0)-this._minBufferSize,0);var O=F*I,q=t.min(O*4,_);if(O){for(var P=0;P<O;P+=I)this._doProcessBlock(w,P);var D=w.splice(0,O);y.sigBytes-=q}return new a.init(D,q)},clone:function(){var d=o.clone.call(this);return d._data=this._data.clone(),d},_minBufferSize:0}),h=s.Hasher=u.extend({cfg:o.extend(),init:function(d){this.cfg=this.cfg.extend(d),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(d){return this._append(d),this._process(),this},finalize:function(d){d&&this._append(d);var y=this._doFinalize();return y},blockSize:512/32,_createHelper:function(d){return function(y,w){return new d.init(w).finalize(y)}},_createHmacHelper:function(d){return function(y,w){return new b.HMAC.init(d,w).finalize(y)}}}),b=i.algo={};return i}(Math);return e})});var gu=U((s1,W9)=>{H();k();(function(e,t){typeof s1=="object"?W9.exports=s1=t(xt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(s1,function(e){return function(t){var r=e,n=r.lib,i=n.Base,s=n.WordArray,o=r.x64={},a=o.Word=i.extend({init:function(l,v){this.high=l,this.low=v}}),f=o.WordArray=i.extend({init:function(l,v){l=this.words=l||[],v!=t?this.sigBytes=v:this.sigBytes=l.length*8},toX32:function(){for(var l=this.words,v=l.length,p=[],u=0;u<v;u++){var h=l[u];p.push(h.high),p.push(h.low)}return s.create(p,this.sigBytes)},clone:function(){for(var l=i.clone.call(this),v=l.words=this.words.slice(0),p=v.length,u=0;u<p;u++)v[u]=v[u].clone();return l}})}(),e})});var G9=U((a1,$9)=>{H();k();(function(e,t){typeof a1=="object"?$9.exports=a1=t(xt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(a1,function(e){return function(){if(typeof ArrayBuffer=="function"){var t=e,r=t.lib,n=r.WordArray,i=n.init,s=n.init=function(o){if(o instanceof ArrayBuffer&&(o=new Uint8Array(o)),(o instanceof Int8Array||typeof Uint8ClampedArray<"u"&&o instanceof Uint8ClampedArray||o instanceof Int16Array||o instanceof Uint16Array||o instanceof Int32Array||o instanceof Uint32Array||o instanceof Float32Array||o instanceof Float64Array)&&(o=new Uint8Array(o.buffer,o.byteOffset,o.byteLength)),o instanceof Uint8Array){for(var a=o.byteLength,f=[],l=0;l<a;l++)f[l>>>2]|=o[l]<<24-l%4*8;i.call(this,f,a)}else i.apply(this,arguments)};s.prototype=n}}(),e.lib.WordArray})});var Z9=U((o1,X9)=>{H();k();(function(e,t){typeof o1=="object"?X9.exports=o1=t(xt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(o1,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=t.enc,s=i.Utf16=i.Utf16BE={stringify:function(a){for(var f=a.words,l=a.sigBytes,v=[],p=0;p<l;p+=2){var u=f[p>>>2]>>>16-p%4*8&65535;v.push(String.fromCharCode(u))}return v.join("")},parse:function(a){for(var f=a.length,l=[],v=0;v<f;v++)l[v>>>1]|=a.charCodeAt(v)<<16-v%2*16;return n.create(l,f*2)}};i.Utf16LE={stringify:function(a){for(var f=a.words,l=a.sigBytes,v=[],p=0;p<l;p+=2){var u=o(f[p>>>2]>>>16-p%4*8&65535);v.push(String.fromCharCode(u))}return v.join("")},parse:function(a){for(var f=a.length,l=[],v=0;v<f;v++)l[v>>>1]|=o(a.charCodeAt(v)<<16-v%2*16);return n.create(l,f*2)}};function o(a){return a<<8&4278255360|a>>>8&16711935}}(),e.enc.Utf16})});var po=U((f1,Y9)=>{H();k();(function(e,t){typeof f1=="object"?Y9.exports=f1=t(xt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(f1,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=t.enc,s=i.Base64={stringify:function(a){var f=a.words,l=a.sigBytes,v=this._map;a.clamp();for(var p=[],u=0;u<l;u+=3)for(var h=f[u>>>2]>>>24-u%4*8&255,b=f[u+1>>>2]>>>24-(u+1)%4*8&255,d=f[u+2>>>2]>>>24-(u+2)%4*8&255,y=h<<16|b<<8|d,w=0;w<4&&u+w*.75<l;w++)p.push(v.charAt(y>>>6*(3-w)&63));var _=v.charAt(64);if(_)for(;p.length%4;)p.push(_);return p.join("")},parse:function(a){var f=a.length,l=this._map,v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var p=0;p<l.length;p++)v[l.charCodeAt(p)]=p}var u=l.charAt(64);if(u){var h=a.indexOf(u);h!==-1&&(f=h)}return o(a,f,v)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(a,f,l){for(var v=[],p=0,u=0;u<f;u++)if(u%4){var h=l[a.charCodeAt(u-1)]<<u%4*2,b=l[a.charCodeAt(u)]>>>6-u%4*2;v[p>>>2]|=(h|b)<<24-p%4*8,p++}return n.create(v,p)}}(),e.enc.Base64})});var vo=U((c1,J9)=>{H();k();(function(e,t){typeof c1=="object"?J9.exports=c1=t(xt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(c1,function(e){return function(t){var r=e,n=r.lib,i=n.WordArray,s=n.Hasher,o=r.algo,a=[];(function(){for(var h=0;h<64;h++)a[h]=t.abs(t.sin(h+1))*4294967296|0})();var f=o.MD5=s.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(h,b){for(var d=0;d<16;d++){var y=b+d,w=h[y];h[y]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360}var _=this._hash.words,I=h[b+0],N=h[b+1],F=h[b+2],O=h[b+3],q=h[b+4],P=h[b+5],D=h[b+6],A=h[b+7],c=h[b+8],m=h[b+9],S=h[b+10],g=h[b+11],E=h[b+12],M=h[b+13],T=h[b+14],R=h[b+15],x=_[0],C=_[1],K=_[2],L=_[3];x=l(x,C,K,L,I,7,a[0]),L=l(L,x,C,K,N,12,a[1]),K=l(K,L,x,C,F,17,a[2]),C=l(C,K,L,x,O,22,a[3]),x=l(x,C,K,L,q,7,a[4]),L=l(L,x,C,K,P,12,a[5]),K=l(K,L,x,C,D,17,a[6]),C=l(C,K,L,x,A,22,a[7]),x=l(x,C,K,L,c,7,a[8]),L=l(L,x,C,K,m,12,a[9]),K=l(K,L,x,C,S,17,a[10]),C=l(C,K,L,x,g,22,a[11]),x=l(x,C,K,L,E,7,a[12]),L=l(L,x,C,K,M,12,a[13]),K=l(K,L,x,C,T,17,a[14]),C=l(C,K,L,x,R,22,a[15]),x=v(x,C,K,L,N,5,a[16]),L=v(L,x,C,K,D,9,a[17]),K=v(K,L,x,C,g,14,a[18]),C=v(C,K,L,x,I,20,a[19]),x=v(x,C,K,L,P,5,a[20]),L=v(L,x,C,K,S,9,a[21]),K=v(K,L,x,C,R,14,a[22]),C=v(C,K,L,x,q,20,a[23]),x=v(x,C,K,L,m,5,a[24]),L=v(L,x,C,K,T,9,a[25]),K=v(K,L,x,C,O,14,a[26]),C=v(C,K,L,x,c,20,a[27]),x=v(x,C,K,L,M,5,a[28]),L=v(L,x,C,K,F,9,a[29]),K=v(K,L,x,C,A,14,a[30]),C=v(C,K,L,x,E,20,a[31]),x=p(x,C,K,L,P,4,a[32]),L=p(L,x,C,K,c,11,a[33]),K=p(K,L,x,C,g,16,a[34]),C=p(C,K,L,x,T,23,a[35]),x=p(x,C,K,L,N,4,a[36]),L=p(L,x,C,K,q,11,a[37]),K=p(K,L,x,C,A,16,a[38]),C=p(C,K,L,x,S,23,a[39]),x=p(x,C,K,L,M,4,a[40]),L=p(L,x,C,K,I,11,a[41]),K=p(K,L,x,C,O,16,a[42]),C=p(C,K,L,x,D,23,a[43]),x=p(x,C,K,L,m,4,a[44]),L=p(L,x,C,K,E,11,a[45]),K=p(K,L,x,C,R,16,a[46]),C=p(C,K,L,x,F,23,a[47]),x=u(x,C,K,L,I,6,a[48]),L=u(L,x,C,K,A,10,a[49]),K=u(K,L,x,C,T,15,a[50]),C=u(C,K,L,x,P,21,a[51]),x=u(x,C,K,L,E,6,a[52]),L=u(L,x,C,K,O,10,a[53]),K=u(K,L,x,C,S,15,a[54]),C=u(C,K,L,x,N,21,a[55]),x=u(x,C,K,L,c,6,a[56]),L=u(L,x,C,K,R,10,a[57]),K=u(K,L,x,C,D,15,a[58]),C=u(C,K,L,x,M,21,a[59]),x=u(x,C,K,L,q,6,a[60]),L=u(L,x,C,K,g,10,a[61]),K=u(K,L,x,C,F,15,a[62]),C=u(C,K,L,x,m,21,a[63]),_[0]=_[0]+x|0,_[1]=_[1]+C|0,_[2]=_[2]+K|0,_[3]=_[3]+L|0},_doFinalize:function(){var h=this._data,b=h.words,d=this._nDataBytes*8,y=h.sigBytes*8;b[y>>>5]|=128<<24-y%32;var w=t.floor(d/4294967296),_=d;b[(y+64>>>9<<4)+15]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,b[(y+64>>>9<<4)+14]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,h.sigBytes=(b.length+1)*4,this._process();for(var I=this._hash,N=I.words,F=0;F<4;F++){var O=N[F];N[F]=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360}return I},clone:function(){var h=s.clone.call(this);return h._hash=this._hash.clone(),h}});function l(h,b,d,y,w,_,I){var N=h+(b&d|~b&y)+w+I;return(N<<_|N>>>32-_)+b}function v(h,b,d,y,w,_,I){var N=h+(b&y|d&~y)+w+I;return(N<<_|N>>>32-_)+b}function p(h,b,d,y,w,_,I){var N=h+(b^d^y)+w+I;return(N<<_|N>>>32-_)+b}function u(h,b,d,y,w,_,I){var N=h+(d^(b|~y))+w+I;return(N<<_|N>>>32-_)+b}r.MD5=s._createHelper(f),r.HmacMD5=s._createHmacHelper(f)}(Math),e.MD5})});var d1=U((u1,Q9)=>{H();k();(function(e,t){typeof u1=="object"?Q9.exports=u1=t(xt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(u1,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=r.Hasher,s=t.algo,o=[],a=s.SHA1=i.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(f,l){for(var v=this._hash.words,p=v[0],u=v[1],h=v[2],b=v[3],d=v[4],y=0;y<80;y++){if(y<16)o[y]=f[l+y]|0;else{var w=o[y-3]^o[y-8]^o[y-14]^o[y-16];o[y]=w<<1|w>>>31}var _=(p<<5|p>>>27)+d+o[y];y<20?_+=(u&h|~u&b)+1518500249:y<40?_+=(u^h^b)+1859775393:y<60?_+=(u&h|u&b|h&b)-1894007588:_+=(u^h^b)-899497514,d=b,b=h,h=u<<30|u>>>2,u=p,p=_}v[0]=v[0]+p|0,v[1]=v[1]+u|0,v[2]=v[2]+h|0,v[3]=v[3]+b|0,v[4]=v[4]+d|0},_doFinalize:function(){var f=this._data,l=f.words,v=this._nDataBytes*8,p=f.sigBytes*8;return l[p>>>5]|=128<<24-p%32,l[(p+64>>>9<<4)+14]=Math.floor(v/4294967296),l[(p+64>>>9<<4)+15]=v,f.sigBytes=l.length*4,this._process(),this._hash},clone:function(){var f=i.clone.call(this);return f._hash=this._hash.clone(),f}});t.SHA1=i._createHelper(a),t.HmacSHA1=i._createHmacHelper(a)}(),e.SHA1})});var jb=U((h1,ew)=>{H();k();(function(e,t){typeof h1=="object"?ew.exports=h1=t(xt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(h1,function(e){return function(t){var r=e,n=r.lib,i=n.WordArray,s=n.Hasher,o=r.algo,a=[],f=[];(function(){function p(d){for(var y=t.sqrt(d),w=2;w<=y;w++)if(!(d%w))return!1;return!0}function u(d){return(d-(d|0))*4294967296|0}for(var h=2,b=0;b<64;)p(h)&&(b<8&&(a[b]=u(t.pow(h,1/2))),f[b]=u(t.pow(h,1/3)),b++),h++})();var l=[],v=o.SHA256=s.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(p,u){for(var h=this._hash.words,b=h[0],d=h[1],y=h[2],w=h[3],_=h[4],I=h[5],N=h[6],F=h[7],O=0;O<64;O++){if(O<16)l[O]=p[u+O]|0;else{var q=l[O-15],P=(q<<25|q>>>7)^(q<<14|q>>>18)^q>>>3,D=l[O-2],A=(D<<15|D>>>17)^(D<<13|D>>>19)^D>>>10;l[O]=P+l[O-7]+A+l[O-16]}var c=_&I^~_&N,m=b&d^b&y^d&y,S=(b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22),g=(_<<26|_>>>6)^(_<<21|_>>>11)^(_<<7|_>>>25),E=F+g+c+f[O]+l[O],M=S+m;F=N,N=I,I=_,_=w+E|0,w=y,y=d,d=b,b=E+M|0}h[0]=h[0]+b|0,h[1]=h[1]+d|0,h[2]=h[2]+y|0,h[3]=h[3]+w|0,h[4]=h[4]+_|0,h[5]=h[5]+I|0,h[6]=h[6]+N|0,h[7]=h[7]+F|0},_doFinalize:function(){var p=this._data,u=p.words,h=this._nDataBytes*8,b=p.sigBytes*8;return u[b>>>5]|=128<<24-b%32,u[(b+64>>>9<<4)+14]=t.floor(h/4294967296),u[(b+64>>>9<<4)+15]=h,p.sigBytes=u.length*4,this._process(),this._hash},clone:function(){var p=s.clone.call(this);return p._hash=this._hash.clone(),p}});r.SHA256=s._createHelper(v),r.HmacSHA256=s._createHmacHelper(v)}(Math),e.SHA256})});var rw=U((l1,tw)=>{H();k();(function(e,t,r){typeof l1=="object"?tw.exports=l1=t(xt(),jb()):typeof define=="function"&&define.amd?define(["./core","./sha256"],t):t(e.CryptoJS)})(l1,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=t.algo,s=i.SHA256,o=i.SHA224=s.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var a=s._doFinalize.call(this);return a.sigBytes-=4,a}});t.SHA224=s._createHelper(o),t.HmacSHA224=s._createHmacHelper(o)}(),e.SHA224})});var Lb=U((p1,nw)=>{H();k();(function(e,t,r){typeof p1=="object"?nw.exports=p1=t(xt(),gu()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],t):t(e.CryptoJS)})(p1,function(e){return function(){var t=e,r=t.lib,n=r.Hasher,i=t.x64,s=i.Word,o=i.WordArray,a=t.algo;function f(){return s.create.apply(s,arguments)}var l=[f(1116352408,3609767458),f(1899447441,602891725),f(3049323471,3964484399),f(3921009573,2173295548),f(961987163,4081628472),f(1508970993,3053834265),f(2453635748,2937671579),f(2870763221,3664609560),f(3624381080,2734883394),f(310598401,1164996542),f(607225278,1323610764),f(1426881987,3590304994),f(1925078388,4068182383),f(2162078206,991336113),f(2614888103,633803317),f(3248222580,3479774868),f(3835390401,2666613458),f(4022224774,944711139),f(264347078,2341262773),f(604807628,2007800933),f(770255983,1495990901),f(1249150122,1856431235),f(1555081692,3175218132),f(1996064986,2198950837),f(2554220882,3999719339),f(2821834349,766784016),f(2952996808,2566594879),f(3210313671,3203337956),f(3336571891,1034457026),f(3584528711,2466948901),f(113926993,3758326383),f(338241895,168717936),f(666307205,1188179964),f(773529912,1546045734),f(1294757372,1522805485),f(1396182291,2643833823),f(1695183700,2343527390),f(1986661051,1014477480),f(2177026350,1206759142),f(2456956037,344077627),f(2730485921,1290863460),f(2820302411,3158454273),f(3259730800,3505952657),f(3345764771,106217008),f(3516065817,3606008344),f(3600352804,1432725776),f(4094571909,1467031594),f(275423344,851169720),f(430227734,3100823752),f(506948616,1363258195),f(659060556,3750685593),f(883997877,3785050280),f(958139571,3318307427),f(1322822218,3812723403),f(1537002063,2003034995),f(1747873779,3602036899),f(1955562222,1575990012),f(2024104815,1125592928),f(2227730452,2716904306),f(2361852424,442776044),f(2428436474,593698344),f(2756734187,3733110249),f(3204031479,2999351573),f(3329325298,3815920427),f(3391569614,3928383900),f(3515267271,566280711),f(3940187606,3454069534),f(4118630271,4000239992),f(116418474,1914138554),f(174292421,2731055270),f(289380356,3203993006),f(460393269,320620315),f(685471733,587496836),f(852142971,1086792851),f(1017036298,365543100),f(1126000580,2618297676),f(1288033470,3409855158),f(1501505948,4234509866),f(1607167915,987167468),f(1816402316,1246189591)],v=[];(function(){for(var u=0;u<80;u++)v[u]=f()})();var p=a.SHA512=n.extend({_doReset:function(){this._hash=new o.init([new s.init(1779033703,4089235720),new s.init(3144134277,2227873595),new s.init(1013904242,4271175723),new s.init(2773480762,1595750129),new s.init(1359893119,2917565137),new s.init(2600822924,725511199),new s.init(528734635,4215389547),new s.init(1541459225,327033209)])},_doProcessBlock:function(u,h){for(var b=this._hash.words,d=b[0],y=b[1],w=b[2],_=b[3],I=b[4],N=b[5],F=b[6],O=b[7],q=d.high,P=d.low,D=y.high,A=y.low,c=w.high,m=w.low,S=_.high,g=_.low,E=I.high,M=I.low,T=N.high,R=N.low,x=F.high,C=F.low,K=O.high,L=O.low,V=q,z=P,G=D,$=A,oe=c,Q=m,te=S,ve=g,J=E,Z=M,Ce=T,se=R,re=x,ft=C,_e=K,be=L,Bt=0;Bt<80;Bt++){var ge=v[Bt];if(Bt<16)var pe=ge.high=u[h+Bt*2]|0,Pt=ge.low=u[h+Bt*2+1]|0;else{var Fe=v[Bt-15],ie=Fe.high,Rt=Fe.low,ae=(ie>>>1|Rt<<31)^(ie>>>8|Rt<<24)^ie>>>7,Ee=(Rt>>>1|ie<<31)^(Rt>>>8|ie<<24)^(Rt>>>7|ie<<25),bi=v[Bt-2],Ae=bi.high,Ie=bi.low,ws=(Ae>>>19|Ie<<13)^(Ae<<3|Ie>>>29)^Ae>>>6,Ne=(Ie>>>19|Ae<<13)^(Ie<<3|Ae>>>29)^(Ie>>>6|Ae<<26),Re=v[Bt-7],Ss=Re.high,Ve=Re.low,Oe=v[Bt-16],Es=Oe.high,De=Oe.low,Pt=Ee+Ve,pe=ae+Ss+(Pt>>>0<Ee>>>0?1:0),Pt=Pt+Ne,pe=pe+ws+(Pt>>>0<Ne>>>0?1:0),Pt=Pt+De,pe=pe+Es+(Pt>>>0<De>>>0?1:0);ge.high=pe,ge.low=Pt}var ze=J&Ce^~J&re,gi=Z&se^~Z&ft,We=V&G^V&oe^G&oe,$e=z&$^z&Q^$&Q,_s=(V>>>28|z<<4)^(V<<30|z>>>2)^(V<<25|z>>>7),Te=(z>>>28|V<<4)^(z<<30|V>>>2)^(z<<25|V>>>7),Ge=(J>>>14|Z<<18)^(J>>>18|Z<<14)^(J<<23|Z>>>9),As=(Z>>>14|J<<18)^(Z>>>18|J<<14)^(Z<<23|J>>>9),qe=l[Bt],Xe=qe.high,yi=qe.low,ue=be+As,me=_e+Ge+(ue>>>0<be>>>0?1:0),ue=ue+gi,me=me+ze+(ue>>>0<gi>>>0?1:0),ue=ue+yi,me=me+Xe+(ue>>>0<yi>>>0?1:0),ue=ue+Pt,me=me+pe+(ue>>>0<Pt>>>0?1:0),xi=Te+$e,Ze=_s+We+(xi>>>0<Te>>>0?1:0);_e=re,be=ft,re=Ce,ft=se,Ce=J,se=Z,Z=ve+ue|0,J=te+me+(Z>>>0<ve>>>0?1:0)|0,te=oe,ve=Q,oe=G,Q=$,G=V,$=z,z=ue+xi|0,V=me+Ze+(z>>>0<ue>>>0?1:0)|0}P=d.low=P+z,d.high=q+V+(P>>>0<z>>>0?1:0),A=y.low=A+$,y.high=D+G+(A>>>0<$>>>0?1:0),m=w.low=m+Q,w.high=c+oe+(m>>>0<Q>>>0?1:0),g=_.low=g+ve,_.high=S+te+(g>>>0<ve>>>0?1:0),M=I.low=M+Z,I.high=E+J+(M>>>0<Z>>>0?1:0),R=N.low=R+se,N.high=T+Ce+(R>>>0<se>>>0?1:0),C=F.low=C+ft,F.high=x+re+(C>>>0<ft>>>0?1:0),L=O.low=L+be,O.high=K+_e+(L>>>0<be>>>0?1:0)},_doFinalize:function(){var u=this._data,h=u.words,b=this._nDataBytes*8,d=u.sigBytes*8;h[d>>>5]|=128<<24-d%32,h[(d+128>>>10<<5)+30]=Math.floor(b/4294967296),h[(d+128>>>10<<5)+31]=b,u.sigBytes=h.length*4,this._process();var y=this._hash.toX32();return y},clone:function(){var u=n.clone.call(this);return u._hash=this._hash.clone(),u},blockSize:1024/32});t.SHA512=n._createHelper(p),t.HmacSHA512=n._createHmacHelper(p)}(),e.SHA512})});var sw=U((v1,iw)=>{H();k();(function(e,t,r){typeof v1=="object"?iw.exports=v1=t(xt(),gu(),Lb()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./sha512"],t):t(e.CryptoJS)})(v1,function(e){return function(){var t=e,r=t.x64,n=r.Word,i=r.WordArray,s=t.algo,o=s.SHA512,a=s.SHA384=o.extend({_doReset:function(){this._hash=new i.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var f=o._doFinalize.call(this);return f.sigBytes-=16,f}});t.SHA384=o._createHelper(a),t.HmacSHA384=o._createHmacHelper(a)}(),e.SHA384})});var ow=U((b1,aw)=>{H();k();(function(e,t,r){typeof b1=="object"?aw.exports=b1=t(xt(),gu()):typeof define=="function"&&define.amd?define(["./core","./x64-core"],t):t(e.CryptoJS)})(b1,function(e){return function(t){var r=e,n=r.lib,i=n.WordArray,s=n.Hasher,o=r.x64,a=o.Word,f=r.algo,l=[],v=[],p=[];(function(){for(var b=1,d=0,y=0;y<24;y++){l[b+5*d]=(y+1)*(y+2)/2%64;var w=d%5,_=(2*b+3*d)%5;b=w,d=_}for(var b=0;b<5;b++)for(var d=0;d<5;d++)v[b+5*d]=d+(2*b+3*d)%5*5;for(var I=1,N=0;N<24;N++){for(var F=0,O=0,q=0;q<7;q++){if(I&1){var P=(1<<q)-1;P<32?O^=1<<P:F^=1<<P-32}I&128?I=I<<1^113:I<<=1}p[N]=a.create(F,O)}})();var u=[];(function(){for(var b=0;b<25;b++)u[b]=a.create()})();var h=f.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){for(var b=this._state=[],d=0;d<25;d++)b[d]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(b,d){for(var y=this._state,w=this.blockSize/2,_=0;_<w;_++){var I=b[d+2*_],N=b[d+2*_+1];I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,N=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360;var F=y[_];F.high^=N,F.low^=I}for(var O=0;O<24;O++){for(var q=0;q<5;q++){for(var P=0,D=0,A=0;A<5;A++){var F=y[q+5*A];P^=F.high,D^=F.low}var c=u[q];c.high=P,c.low=D}for(var q=0;q<5;q++)for(var m=u[(q+4)%5],S=u[(q+1)%5],g=S.high,E=S.low,P=m.high^(g<<1|E>>>31),D=m.low^(E<<1|g>>>31),A=0;A<5;A++){var F=y[q+5*A];F.high^=P,F.low^=D}for(var M=1;M<25;M++){var F=y[M],T=F.high,R=F.low,x=l[M];if(x<32)var P=T<<x|R>>>32-x,D=R<<x|T>>>32-x;else var P=R<<x-32|T>>>64-x,D=T<<x-32|R>>>64-x;var C=u[v[M]];C.high=P,C.low=D}var K=u[0],L=y[0];K.high=L.high,K.low=L.low;for(var q=0;q<5;q++)for(var A=0;A<5;A++){var M=q+5*A,F=y[M],V=u[M],z=u[(q+1)%5+5*A],G=u[(q+2)%5+5*A];F.high=V.high^~z.high&G.high,F.low=V.low^~z.low&G.low}var F=y[0],$=p[O];F.high^=$.high,F.low^=$.low}},_doFinalize:function(){var b=this._data,d=b.words,y=this._nDataBytes*8,w=b.sigBytes*8,_=this.blockSize*32;d[w>>>5]|=1<<24-w%32,d[(t.ceil((w+1)/_)*_>>>5)-1]|=128,b.sigBytes=d.length*4,this._process();for(var I=this._state,N=this.cfg.outputLength/8,F=N/8,O=[],q=0;q<F;q++){var P=I[q],D=P.high,A=P.low;D=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,O.push(A),O.push(D)}return new i.init(O,N)},clone:function(){for(var b=s.clone.call(this),d=b._state=this._state.slice(0),y=0;y<25;y++)d[y]=d[y].clone();return b}});r.SHA3=s._createHelper(h),r.HmacSHA3=s._createHmacHelper(h)}(Math),e.SHA3})});var cw=U((g1,fw)=>{H();k();(function(e,t){typeof g1=="object"?fw.exports=g1=t(xt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(g1,function(e){return function(t){var r=e,n=r.lib,i=n.WordArray,s=n.Hasher,o=r.algo,a=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),f=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),v=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=i.create([0,1518500249,1859775393,2400959708,2840853838]),u=i.create([1352829926,1548603684,1836072691,2053994217,0]),h=o.RIPEMD160=s.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(N,F){for(var O=0;O<16;O++){var q=F+O,P=N[q];N[q]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}var D=this._hash.words,A=p.words,c=u.words,m=a.words,S=f.words,g=l.words,E=v.words,M,T,R,x,C,K,L,V,z,G;K=M=D[0],L=T=D[1],V=R=D[2],z=x=D[3],G=C=D[4];for(var $,O=0;O<80;O+=1)$=M+N[F+m[O]]|0,O<16?$+=b(T,R,x)+A[0]:O<32?$+=d(T,R,x)+A[1]:O<48?$+=y(T,R,x)+A[2]:O<64?$+=w(T,R,x)+A[3]:$+=_(T,R,x)+A[4],$=$|0,$=I($,g[O]),$=$+C|0,M=C,C=x,x=I(R,10),R=T,T=$,$=K+N[F+S[O]]|0,O<16?$+=_(L,V,z)+c[0]:O<32?$+=w(L,V,z)+c[1]:O<48?$+=y(L,V,z)+c[2]:O<64?$+=d(L,V,z)+c[3]:$+=b(L,V,z)+c[4],$=$|0,$=I($,E[O]),$=$+G|0,K=G,G=z,z=I(V,10),V=L,L=$;$=D[1]+R+z|0,D[1]=D[2]+x+G|0,D[2]=D[3]+C+K|0,D[3]=D[4]+M+L|0,D[4]=D[0]+T+V|0,D[0]=$},_doFinalize:function(){var N=this._data,F=N.words,O=this._nDataBytes*8,q=N.sigBytes*8;F[q>>>5]|=128<<24-q%32,F[(q+64>>>9<<4)+14]=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360,N.sigBytes=(F.length+1)*4,this._process();for(var P=this._hash,D=P.words,A=0;A<5;A++){var c=D[A];D[A]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360}return P},clone:function(){var N=s.clone.call(this);return N._hash=this._hash.clone(),N}});function b(N,F,O){return N^F^O}function d(N,F,O){return N&F|~N&O}function y(N,F,O){return(N|~F)^O}function w(N,F,O){return N&O|F&~O}function _(N,F,O){return N^(F|~O)}function I(N,F){return N<<F|N>>>32-F}r.RIPEMD160=s._createHelper(h),r.HmacRIPEMD160=s._createHmacHelper(h)}(Math),e.RIPEMD160})});var x1=U((y1,uw)=>{H();k();(function(e,t){typeof y1=="object"?uw.exports=y1=t(xt()):typeof define=="function"&&define.amd?define(["./core"],t):t(e.CryptoJS)})(y1,function(e){(function(){var t=e,r=t.lib,n=r.Base,i=t.enc,s=i.Utf8,o=t.algo,a=o.HMAC=n.extend({init:function(f,l){f=this._hasher=new f.init,typeof l=="string"&&(l=s.parse(l));var v=f.blockSize,p=v*4;l.sigBytes>p&&(l=f.finalize(l)),l.clamp();for(var u=this._oKey=l.clone(),h=this._iKey=l.clone(),b=u.words,d=h.words,y=0;y<v;y++)b[y]^=1549556828,d[y]^=909522486;u.sigBytes=h.sigBytes=p,this.reset()},reset:function(){var f=this._hasher;f.reset(),f.update(this._iKey)},update:function(f){return this._hasher.update(f),this},finalize:function(f){var l=this._hasher,v=l.finalize(f);l.reset();var p=l.finalize(this._oKey.clone().concat(v));return p}})})()})});var hw=U((m1,dw)=>{H();k();(function(e,t,r){typeof m1=="object"?dw.exports=m1=t(xt(),d1(),x1()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],t):t(e.CryptoJS)})(m1,function(e){return function(){var t=e,r=t.lib,n=r.Base,i=r.WordArray,s=t.algo,o=s.SHA1,a=s.HMAC,f=s.PBKDF2=n.extend({cfg:n.extend({keySize:128/32,hasher:o,iterations:1}),init:function(l){this.cfg=this.cfg.extend(l)},compute:function(l,v){for(var p=this.cfg,u=a.create(p.hasher,l),h=i.create(),b=i.create([1]),d=h.words,y=b.words,w=p.keySize,_=p.iterations;d.length<w;){var I=u.update(v).finalize(b);u.reset();for(var N=I.words,F=N.length,O=I,q=1;q<_;q++){O=u.finalize(O),u.reset();for(var P=O.words,D=0;D<F;D++)N[D]^=P[D]}h.concat(I),y[0]++}return h.sigBytes=w*4,h}});t.PBKDF2=function(l,v,p){return f.create(p).compute(l,v)}}(),e.PBKDF2})});var Za=U((w1,lw)=>{H();k();(function(e,t,r){typeof w1=="object"?lw.exports=w1=t(xt(),d1(),x1()):typeof define=="function"&&define.amd?define(["./core","./sha1","./hmac"],t):t(e.CryptoJS)})(w1,function(e){return function(){var t=e,r=t.lib,n=r.Base,i=r.WordArray,s=t.algo,o=s.MD5,a=s.EvpKDF=n.extend({cfg:n.extend({keySize:128/32,hasher:o,iterations:1}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,l){for(var v=this.cfg,p=v.hasher.create(),u=i.create(),h=u.words,b=v.keySize,d=v.iterations;h.length<b;){y&&p.update(y);var y=p.update(f).finalize(l);p.reset();for(var w=1;w<d;w++)y=p.finalize(y),p.reset();u.concat(y)}return u.sigBytes=b*4,u}});t.EvpKDF=function(f,l,v){return a.create(v).compute(f,l)}}(),e.EvpKDF})});var Wr=U((S1,pw)=>{H();k();(function(e,t,r){typeof S1=="object"?pw.exports=S1=t(xt(),Za()):typeof define=="function"&&define.amd?define(["./core","./evpkdf"],t):t(e.CryptoJS)})(S1,function(e){e.lib.Cipher||function(t){var r=e,n=r.lib,i=n.Base,s=n.WordArray,o=n.BufferedBlockAlgorithm,a=r.enc,f=a.Utf8,l=a.Base64,v=r.algo,p=v.EvpKDF,u=n.Cipher=o.extend({cfg:i.extend(),createEncryptor:function(c,m){return this.create(this._ENC_XFORM_MODE,c,m)},createDecryptor:function(c,m){return this.create(this._DEC_XFORM_MODE,c,m)},init:function(c,m,S){this.cfg=this.cfg.extend(S),this._xformMode=c,this._key=m,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(c){return this._append(c),this._process()},finalize:function(c){c&&this._append(c);var m=this._doFinalize();return m},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function c(m){return typeof m=="string"?A:q}return function(m){return{encrypt:function(S,g,E){return c(g).encrypt(m,S,g,E)},decrypt:function(S,g,E){return c(g).decrypt(m,S,g,E)}}}}()}),h=n.StreamCipher=u.extend({_doFinalize:function(){var c=this._process(!0);return c},blockSize:1}),b=r.mode={},d=n.BlockCipherMode=i.extend({createEncryptor:function(c,m){return this.Encryptor.create(c,m)},createDecryptor:function(c,m){return this.Decryptor.create(c,m)},init:function(c,m){this._cipher=c,this._iv=m}}),y=b.CBC=function(){var c=d.extend();c.Encryptor=c.extend({processBlock:function(S,g){var E=this._cipher,M=E.blockSize;m.call(this,S,g,M),E.encryptBlock(S,g),this._prevBlock=S.slice(g,g+M)}}),c.Decryptor=c.extend({processBlock:function(S,g){var E=this._cipher,M=E.blockSize,T=S.slice(g,g+M);E.decryptBlock(S,g),m.call(this,S,g,M),this._prevBlock=T}});function m(S,g,E){var M=this._iv;if(M){var T=M;this._iv=t}else var T=this._prevBlock;for(var R=0;R<E;R++)S[g+R]^=T[R]}return c}(),w=r.pad={},_=w.Pkcs7={pad:function(c,m){for(var S=m*4,g=S-c.sigBytes%S,E=g<<24|g<<16|g<<8|g,M=[],T=0;T<g;T+=4)M.push(E);var R=s.create(M,g);c.concat(R)},unpad:function(c){var m=c.words[c.sigBytes-1>>>2]&255;c.sigBytes-=m}},I=n.BlockCipher=u.extend({cfg:u.cfg.extend({mode:y,padding:_}),reset:function(){u.reset.call(this);var c=this.cfg,m=c.iv,S=c.mode;if(this._xformMode==this._ENC_XFORM_MODE)var g=S.createEncryptor;else{var g=S.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==g?this._mode.init(this,m&&m.words):(this._mode=g.call(S,this,m&&m.words),this._mode.__creator=g)},_doProcessBlock:function(c,m){this._mode.processBlock(c,m)},_doFinalize:function(){var c=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){c.pad(this._data,this.blockSize);var m=this._process(!0)}else{var m=this._process(!0);c.unpad(m)}return m},blockSize:128/32}),N=n.CipherParams=i.extend({init:function(c){this.mixIn(c)},toString:function(c){return(c||this.formatter).stringify(this)}}),F=r.format={},O=F.OpenSSL={stringify:function(c){var m=c.ciphertext,S=c.salt;if(S)var g=s.create([1398893684,1701076831]).concat(S).concat(m);else var g=m;return g.toString(l)},parse:function(c){var m=l.parse(c),S=m.words;if(S[0]==1398893684&&S[1]==1701076831){var g=s.create(S.slice(2,4));S.splice(0,4),m.sigBytes-=16}return N.create({ciphertext:m,salt:g})}},q=n.SerializableCipher=i.extend({cfg:i.extend({format:O}),encrypt:function(c,m,S,g){g=this.cfg.extend(g);var E=c.createEncryptor(S,g),M=E.finalize(m),T=E.cfg;return N.create({ciphertext:M,key:S,iv:T.iv,algorithm:c,mode:T.mode,padding:T.padding,blockSize:c.blockSize,formatter:g.format})},decrypt:function(c,m,S,g){g=this.cfg.extend(g),m=this._parse(m,g.format);var E=c.createDecryptor(S,g).finalize(m.ciphertext);return E},_parse:function(c,m){return typeof c=="string"?m.parse(c,this):c}}),P=r.kdf={},D=P.OpenSSL={execute:function(c,m,S,g){g||(g=s.random(64/8));var E=p.create({keySize:m+S}).compute(c,g),M=s.create(E.words.slice(m),S*4);return E.sigBytes=m*4,N.create({key:E,iv:M,salt:g})}},A=n.PasswordBasedCipher=q.extend({cfg:q.cfg.extend({kdf:D}),encrypt:function(c,m,S,g){g=this.cfg.extend(g);var E=g.kdf.execute(S,c.keySize,c.ivSize);g.iv=E.iv;var M=q.encrypt.call(this,c,m,E.key,g);return M.mixIn(E),M},decrypt:function(c,m,S,g){g=this.cfg.extend(g),m=this._parse(m,g.format);var E=g.kdf.execute(S,c.keySize,c.ivSize,m.salt);g.iv=E.iv;var M=q.decrypt.call(this,c,m,E.key,g);return M}})}()})});var bw=U((E1,vw)=>{H();k();(function(e,t,r){typeof E1=="object"?vw.exports=E1=t(xt(),Wr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(E1,function(e){return e.mode.CFB=function(){var t=e.lib.BlockCipherMode.extend();t.Encryptor=t.extend({processBlock:function(n,i){var s=this._cipher,o=s.blockSize;r.call(this,n,i,o,s),this._prevBlock=n.slice(i,i+o)}}),t.Decryptor=t.extend({processBlock:function(n,i){var s=this._cipher,o=s.blockSize,a=n.slice(i,i+o);r.call(this,n,i,o,s),this._prevBlock=a}});function r(n,i,s,o){var a=this._iv;if(a){var f=a.slice(0);this._iv=void 0}else var f=this._prevBlock;o.encryptBlock(f,0);for(var l=0;l<s;l++)n[i+l]^=f[l]}return t}(),e.mode.CFB})});var yw=U((_1,gw)=>{H();k();(function(e,t,r){typeof _1=="object"?gw.exports=_1=t(xt(),Wr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(_1,function(e){return e.mode.CTR=function(){var t=e.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(n,i){var s=this._cipher,o=s.blockSize,a=this._iv,f=this._counter;a&&(f=this._counter=a.slice(0),this._iv=void 0);var l=f.slice(0);s.encryptBlock(l,0),f[o-1]=f[o-1]+1|0;for(var v=0;v<o;v++)n[i+v]^=l[v]}});return t.Decryptor=r,t}(),e.mode.CTR})});var mw=U((A1,xw)=>{H();k();(function(e,t,r){typeof A1=="object"?xw.exports=A1=t(xt(),Wr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(A1,function(e){return e.mode.CTRGladman=function(){var t=e.lib.BlockCipherMode.extend();function r(s){if((s>>24&255)===255){var o=s>>16&255,a=s>>8&255,f=s&255;o===255?(o=0,a===255?(a=0,f===255?f=0:++f):++a):++o,s=0,s+=o<<16,s+=a<<8,s+=f}else s+=1<<24;return s}function n(s){return(s[0]=r(s[0]))===0&&(s[1]=r(s[1])),s}var i=t.Encryptor=t.extend({processBlock:function(s,o){var a=this._cipher,f=a.blockSize,l=this._iv,v=this._counter;l&&(v=this._counter=l.slice(0),this._iv=void 0),n(v);var p=v.slice(0);a.encryptBlock(p,0);for(var u=0;u<f;u++)s[o+u]^=p[u]}});return t.Decryptor=i,t}(),e.mode.CTRGladman})});var Sw=U((B1,ww)=>{H();k();(function(e,t,r){typeof B1=="object"?ww.exports=B1=t(xt(),Wr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(B1,function(e){return e.mode.OFB=function(){var t=e.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(n,i){var s=this._cipher,o=s.blockSize,a=this._iv,f=this._keystream;a&&(f=this._keystream=a.slice(0),this._iv=void 0),s.encryptBlock(f,0);for(var l=0;l<o;l++)n[i+l]^=f[l]}});return t.Decryptor=r,t}(),e.mode.OFB})});var _w=U((P1,Ew)=>{H();k();(function(e,t,r){typeof P1=="object"?Ew.exports=P1=t(xt(),Wr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(P1,function(e){return e.mode.ECB=function(){var t=e.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(r,n){this._cipher.encryptBlock(r,n)}}),t.Decryptor=t.extend({processBlock:function(r,n){this._cipher.decryptBlock(r,n)}}),t}(),e.mode.ECB})});var Bw=U((I1,Aw)=>{H();k();(function(e,t,r){typeof I1=="object"?Aw.exports=I1=t(xt(),Wr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(I1,function(e){return e.pad.AnsiX923={pad:function(t,r){var n=t.sigBytes,i=r*4,s=i-n%i,o=n+s-1;t.clamp(),t.words[o>>>2]|=s<<24-o%4*8,t.sigBytes+=s},unpad:function(t){var r=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=r}},e.pad.Ansix923})});var Iw=U((M1,Pw)=>{H();k();(function(e,t,r){typeof M1=="object"?Pw.exports=M1=t(xt(),Wr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(M1,function(e){return e.pad.Iso10126={pad:function(t,r){var n=r*4,i=n-t.sigBytes%n;t.concat(e.lib.WordArray.random(i-1)).concat(e.lib.WordArray.create([i<<24],1))},unpad:function(t){var r=t.words[t.sigBytes-1>>>2]&255;t.sigBytes-=r}},e.pad.Iso10126})});var Cw=U((C1,Mw)=>{H();k();(function(e,t,r){typeof C1=="object"?Mw.exports=C1=t(xt(),Wr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(C1,function(e){return e.pad.Iso97971={pad:function(t,r){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,r)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971})});var Nw=U((F1,Fw)=>{H();k();(function(e,t,r){typeof F1=="object"?Fw.exports=F1=t(xt(),Wr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(F1,function(e){return e.pad.ZeroPadding={pad:function(t,r){var n=r*4;t.clamp(),t.sigBytes+=n-(t.sigBytes%n||n)},unpad:function(t){for(var r=t.words,n=t.sigBytes-1;!(r[n>>>2]>>>24-n%4*8&255);)n--;t.sigBytes=n+1}},e.pad.ZeroPadding})});var Ow=U((N1,Rw)=>{H();k();(function(e,t,r){typeof N1=="object"?Rw.exports=N1=t(xt(),Wr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(N1,function(e){return e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding})});var Tw=U((R1,Dw)=>{H();k();(function(e,t,r){typeof R1=="object"?Dw.exports=R1=t(xt(),Wr()):typeof define=="function"&&define.amd?define(["./core","./cipher-core"],t):t(e.CryptoJS)})(R1,function(e){return function(t){var r=e,n=r.lib,i=n.CipherParams,s=r.enc,o=s.Hex,a=r.format,f=a.Hex={stringify:function(l){return l.ciphertext.toString(o)},parse:function(l){var v=o.parse(l);return i.create({ciphertext:v})}}}(),e.format.Hex})});var Hw=U((O1,qw)=>{H();k();(function(e,t,r){typeof O1=="object"?qw.exports=O1=t(xt(),po(),vo(),Za(),Wr()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(O1,function(e){return function(){var t=e,r=t.lib,n=r.BlockCipher,i=t.algo,s=[],o=[],a=[],f=[],l=[],v=[],p=[],u=[],h=[],b=[];(function(){for(var w=[],_=0;_<256;_++)_<128?w[_]=_<<1:w[_]=_<<1^283;for(var I=0,N=0,_=0;_<256;_++){var F=N^N<<1^N<<2^N<<3^N<<4;F=F>>>8^F&255^99,s[I]=F,o[F]=I;var O=w[I],q=w[O],P=w[q],D=w[F]*257^F*16843008;a[I]=D<<24|D>>>8,f[I]=D<<16|D>>>16,l[I]=D<<8|D>>>24,v[I]=D;var D=P*16843009^q*65537^O*257^I*16843008;p[F]=D<<24|D>>>8,u[F]=D<<16|D>>>16,h[F]=D<<8|D>>>24,b[F]=D,I?(I=O^w[w[w[P^O]]],N^=w[w[N]]):I=N=1}})();var d=[0,1,2,4,8,16,32,64,128,27,54],y=i.AES=n.extend({_doReset:function(){if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var w=this._keyPriorReset=this._key,_=w.words,I=w.sigBytes/4,N=this._nRounds=I+6,F=(N+1)*4,O=this._keySchedule=[],q=0;q<F;q++)if(q<I)O[q]=_[q];else{var P=O[q-1];q%I?I>6&&q%I==4&&(P=s[P>>>24]<<24|s[P>>>16&255]<<16|s[P>>>8&255]<<8|s[P&255]):(P=P<<8|P>>>24,P=s[P>>>24]<<24|s[P>>>16&255]<<16|s[P>>>8&255]<<8|s[P&255],P^=d[q/I|0]<<24),O[q]=O[q-I]^P}for(var D=this._invKeySchedule=[],A=0;A<F;A++){var q=F-A;if(A%4)var P=O[q];else var P=O[q-4];A<4||q<=4?D[A]=P:D[A]=p[s[P>>>24]]^u[s[P>>>16&255]]^h[s[P>>>8&255]]^b[s[P&255]]}}},encryptBlock:function(w,_){this._doCryptBlock(w,_,this._keySchedule,a,f,l,v,s)},decryptBlock:function(w,_){var I=w[_+1];w[_+1]=w[_+3],w[_+3]=I,this._doCryptBlock(w,_,this._invKeySchedule,p,u,h,b,o);var I=w[_+1];w[_+1]=w[_+3],w[_+3]=I},_doCryptBlock:function(w,_,I,N,F,O,q,P){for(var D=this._nRounds,A=w[_]^I[0],c=w[_+1]^I[1],m=w[_+2]^I[2],S=w[_+3]^I[3],g=4,E=1;E<D;E++){var M=N[A>>>24]^F[c>>>16&255]^O[m>>>8&255]^q[S&255]^I[g++],T=N[c>>>24]^F[m>>>16&255]^O[S>>>8&255]^q[A&255]^I[g++],R=N[m>>>24]^F[S>>>16&255]^O[A>>>8&255]^q[c&255]^I[g++],x=N[S>>>24]^F[A>>>16&255]^O[c>>>8&255]^q[m&255]^I[g++];A=M,c=T,m=R,S=x}var M=(P[A>>>24]<<24|P[c>>>16&255]<<16|P[m>>>8&255]<<8|P[S&255])^I[g++],T=(P[c>>>24]<<24|P[m>>>16&255]<<16|P[S>>>8&255]<<8|P[A&255])^I[g++],R=(P[m>>>24]<<24|P[S>>>16&255]<<16|P[A>>>8&255]<<8|P[c&255])^I[g++],x=(P[S>>>24]<<24|P[A>>>16&255]<<16|P[c>>>8&255]<<8|P[m&255])^I[g++];w[_]=M,w[_+1]=T,w[_+2]=R,w[_+3]=x},keySize:256/32});t.AES=n._createHelper(y)}(),e.AES})});var jw=U((D1,kw)=>{H();k();(function(e,t,r){typeof D1=="object"?kw.exports=D1=t(xt(),po(),vo(),Za(),Wr()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(D1,function(e){return function(){var t=e,r=t.lib,n=r.WordArray,i=r.BlockCipher,s=t.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],f=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],v=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=s.DES=i.extend({_doReset:function(){for(var d=this._key,y=d.words,w=[],_=0;_<56;_++){var I=o[_]-1;w[_]=y[I>>>5]>>>31-I%32&1}for(var N=this._subKeys=[],F=0;F<16;F++){for(var O=N[F]=[],q=f[F],_=0;_<24;_++)O[_/6|0]|=w[(a[_]-1+q)%28]<<31-_%6,O[4+(_/6|0)]|=w[28+(a[_+24]-1+q)%28]<<31-_%6;O[0]=O[0]<<1|O[0]>>>31;for(var _=1;_<7;_++)O[_]=O[_]>>>(_-1)*4+3;O[7]=O[7]<<5|O[7]>>>27}for(var P=this._invSubKeys=[],_=0;_<16;_++)P[_]=N[15-_]},encryptBlock:function(d,y){this._doCryptBlock(d,y,this._subKeys)},decryptBlock:function(d,y){this._doCryptBlock(d,y,this._invSubKeys)},_doCryptBlock:function(d,y,w){this._lBlock=d[y],this._rBlock=d[y+1],u.call(this,4,252645135),u.call(this,16,65535),h.call(this,2,858993459),h.call(this,8,16711935),u.call(this,1,1431655765);for(var _=0;_<16;_++){for(var I=w[_],N=this._lBlock,F=this._rBlock,O=0,q=0;q<8;q++)O|=l[q][((F^I[q])&v[q])>>>0];this._lBlock=F,this._rBlock=N^O}var P=this._lBlock;this._lBlock=this._rBlock,this._rBlock=P,u.call(this,1,1431655765),h.call(this,8,16711935),h.call(this,2,858993459),u.call(this,16,65535),u.call(this,4,252645135),d[y]=this._lBlock,d[y+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function u(d,y){var w=(this._lBlock>>>d^this._rBlock)&y;this._rBlock^=w,this._lBlock^=w<<d}function h(d,y){var w=(this._rBlock>>>d^this._lBlock)&y;this._lBlock^=w,this._rBlock^=w<<d}t.DES=i._createHelper(p);var b=s.TripleDES=i.extend({_doReset:function(){var d=this._key,y=d.words;this._des1=p.createEncryptor(n.create(y.slice(0,2))),this._des2=p.createEncryptor(n.create(y.slice(2,4))),this._des3=p.createEncryptor(n.create(y.slice(4,6)))},encryptBlock:function(d,y){this._des1.encryptBlock(d,y),this._des2.decryptBlock(d,y),this._des3.encryptBlock(d,y)},decryptBlock:function(d,y){this._des3.decryptBlock(d,y),this._des2.encryptBlock(d,y),this._des1.decryptBlock(d,y)},keySize:192/32,ivSize:64/32,blockSize:64/32});t.TripleDES=i._createHelper(b)}(),e.TripleDES})});var Kw=U((T1,Lw)=>{H();k();(function(e,t,r){typeof T1=="object"?Lw.exports=T1=t(xt(),po(),vo(),Za(),Wr()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(T1,function(e){return function(){var t=e,r=t.lib,n=r.StreamCipher,i=t.algo,s=i.RC4=n.extend({_doReset:function(){for(var f=this._key,l=f.words,v=f.sigBytes,p=this._S=[],u=0;u<256;u++)p[u]=u;for(var u=0,h=0;u<256;u++){var b=u%v,d=l[b>>>2]>>>24-b%4*8&255;h=(h+p[u]+d)%256;var y=p[u];p[u]=p[h],p[h]=y}this._i=this._j=0},_doProcessBlock:function(f,l){f[l]^=o.call(this)},keySize:256/32,ivSize:0});function o(){for(var f=this._S,l=this._i,v=this._j,p=0,u=0;u<4;u++){l=(l+1)%256,v=(v+f[l])%256;var h=f[l];f[l]=f[v],f[v]=h,p|=f[(f[l]+f[v])%256]<<24-u*8}return this._i=l,this._j=v,p}t.RC4=n._createHelper(s);var a=i.RC4Drop=s.extend({cfg:s.cfg.extend({drop:192}),_doReset:function(){s._doReset.call(this);for(var f=this.cfg.drop;f>0;f--)o.call(this)}});t.RC4Drop=n._createHelper(a)}(),e.RC4})});var Vw=U((q1,Uw)=>{H();k();(function(e,t,r){typeof q1=="object"?Uw.exports=q1=t(xt(),po(),vo(),Za(),Wr()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(q1,function(e){return function(){var t=e,r=t.lib,n=r.StreamCipher,i=t.algo,s=[],o=[],a=[],f=i.Rabbit=n.extend({_doReset:function(){for(var v=this._key.words,p=this.cfg.iv,u=0;u<4;u++)v[u]=(v[u]<<8|v[u]>>>24)&16711935|(v[u]<<24|v[u]>>>8)&4278255360;var h=this._X=[v[0],v[3]<<16|v[2]>>>16,v[1],v[0]<<16|v[3]>>>16,v[2],v[1]<<16|v[0]>>>16,v[3],v[2]<<16|v[1]>>>16],b=this._C=[v[2]<<16|v[2]>>>16,v[0]&4294901760|v[1]&65535,v[3]<<16|v[3]>>>16,v[1]&4294901760|v[2]&65535,v[0]<<16|v[0]>>>16,v[2]&4294901760|v[3]&65535,v[1]<<16|v[1]>>>16,v[3]&4294901760|v[0]&65535];this._b=0;for(var u=0;u<4;u++)l.call(this);for(var u=0;u<8;u++)b[u]^=h[u+4&7];if(p){var d=p.words,y=d[0],w=d[1],_=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,I=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,N=_>>>16|I&4294901760,F=I<<16|_&65535;b[0]^=_,b[1]^=N,b[2]^=I,b[3]^=F,b[4]^=_,b[5]^=N,b[6]^=I,b[7]^=F;for(var u=0;u<4;u++)l.call(this)}},_doProcessBlock:function(v,p){var u=this._X;l.call(this),s[0]=u[0]^u[5]>>>16^u[3]<<16,s[1]=u[2]^u[7]>>>16^u[5]<<16,s[2]=u[4]^u[1]>>>16^u[7]<<16,s[3]=u[6]^u[3]>>>16^u[1]<<16;for(var h=0;h<4;h++)s[h]=(s[h]<<8|s[h]>>>24)&16711935|(s[h]<<24|s[h]>>>8)&4278255360,v[p+h]^=s[h]},blockSize:128/32,ivSize:64/32});function l(){for(var v=this._X,p=this._C,u=0;u<8;u++)o[u]=p[u];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<o[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<o[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<o[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<o[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<o[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<o[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<o[6]>>>0?1:0)|0,this._b=p[7]>>>0<o[7]>>>0?1:0;for(var u=0;u<8;u++){var h=v[u]+p[u],b=h&65535,d=h>>>16,y=((b*b>>>17)+b*d>>>15)+d*d,w=((h&4294901760)*h|0)+((h&65535)*h|0);a[u]=y^w}v[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,v[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,v[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,v[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,v[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,v[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,v[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,v[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}t.Rabbit=n._createHelper(f)}(),e.Rabbit})});var Ww=U((H1,zw)=>{H();k();(function(e,t,r){typeof H1=="object"?zw.exports=H1=t(xt(),po(),vo(),Za(),Wr()):typeof define=="function"&&define.amd?define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],t):t(e.CryptoJS)})(H1,function(e){return function(){var t=e,r=t.lib,n=r.StreamCipher,i=t.algo,s=[],o=[],a=[],f=i.RabbitLegacy=n.extend({_doReset:function(){var v=this._key.words,p=this.cfg.iv,u=this._X=[v[0],v[3]<<16|v[2]>>>16,v[1],v[0]<<16|v[3]>>>16,v[2],v[1]<<16|v[0]>>>16,v[3],v[2]<<16|v[1]>>>16],h=this._C=[v[2]<<16|v[2]>>>16,v[0]&4294901760|v[1]&65535,v[3]<<16|v[3]>>>16,v[1]&4294901760|v[2]&65535,v[0]<<16|v[0]>>>16,v[2]&4294901760|v[3]&65535,v[1]<<16|v[1]>>>16,v[3]&4294901760|v[0]&65535];this._b=0;for(var b=0;b<4;b++)l.call(this);for(var b=0;b<8;b++)h[b]^=u[b+4&7];if(p){var d=p.words,y=d[0],w=d[1],_=(y<<8|y>>>24)&16711935|(y<<24|y>>>8)&4278255360,I=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,N=_>>>16|I&4294901760,F=I<<16|_&65535;h[0]^=_,h[1]^=N,h[2]^=I,h[3]^=F,h[4]^=_,h[5]^=N,h[6]^=I,h[7]^=F;for(var b=0;b<4;b++)l.call(this)}},_doProcessBlock:function(v,p){var u=this._X;l.call(this),s[0]=u[0]^u[5]>>>16^u[3]<<16,s[1]=u[2]^u[7]>>>16^u[5]<<16,s[2]=u[4]^u[1]>>>16^u[7]<<16,s[3]=u[6]^u[3]>>>16^u[1]<<16;for(var h=0;h<4;h++)s[h]=(s[h]<<8|s[h]>>>24)&16711935|(s[h]<<24|s[h]>>>8)&4278255360,v[p+h]^=s[h]},blockSize:128/32,ivSize:64/32});function l(){for(var v=this._X,p=this._C,u=0;u<8;u++)o[u]=p[u];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<o[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<o[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<o[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<o[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<o[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<o[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<o[6]>>>0?1:0)|0,this._b=p[7]>>>0<o[7]>>>0?1:0;for(var u=0;u<8;u++){var h=v[u]+p[u],b=h&65535,d=h>>>16,y=((b*b>>>17)+b*d>>>15)+d*d,w=((h&4294901760)*h|0)+((h&65535)*h|0);a[u]=y^w}v[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,v[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,v[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,v[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,v[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,v[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,v[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,v[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}t.RabbitLegacy=n._createHelper(f)}(),e.RabbitLegacy})});var Gw=U((k1,$w)=>{H();k();(function(e,t,r){typeof k1=="object"?$w.exports=k1=t(xt(),gu(),G9(),Z9(),po(),vo(),d1(),jb(),rw(),Lb(),sw(),ow(),cw(),x1(),hw(),Za(),Wr(),bw(),yw(),mw(),Sw(),_w(),Bw(),Iw(),Cw(),Nw(),Ow(),Tw(),Hw(),jw(),Kw(),Vw(),Ww()):typeof define=="function"&&define.amd?define(["./core","./x64-core","./lib-typedarrays","./enc-utf16","./enc-base64","./md5","./sha1","./sha256","./sha224","./sha512","./sha384","./sha3","./ripemd160","./hmac","./pbkdf2","./evpkdf","./cipher-core","./mode-cfb","./mode-ctr","./mode-ctr-gladman","./mode-ofb","./mode-ecb","./pad-ansix923","./pad-iso10126","./pad-iso97971","./pad-zeropadding","./pad-nopadding","./format-hex","./aes","./tripledes","./rc4","./rabbit","./rabbit-legacy"],t):e.CryptoJS=t(e.CryptoJS)})(k1,function(e){return e})});var Xw=U(li=>{"use strict";H();k();var DK=li&&li.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),TK=li&&li.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),qK=li&&li.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&DK(t,e,r);return TK(t,e),t};Object.defineProperty(li,"__esModule",{value:!0});li.decrypt=li.encrypt=void 0;var Us=qK(Gw());function HK(e,t){let r=Us.enc.Utf8.parse(t);return Us.AES.encrypt(e,r,{iv:r,mode:Us.mode.CBC,padding:Us.pad.Pkcs7}).toString()}li.encrypt=HK;function kK(e,t){let r=Us.enc.Utf8.parse(t);return Us.AES.decrypt(e,r,{iv:r,mode:Us.mode.CBC,padding:Us.pad.Pkcs7}).toString(Us.enc.Utf8)}li.decrypt=kK});var Yw=U(Lt=>{"use strict";H();k();var jK=Lt&&Lt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),LK=Lt&&Lt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),KK=Lt&&Lt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&jK(t,e,r);return LK(t,e),t};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.wrapPEM=Lt.unwrapPEM=Lt.covertPublicKeyFromPkcs8ToPkcs1=Lt.covertPublicKeyFromPkcs8ToPkix=Lt.genKeyPair=Lt.decodeAny=Lt.encodeAny=Lt.decode=Lt.encode=void 0;var vt=KK(Ib()),UK=vt.BigInteger,j1=Hb(),VK=kb();function Kb(e,t){let r=vt.KJUR.crypto.Cipher.encrypt(e,t,"RSA");return(0,j1.fromHex)(r)}Lt.encode=Kb;function Ub(e,t){return vt.KJUR.crypto.Cipher.decrypt(e,t,"RSA")}Lt.decode=Ub;function zK(e,t){let r=XK(t),n=Math.floor((r.n.bitLength()+7)/8),i=e.length,s=0,o=n-11,a=[];for(;;){if(s+o>=i){let l=Kb(e.slice(s),r);a.push(l);break}let f=Kb(e.slice(s,s+o),r);a.push(f),s+=o}return vt.hextob64((0,j1.toHex)(j.Buffer.concat(a)))}Lt.encodeAny=zK;function WK(e,t){let r=vt.RSAKey.getHexValueArrayOfChildrenFromHex(vt.b64tohex(t)),n=new vt.RSAKey;n.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8]);let i=Math.floor((n.n.bitLength()+7)/8),s=(0,VK.fromBase64)(e),o=s.length,a=0,f=[];for(;;){if(a+i>=o){let v=Ub((0,j1.toHex)(s.slice(a)),n);f.push(v);break}let l=Ub((0,j1.toHex)(s.slice(a,a+i)),n);f.push(l),a+=i}return f.join("")}Lt.decodeAny=WK;function $K(e){let t=vt.KEYUTIL.generateKeypair("RSA",e),r=vt.KEYUTIL.getPEM(t.prvKeyObj,"PKCS1PRV"),n=vt.KEYUTIL.getPEM(t.pubKeyObj),i=Zw(Vb(n,!0));return{privateKey:Vb(r,!1),publicKey:i}}Lt.genKeyPair=$K;function GK(e){let t=vt.KEYUTIL.getKey(zb(e,!0)),r=new vt.KJUR.asn1.DERSequence({array:[new vt.KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new vt.KJUR.asn1.DERNull]}),n=new vt.KJUR.asn1.DERSequence({array:[new vt.KJUR.asn1.DERInteger({bigint:t.n}),new vt.KJUR.asn1.DERInteger({int:t.e})]}),i=new vt.KJUR.asn1.DERBitString({hex:"00"+n.getEncodedHex()}),s=new vt.KJUR.asn1.DERSequence({array:[r,i]});return vt.hextob64(s.getEncodedHex())}Lt.covertPublicKeyFromPkcs8ToPkix=GK;function Zw(e){let t=vt.KEYUTIL.getKey(zb(e,!0)),r=new vt.KJUR.asn1.DERSequence({array:[new vt.KJUR.asn1.DERInteger({bigint:t.n}),new vt.KJUR.asn1.DERInteger({int:t.e})]});return vt.hextob64(r.getEncodedHex())}Lt.covertPublicKeyFromPkcs8ToPkcs1=Zw;function XK(e){let t=vt.b64tohex(e);if(!vt.ASN1HEX.isASN1HEX(t))throw new Error("keyHex is not ASN.1 hex string");let r=vt.ASN1HEX.getChildIdx(t,0),n=new vt.RSAKey,i=vt.ASN1HEX.getV(t,r[0]);n.n=new UK(i,16);let s=vt.ASN1HEX.getV(t,r[1]);return n.e=parseInt(s,16),n.isPublic=!0,n.isPrivate=!1,n}function Vb(e,t){let r=t?"PUBLIC KEY":"RSA PRIVATE KEY";return vt.hextob64(vt.pemtohex(e,r))}Lt.unwrapPEM=Vb;function zb(e,t){let r=t?"PUBLIC KEY":"RSA PRIVATE KEY";return vt.hextopem(vt.b64tohex(e),r)}Lt.wrapPEM=zb});var Wb=U(xn=>{"use strict";H();k();var Jw=xn&&xn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),ZK=xn&&xn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Qw=xn&&xn.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Jw(t,e,r)},eS=xn&&xn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Jw(t,e,r);return ZK(t,e),t};Object.defineProperty(xn,"__esModule",{value:!0});xn.rsa=xn.aes=void 0;Qw(Hb(),xn);Qw(kb(),xn);xn.aes=eS(Xw());xn.rsa=eS(Yw())});var nS=U(pi=>{"use strict";H();k();Object.defineProperty(pi,"__esModule",{value:!0});pi.RSADecodeQRCodeInfo=pi.RSAEncodeQRCodeInfo=pi.GenRSAKeyForQRCode=pi.AesDecodeQRCodeInfo=pi.AesEncodeQRCodeInfo=void 0;var $b=ta(),Vf=Wb(),tS=$b.base.md5.encode("1677594506944"),YK=2048;function JK(e,t){if(e.length===0)throw new Error("message is empty");if(t.length===0)throw new Error("accountId is empty");let r=rS(t);return Vf.aes.encrypt(e,r)}pi.AesEncodeQRCodeInfo=JK;function QK(e,t){if(e.length===0)throw new Error("secret is empty");if(t.length===0)throw new Error("accountId is empty");let r=rS(t);return Vf.aes.decrypt(e,r)}pi.AesDecodeQRCodeInfo=QK;async function eU(){return Promise.resolve(Vf.rsa.genKeyPair(YK))}pi.GenRSAKeyForQRCode=eU;async function tU(e,t){return Promise.resolve(Vf.rsa.encodeAny(e,t))}pi.RSAEncodeQRCodeInfo=tU;async function rU(e,t){return Promise.resolve(Vf.rsa.decodeAny(e,t))}pi.RSADecodeQRCodeInfo=rU;function rS(e){let t=Vf.aes.encrypt(e,$b.base.md5.encode(tS));return $b.base.md5.encode(tS+t)}});var iS=U(L1=>{"use strict";H();k();Object.defineProperty(L1,"__esModule",{value:!0});L1.getCoinHexKeyStringFromShareString=void 0;var Gb=Hi();async function nU(e,t){let r=(0,Gb.JsonParseBigInt)(e),n=BigInt(r.ecdsaShare2.ShareI.toString()),i=n.toString(16);if(t&&t.length==3){let s=r.ecdsaShare2.ChainCode.toString(),o=new Gb.ECPoint(r.ecdsaShare2.PublicKey.Curve,BigInt(r.ecdsaShare2.PublicKey.X.toString()),BigInt(r.ecdsaShare2.PublicKey.Y.toString())),[a,f]=await(0,Gb.bip32Derive)([t[0],t[1],t[2]],n,o,s);i=a.toString(16)}return i.length%2==1&&(i="0"+i),i}L1.getCoinHexKeyStringFromShareString=nU});var sS=U(vi=>{"use strict";H();k();var iU=vi&&vi.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),zf=vi&&vi.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&iU(t,e,r)};Object.defineProperty(vi,"__esModule",{value:!0});zf(Db(),vi);zf(L9(),vi);zf(K9(),vi);zf(nS(),vi);zf(Fb(),vi);zf(iS(),vi)});var aS=U(K1=>{"use strict";H();k();Object.defineProperty(K1,"__esModule",{value:!0});K1.getMidKey=void 0;var Xb=Hi(),sU=ta();function aU(e){return e.startsWith("0x")&&(e=e.substring(2)),j.Buffer.from(e,"hex")}async function oU(e,t){let r=(0,Xb.JsonParseBigInt)(e),n=r.ecdsaShare2.PublicKey,i=r.ecdsaShare2.ChainCode,s=new Xb.ECPoint(n.Curve,BigInt(n.X.toString()),BigInt(n.Y.toString())),[o,a]=await(0,Xb.bip32Derive)([0,t.valueOf(),0],0n,s,i,0),f=a.toHex(),l=aU(f);return sU.base.sha256(l)}K1.getMidKey=oU});var U9=U(mn=>{H();k();var oS=mn&&mn.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),fU=mn&&mn.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),U1=mn&&mn.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&oS(t,e,r)},cU=mn&&mn.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&oS(t,e,r);return fU(t,e),t};Object.defineProperty(mn,"__esModule",{value:!0});mn.base=void 0;U1(Sd(),mn);U1(sS(),mn);U1(go(),mn);U1(aS(),mn);mn.base=cU(Wb())});export default U9();

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=dist-RJE7TYEC.js.map
