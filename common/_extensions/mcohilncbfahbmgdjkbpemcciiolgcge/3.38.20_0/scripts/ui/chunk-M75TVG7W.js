import{a as R,b as ie}from"./chunk-YXS5E7TI.js";import{C as X,Fb as oe,Kb as E,Wa as Z,Xa as _,Ya as $,Za as ee,bb as te,ob as b,sb as ne,y as M,zb as re}from"./chunk-NTISK7TT.js";import{na as q,oa as Te}from"./chunk-KSCBZ3RY.js";import{Gb as x,Ib as S,Lb as Y,Nb as W,Oc as Ue,Pb as P,fc as j,zc as G}from"./chunk-YILNSICT.js";import{ja as U,pa as Q}from"./chunk-LBCQTFOD.js";import{f as w,m as l,o as u}from"./chunk-UGZFXKPB.js";l();u();function ae(e){return Object.keys(e).sort().reduce((t,n)=>(t[n]=e[n]instanceof Object?ae(e[n]):e[n],t),{})}function Je(e){let t=ae(e);return JSON.stringify(t)}function Qe(e){if(!e||typeof e!="object")return null;let t={...e};for(let n in t)(t[n]===null||t[n]===void 0)&&delete t[n];return t}function se({coins:e,walletId:t,walletIdentityMap:n,createdMap:r}){let o=r[t]||[],s=new Set(o.map(({coinId:a})=>a));return e.reduce((a,i)=>{let{coinId:c,baseCoinId:y}=i;return(typeof c>"u"&&typeof y>"u"||(s.has(y)||s.has(c))&&R({coin:i,walletIdentity:n[t]}))&&a.push(i),a},[])}l();u();Q();var h=w(M());l();u();Q();j();l();u();var ce=e=>({...e,currencyAmount:"0",currencyAmountUSD:"0",coinAmount:"0",coinAmountInt:"0"});function K(e,t,n){let r=null,o=t[e.coinId];e.coinAmount==="0"||o=="0"?r="0":typeof o<"u"&&(r=x(e.coinAmount,o)),e.currencyAmountUSD=r??e.currencyAmountUSD,e.currencyAmount=x(e.currencyAmountUSD,n?.usdToThisRate??"1")}function F(e,t,{sort:n=!0}={}){let r=[],o=[];e.forEach(a=>{let i={...a};if(i.childrenCoin){if(i.childrenCoin.filter(y=>t(y,i.default)).length===0){o.push(i);return}r.push(i)}else{if(!t(i,i.default)){o.push(i);return}r.push(i)}});let s=(a,i)=>P(i.currencyAmount,a.currencyAmount)?P(i.coinAmount,a.coinAmount)?W(a.rank,i.rank)?1:-1:W(i.coinAmount,a.coinAmount)?1:-1:W(i.currencyAmount,a.currencyAmount)?1:-1;return n?(r.sort(s),o.sort(s),{results:r,uselessResults:o}):{results:r,uselessResults:o}}var We=[];function le(e,t,n,{walletIdentityMap:r,createdMap:o,walletId:s}){if(!e[t])return We;let a=e[t]??{},i=a.coins?[...a.coins]:[],c=i.reduce((m,p)=>(m.set(p.aggregation?p.symbol:p.coinId,p),m),new Map),y=se({coins:n,walletId:s,walletIdentityMap:r,createdMap:o}),d=new Map,C=[];return y.forEach(m=>{let p=ce(m);if(m.aggregation){if(!d.get(m.symbol)){let T={...p,childrenCoin:[]};d.set(m.symbol,T),C.push(T)}d.get(m.symbol).childrenCoin.push(p)}else C.push(p)}),C.forEach(m=>{let p=c.get(m.aggregation?m.symbol:m.coinId);p?p.aggregation&&(p.childrenCoin=U(p.childrenCoin,m.childrenCoin,"coinId")):i.push(m)}),i}l();u();Te();var Re=q({name:"currencySlice",initialState:{coinToUSDRate:{}},reducers:{updateCoinToUSDRate(e,t){e.coinToUSDRate=t.payload}}}),ke={},ue=e=>e.currencySlice.coinToUSDRate||ke,{actions:Oe,reducer:Pe}=Re,{updateCoinToUSDRate:st}=Oe,ct=Pe;Ue();j();var I=(e,t)=>t??b(e),je=(0,h.createSelector)(e=>e.keyring.keyringIdentities,I,(e,t)=>{let n;for(let r=0;r<e.length;r++){let o=e[r];if(o.walletIdentities.find(s=>s.walletId===t)){n=o.keyringIdentityType;break}}return n===G.PRIVATE_KEY}),Ee=(0,h.createSelector)(e=>{let{createdMap:t={}}=e.metamask;return t},I,je,E,(e,t,n,r)=>{if(!n)return new Set([]);let o=e[t]||[];return new Set(o.map(({coinId:a})=>a))}),v=(0,h.createSelector)(Ee,E,(e,t)=>t.filter(n=>e.has(n.coinId))),N=te(e=>({keyringIdentities:e.keyring.keyringIdentities,createdMap:e.metamask.createdMap}),I,(e,t)=>{let{keyringIdentities:n,createdMap:r}=e;return{walletIdentityMap:ne({keyring:{keyringIdentities:n}}),createdMap:r,walletId:t}}),L=(0,h.createSelector)(I,Z,(e,t)=>t?.[e]??[]),me=(0,h.createSelector)(I,_,(e,t)=>t?.[e]??[]),ge=(0,h.createSelector)(L,v,(e,t)=>U(t,e,"coinId")),Ke=(e,t,n,r,o)=>{let s=[];return e.forEach(a=>{let i=a.childrenCoin?.length||0,c={...n[a.coinId]??{},...a};if(c.childrenCoin){let y=c.childrenCoin.filter(C=>t.has(C.chainId)).map(C=>({...C,...n[C.coinId]??{}})),d=ie({coins:y,walletIdentity:o[r]});if(d.length===0)return;d.length!==i&&Object.assign(c,d[0]),c.childrenCoin=d}else if(!R({coin:c,walletIdentity:o[r]})||!t.has(c.chainId))return;s.push(c)}),s};function Fe(e,t,n){e.forEach(r=>{r.childrenCoin?(r.childrenCoin.forEach(o=>{K(o,t,n)}),r.currencyAmountUSD=r.childrenCoin.reduce((o,s)=>s.currencyAmountUSD?S(o,s.currencyAmountUSD):o,"0"),r.currencyAmount=x(r.currencyAmountUSD,n?.usdToThisRate??"1"),r.coinAmount=r.childrenCoin.reduce((o,s)=>S(o,s.coinAmount),"0"),r.coinAmountInt=r.childrenCoin.reduce((o,s)=>S(o,s.coinAmountInt),"0")):K(r,t,n)})}var ve=(e,t,n,r,o,s,a)=>{let{coins:i,...c}=e,d=Ke(i??[],t,n,r,o);return Fe(d,s,a),{...c,coins:d}},de={},k=(0,h.createSelector)((e,t,n)=>n?{[n.balanceData.walletId]:n.balanceData}:e.metamask.balancesMap??e.balanceSlice.balanceMap,X,ee,$,N,re,ue,I,(e,t,n,r,o,s,a,i)=>{if(!n||!Object.keys(e).length||!t?.length||Object.values(e)?.[0]?.v!==2)return de;let{walletIdentityMap:c}=o,y=new Set(t);return Object.entries(e).reduce((d,[C,m])=>(i&&C!==i||m?.v!==2||(d[C]=ve(m,y,r,C,c,a,s)),d),{})});l();u();j();function V({networkChainIdSet:e,defaultBaseCoinsCoinIdsSet:t,reducedCoinIdsSet:n,addedCoinIdsSet:r,balanceCoin:o,customFilter:s,isDefault:a,hiddenSmallAssets:i=!0}){let c=e&&!e.has(o.chainId);return n.has(o.coinId)||c||s&&!s(o)?{isFiltered:!0}:i&&Y(o.currencyAmountUSD,"1")&&!r.has(o.coinId)&&!t.has(o.coinId)&&!(a||o.isDefault)?{isSmallCurrency:!0}:{isFiltered:!1,isSmallCurrency:!1}}function Mt({isReady:e,networks:t,defaultBaseCoinsCoinIds:n,addedCoins:r,reducedCoins:o,balanceCoins:s,defi:a,nft:i,customFilter:c,hiddenSmallAssets:y=!0}){if(!e)return null;let d="0",C="0",m=new Set(t?.map(({chainId:g})=>g)??[]),p=new Set(n),H=(o??[]).reduce((g,f)=>(g.add(f.coinId),g),new Set),T=(r??[]).reduce((g,f)=>(g.add(f.coinId),g),new Set);function Be(g,f){return g.reduce((O,B)=>{if(B.currencyAmountUSD==="0")return O;let{isSmallCurrency:xe,isFiltered:Me}=V({networkChainIdSet:m,addedCoinIdsSet:T,reducedCoinIdsSet:H,isDefault:f,balanceCoin:B,defaultBaseCoinsCoinIdsSet:p,hiddenSmallAssets:y,customFilter:J=>!J.voucherToken&&(!c||c(J))});return Me?O:(xe&&(d=S(d,B.currencyAmountUSD)),B?.platformType===0&&(C=S(C,B.currencyAmountUSD)),S(O,B.currencyAmountUSD))},"0")}let be=s.reduce((g,f)=>S(g,Be(f.childrenCoin?.length?f.childrenCoin:[f],f.default)),"0"),De=a&&Array.isArray(a)?a.reduce((g,f)=>c&&!c(f)?g:S(g,f.currencyAmountUSD),"0"):"0",we=i&&Array.isArray(i)?i.reduce((g,f)=>c&&!c(f)?g:S(g,f.currencyAmountUSD),"0"):"0";return{tokenTotalAssetsUSD:be,defiTotalAssetsUSD:De,nftTotalAssetsUSD:we,smallTotalAssetsUSD:d,platformTotalAssetsUSD:C}}l();u();var D=w(M());l();u();var Ce=w(M());var Ne=(0,Ce.createSelector)(L,e=>new Set(e?.map(t=>t.coinId)??[])),fe=Ne;l();u();var Le=e=>pe(e,b(e)),z=Le;l();u();var ye=w(M());var Ve=(0,ye.createSelector)(v,e=>new Set(e.map(t=>t.coinId))),Se=Ve;l();u();var Ae=w(M());var ze=(0,Ae.createSelector)(me,e=>new Set(e?.map(t=>t.coinId)??[])),he=ze;var nn=(0,D.createSelector)(k,e=>Object.entries(e).reduce((t,[n,r])=>{let s=(r?.coins??[]).reduce((a,i)=>i.childrenCoin?a.concat(i.childrenCoin):a.concat([i]),[]);return t[n]={...r,coins:s},t},{})),rn=(0,D.createSelector)(k,b,(e,t)=>!Array.isArray(e[t]?.coins)),pe=(0,D.createSelector)(k,I,ge,N,le),Ie=[],on=(0,D.createSelector)(z,fe,he,Se,oe,(e,t,n,r,o)=>e.length?F(e,(s,a)=>{let{isFiltered:i,isSmallCurrency:c}=V({defaultBaseCoinsCoinIdsSet:r,addedCoinIdsSet:t,reducedCoinIdsSet:n,balanceCoin:s,isDefault:a,hiddenSmallAssets:o});return!i&&!c}).results:Ie),an=(0,D.createSelector)(z,e=>e.length?F(e,()=>!0).results:Ie);export{st as a,ct as b,Je as c,Qe as d,se as e,ce as f,F as g,Ee as h,k as i,Mt as j,fe as k,z as l,Se as m,he as n,nn as o,rn as p,pe as q,on as r,an as s};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-M75TVG7W.js.map
