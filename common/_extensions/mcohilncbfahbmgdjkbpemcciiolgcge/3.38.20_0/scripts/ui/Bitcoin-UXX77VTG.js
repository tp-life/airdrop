import{a as Bn}from"./chunk-3C53IKG6.js";import{a as Sn}from"./chunk-N2HELUD4.js";import{a as An}from"./chunk-UMPU7CTW.js";import{a as En}from"./chunk-XHGPIP6U.js";import{a as bn}from"./chunk-NVTMZ25X.js";import{i as yn,j as Cn,k as In,l as wn,m as hn,n as Nn}from"./chunk-VIUQAQ72.js";import"./chunk-TNGW2OJP.js";import"./chunk-CNX3VVOM.js";import"./chunk-5SOXH2CS.js";import{a as gn}from"./chunk-3SNY26AW.js";import{a as Oo,b as Uo}from"./chunk-O6IGNLRS.js";import{a as Do}from"./chunk-UVEUQXM6.js";import{b as fn,c as xn,d as Tn}from"./chunk-ZORPRUU7.js";import"./chunk-QCAVIM5G.js";import{a as dn}from"./chunk-B7P7Y7YD.js";import"./chunk-RN3CEAG6.js";import{a as _n}from"./chunk-3K6OE4O5.js";import"./chunk-SEL5SOAI.js";import{a as un}from"./chunk-EMVP43OQ.js";import"./chunk-XHGPSNTM.js";import{d as pn}from"./chunk-64U6VGZH.js";import"./chunk-TW5NSKIQ.js";import{a as ln,c as mn,g as cn}from"./chunk-JOGFEK3S.js";import{a as an}from"./chunk-TEHSOGCP.js";import{a as uo}from"./chunk-L5MAEEVU.js";import{a as vo,b as Mo}from"./chunk-KPYSN5PV.js";import{b as Kt,g as Lo,i as tn,j as on,k as Po,m as Fo,p as en,q as nn,r as rn}from"./chunk-MOISJT5B.js";import"./chunk-OSVZOFON.js";import"./chunk-7JDG2FPM.js";import"./chunk-KSO662WW.js";import{a as ko}from"./chunk-5AU4SCQT.js";import"./chunk-HCXRQ4GY.js";import"./chunk-AHNTWQZY.js";import"./chunk-4U65LWXX.js";import{a as X,b as po,c as re,d as tt}from"./chunk-WMQSMBLA.js";import{a as co}from"./chunk-XKK5N6CR.js";import"./chunk-ICLH7VK5.js";import{a as Q,b as sn,c as Jt}from"./chunk-3RJOXTRR.js";import"./chunk-J2MASCEL.js";import"./chunk-J2Y34YM2.js";import{f as G,h as Je,t as Qe}from"./chunk-NNO7KFUF.js";import{a as mo}from"./chunk-3L5C5CQB.js";import"./chunk-CGBWDXEW.js";import"./chunk-NRWOOVOJ.js";import"./chunk-P6MBUJNT.js";import"./chunk-2XYRURE2.js";import"./chunk-LYFECSNW.js";import"./chunk-M7CDJYYG.js";import{c as Ke}from"./chunk-VUB7XYHG.js";import"./chunk-QZXK25MX.js";import"./chunk-J7ZUOIII.js";import"./chunk-Q2BK5I52.js";import"./chunk-QVG4GOA5.js";import{d as Nt,g as je}from"./chunk-4NCQWC2K.js";import"./chunk-BSEC3HD3.js";import{c as ft}from"./chunk-SR5VKAMR.js";import"./chunk-2L5V4MTR.js";import"./chunk-762Y5MQL.js";import"./chunk-L56XCX6G.js";import{a as He}from"./chunk-LL7EUK43.js";import"./chunk-NXLWHU4N.js";import"./chunk-7UJMDFGU.js";import"./chunk-PB7BCSCP.js";import"./chunk-6ZM3C6AR.js";import"./chunk-QOIOEYFC.js";import"./chunk-ERN756XV.js";import"./chunk-SUOZFPDI.js";import"./chunk-XWBWLTOV.js";import"./chunk-PHVYXSWP.js";import{b as Re}from"./chunk-QO3FK7IQ.js";import{b as rt}from"./chunk-UWTAV26V.js";import{d as Ze}from"./chunk-A6RKGNRU.js";import"./chunk-IMZZ3LDB.js";import"./chunk-BM73LLRW.js";import"./chunk-6LE7Q5ED.js";import"./chunk-XD7VJART.js";import"./chunk-36UM4YJX.js";import"./chunk-6JGR2L6N.js";import"./chunk-ZBSU6WZQ.js";import"./chunk-S2V4K2JM.js";import"./chunk-GSWJ5GW7.js";import{a as ne}from"./chunk-IVCA3VWI.js";import"./chunk-FLZ5KV6J.js";import{h as J,i as lt}from"./chunk-OCTREJ3R.js";import"./chunk-RG4N2AAJ.js";import"./chunk-JPVBM3R5.js";import"./chunk-DMPLD3VG.js";import"./chunk-WWUOPI5T.js";import"./chunk-HVADQEJS.js";import"./chunk-A52XYJMT.js";import{a as Ve}from"./chunk-YDUQEL3D.js";import"./chunk-SWHCYDK2.js";import"./chunk-BCT5GPKT.js";import"./chunk-FJBNQZUR.js";import"./chunk-XN45YXW3.js";import"./chunk-M75TVG7W.js";import"./chunk-YXS5E7TI.js";import"./chunk-XUKRDQIU.js";import{d as $e}from"./chunk-OQJOA7JT.js";import"./chunk-YOJOUOFP.js";import"./chunk-7OQVWENF.js";import"./chunk-WD7752PC.js";import"./chunk-SLWKMGPD.js";import"./chunk-UC77E3WD.js";import{l as ao,m as lo}from"./chunk-GTSNHSPT.js";import"./chunk-LVPRDSPO.js";import"./chunk-PP43MII2.js";import"./chunk-YV3R2S6K.js";import{a as Gt}from"./chunk-RJO5LUBF.js";import"./chunk-DRPGNVVL.js";import{a as Yt}from"./chunk-UEENMIFU.js";import"./chunk-3OMHZBKM.js";import"./chunk-A264YTOP.js";import"./chunk-LRVKM4IV.js";import{a as jt}from"./chunk-PVSNAFN3.js";import{b as nt}from"./chunk-JYKQJVIF.js";import{a as Xe,q as y}from"./chunk-GBQG32PI.js";import{a as vr}from"./chunk-Q6XXIWBJ.js";import"./chunk-VWYA3Z7M.js";import{o as ht}from"./chunk-A3FIPWG3.js";import{P as Ue,Ra as We,Sa as ze,ac as so,j as oe,k as bo,m as Ae,n as Se}from"./chunk-NTISK7TT.js";import"./chunk-MXRUZQZ7.js";import{G as K,U as Oe,V as zt,b as P,c as Me,ea as kt,i as De}from"./chunk-CU7RFE6B.js";import{a as qe}from"./chunk-J4UWPXXS.js";import{a as ee}from"./chunk-QZUNX5I4.js";import"./chunk-IVA2TTR4.js";import{e as Ye,g as Ge}from"./chunk-OG3IV3YP.js";import"./chunk-45FKVGCF.js";import{La as yo,Pa as ve}from"./chunk-KSCBZ3RY.js";import{d as Fe,f as Fr}from"./chunk-37O7OMRA.js";import"./chunk-5PGNMLJO.js";import"./chunk-35FUKWV2.js";import"./chunk-DHNKVM4B.js";import"./chunk-VL5VJIZ7.js";import{c as u}from"./chunk-TU7CE5HJ.js";import"./chunk-2NE2FMGV.js";import{Ac as Vt,Gb as Jo,Jc as Ee,Lc as be,Mc as Be,Nc as ke,Oc as Bo,Rc as Le,Ta as ro,Ua as wt,Wa as xe,Wc as Lr,Xc as Pe,Ya as io,Yc as Pr,_a as Te,fc as kr,wb as Br}from"./chunk-YILNSICT.js";import"./chunk-ORQMOT6Z.js";import{G as Ie,H as we,O as te,P as he,X as Ne,c as $t,o as Wt,p as Qo,r as ye,y as Ce}from"./chunk-L4N7WJIQ.js";import"./chunk-LBCQTFOD.js";import{N as R,l as A,w as i}from"./chunk-V63HWKAL.js";import"./chunk-ZZ2UZY4M.js";import"./chunk-XFAFBXWC.js";import"./chunk-7EEPBGCR.js";import"./chunk-CY6DCOJP.js";import{H as So,T as Eo,Z as ge,ca as z}from"./chunk-2EJYCNYZ.js";import"./chunk-V2K75WCG.js";import{a as W}from"./chunk-B75PPTYD.js";import"./chunk-2AWSM2JA.js";import"./chunk-QXPU36HD.js";import"./chunk-QI5O5UGB.js";import"./chunk-2OGSVQVK.js";import"./chunk-Y5BBPTSN.js";import"./chunk-5LMNZ6ME.js";import"./chunk-SY7RUBBT.js";import"./chunk-M3FHVHHL.js";import"./chunk-BL7VW4RD.js";import"./chunk-LQWZRQFF.js";import"./chunk-VGOLUGG3.js";import"./chunk-DCDI35O2.js";import"./chunk-YEL3LVD4.js";import"./chunk-6SIBAM5N.js";import"./chunk-42IJDSSW.js";import"./chunk-XYCKE5Q7.js";import"./chunk-HQ74Q4WH.js";import"./chunk-BMKS7XLD.js";import"./chunk-MTFM4GGW.js";import{f as d,m as s,n as g,o as a}from"./chunk-UGZFXKPB.js";s();a();var Ft=d(W());s();a();var Wo=d(W());R();s();a();var kn=({unapproved:t})=>Wo.default.createElement(u.Container,null,Wo.default.createElement(Gt,{title:i("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),Wo.default.createElement(gn,{unapproved:t}));s();a();var h=d(W()),Ln=d(so()),zo=d(ht());R();Fr();Bo();io();var Mr=({unapproved:t})=>{let o=t?.localType,e=ft({localType:o})?.coinId;e===void 0&&(e=wt(o));let r=Nt(e),l=(0,Ln.useDispatch)(),c=t.walletId,p=t.params.transaction.from,E=lo(c),T=t.params.transaction.amount||2,[,x]=ko({coinId:e,address:p,chainId:r?.chainId}),w=x?.transferReminder,f=x?.dummyOutput,[m,I]=(0,h.useState)({level:zt.STANDARD,satBytes:x?.normal}),b=m?.satBytes;(0,h.useEffect)(()=>{if(!b&&x?.normal&&I({level:zt.STANDARD,satBytes:x?.normal}),b&&m?.level!==zt.CUSTOM){let $=x[vo[m?.level]?.satBytes];I({...m,satBytes:$})}},[x]);let[D,{toggle:O}]=(0,zo.useBoolean)(!1),[F,{set:N}]=(0,zo.useBoolean)(!1),[B,{set:U}]=(0,zo.useBoolean)(!1),[v,vt]=(0,h.useState)(),[H,S]=Po({coinId:e,walletId:c,address:p,batchDummyNum:T,utxoType:Kt.SPLIT_UTXO}),[It,k,gt]=on({coinId:e,walletId:c,address:p,networkFee:v,utxoType:Kt.SPLIT_UTXO,batchDummyNum:T,coinAmount:A.mul(f,T)},{ready:!!f}),it=(0,h.useMemo)(()=>k.findIndex(({dummy:$})=>$!==!0),[k]),ct=(0,h.useMemo)(()=>it===-1?[]:k.slice(it),[it,k]),st=(0,h.useMemo)(()=>it===-1?0:Math.max(T-it,0),[T,it]),St=A.gt(st,0),to=A.mul(f,st),ot=en({coinId:e,fromAddr:p,satBytes:b}),at=(0,h.useCallback)(async()=>{try{if(!b)return;N(!0);let $=await ot({inputs:ct,outputs:Array.from({length:st}).map(()=>({address:p,amount:f}))});U(!1),vt($)}catch{U(!0)}finally{N(!1)}},[f,ot,p,ct,st,b,U,N]);(0,h.useEffect)(()=>{at()},[at]);let yt=(0,h.useMemo)(()=>S===void 0||!v?!0:A.gt(S,v),[S,v]),To=(0,h.useMemo)(()=>E?{type:tt.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:B?{type:tt.TIP_TYPE.FEE_ERROR}:yt?{type:$t.TYPE.warn,message:w}:{coinId:e,type:tt.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[e,B,E,yt,w]),Mt=Qe({coinId:e,walletId:c,coinAmount:0,fromAddr:p,toAddr:p,localType:r?.localType,networkFee:v,extJson:JSON.stringify({}),txSource:Vt.DAPP,txType:P.BTC_SPLIT_UTXO}),Et=Fo({coinId:e,txType:P.BTC_SPLIT_UTXO,address:p}),Dt=ao(c),[Ht,Ot]=(0,h.useState)(!1),Zt=(0,h.useCallback)(async()=>{await l(J(t.id)),await l(rt()),Ot(!1)},[l,t.id]),et=(0,h.useCallback)(async()=>{if(St)try{if(!await mo({walletId:c,callback:async()=>{await l(J(t.id))}}))return;await Et(ct),Ot(!0);let{signed:Ut,utxos:No}=await Fe().splitUtxo({splitAmount:st,inputs:Lo(ct),amount:f,feePerB:m.satBytes},p,c);await Mt(Ut);let jo=k.filter(oo=>oo.dummy),Ko=[...Lo(jo),...No.map(oo=>({...oo,rawTransaction:Ut}))];await l(lt(t.id,{utxos:Ko}))}catch($){console.log($)}finally{Ot(!1)}else{let $=k.slice(0,T);await l(lt(t.id,{utxos:Lo($)}))}},[T,l,f,k,p,St,ct,Mt,st,m.satBytes,t.id,Et,c]),{loading:bt,onClick:Rt}=Q(Zt),{loading:Io,onClick:wo}=Q(et),ho=(0,h.useMemo)(()=>{let $={loading:bt,actionType:G.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:Rt},Ut={actionType:G.ACTION_TYPE.CONFIRM,disabled:H||F||It||B||gt||!Number(v)||E,onClick:wo,loading:Io};return yt||(Ut={coinId:e,walletId:c,address:p,actionType:G.ACTION_TYPE.FILL_UP}),[$,Ut]},[e,v,B,F,p,E,yt,H,Rt,wo,gt,It,c,bt,Io]);return h.default.createElement(u.Container,null,h.default.createElement(Gt,{backable:!1,closeable:!1,title:i("wallet_extension_send_title_send")}),h.default.createElement(X,null,h.default.createElement(po,{title:i("wallet_extension_send_colored_send"),summaryList:[{coinId:e,coinAmount:to}]})),h.default.createElement(X,null,h.default.createElement(Jt,{walletId:c,address:p,title:i("wallet_extension_network_address_title_walletused")},!!S&&h.default.createElement(Oo,{coinBalance:S,tooltip:i("extension_defi_bot_popuptext_avail_amount"),coinId:e}))),h.default.createElement(X,{bordered:!1},h.default.createElement(co,{coinId:e,loading:F,feeError:B,networkFee:v,onClick:O})),h.default.createElement(Yt,{placeholder:!0,offsetBottom:0,borderTop:!0},h.default.createElement(tt,{coinId:e,...To}),h.default.createElement(G,{buttonGroup:ho})),h.default.createElement(Mo,{coinId:e,visible:D,signInfo:x,value:m,estimatedFee:v,onChange:I,onToggleVisible:O}),h.default.createElement(Uo,{visible:Dt&&Ht}))},Pn=Mr;s();a();var Fn=d(W());var vn=({unapproved:t})=>{let o=t.params?.message,n=Bn({unapproved:t});return Fn.default.createElement(bn,{needCheckMpc:!0,message:o,unapproved:t,tipMessage:n})};s();a();var Ct=d(W()),Mn=d(so()),Dn=d(ee()),On=d(ht());Bo();Br();io();s();a();var Qt={AMOUNT:1,CONFIRM:2};var ie=Qt.AMOUNT;function Dr({unapproved:t}){let{from:o,type:n=P.BRC20_INSCRIBE,tick:e="",tid:r,amount:l,txSource:c=Vt.DAPP}=t?.params?.transaction||{},p=t?.localType||Te,[E,T]=(0,Ct.useState)(ie),x=(0,Mn.useDispatch)(),w=(0,Dn.useHistory)(),m=ft({localType:p})?.netWorkId;m===void 0?m=ro(p):m=+m;let I=(0,On.useCreation)(()=>n===P.BRC20_INSCRIBE?{chainId:m,coinType:bo(m),symbol:e}:null,[n,r,e,m]),D=Nt(void 0,{},I)?.coinId,O=(0,Ct.useCallback)(async()=>{await x(J(t.id)),await x(rt()),w.push(jt)},[x,w,t.id]),F=(0,Ct.useCallback)(()=>{T(Qt.CONFIRM),ie=Qt.CONFIRM},[]),N=(0,Ct.useCallback)(async({txIds:U,commitTx:v,revealTxs:vt})=>{await x(lt(t.id,{txIds:U,commitTx:v,revealTxs:vt})),await x(rt()),w.push(jt)},[x,w,t.id]),B=(0,Ct.useCallback)(()=>{T(Qt.AMOUNT),ie=Qt.AMOUNT},[]);return Ct.default.createElement(Nn,{fromAddress:o,coinId:D},E===Qt.AMOUNT?Ct.default.createElement(wn,{amount:l,walletId:t.walletId,onCancel:O,onConfirm:F,headerProps:{closeable:!1,backable:!1}}):Ct.default.createElement(hn,{txSource:c,onCancel:O,onConfirm:N,walletId:t.walletId,headerProps:{onBack:B,closeable:!1,backable:!0}}))}var Un=Dr;s();a();var _=d(W()),pr=d(so()),ur=d(ee());R();s();a();var se=d(W()),zn=d(ht());s();a();function Wn(t=[]){if(!Array.isArray(t))throw new Error("assetChange should be an array");return t.map(o=>{let{direction:n,amount:e,usdAmount:r,symbol:l,logo:c}=o;return{operator:n===1?"+":"-",usdValue:r,rawValue:e,asset:{assetType:Je.NATIVE,amount:e,symbol:l,imageUrl:c}}})}var Or=({address:t,hexStringList:o=[],chainIndex:n=0},e={})=>{let r=o?.toString(),l={ready:n!==void 0&&!!o?.length,refreshDeps:[t,r,n],...e},{loading:c,data:p,error:E}=(0,zn.useRequest)(async()=>(await Ue({address:t,hexStringList:o,chainIndex:n})).data,l);return{loading:c,data:p,error:E}},Ur=t=>(0,se.useMemo)(()=>!t||!t.length?[]:t.map(o=>{let{assetChange:n=[],assetInversion:e}=o;return{status:o.analysisStatus,gasFee:o?.gasFee||0,isShowFee:o?.isShowFee,exploreUrl:o?.exploreUrl,inputInfo:o?.inputInfo||[],outputInfo:o?.outputInfo||[],assetChange:Wn(n),assetInversion:e||!1}}),[t]),Wr=(t=[])=>(0,se.useMemo)(()=>!t||!t.length?null:t.some(n=>n.status>0)?kt.EXECUTE_ERROR:null,[t]);function Yn(t={},o={}){let{loading:n,data:e,error:r}=Or(t,o),{utxoAllInfos:l}=e||{},c=Ur(l),p=Wr(c);return{loading:n,error:r||p,data:c}}s();a();var dt=d(W()),Go=d(ht());R();s();a();var j=d(W()),ae=d(ht());R();s();a();R();var Gn=t=>{typeof t!="string"&&(t=t.toString());let o=t?.length;return o<=9?36:o>=10&&o<12?32:o===12?30:o>=13&&o<=15?24:o>=16&&o<=18?20:o>=19&&o<=24?16:12},Xn=(t,o)=>t?!1:o===""?!0:!A.gte(`${o||0}`,0);s();a();var At={AuthorizationToken:"_AuthorizationToken_g68hx_1",authorizationToken:"_AuthorizationToken_g68hx_1",title:"_title_g68hx_1",content:"_content_g68hx_4",unlimited_text:"_unlimited_text_g68hx_13",unlimitedText:"_unlimited_text_g68hx_13",balance:"_balance_g68hx_17",amount:"_amount_g68hx_22",checkAll:"_checkAll_g68hx_26",checkAll__text:"_checkAll__text_g68hx_30",checkAllText:"_checkAll__text_g68hx_30",footerActions:"_footerActions_g68hx_33"};s();a();var zr=({chainId:t,address:o,walletId:n})=>{let e=Nt(void 0,void 0,{chainId:t,address:o}),{coinId:r}=e||{};return an(r,n)},qn=zr;var Yr=({txType:t,chainId:o,address:n,walletId:e,authAmount:r,onConfirm:l})=>{let c=qn({chainId:o,address:n,walletId:e}),{symbol:p,decimals:E}=c||{},T=pn(p,10),x=t===P.INCREASE_ALLOWANCE?"extension_approve_text_increase_approvals":"wallet_contract_interaction_approval_permission_authorized_amount",w=ze(r),[f,m]=(0,j.useState)(!1),[I,b]=(0,j.useState)(w?"0":r),D=(0,j.useMemo)(()=>Xn(f,I),[f,I]),O=(0,ae.useMemoizedFn)(async()=>{l?.(f?We:I)}),F=(0,ae.useMemoizedFn)(()=>{b(c?.coinAmount)}),N=A.thousandFormat(c?.coinAmount);return j.default.createElement(u.FlexBox,{className:At.AuthorizationToken,direction:u.DIRECTION.vertical,align:u.ALIGN.center},j.default.createElement(y.Text,{strong:700,className:At.title},i(x)),j.default.createElement(u.Box,{className:At.content},f?j.default.createElement(y.Text,{strong:500,size:y.SIZE.xl,className:At.unlimited_text},i("wallet_extension_transfer_title_unlimited_amount",{token:T})):j.default.createElement(Ke,{symbol:T,autoSize:Gn,placeholder:"0",decimals:E||0,value:I,onChange:b,style:{fontWeight:500,height:"48px"}}),!!Number(c?.coinAmount)&&j.default.createElement(y.Text,{nowrap:!0,type:y.TYPE.secondary,size:y.SIZE.xs,onClick:F,className:At.balance},i("wallet_extension_transfer_dialog_text_balance_amount",{amount:j.default.createElement(y.Text,{inherit:!0,component:"span",className:At.amount,ellipsis:{tooltip:N}},N),token:T}))),j.default.createElement(ye,{className:At.checkAll,checked:f,textClass:At.checkAll__text,onChange:({target:{checked:B}})=>{m(B)}},i("wallet_extension_transfer_dialog_checkbox_set_to_unlimited")),j.default.createElement(Yt.FooterActions,{affixStyle:{position:"none"},placeholder:!1,className:At.footerActions},j.default.createElement(z,{disabled:D,category:z.CATEGORY.fill,type:z.TYPE.primary,size:z.SIZE.lg,onClick:O},i("commonall_filter_btn_save"))))},Hn=Yr;s();a();var Yo={edit_btn:"_edit_btn_rw6lw_1",editBtn:"_edit_btn_rw6lw_1",authorization_token_dialog:"_authorization_token_dialog_rw6lw_5",authorizationTokenDialog:"_authorization_token_dialog_rw6lw_5",authorization_token_dialog__content:"_authorization_token_dialog__content_rw6lw_5",authorizationTokenDialogContent:"_authorization_token_dialog__content_rw6lw_5"};var Gr=t=>{let[o,{toggle:n}]=(0,Go.useBoolean)(!1),{txType:e,loading:r,dappInfo:l,walletId:c,analyzeRet:p,approveToken:E,onAuthTokenAmountChange:T,showDappInfo:x=!0,noFold:w=!1}=t,{approveList:f,assetChange:m=[]}=p,I=f?.[0]||{},b=(0,Go.useMemoizedFn)(D=>{n(),T?.(D)});return r?dt.default.createElement(dn,null):mn(e)?dt.default.createElement(xn,{approveInfo:I}):ln(e)?dt.default.createElement(dt.default.Fragment,null,dt.default.createElement(Tn,{approveInfo:I,authAmount:E?.authAmount,editBtnSlot:[P.AUTHORIZATION,P.INCREASE_ALLOWANCE].includes(I?.approvalType)?dt.default.createElement(z,{size:z.SIZE.xs,type:z.TYPE.primary,category:z.CATEGORY.outline,className:Yo.edit_btn,onClick:n},i("wallet_extension_transfer_text_edit")):null}),dt.default.createElement(Wt,{alignBottom:!0,noContentPadding:!0,visible:o,onClose:n,className:Yo.authorization_token_dialog,windowClass:Yo.authorization_token_dialog__content},dt.default.createElement(Hn,{txType:e,walletId:c,...E,onConfirm:b}))):cn(e)?dt.default.createElement(fn,{assetChange:m,dappInfo:l,showDappInfo:x,noFold:w}):x?dt.default.createElement(X,null,dt.default.createElement(_n,{...l})):null},Xo=Gr;s();a();var C=d(W()),fo=d(So());R();s();a();var _o=d(W());var Rn=d(vr());R();var le=d(ht());s();a();var Zn={address:"_address_11ipy_1"};function me({children:t,addresses:o=[],exploreUrl:n=""}){let e=o[0],r=(0,le.useMemoizedFn)(()=>{(0,Rn.default)(e),Ie.success({title:i("wallet_receive_toast_address_copied"),desc:""})},[e]),l=(0,le.useMemoizedFn)(()=>{n&&globalThis.platform.openTab({url:`${n}${e}`})},[e,n]);return o.length>1?t:_o.default.createElement(Qo.WhiteBoard,{rebirthPopper:!0,popupStyle:{marginLeft:16,marginRight:16,padding:12,borderRadius:8},content:_o.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"center"},_o.default.createElement(y.Text,{forceWrap:!0,size:y.SIZE.sm,className:Zn.address},e),_o.default.createElement(nt,{size:nt.SIZE.xs,icon:"okds-copy",onClick:r,style:{marginLeft:8}}),_o.default.createElement(nt,{size:nt.SIZE.sm,icon:"okx-wallet-plugin-open-link",onClick:l,style:{marginLeft:8}})),trigger:Qo.TRIGGER.hover},t)}s();a();Bo();function ce(t){return t===Ee.XRC_NFT}s();a();var M={content:"_content_1i550_1",none:"_none_1i550_4",title:"_title_1i550_10",input:"_input_1i550_15",utxoContainer:"_utxoContainer_1i550_18",isCurrentAddr:"_isCurrentAddr_1i550_18",signTag:"_signTag_1i550_18",addrContainer:"_addrContainer_1i550_24",address:"_address_1i550_29",amount:"_amount_1i550_38",xrcAssetsContainer:"_xrcAssetsContainer_1i550_50",xrcAssetsTitle:"_xrcAssetsTitle_1i550_56",xrcAssetContainer:"_xrcAssetContainer_1i550_62",logo:"_logo_1i550_65",isNFT:"_isNFT_1i550_72",isNft:"_isNFT_1i550_72",amountText:"_amountText_1i550_75",protocol:"_protocol_1i550_78",moreXRCContainer:"_moreXRCContainer_1i550_85",moreXrcContainer:"_moreXRCContainer_1i550_85",showMoreTitle:"_showMoreTitle_1i550_89",moreAssetsLogos:"_moreAssetsLogos_1i550_95",moreAssetsLogo:"_moreAssetsLogo_1i550_95",expandContainer:"_expandContainer_1i550_106",expandContainer_title:"_expandContainer_title_1i550_110",expandContainerTitle:"_expandContainer_title_1i550_110",expandContainer_leftTotal:"_expandContainer_leftTotal_1i550_116",expandContainerLeftTotal:"_expandContainer_leftTotal_1i550_116",expandContainer_icon:"_expandContainer_icon_1i550_123",expandContainerIcon:"_expandContainer_icon_1i550_123"};var pe="inputInfo",$n="outputInfo",qo={xrcAsset:10,utxo:50},Xr=({coinId:t,data:o={},currentAddr:n})=>{let[e,r]=(0,C.useState)({}),[,l]=je(t,{withPrice:!0}),c=(0,C.useMemo)(()=>[pe,$n].map(m=>{let I=o[m]||[],b=e[m]||!1;return I.map((D,O)=>{let F=e[`${m}-${O}`]||!1,N=D.xrcAssets||[];return D.xrcToShow=F?N:N.slice(0,qo.xrcAsset),D.moreXRC=N.slice(qo.xrcAsset),D}),{key:m,exploreUrl:o.exploreUrl,allData:I,dataToShow:b?I:I.slice(0,qo.utxo),moreData:I.slice(qo.utxo)}}),[o,e]),p=(0,C.useCallback)((f=[])=>f.reduce((m,{amount:I})=>A.add(m,I),0),[]),E=(0,C.useCallback)(f=>{switch(f){case pe:return i("wallet_extension_asset_input_inputs_num",{amount:c[0].allData.length});case $n:return i("wallet_extension_asset_outputs",{amount:c[1].allData.length});default:return""}},[c]),T=(0,C.useCallback)(f=>{r(m=>({...m,[f]:!0}))},[]),x=f=>{let{protocolType:m}=f||{};return ce(m)?f.logo||Ge:f.logo||Ye},w=C.default.memo(({xrcAssets:f=[]})=>C.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:M.moreAssetsLogos},f.slice(0,3).map(m=>C.default.createElement("img",{className:M.moreAssetsLogo,src:m.logo||"",alt:m.symbol}))));return C.default.createElement(Do,{copyable:!1,title:i("wallet_extension_asset_btn_transaction_details")},c.map(f=>C.default.createElement("div",{className:(0,fo.default)(M.content,f.key===pe?M.input:"",f.dataToShow.length===0?M.none:"")},C.default.createElement("div",{className:(0,fo.default)(M.title)},E(f.key)),f.dataToShow.map((m,I)=>C.default.createElement(C.default.Fragment,null,C.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"space-between",className:(0,fo.default)(M.utxoContainer,n===m.address[0]?M.isCurrentAddr:"")},C.default.createElement("div",{className:(0,fo.default)(M.addrContainer)},C.default.createElement(me,{addresses:m.address,exploreUrl:f.exploreUrl},C.default.createElement("div",{className:M.address},m.address.length>1?i("wallet_extension_asset_title_multisig"):Ae(m.address[0]))),C.default.createElement(Ne,{className:M.signTag,size:te.SIZE.sm},i("wallet_extension_asset_tag_sign"))),C.default.createElement("div",{className:M.amount},C.default.createElement(y.DisplayAmount,{noStyle:!0,amount:m.amount,mode:y.CRYPTO,symbol:l?.symbol,decimals:l?.decimals}))),m.xrcToShow.length>0&&C.default.createElement("div",{className:M.xrcAssetsContainer},C.default.createElement(y.Text,{size:y.SIZE.xs,className:M.xrcAssetsTitle},i("wallet_extension_asset_include_asset")),m.xrcToShow.map(b=>C.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:M.xrcAssetContainer},C.default.createElement("img",{className:(0,fo.default)(M.logo,ce(b.protocolType)?M.isNFT:""),src:x(b),alt:b.symbol}),C.default.createElement(y.Text,{nowrap:!0,size:y.SIZE.xs,ellipsis:{tooltip:!0},className:M.amountText},`${b.amount} ${b.symbol}`),C.default.createElement(he,{className:M.protocol,size:te.SIZE.sm},b.protocolName))),m.moreXRC.length>0&&!e[`${f.key}-${I}`]?C.default.createElement(u.FlexBox,{align:u.ALIGN.center,onClick:()=>{T(`${f.key}-${I}`)},className:M.moreXRCContainer},C.default.createElement(w,{xrcAssets:m.moreXRC}),C.default.createElement("div",{className:M.showMoreTitle},i("wallet_extension_asset_btn_show_num_asset",{amount:A.thousandFormat(m.moreXRC.length)})),C.default.createElement(nt,{icon:"okds-arrow-chevron-down-md",size:nt.SIZE.xs})):null))),f.moreData.length>0&&!e[f.key]?C.default.createElement("div",{className:M.expandContainer,onClick:()=>{T(f.key)}},C.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"space-between"},C.default.createElement("div",{className:M.expandContainer_title},i("wallet_extension_asset_more_amount_inputs",{amount:A.thousandFormat(f.moreData.length)})),C.default.createElement(u.FlexBox,null,C.default.createElement("div",{className:M.expandContainer_leftTotal},C.default.createElement(y.DisplayAmount,{noStyle:!0,amount:p(f.moreData),mode:y.CRYPTO,symbol:l?.symbol,decimals:l?.decimals})),C.default.createElement(nt,{icon:"okds-arrow-chevron-down-md",size:Xe.xs,className:M.expandContainer_icon})))):null)))},Vn=Xr;s();a();var Z=d(W()),jn=d(So());R();s();a();var mt={main:"_main_asg9r_1",title:"_title_asg9r_8",scrollArea:"_scrollArea_asg9r_17",item:"_item_asg9r_22",subTitle:"_subTitle_asg9r_25",content:"_content_asg9r_32",loading:"_loading_asg9r_38",arrow:"_arrow_asg9r_43",icon:"_icon_asg9r_48"};function qr({psbts:t=[],loading:o,onClick:n}){let e=(0,Z.useCallback)(l=>{n(l)},[n]),r=()=>o?Z.default.createElement("div",{className:mt.scrollArea},Z.default.createElement("div",{className:mt.loading},Z.default.createElement(ge.Circle,null))):t.length===0?Z.default.createElement(Ce.State,{className:mt.empty}):Z.default.createElement("div",{className:mt.scrollArea},(t||[]).map((l,c)=>Z.default.createElement(u.FlexBox,{className:mt.item,align:u.ALIGN.center,key:l,onClick:()=>{e(c)}},Z.default.createElement(u.FlexBox,{className:mt.content,direction:u.DIRECTION.vertical},Z.default.createElement("div",{className:mt.subTitle},i("wallet_extension_asset_transaction_confirmation",{amount:ne(c+1)})),Z.default.createElement("div",{className:mt.content},Se(l))),Z.default.createElement("div",{className:mt.arrow},Z.default.createElement(nt,{className:(0,jn.default)("okx-wallet-plugin-arrow-small-right",mt.icon)})))));return Z.default.createElement(u.FlexBox,{className:mt.main},Z.default.createElement("div",{className:mt.title},i("",{number:ne(t.length)})),r())}var Kn=(0,Z.memo)(qr);ve();io();s();a();var xt=d(W()),Jn=d(So());R();s();a();var Xt={main:"_main_1w6ta_1",box:"_box_1w6ta_6",tipImg:"_tipImg_1w6ta_12",tipImgIcon:"_tipImgIcon_1w6ta_21",title:"_title_1w6ta_25",decs:"_decs_1w6ta_33",w100:"_w100_1w6ta_39",footerWrap:"_footerWrap_1w6ta_42"};var Hr=({visible:t,onCancel:o,onConfirm:n,headerProps:e,psbtHasMultiXRCAsset:r,paymentUseXRCAsset:l,assetInversion:c})=>{let p=(0,xt.useMemo)(()=>r?i("wallet_extension_tip_multiple_inscription_use"):l?i("wallet_extension_desc_inscription_asset"):c?i("wallet_extension_transaction_desc_risky_greater_pay"):"",[c,l,r]);return xt.default.createElement(Wt,{visible:t,alignBottom:!0,noMargin:!0,maskClosable:!0,noContentPadding:!0,transitionProps:{type:"slide",placement:"bottom",timeout:300},confirmBtnProps:{size:z.SIZE.lg},cancelBtnProps:{size:z.SIZE.lg},cancelText:i("wallet_extension_function_btn_continue_transaction"),confirmText:i("wallet_extension_mid_dialog_btn_cancel"),onCancel:o,onConfirm:n,onClose:o},xt.default.createElement(u.FlexBox,{className:Xt.main,direction:u.DIRECTION.vertical},xt.default.createElement(u.Box,{className:Xt.box},xt.default.createElement(u.Box,{className:Xt.tipImg},xt.default.createElement(Eo,{className:(0,Jn.default)("okx-wallet-plugin-risk-trading",Xt.tipImgIcon)})),xt.default.createElement(y.Text,{className:Xt.title,align:y.ALIGN.center},i("wallet_extension_title_transaction_risk")),xt.default.createElement(y.Text,{className:Xt.decs,size:y.SIZE.sm,align:y.ALIGN.center},p)),xt.default.createElement(u.Box,{className:Xt.w100},xt.default.createElement(Xo,{...e,showDappInfo:!1,loading:!1,noFold:!0}))))},Qn=Hr;s();a();Pr();Lr();var Ho=d(W()),Zr=()=>{let[t,o]=(0,Ho.useState)(""),n=async()=>{let{data:e}=await Le(Pe.getSignPrompt);e.assetReminder?o(e.assetReminder):o(null)};return(0,Ho.useEffect)(()=>{n()},[]),{assetReminder:t}},tr=Zr;s();a();var or=d(W());R();var Rr=({onConfirm:t})=>(0,or.useCallback)(()=>{Wt.warn({title:i("wallet_extension_asset_alertbanner_title_alert"),alignBottom:!1,maskClosable:!1,hideCloseBtn:!0,text:i("wallet_extension_asset_alertbanner_desc_utxo_lost"),confirmBtnProps:{type:z.TYPE.outline,size:z.SIZE.lg},cancelBtnProps:{type:z.TYPE.highlight,size:z.SIZE.lg},onConfirm(o){o.destroy(),t()},async onCancel(o){o.destroy()},cancelText:i("commonall_text_btn_cancel"),confirmText:i("wallet_extension_asset_btn_continue")})},[t]),er=Rr;s();a();var xo=d(W());s();a();var q=d(W()),ue=d(So());s();a();var Tt={main:"_main_1fewt_1",box:"_box_1fewt_6",isPureScreen:"_isPureScreen_1fewt_12",tipImg:"_tipImg_1fewt_15",tipImgIcon:"_tipImgIcon_1fewt_24",title:"_title_1fewt_28",decs:"_decs_1fewt_36",extLink:"_extLink_1fewt_42",footerWrap:"_footerWrap_1fewt_46",screenOneButtons:"_screenOneButtons_1fewt_49",extButton:"_extButton_1fewt_53"};var nr=t=>{let{children:o,desc:n,title:e,isPureScreen:r}=t;return q.default.createElement(u.FlexBox,{className:Tt.main,direction:u.DIRECTION.vertical},q.default.createElement(u.Box,{className:(0,ue.default)(Tt.box,{[Tt.isPureScreen]:r})},q.default.createElement(u.Box,{className:Tt.tipImg},q.default.createElement(Eo,{className:(0,ue.default)("okx-wallet-plugin-risk-trading",Tt.tipImgIcon)})),q.default.createElement(y.Text,{className:Tt.title,align:y.ALIGN.center},e),q.default.createElement(y.Text,{className:Tt.decs,size:y.SIZE.sm,align:y.ALIGN.center},n)),q.default.createElement(u.Box,{className:Tt.footerWrap},o))},$r=({modalParams:t,handleCancel:o,handleNext:n})=>{let{screenOne:e,screenTwo:r}=t,[l,c]=(0,q.useState)(!1),p=async()=>{c(!0),await o(),c(!1)};return q.default.createElement(nr,{desc:e.desc,title:e.title},q.default.createElement(u.Box,{className:Tt.screenOneButtons},q.default.createElement(z,{block:!0,loading:l,size:z.SIZE.lg,onClick:p,type:z.TYPE.highlight,category:z.CATEGORY.fill},e.mainBtnText),r?q.default.createElement(u.Box,{className:Tt.extButton,onClick:n},e.subBtnText):null))},Vr=({handleCancel:t,handleNext:o,modalParams:n})=>{let{screenTwo:e={}}=n,{loading:r,onClick:l}=Q(o),{loading:c,onClick:p}=Q(t),E=[{loading:r,actionType:G.ACTION_TYPE.CANCEL,btnText:e.subBtnText,onClick:l},{loading:c,actionType:G.ACTION_TYPE.CONFIRM,btnText:e.mainBtnText,onClick:p}];return q.default.createElement(nr,{isPureScreen:!0,desc:e.desc,title:e.title},q.default.createElement(u.Box,{className:Tt.screenTwoButtons},q.default.createElement(G,{buttonGroup:E})))},jr=({handleCancel:t,closeModal:o,modalParams:n})=>{let[e,r]=(0,q.useState)(1);return e===2?q.default.createElement(Vr,{modalParams:n,handleCancel:t,handleNext:o}):q.default.createElement($r,{modalParams:n,handleCancel:t,handleNext:()=>{r(2)}})},rr=jr;s();a();var sr=d(W());R();s();a();var ir={extLink:"_extLink_1eb1z_1"};var Kr=()=>{let t=Ve(),o=r=>({title:i("wallet_extension_fractal_title_transaction_risky"),desc:i(r,{case:sr.default.createElement(qe,{className:ir.extLink,href:t?.scamsUrl},i("wallet_extension_function_link_case"))}),mainBtnText:i("wallet_extension_function_btn_cancel"),subBtnText:i("wallet_extension_function_btn_advanced")}),n={title:i("wallet_extension_fractal_title_transaction_risky"),desc:i("wallet_extension_function_desc_developer_continue"),mainBtnText:i("wallet_extension_mid_dialog_btn_cancel"),subBtnText:i("wallet_extension_function_btn_continue_transaction")};return{getUTXONotFoundModalParams:()=>({screenOne:o("wallet_extension_fractal_desc_transaction_risky"),screenTwo:n})}},ar=Kr;var Jr=({psbtsInfoErr:t,handleCancel:o})=>{let{getUTXONotFoundModalParams:n}=ar(),e=(0,xo.useRef)(),r=l=>{e.current||(e.current=Wt.action({hideCloseBtn:!0,maskClosable:!1,noContentPadding:!0,children:xo.default.createElement(rr,{modalParams:l,handleCancel:async()=>{await o(),e.current.destroy(),e.current=null},closeModal:()=>{e.current.destroy(),e.current=null}})}))};(0,xo.useEffect)(()=>{t?.code==kt.UTXO_NOT_FOUND&&r(n())},[t])},lr=Jr;s();a();R();s();a();var _e=d(He());var mr=t=>{try{return _e.Psbt.fromHex(t).toBase64()}catch{return _e.Psbt.fromBase64(t),t}};var Zo=d(He()),Lt={LIST:"list",UNLIST:"unlist",TRADE:"trade",RUNES:"runes"},cr=t=>{try{let o=Zo.Psbt.fromBase64(mr(t)),n=o?.data?.inputs||[],e=o?.data?.globalMap?.unsignedTx?.tx?.outs||[],r=[];return n.forEach((l,c)=>{if(l.witnessUtxo)r.push({...l,value:l.witnessUtxo.value});else if(l.nonWitnessUtxo){let p=Zo.Transaction.fromBuffer(l.nonWitnessUtxo),E=o?.data?.globalMap?.unsignedTx?.tx?.ins||[],x=p.outs[E[c]?.index]?.value;r.push({...l,value:x})}}),{inputs:r,outputs:e}}catch{return{inputs:[],outputs:[]}}},qt=(t,o=0,n)=>!Array.isArray(t)||n===0?0:t.slice(o,n?o+n:void 0).reduce((e,{value:r})=>A.add(e,r),0);var _r=({unapproved:t})=>{let{psbt:o,psbts:n,type:e,from:r,amount:l=1,psbtOpts:c,broadcast:p=!1}=t.params.transaction,{origin:E}=t,T=t.method===K.SIGNPSBTS,x=t?.walletId,w=t?.localType,m=ft({localType:w})?.coinId;m===void 0&&(m=wt(w));let I=ao(x),b=lo(x),D=uo(x),{loading:O,data:F,error:N}=Yn({address:r,hexStringList:T?n:[o],chainIndex:ro(w)}),[B,U]=(0,_.useState)(!1),[v,vt]=(0,_.useState)(0),H=(0,_.useMemo)(()=>T&&!B,[T,B]),S=(0,_.useMemo)(()=>F[v]||{},[F,v]),{assetReminder:It}=tr(),k=(0,pr.useDispatch)(),gt=(0,ur.useHistory)(),it=un(t),{name:ct,icon:st,host:St}=it,{inputs:to,outputs:ot}=cr(T?n[v]:o),at=(0,_.useMemo)(()=>A.sub(qt(to),qt(ot)),[to,ot]),yt=An(),To=(0,_.useMemo)(()=>{if(e!==Lt.TRADE&&e!==Lt.RUNES)return null;let V=Number(l);if(e===Lt.RUNES){let eo=qt(ot,1,V),no=A.add(qt(ot,0,1),qt(ot,ot.length-V+1,V-1));return`${A.sub(no,A.add(eo,at))}`}let Bt=qt(ot,V+1,V),pt=qt(ot,1,V);return`${A.sub(pt,A.add(Bt,at))}`},[l,at,ot,e]),Mt=(0,_.useMemo)(()=>I&&T?{type:tt.TIP_TYPE.COMMON_ERROR,message:i("extension_wallet_contractual_interaction_wallet_unavailable")}:b?{type:tt.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:N?{type:$t.TYPE.warn,message:i("wallet_extension_asset_alert_trust_network")}:It&&!E?.includes("okx.com")?{type:$t.TYPE.warn,message:It}:{},[b,I,It,N,E]),Et=(0,_.useCallback)(async()=>{await k(J(t.id)),await k(rt()),await yo(k)},[k,t.id]),Dt=(0,_.useCallback)(async()=>{if(!await mo({walletId:x,callback:async()=>{await k(J(t.id))}}))return;let Bt=xe(w);try{let pt=await Ze(T?n:o,r,x,{localType:Bt,isPsbts:T},c);await k(lt(t.id,{signedTx:pt,broadcast:p}))}catch(pt){await yt({id:t.id,error:pt?.message||"Error"})}await k(rt()),gt.push(jt)},[gt,r,yt,k,T,w,o,c,n,t.id,x]);lr({psbtsInfoErr:N,handleCancel:Et});let Ht=er({onConfirm:Dt}),[Ot,Zt]=(0,_.useState)(!1),et=(0,_.useMemo)(()=>{let V=S?.inputInfo||[],Bt=S?.outputInfo||[],pt=V.filter(ut=>ut.address?.includes(r)),eo=Bt.filter(ut=>ut.address?.includes(r)),no=[],Ao=[];return pt.forEach(ut=>{ut.xrcAssets&&ut.xrcAssets.forEach(_t=>{no.some(go=>go.symbol===_t.symbol&&go.protocolId===_t.protocolId)||no.push({symbol:_t.symbol,protocolId:_t.protocolId})})}),eo.forEach(ut=>{ut.xrcAssets&&ut.xrcAssets.forEach(_t=>{Ao.some(go=>go.symbol===_t.symbol&&go.protocolId===_t.protocolId)||Ao.push({symbol:_t.symbol,protocolId:_t.protocolId})})}),no.length>0&&Ao.length>0?!no.every(ut=>Ao.some(_t=>ut.symbol===_t.symbol&&ut.protocolId===_t.protocolId)):!1},[S,r]),bt=(0,_.useMemo)(()=>{let V=S.inputInfo||[],Bt=S.outputInfo||[];return[...V,...Bt].some(pt=>!!(pt.xrcAssets&&pt.xrcAssets.length>1))},[S]),Rt=(0,_.useMemo)(()=>F.some(V=>{let Bt=V.inputInfo||[],pt=V.outputInfo||[];return[...Bt,...pt].some(eo=>!!(eo.xrcAssets&&eo.xrcAssets.length>1))}),[F]);(0,_.useEffect)(()=>{H||(bt||et||S.assetInversion)&&Zt(!0)},[F,H,bt,et,S.assetInversion]);let Io=(0,_.useCallback)(()=>{if(!Rt||!H){Dt();return}Ht()},[Rt,Dt,Ht,H]),wo=(0,_.useCallback)(V=>{U(!0),vt(V)},[U]),{loading:ho,onClick:$}=Q(Et),{loading:Ut,onClick:No}=Q(Io),jo=(0,_.useMemo)(()=>[{loading:ho,actionType:G.ACTION_TYPE.CANCEL,btnText:H?i("wallet_extension_asset_btn_cancel_all"):i("wallet_dapp_connection_btn_reject"),onClick:$},{disabled:b||O||Mt.type===tt.TIP_TYPE.COMMON_ERROR,actionType:G.ACTION_TYPE.CONFIRM,btnText:H?i("wallet_extension_asset_btn_confirm_all"):i("extension_transactions_btn_confirm"),onClick:No,loading:Ut}],[b,ho,Ut,$,Mt,No,H,O]),Ko=(0,_.useMemo)(()=>{switch(e){case Lt.LIST:return i("extension_wallet_transfer_maintitle_list");case Lt.UNLIST:return i("extension_wallet_transfer_maintitle_cancel_listing");case Lt.TRADE:return i("extension_wallet_transfer_maintitle_transaction");default:return i("extension_wallet_transfer_maintitle_transaction")}},[e]),oo=(0,_.useMemo)(()=>e==="list"||S&&!S.isShowFee?!1:A.gt(S.gasFee,0)||A.gt(at,0),[at,S,e]),Er=(0,_.useMemo)(()=>!N||N===kt.EXECUTE_ERROR&&S.status!==kt.PSBT_ANALYSIS_FAILED,[N,S]),br=(0,_.useMemo)(()=>N&&N!==kt.EXECUTE_ERROR||S?.status===kt.PSBT_ANALYSIS_FAILED,[N,S]);return _.default.createElement(u.Container,null,_.default.createElement(Gt,{title:Ko,backable:T&&B,closeable:!1,onBack:()=>{U(!1)}}),H?_.default.createElement("div",null,_.default.createElement(X,null,_.default.createElement(re,{summaryList:[{title:ct,desc:St,icon:{src:st}}],title:i("extension_contract_interaction_maintitle_request_from")})),_.default.createElement(Kn,{psbts:n,loading:O,onClick:wo})):null,H?null:_.default.createElement(_.default.Fragment,null,Er&&_.default.createElement(Xo,{coinId:m,txType:P.TRANS_OUT,loading:O,dappInfo:{name:ct,host:St,icon:st},analyzeRet:S}),br&&_.default.createElement(X,null,(e===Lt.TRADE||e===Lt.RUNES)&&_.default.createElement(po,{summaryList:[{coinId:m,coinAmount:To}],tooltip:i("extension_infor_tooltip_asset_changestips"),title:i("extension_contract_interaction_maintitle_asset_changes")}),_.default.createElement(re,{summaryList:[{title:ct,desc:St,icon:{src:st}}],title:i("extension_contract_interaction_maintitle_request_from")})),oo&&_.default.createElement(X,null,_.default.createElement(co,{coinId:m,networkFee:S.gasFee||at})),_.default.createElement(X,null,_.default.createElement(Jt,{title:i("wallet_extension_network_address_title_walletused"),address:r,walletId:x,onCopyCallback:()=>{D({trade:"approve",all_confirmation:"wallet_used_address"})}})),!oo&&_.default.createElement(X,null,_.default.createElement(En,{coinId:m})),_.default.createElement(X,null,_.default.createElement(Vn,{coinId:m,data:S,currentAddr:r})),_.default.createElement(X,null,_.default.createElement(Do,{data:T?n[v]:o,copyable:{hideDesc:!0}}))),B?null:_.default.createElement(Yt,{placeholder:!0,offsetBottom:0,borderTop:!0},_.default.createElement(tt,{coinId:m,...Mt}),_.default.createElement(G,{buttonGroup:jo})),_.default.createElement(Qn,{visible:Ot,onCancel:()=>{Zt(!1)},onConfirm:()=>{Zt(!1),Et()},headerProps:{coinId:m,txType:P.TRANS_OUT,analyzeRet:S},psbtHasMultiXRCAsset:bt,paymentUseXRCAsset:et,assetInversion:S.assetInversion}))};s();a();var L=d(W()),fr=d(so()),dr=d(ee()),xr=d(ht());R();io();var Tr=({unapproved:t})=>{let o=t.walletId,{localType:n}=t,r=ft({localType:n})?.coinId;r===void 0&&(r=wt(n));let l=lo(o),{memo:c,value:p,memoPos:E,to:T,satBytes:x,from:w,extraParams:f}=t.params.transaction,m=Nt(r),[I,{toggle:b}]=(0,xr.useBoolean)(!1),[D,O]=(0,L.useState)(x?{level:zt.CUSTOM,satBytes:x}:{}),F=D?.satBytes,N=(0,fr.useDispatch)(),B=(0,dr.useHistory)(),[,U]=ko({coinId:r,address:w,chainId:m?.chainId}),v=U?.transferReminder;(0,L.useEffect)(()=>{if(!F&&U?.normal&&O({level:zt.STANDARD,satBytes:U?.normal}),F&&D?.level!==zt.CUSTOM){let et=U[vo[D?.level]?.satBytes];O({...D,satBytes:et})}},[U]);let[vt,H]=Po({coinId:r,walletId:o,address:w,satBytes:F},{}),S=uo(o),[It,k,gt]=nn({coinId:r,toAddr:T,walletId:o,fromAddr:w,satBytes:F,coinAmount:p,canTransferAmount:H},{}),it=(0,L.useMemo)(()=>H===void 0||k===void 0?!0:A.gte(H,A.add(k,p)),[H,p,k]),ct=Fo({coinId:r,txType:P.TRANS_OUT,address:w}),st=rn({memo:c,memoPos:E,coinId:r,toAddr:T,walletId:o,coinAmount:p,fromAddr:w,localType:m?.localType,dustSize:U?.minOutput,networkFee:k,satBytes:D.satBytes}),St=tn({coinId:r,walletId:o,satBytes:F,address:w,utxoType:Kt.TRANSFER}),to=ao(o),[ot,at]=(0,L.useState)(!1),yt=(0,L.useCallback)(async()=>{await N(J(t.id)),await N(rt()),at(!1),B.push(jt)},[N,B,t.id]),To=(0,L.useCallback)(async()=>{if(!await mo({walletId:o,callback:async()=>{await N(J(t.id))}}))return;let bt=await St(p,k);await ct(bt,()=>{yt()}),at(!0);let Rt=await st({utxoList:bt});t.id&&(await N(lt(t.id,{signedTx:Rt,coinAmount:p,serviceCharge:k,satPerByte:F,coinId:r,...f})),await N(rt())),at(!1)},[ct,p,N,k,f,St,yt,F,st,t.id]),Mt=(0,L.useMemo)(()=>l?{type:tt.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:it?gt?{type:tt.TIP_TYPE.FEE_ERROR}:{type:$t.TYPE.warn,message:v}:{type:tt.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[gt,l,it,v]),{loading:Et,onClick:Dt}=Q(yt),{loading:Ht,onClick:Ot}=Q(To),Zt=(0,L.useMemo)(()=>{let et=[{actionType:G.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:Dt,loading:Et}];return it?et=[...et,{disabled:vt||It||gt||l||!Number(k),actionType:G.ACTION_TYPE.CONFIRM,onClick:Ot,loading:Ht}]:et=[...et,{coinId:r,address:w,walletId:o,actionType:G.ACTION_TYPE.FILL_UP}],et},[Et,r,Ht,k,gt,It,w,l,it,vt,Dt,Ot,o]);return L.default.createElement(u.Container,null,L.default.createElement(Gt,{title:i("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),L.default.createElement(X,null,L.default.createElement(po,{title:i("wallet_extension_send_colored_send"),summaryList:[{coinId:r,coinAmount:p}]})),L.default.createElement(X,null,L.default.createElement(Jt,{walletId:o,address:w,title:i("extension_send_mid_text_from"),onCopyCallback:()=>{S({trade:"send",all_confirmation:"wallet_used_address"})}},!!H&&L.default.createElement(Oo,{coinBalance:H,coinId:r})),L.default.createElement(Jt,{address:T,title:i("extension_send_mid_text_to"),onCopyCallback:()=>{S({trade:"send",all_confirmation:"to_address"})}})),L.default.createElement(X,{bordered:!1},L.default.createElement(co,{coinId:r,loading:It,estimateFailed:gt,networkFee:k,level:D?.level,onClick:()=>{b(),S({trade:"send",all_confirmation:"network_fee"})}})),L.default.createElement(Yt,{placeholder:!0,offsetBottom:0,borderTop:!0},L.default.createElement(tt,{coinId:r,...Mt}),L.default.createElement(G,{buttonGroup:Zt})),L.default.createElement(Mo,{coinId:r,visible:I,signInfo:U,value:D,estimatedFee:k,onChange:O,onToggleVisible:b}),L.default.createElement(Uo,{visible:to&&ot}))};s();a();var Co=d(W()),wr=d(ht());Bo();io();s();a();function gr(t){try{return[JSON.parse(t),null]}catch{return[null,new Error("Illegal JSON string")]}}kr();s();a();var Vo=d(W()),Cr=d(so());R();io();s();a();var Y=d(W());R();var $o=d(ht());s();a();var Pt={"inscription-preview":"_inscription-preview_yy6vc_1",inscriptionPreview:"_inscription-preview_yy6vc_1","inscription-preview__inner":"_inscription-preview__inner_yy6vc_13",inscriptionPreviewInner:"_inscription-preview__inner_yy6vc_13","inscription-preview-text":"_inscription-preview-text_yy6vc_21",inscriptionPreviewText:"_inscription-preview-text_yy6vc_21","inscription-preview-image":"_inscription-preview-image_yy6vc_26",inscriptionPreviewImage:"_inscription-preview-image_yy6vc_26","inscription-item__content":"_inscription-item__content_yy6vc_30",inscriptionItemContent:"_inscription-item__content_yy6vc_30","inscription-exceedTip":"_inscription-exceedTip_yy6vc_34",inscriptionExceedTip:"_inscription-exceedTip_yy6vc_34","inscription-extend":"_inscription-extend_yy6vc_39",inscriptionExtend:"_inscription-extend_yy6vc_39","inscription-extend__icon":"_inscription-extend__icon_yy6vc_43",inscriptionExtendIcon:"_inscription-extend__icon_yy6vc_43"};var fe=24,Ro={TEXT:"text",IMAGE:"image"},Qr=Y.default.memo(({type:t,contentType:o,body:n})=>{let[{inscriptionType:e,inscriptionContent:r},l]=(0,$o.useSetState)({inscriptionType:Ro.TEXT,inscriptionContent:n});return(0,Y.useEffect)(()=>{if(t===P.ORDINAL_NFT||o?.startsWith("image/"))try{let c=URL.createObjectURL(new Blob([n]));l({inscriptionType:Ro.IMAGE,inscriptionContent:c})}catch{l({inscriptionType:Ro.TEXT,inscriptionContent:n})}finally{l({initing:!1})}},[n,o,l,t]),Y.default.createElement(u.Box,{className:Pt["inscription-preview"]},e===Ro.IMAGE?Y.default.createElement("img",{alt:"",src:r,className:Pt["inscription-preview-image"]}):Y.default.createElement(u.Box,{className:Pt["inscription-preview__inner"]},Y.default.createElement(y.Text,{forceWrap:!0,className:Pt["inscription-preview-text"]},r)))}),ti=({type:t,contentType:o,body:n,rawBody:e})=>{let r=(0,Y.useMemo)(()=>{let p=n?.length;return A.lt(p,1024)?`${p} B`:`${A.floorTruncate(A.div(p,1024),3)} KB`},[n?.length]),l=t===P.ORDINAL_NFT||o?.startsWith("image/"),c=l?e?.slice(0,200):e;return Y.default.createElement(u.FlexBox,null,Y.default.createElement(Qr,{type:t,body:n,contentType:o}),Y.default.createElement(u.FlexBox,{direction:u.DIRECTION.vertical,className:Pt["inscription-item__content"]},Y.default.createElement(y.Text,{strong:!0,ellipsis:{tooltip:!l},size:y.SIZE.xs},c),Y.default.createElement(y.Text,{size:y.SIZE.xs,type:y.TYPE.secondary},r)))},oi=({type:t,dataSource:o=[]})=>{let n=o?.length||0,[e,{toggle:r}]=(0,$o.useBoolean)(!1),l=(0,Y.useMemo)(()=>e?o?.slice(0,fe):o?.slice(0,3),[o,e]),c=(0,Y.useMemo)(()=>De(t),[t]);return Y.default.createElement(sn,{space:16,title:i(c,{num:n})},Y.default.createElement($e,{space:24,renderEmpty:!1,dataSource:l,renderItem:p=>Y.default.createElement(ti,{...p,type:t})}),e&&n>fe&&Y.default.createElement(y.Text,{size:y.SIZE.xs,type:y.TYPE.secondary,className:Pt["inscription-exceedTip"]},i("wallet_info_dialog_desc_replicate_hide",{num:A.sub(n,fe)})),n>3&&Y.default.createElement(u.FlexBox,{justify:"center",className:Pt["inscription-extend"],onClick:r},Y.default.createElement(nt,{size:nt.SIZE.xs,className:Pt["inscription-extend__icon"],icon:e?"okds-arrow-chevron-up-md":"okx-wallet-plugin-add-arrow-chevrons"})))},yr=oi;function ei({unapproved:t}){let o=(0,Cr.useDispatch)(),{id:n}=t,{type:e}=t.params?.transaction||{},r=Me[e],{localType:l}=t,p=ft({localType:l})?.coinId;p===void 0&&(p=wt(l));let E=async()=>{await o(rt()),await o(J(t.id))},T=async w=>{await o(lt(t.id,w)),await o(rt())},{inscriptions:x}=yn();return Vo.default.createElement(Cn,{txId:n,headerProps:{title:r?i(r):null,closeable:!1,backable:!1},confirmButtonProps:{onCancel:E,onConfirm:T},slot:{top:Vo.default.createElement(X,null,Vo.default.createElement(yr,{type:e,dataSource:x}))},netWorkCoinId:p})}var Ir=ei;var ni=[P.BRC20_MINT,P.BRC20_INSCRIBE,P.BRC20_DEPLOY],ri=[P.RUNES_ETCH];function ii(t,o){let n=Be(o);return ni.includes(t)?n=be(o):ri.includes(t)&&(n=ke(o)),n}function si(t,o){return o.map(({contentType:n,body:e})=>{let r=e;try{(t===P.ORDINAL_NFT||typeof t!="number"&&n?.startsWith("image/"))&&(r=g.Buffer.from(e,"hex"))}catch{}return{contentType:n,body:r,rawBody:e}})}function ai({unapproved:t}){let{tick:o,type:n,from:e,to:r,txSource:l,inscriptions:c=[],amount:p,mintType:E=Oe.parallel,noBroadCast:T=!1}=t.params?.transaction||{},{localType:x}=t,w=(0,Co.useMemo)(()=>si(n,c),[n,c]),f=ft({localType:x}),m=f?.netWorkId;m===void 0?m=ro(x):m=+m;let I=f?.coinId;I===void 0&&(I=wt(x));let b=(0,wr.useCreation)(()=>{if(n===P.RUNES_ETCH){let[B,U]=gr(c[0]?.body);if(U)return{chainId:m,coinType:oe(m),symbol:o,address:"btc-runesMain-invalid-inscriptions"};let v=B?.id||"";return{chainId:m,coinType:oe(m),symbol:o,address:`btc-runesMain-${v}`}}return o?{chainId:m,coinType:bo(m),symbol:o}:null},[o,n,m]),D=ii(n,m),O=Nt(void 0,{},b),F=(B,U)=>{let v=0;if(n===P.RUNES_ETCH){B.coinAmount=Jo(p,10**O?.decimals),B.coinId=O?.coinId||I,B.txSource=l||Vt.DAPP;return}p&&O?.decimals&&(v=Jo(p,10**O?.decimals)),B.coinAmount=v,B.coinId=U?I:O?.coinId||I,B.txSource=l||Vt.DAPP},N=(B,U)=>(B&&F(B,!0),Array.isArray(U)&&U.forEach(v=>{F(v,!1)}),T);return Co.default.createElement(In,{params:{walletId:t.walletId,utxoType:Kt.INSCRIPTION_USE_NFT_UTXO,from:e,to:r,inscriptions:w,txType:n,protocolId:D,mintType:E,netWorkCoinId:I},lifecycle:{beforePostTx:N}},Co.default.createElement(Ir,{unapproved:t}))}var hr=ai;s();a();var Nr=d(W()),Ar=d(so()),de=d(ht());R();ve();var li=({unapproved:t})=>{let o=(0,Ar.useDispatch)(),{targetCoin:n}=t.params||{},e={image:n.logo,decimals:n.decimals,name:n.name,address:n.contractAddress,symbol:n.symbol},r=uo(),l=(0,de.useMemoizedFn)(async()=>{r({all_confirmation:"cancel",trade:"add_token"}),await o(J(t.id)),await yo(o)}),{loading:c,onClick:p}=Q(l),E={actionType:G.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:p,loading:c},T=(0,de.useMemoizedFn)(async()=>{try{r({all_confirmation:"confirm",trade:"add_token"}),await Re(n),await o(lt(t.id)),await yo(o)}catch(I){we.error(I?.data?.originalError?.msg||i("wallet_extenshion_toast_add_failed"))}}),{loading:x,onClick:w}=Q(T),f={actionType:G.ACTION_TYPE.CONFIRM,onClick:w,loading:x},m=[E,f];return Nr.default.createElement(Sn,{token:e,networkName:n.blockChain||n.localType,buttonGroup:m})},Sr=li;var Au=({unapproved:t})=>{switch(t.method){case K.TRANSFER_NFT:case K.SEND_INSCRIPTION:return Ft.default.createElement(kn,{unapproved:t});case K.SPLITUTXO:return Ft.default.createElement(Pn,{unapproved:t});case K.INSCRIBE:case K.INSCRIBE_TRANSFER:return Ft.default.createElement(Un,{unapproved:t});case K.SIGNPSBT:case K.SIGNPSBTS:return Ft.default.createElement(_r,{unapproved:t});case K.SIGN_MESSAGE:return Ft.default.createElement(vn,{unapproved:t});case K.MINT:return Ft.default.createElement(hr,{unapproved:t});case K.WATCHASSET:return Ft.default.createElement(Sr,{unapproved:t});case K.SEND:case K.SEND_BTC:return Ft.default.createElement(Tr,{unapproved:t});default:return""}};export{Au as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=Bitcoin-UXX77VTG.js.map
