import{a as Q}from"./chunk-OZPHJXRI.js";import{d as K}from"./chunk-4MFRD43G.js";import{b as j,c as q,d as z}from"./chunk-L3G6DHBI.js";import{l as C}from"./chunk-DMPLD3VG.js";import{a as A}from"./chunk-WWUOPI5T.js";import{b as X}from"./chunk-WD7752PC.js";import{o as J}from"./chunk-A3FIPWG3.js";import{Ub as Z,ac as le,q as Y}from"./chunk-NTISK7TT.js";import{a as V}from"./chunk-IVA2TTR4.js";import{Gb as y,Ib as E,Jb as g,Kb as H,Lb as F,Mb as M,Nb as W,Ob as $,Zb as w,fc as N}from"./chunk-YILNSICT.js";import{ea as v,ga as _,pa as ue}from"./chunk-LBCQTFOD.js";import{N as me,m as U}from"./chunk-V63HWKAL.js";import{a as k}from"./chunk-B75PPTYD.js";import{f as x,m as f,o as d}from"./chunk-UGZFXKPB.js";f();d();var T={UNAPPROVED:"unapproved",APPROVED:"approved",REJECTED:"rejected",SIGNED:"signed",SUBMITTED:"submitted",FAILED:"failed",DROPPED:"dropped",SUCCEED:"succeed",PENDING:"pending"},l={TRANS_OUT:1,AUTHORIZATION:2,CONTRACT_CALL:3,CANCEL_AUTHORIZATION:4,CONTRACT_DEPLOY:5},Ne={[l.TRANS_OUT]:"wallet_extension_history_list_send",[l.CONTRACT_CALL]:"wallet_extension_history_list_contract_interaction",[l.AUTHORIZATION]:"wallet_extension_history_list_approval",[l.CANCEL_AUTHORIZATION]:"wallet_extension_history_list_revoke_approval",[l.CONTRACT_DEPLOY]:"developer_mode_history_title_contract_eployment"};f();d();var se=x(k()),R=x(J());N();f();d();N();var te=async(e={})=>e?.baseFeePerGas!==void 0,L=e=>parseInt(e,16);function pe({baseFeePerGas:e,number:r}){return{number:r,baseFeePerGas:e,gasUsedRatio:null,priorityFeesByPercentile:null}}function fe({baseFeePerGas:e,number:r,blockIndex:o,gasUsedRatios:n,priorityFeePercentileGroups:s,percentiles:t}){let i=n[o],a=s[o],u=t.reduce((c,m,p)=>{let h=a[p];return{...c,[m]:L(h)}},{});return{number:r,baseFeePerGas:e,gasUsedRatio:i,priorityFeesByPercentile:u}}async function ee({web3:e,numberOfBlocks:r,endBlockNumber:o,percentiles:n,includeNextBlock:s}){let t=await e.eth.getFeeHistory(r,o,n),i=L(t.oldestBlock);if(t.baseFeePerGas!==void 0&&t.baseFeePerGas.length>0&&t.gasUsedRatio.length>0&&(t.reward===void 0||t.reward.length>0)){let a=s?t.baseFeePerGas:t.baseFeePerGas.slice(0,r),u=t.gasUsedRatio,c=t.reward??[],m=u.length;return a.map((p,h)=>{let b=L(p),B=E(i,h);return h>=m?pe({baseFeePerGas:b,number:B}):fe({baseFeePerGas:b,number:B,blockIndex:h,gasUsedRatios:u,priorityFeePercentileGroups:c,percentiles:n})})}return[]}var I=1024;function de(e,r){F(e,r)&&(r=e);let o=[];for(let n=g(e,r);F(n,e);n=E(n,I)){let s=g(e,n),t=s<I?s:I,i=E(n,t);o.push({numberOfBlocks:t,endBlockNumber:i})}return o}var re=async({web3:e,numberOfBlocks:r,endBlock:o="latest",percentiles:n=[],includeNextBlock:s=!1})=>{let t=n.length>0?Array.from(new Set(n)).sort((c,m)=>c-m):[],a=de(o,r);return(await Promise.all(a.map(({numberOfBlocks:c,endBlockNumber:m},p)=>p===a.length-1?ee({web3:e,numberOfBlocks:c,endBlockNumber:m,percentiles:t,includeNextBlock:s}):ee({web3:e,numberOfBlocks:c,endBlockNumber:m,percentiles:t,includeNextBlock:!1})))).reduce((c,m)=>[...c,...m],[])};var Te=e=>e?C(e):{},Pe=["0x144","0x2105"],Ee=e=>(0,se.useCallback)(async()=>e?(await Te(e)).eth.getBlock("latest"):{},[e]),$e=e=>(0,R.useMemoizedFn)(async({to:r,from:o,value:n,data:s=""},t)=>{let i=!t,a="";return s?z(s)?a=Y(s):a=q(s):i||(a=Q(r,n||0)),await(await C(e)).eth.estimateGas({from:o,to:i?r:t,value:i?n:null,data:a||null})},[e]),S=["low","medium","high"],ne={low:{percentile:10,base:1.1,priority:.94,minSuggestedMaxPriorityFeePerGas:1e9,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:3e4}},medium:{percentile:20,base:1.2,priority:.97,minSuggestedMaxPriorityFeePerGas:15e8,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:45e3}},high:{percentile:30,base:1.25,priority:.98,minSuggestedMaxPriorityFeePerGas:2e9,estimatedWaitTimes:{minWaitTimeEstimate:15e3,maxWaitTimeEstimate:6e4}}};function he(e){let r=e.slice().sort((s,t)=>F(g(s,t),0)?-1:1),o=r.length,n=Math.floor((o-1)/2);return r[n]}var xe=(e,r,o)=>{let n=o[e],s=r[r.length-1].baseFeePerGas,t=y(s,n.base),i=r.map(p=>"priorityFeesByPercentile"in p?p?.priorityFeesByPercentile?.[n.percentile]:null).filter(Boolean),a=he(i),u=y(a,n.priority),c=H([u,n.minSuggestedMaxPriorityFeePerGas]),m=E(t,c);return{baseFeePerGas:w(t,0),maxFeePerGas:w(m,0),maxPriorityFeePerGas:w(c,0)}},_e=(e,r)=>S.reduce((o,n)=>{let s=xe(n,e,r),{maxFeePerGas:t}=s;return[...o,{level:n,isSupportEip1559:!0,gasPrice:t,...s}]},[]),ge=(e,r)=>(0,R.useMemoizedFn)(async o=>{let n=await C(e),s=await re({web3:n,endBlock:o.number,numberOfBlocks:21,percentiles:[10,20,30]});return _e(s,r)},[e]),Fe={low:{coefficient:1.1,level:"low"},medium:{coefficient:1.35,level:"medium"},high:{coefficient:1.7,level:"high"}},Ce=(e,r)=>(0,R.useMemoizedFn)(async()=>{let n=await(await C(e)).eth.getGasPrice();return S.reduce((s,t)=>{let{level:i,coefficient:a}=r[t];return[...s,{level:i,gasPrice:y(n,a)}]},[])},[e]);function Re(e){let{rpcNetworks:r}=K(),o=r.find(n=>n?.rpcUrl===e);return S.reduce((n,s)=>{let t=o?.gasNormal?.[s]||Fe[s]?.coefficient,i=o?.gas1559?.[s]||ne?.[s];return{evmNormalGasPrice:{...n.evmNormalGasPrice,[s]:{level:s,coefficient:t}},evm1559GasPrice:{...n.evm1559GasPrice,[s]:{...ne[s],base:i?.base,priority:i?.priority}}}},{})}var Ye=e=>{let r=Re(e),o=Ee(e),n=Ce(e,r?.evmNormalGasPrice),s=ge(e,r?.evm1559GasPrice);return(0,R.useMemoizedFn)(async t=>{if(e){let i=await o(),a=!Pe.includes(t)&&await te(i),u,c=a?s:n;try{u=await c(i)}catch{u=await n(i)}return u}return[]},[e])};f();d();var P=x(k()),G=x(le()),oe=x(J());ue();me();N();function ye(){return(0,G.useSelector)(Z,G.shallowEqual)}function D(e,r){let o=ye(),n=X(),{extensionConfig:s}=A("rpc_info"),t=r||s;return(0,P.useMemo)(()=>Object.values(o).filter(i=>{if(!i.txParams)return!1;let{from:a,chainId:u}=i.txParams;return n===a&&u===t.chainId&&e(i)}),[o,n,t.chainId])}function ot(e){return D(r=>r.status===T.FAILED||r.status===T.SUCCEED,e)}function ie(e){let[r,o]=e,n=+r,s=+U.add(1,"d",new Date(o));return t=>$(t,n)&&M(t,s)}function ae(e={},r=null){let{dates:o}=e,n=D(s=>s.status===T.FAILED||s.status===T.SUCCEED||s.status===T.DROPPED,r);return(0,P.useMemo)(()=>{let s=n;if(o){let t=ie(o);s=s.filter(({finishTime:i})=>t(i))}return s.sort((t,i)=>i.finishTime-t.finishTime).map(t=>({...t,isShowPending:!1}))},[n,o])}function ce(e={},r=null){let o=D(s=>s.status===T.PENDING,r),{dates:n}=e;return(0,P.useMemo)(()=>{let s=v(o,[t=>j(t.txParams.nonce)]).map((t,i)=>({...t,isShowPending:i===0}));if(n){let t=ie(n);s=s.filter(({sendTime:i})=>t(i))}return s},[o,n])}function we(){let e=ce(),r=ae();return(0,P.useMemo)(()=>[...e,...r],[e,r])}function it(e){let r=we();return(0,P.useMemo)(()=>e?r.find(({id:o})=>e===o):null,[e,r])}function at({tokenAddress:e}){let r=ce(),o=ae();return(0,P.useMemo)(()=>[...r,...o].filter(({type:n,txParams:s,extraParams:t})=>{if(n===l.TRANS_OUT)return!e&&!t?.tokenAddress||_(e)===_(t?.tokenAddress);if(n===l.AUTHORIZATION||n===l.CANCEL_AUTHORIZATION)return _(e)===_(t?.tokenAddress);if(n===l.CONTRACT_CALL){let{value:i}=s||{};return!e&&W(V(i),0)}return!1}),[r,o,e])}var Ge=(e,r,o)=>{let{protocol:n,host:s,pathname:t,search:i,hash:a}=new URL(e),u=t.endsWith("/")?`${t}${r}/${o}`:`${t}/${r}/${o}`;return new URL(`${n}//${s}${u}${i}${a}`).toString()};function ct(){let{extensionConfig:e}=A("rpc_info");return(0,oe.useMemoizedFn)(r=>e?.explorerUrl?Ge(e?.explorerUrl,"tx",r):null)}export{T as a,l as b,Ne as c,ot as d,ae as e,ce as f,we as g,it as h,at as i,Ge as j,ct as k,$e as l,Ye as m};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-V2P5T42X.js.map
