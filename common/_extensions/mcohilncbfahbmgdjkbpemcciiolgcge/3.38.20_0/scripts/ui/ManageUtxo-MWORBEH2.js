import{a as te}from"./chunk-2XYRURE2.js";import{a as R}from"./chunk-Q2BK5I52.js";import{d as bt}from"./chunk-4NCQWC2K.js";import"./chunk-BSEC3HD3.js";import"./chunk-SR5VKAMR.js";import{c as Lt}from"./chunk-IVCA3VWI.js";import"./chunk-XN45YXW3.js";import"./chunk-M75TVG7W.js";import"./chunk-YXS5E7TI.js";import"./chunk-XUKRDQIU.js";import"./chunk-YOJOUOFP.js";import{h as vt}from"./chunk-7OQVWENF.js";import{a as Jt}from"./chunk-WD7752PC.js";import"./chunk-SLWKMGPD.js";import"./chunk-UC77E3WD.js";import"./chunk-GTSNHSPT.js";import"./chunk-LVPRDSPO.js";import{a as Rt}from"./chunk-RJO5LUBF.js";import"./chunk-DRPGNVVL.js";import{a as Kt}from"./chunk-UEENMIFU.js";import"./chunk-3OMHZBKM.js";import"./chunk-A264YTOP.js";import"./chunk-LRVKM4IV.js";import"./chunk-PVSNAFN3.js";import{b as Et}from"./chunk-JYKQJVIF.js";import{m as gt,q as b}from"./chunk-GBQG32PI.js";import"./chunk-Q6XXIWBJ.js";import"./chunk-VWYA3Z7M.js";import"./chunk-A3FIPWG3.js";import{ac as jt,ob as Wt,zb as Qt}from"./chunk-NTISK7TT.js";import"./chunk-MXRUZQZ7.js";import"./chunk-CU7RFE6B.js";import"./chunk-J4UWPXXS.js";import{a as Ae}from"./chunk-QZUNX5I4.js";import"./chunk-OG3IV3YP.js";import"./chunk-45FKVGCF.js";import"./chunk-KSCBZ3RY.js";import{d as Vt,f as Ce}from"./chunk-37O7OMRA.js";import"./chunk-5PGNMLJO.js";import"./chunk-35FUKWV2.js";import"./chunk-DHNKVM4B.js";import"./chunk-VL5VJIZ7.js";import{c as L}from"./chunk-TU7CE5HJ.js";import{a as yt}from"./chunk-2NE2FMGV.js";import{$b as Gt,Gb as St,Hb as Mt,Ib as pt,Uc as ft,Wc as Ne,Xc as xt,Y as rt,Ya as At,Yc as Ie,fc as Zt,ya as J}from"./chunk-YILNSICT.js";import"./chunk-ORQMOT6Z.js";import{A as Ut,G as Bt,N as Q,c as wt,f as Dt,o as G,r as qt,y as Z}from"./chunk-L4N7WJIQ.js";import"./chunk-LBCQTFOD.js";import{N as $,v as Ct,w as t}from"./chunk-V63HWKAL.js";import"./chunk-ZZ2UZY4M.js";import"./chunk-XFAFBXWC.js";import"./chunk-7EEPBGCR.js";import"./chunk-CY6DCOJP.js";import{H as kt,T as W,Z as dt,ca as d}from"./chunk-2EJYCNYZ.js";import"./chunk-V2K75WCG.js";import{a as k}from"./chunk-B75PPTYD.js";import"./chunk-2AWSM2JA.js";import"./chunk-QXPU36HD.js";import"./chunk-QI5O5UGB.js";import"./chunk-2OGSVQVK.js";import"./chunk-Y5BBPTSN.js";import"./chunk-5LMNZ6ME.js";import"./chunk-LQWZRQFF.js";import"./chunk-VGOLUGG3.js";import"./chunk-6SIBAM5N.js";import"./chunk-42IJDSSW.js";import"./chunk-BMKS7XLD.js";import"./chunk-MTFM4GGW.js";import{f as y,m as o,o as n}from"./chunk-UGZFXKPB.js";o();n();var nt=y(k()),fe=y(Ae()),xe=y(kt());$();At();o();n();var r=y(k()),pe=y(jt());$();Zt();o();n();$();var Se=({isUnSpend:e=!1,onConfirm:m=()=>{},coin:_})=>async()=>{if(e){let i=G.warn({alignBottom:!1,title:t("wallet_extension_footer_btn_unfreeze"),text:t("wallet_extension_bot_text_confirm_unoccupy_icu",{chainName:_?.symbol}),cancelText:t("wallet_extension_bot_btn_reconsider"),confirmText:t("wallet_extension_btn_general_confirm"),onCancel:()=>{i.destroy()},onConfirm:async()=>{await m()}})}else await m()},ee=Se;o();n();var Pt=y(k()),ne=y(jt());Ce();At();Ie();Ne();var oe={utxoList:[],totalUtxoNum:0,canTransferAmount:0};function ke(e){let _=R().get("coinId"),s=bt(_||J,{withPrice:!0,withPriceChangePercent24h:!1}),i=Jt(rt),u=(0,ne.useSelector)(Wt),v=vt(rt)[e],c=e?v:i,U=(0,Pt.useCallback)(async()=>{let C={coinId:s?.coinId,utxoRequests:[{address:c,utxoType:12}]};try{let{data:N}=await ft(xt.getBTCUTXO,C);return N.length===1?N[0]:oe}catch{return oe}},[c,s]),A=(0,Pt.useCallback)(async(C,N,B)=>{let I=s?.chainId;if(!I&&I!==0)return{};let z={txHash:C,address:c,status:B,vout:N,chainId:I};try{let{data:M}=await ft(xt.getUTXOAsset,z);return M}catch{return{}}},[s]);return{fetchUTXO:U,fetchUTXOAsset:A,manageUTXO:async({utxoList:C=[],spentStatus:N})=>{let B=s?.chainId,I=await Vt().getRequestHeaders({walletId:u,needSign:!0,currency:"usd"}),z={address:c,spentStatus:N,chainId:B};C&&(z.utxoList=C);try{return await ft(xt.manageUTXO,z,{headers:I})}catch{return{}}}}}var Tt=ke;o();n();var g=y(k());At();var re=(e,m)=>{let s=R().get("coinId"),i=bt(s||J,{withPrice:!0,withPriceChangePercent24h:!1}),[u,x]=(0,g.useState)({address:"",canTransferAmount:"",utxoList:[],totalUtxoNum:0}),[v,c]=(0,g.useState)(!0),[U,A]=(0,g.useState)({}),[j,C]=(0,g.useState)(!1),{fetchUTXO:N,fetchUTXOAsset:B}=Tt(m),I=(0,g.useCallback)(async()=>{c(!0);let a=await N();return c(!1),a},[N]),z=(0,g.useCallback)(async()=>{if(!i?.coinId&&i?.coinId!==0)return;let a=await I();x(a)},[I]),M=(0,g.useCallback)(async(a,F,E)=>{C(!0);let X=await B(a,F,E);A(X),C(!1)},[B]),O=(0,g.useMemo)(()=>(u?.utxoList||[]).filter(a=>a.utxoStatusType===e),[u,e]),ht=(0,g.useMemo)(()=>O.reduce((a,F)=>a+F.coinAmount,0),[O]),lt=(0,g.useMemo)(()=>O.every(a=>a.select),[O]),Nt=(0,g.useMemo)(()=>O.filter(a=>a.select),[O]),mt=a=>{let F=(u?.utxoList||[]).map(E=>E.utxoStatusType===e?{...E,select:a}:{...E});x({...u,utxoList:F})},ct=({txHash:a,vout:F})=>{let E=(u?.utxoList||[]).map(X=>X.txHash===a&&X.vout===F?{...X,select:!X.select}:X);x({...u,utxoList:E})};return(0,g.useEffect)(()=>{(async()=>await z())()},[i?.coinId]),{utxoData:u,activeList:O,activeAmount:ht,loading:v,selectList:Nt,isSelectAll:lt,selectUtxo:ct,handleSelectAll:mt,fetchAndSetData:z,detail:U,fetchDetail:M,detailLoading:j,coin:i}};o();n();o();n();var w=y(k());$();o();n();var it={main:"_main_19np7_1",btn:"_btn_19np7_7",header:"_header_19np7_10",banner:"_banner_19np7_14",subContent:"_subContent_19np7_21"};var ie=({visible:e,close:m,token:_})=>{let s=w.default.createElement(w.default.Fragment,null,w.default.createElement("div",{className:it.main},w.default.createElement(b.Text,{strong:700,className:it.header},t("extension_defi_toast_title_manage_utxos")),w.default.createElement(b.Text,{className:it.subContent},t("extension_defi_toast_text_utxo_usage",{token:_}))),w.default.createElement("div",{className:it.btn},w.default.createElement(d,{block:!0,type:d.TYPE.highlight,size:d.SIZE.lg,onClick:()=>{m()}},t("wallet_extension_btn_general_gotit"))));return w.default.createElement(G.Action,{onClose:()=>{m()},visible:e,title:w.default.createElement(w.default.Fragment,null),alignBottom:!0,maskClosable:!0,topStyle:{border:"none",padding:"12px"},windowStyle:{overflow:"hidden"},noTopRadius:!1,renderContent:()=>s})};o();n();var et=y(k());$();o();n();var tt={header:"_header_y50y8_1",title:"_title_y50y8_11",amount:"_amount_y50y8_14",unfreeze:"_unfreeze_y50y8_21",text:"_text_y50y8_26",divider:"_divider_y50y8_29",icon:"_icon_y50y8_32",currency:"_currency_y50y8_36",background:"_background_y50y8_43"};var se=({amount:e="",currencyAmount:m="",symbol:_="",activeTab:s})=>{let i=yt();return et.default.createElement("div",{className:tt.header},et.default.createElement("img",{alt:"UTXO",src:`${i}/cdn/assets/imgs/241/46CBAC7179F5F752.png`,className:tt.background}),et.default.createElement(b.Text,{className:tt.title,size:b.SIZE.sm},s===1?t("wallet_extension_card_input_total_amount"):t("wallet_extension_card_input_total_unavailable")),et.default.createElement("div",{className:tt.amount},`${e} ${_}`),et.default.createElement("div",{className:tt.currency},m))};o();n();var f=y(k());$();o();n();var T=y(k());$();o();n();var D={nftContain:"_nftContain_19spt_1",detail:"_detail_19spt_4",detailLeft:"_detailLeft_19spt_12",img:"_img_19spt_22",tokenAltImg:"_tokenAltImg_19spt_33",altImgFont:"_altImgFont_19spt_44",content:"_content_19spt_51",badge:"_badge_19spt_55",currency:"_currency_19spt_63"};var ae=({item:e,getUSDtoCurrency:m})=>{let _=yt(),s=e.protocolType===1,i=s?`${gt(e.tokenAmount)} ${e.tokenSymbol}`:e.collectionName,u=()=>{let x={fontSize:"16px",lineHeight:"20px"};return s?(e.tokenSymbol.length>4&&(x={fontSize:"12px",lineHeight:"16px"}),T.default.createElement("div",{className:D.tokenAltImg},T.default.createElement("div",{className:D.altImgFont,style:x},e.tokenSymbol))):T.default.createElement("div",{className:D.img},T.default.createElement("img",{src:`${_}/cdn/assets/imgs/241/C82F2BF8460AC236.png`,alt:"nft-img"}))};return T.default.createElement("div",{className:D.nftContain},T.default.createElement("div",{className:D.detail},T.default.createElement("div",{className:D.detailLeft},e.logo?T.default.createElement("div",{className:D.img},T.default.createElement("img",{src:e.logo,alt:"nft-img"})):u(),T.default.createElement(L.FlexBox,{direction:L.DIRECTION.vertical,className:D.content},T.default.createElement(b.Text,{ellipsis:{tooltip:!0},style:{flex:1}},i),e.protocolName&&T.default.createElement(Dt,{type:Dt.TYPE.rect,className:D.badge},e.protocolName))),T.default.createElement(b.Text,{size:b.SIZE.xs,className:D.currency},e.usdAmount?m(e.usdAmount):t("extension_defi_card_text_unknown_value")),T.default.createElement("div",null)))};o();n();var P={detailDialog:"_detailDialog_10fh7_1",container:"_container_10fh7_4",footer:"_footer_10fh7_9",alertIcon:"_alertIcon_10fh7_18",loading:"_loading_10fh7_25",error:"_error_10fh7_29",empty:"_empty_10fh7_33",unknown:"_unknown_10fh7_37"};var le=({visible:e,closeCallback:m,detail:_,detailLoading:s,getUSDtoCurrency:i,detailUTXO:u,fetchDetail:x})=>{let{protocolAssetList:v,assetUnknown:c=[]}=_,U=c.join(t("extension_wallet_text_punctuation_mark"));return f.default.createElement(G.Action,{onClose:()=>{m()},visible:e,maskClosable:!0,noTopRadius:!1,windowClass:P.detailDialog,alignBottom:!0},s&&f.default.createElement("div",{className:P.loading},f.default.createElement(dt.Circle,null)),!s&&v&&f.default.createElement(f.default.Fragment,null,f.default.createElement("div",{className:P.container},c.length>0&&f.default.createElement("div",{className:P.unknown},f.default.createElement(wt,{desc:t("extension_defi_popup_alert_utxo_not_decode_yet",{asset:U}),type:wt.TYPE.warn,closable:!1})),v.length>0?v.map(A=>f.default.createElement(f.default.Fragment,null,f.default.createElement(ae,{getUSDtoCurrency:i,key:A.protocolId,item:A}))):f.default.createElement(Z.State,{type:c.length>0?Z.State.TYPE.noRecord:Z.State.TYPE.noResult,title:c.length>0?t("extension_defi_popup_emptystate_btn_nodata"):t("extension_defi_toast_error_no_inscriptions"),className:P.empty})),v.length>0&&f.default.createElement("div",{className:P.footer},f.default.createElement(Et,{size:Et.SIZE.xs,className:`okds-information-circle-fill ${P.alertIcon}`}),f.default.createElement("div",null,t("extension_defi_bot_tips_show_300_assets")))),!s&&!v&&f.default.createElement("div",{className:P.container},f.default.createElement(Z.State,{type:Z.State.TYPE.noNetwork,className:P.error,title:t("extension_defi_popup_emptystate_title_data_loading_fail"),buttonText:t("extension_defi_popup_emptystate_btn_reload"),onButtonClick:()=>{x(u.txHash,u.vout,u.status)}})))};o();n();var at=y(k());$();o();n();var st={btnWrapper:"_btnWrapper_14mei_1",confirmBtn:"_confirmBtn_14mei_5",tipContent:"_tipContent_14mei_8",closeBtn:"_closeBtn_14mei_11"};var me=({tipData:e,handleConfirm:m,symbol:_})=>at.default.createElement(G.Tip,{visible:e.visible,titleCenter:!0,title:t("extension_investutxo_mid_text_successfully_unlock"),closeClassName:st.closeBtn,renderFooter:()=>at.default.createElement("div",{className:st.btnWrapper},at.default.createElement(d,{size:d.SIZE.lg,type:d.TYPE.highlight,category:d.CATEGORY.fill,onClick:m,className:st.confirmBtn},t("extension_defi_modal_btn_ok")))},at.default.createElement(b.Text,{type:b.TYPE.secondary,size:b.SIZE.sm,className:st.tipContent,align:b.ALIGN.center},t("extension_investutxo_mid_textarea_released_and_get_token",{num:e.valuelessNftNum,num1:e?.freedBtcAmount,symbol:_})));o();n();var h=y(k());$();Zt();var zt=y(kt());o();n();var H={footerContain:"_footerContain_19y6a_1",footer:"_footer_19y6a_1",tip:"_tip_19y6a_8",footerIcon:"_footerIcon_19y6a_15",leftBtn:"_leftBtn_19y6a_22",rightBtn:"_rightBtn_19y6a_25"};var ce=({selectList:e=[],handleConfirm:m,handleSelectAll:_,divDecimal:s,activeTab:i,isSelectAll:u,utxoData:x,symbol:v})=>{let c=e.length,U=x?.utxoList?.length===0,A=x?.totalUtxoNum,j=(0,h.useMemo)(()=>e.reduce((B,I)=>pt(B,I.coinAmount),0),[e]),C=(0,h.useMemo)(()=>i===1?c===0?t("wallet_extension_footer_btn_frozen"):t("wallet_extension_footer_btn_frozen_value",{value:c}):c===0?t("wallet_extension_footer_btn_unfreeze"):t("wallet_extension_footer_btn_unfreeze_value",{value:c}),[i,c]),N=()=>i===2&&c!==0?h.default.createElement("div",{className:H.tip},h.default.createElement(W,{className:(0,zt.default)("okds-information-circle-fill",H.footerIcon)}),h.default.createElement("div",null,t("extension_investutxo_bot_textarea_desc_potential_risk",{extension_investutxo_bot_textarea_desc_potential_risk:c,numToken:`${s(j)} ${v}`}))):A>300?h.default.createElement("div",{className:H.tip},h.default.createElement(W,{className:(0,zt.default)("okds-information-circle-fill",H.footerIcon)}),h.default.createElement("div",null,A<=1e3?t("extension_defi_bot_tips_300_utxo_variable_unlock",{num:A}):t("extension_defi_bot_tips_300_utxo_unlock"))):null;return h.default.createElement(Kt.FooterActions,{className:H.footerContain},h.default.createElement("div",{className:H.footer},N(),h.default.createElement(L.FlexBox,null,h.default.createElement(d,{category:d.CATEGORY.outline,type:d.TYPE.secondary,size:d.SIZE.lg,disabled:U,onClick:()=>{_(!u)},className:H.leftBtn},u?t("extension_defi_mid_btn_cancel"):t("extension_investutxo_bot_btn_select_all")),h.default.createElement(d,{size:d.SIZE.lg,type:d.TYPE.highlight,category:d.CATEGORY.fill,disabled:c===0,onClick:m,className:H.rightBtn},C))))};o();n();var Ft=y(k()),_e=y(kt());o();n();var Ot={root:"_root_15vei_1",item:"_item_15vei_6",more:"_more_15vei_14",arrow:"_arrow_15vei_22"};function we({onClick:e}){return Ft.default.createElement("div",{className:Ot.root,onClick:e},Ft.default.createElement(W,{className:(0,_e.default)("okx-wallet-plugin-arrow-small-right",Ot.arrow)}))}var ue=we;o();n();var S={"retina-border-basic":"_retina-border-basic_1vxmz_1",retinaBorderBasic:"_retina-border-basic_1vxmz_1",main:"_main_1vxmz_29",scrollArea:"_scrollArea_1vxmz_36",item:"_item_1vxmz_40",select:"_select_1vxmz_74",content:"_content_1vxmz_78",itemTitle:"_itemTitle_1vxmz_81",itemSubTitle:"_itemSubTitle_1vxmz_88",circle:"_circle_1vxmz_94",checkIcon:"_checkIcon_1vxmz_95",empty:"_empty_1vxmz_110",loading:"_loading_1vxmz_113",nftPortal:"_nftPortal_1vxmz_118",internalPortal:"_internalPortal_1vxmz_122"};var de=({baseCoin:e,addressType:m})=>{let[_,s]=(0,r.useState)(!1),[i,u]=(0,r.useState)(2),[x,v]=r.default.useState({visible:!1,valuelessNftNum:0,freedBtcAmount:""}),[c,U]=r.default.useState(!1),[A,j]=r.default.useState({txHash:"",vout:0,status:0}),{utxoData:C,loading:N,fetchAndSetData:B,selectList:I,isSelectAll:z,selectUtxo:M,handleSelectAll:O,detail:ht,fetchDetail:lt,detailLoading:Nt,activeList:mt,activeAmount:ct,coin:a}=re(i,m);(0,r.useEffect)(()=>{Ct.get("manageUTXOAlert")||!a?.symbol||(U(!0),Ct.set("manageUTXOAlert",!0))},[a]);let{manageUTXO:F}=Tt(m),E=(0,pe.useSelector)(Qt),X=i===2,ye=l=>{j({txHash:l.txHash,vout:l.vout,status:l.status}),lt(l.txHash,l.vout,l.status),s(!0)},Yt=l=>{let Y=a?.decimals||8;return Mt(l,10**Y)},_t=l=>{let Y=Yt(l);return gt(Y)},ge=ee({isUnSpend:X,onConfirm:async()=>{let Y={utxoList:I.map(({txHash:V,vout:It,coinAmount:he})=>({txHash:V,vout:It,coinAmount:he})),spentStatus:i===1?0:1},{code:K,msg:ut}=await F(Y);await B();let Ht=I.reduce((V,It)=>pt(V,It.coinAmount),0);if(K===0){let V=i===1?"extension_defi_mid_toast_frozen_success":"extension_defi_mid_toast_unfreeze_successful";Bt.success({title:t(V,{value:_t(Ht),token:e.symbol})})}else{let V=i===1?"wallet_extension_top_toast_frozen_failed":"wallet_extension_top_toast_unfreeze_failed";Bt.error({title:ut||t(V)})}},coin:a}),ve=async l=>{u(l)},$t=l=>{let Y=Yt(l),K=a?.currencyPrice||0,ut=a?.currencySymbol||"$";return Lt(St(Gt(Y),K),{symbol:ut,isFixedUp:!0})},be=l=>{let Y=E?.symbol||"$",K=E?.usdToThisRate||1;return Lt(St(l,K),{symbol:Y,isFixedUp:!0})},Te=()=>N?r.default.createElement("div",{className:S.scrollArea},r.default.createElement("div",{className:S.loading},r.default.createElement(dt.Circle,null))):mt.length===0?r.default.createElement(Z.State,{className:S.empty,title:i===2?t("wallet_extension_mid_text_utxo_available"):t("wallet_extension_mid_text_noutxo_now")}):r.default.createElement("div",{className:S.scrollArea},r.default.createElement(se,{amount:_t(ct),currencyAmount:$t(ct),symbol:e.symbol,activeTab:i}),r.default.createElement("div",{className:S.list},(mt||[]).map(l=>r.default.createElement(L.FlexBox,{className:S.item,align:L.ALIGN.center,key:`${l.txHash}${l.vout}`},r.default.createElement("div",{className:S.select,onClick:()=>M(l)},r.default.createElement(qt.Circle,{checked:l.select})),r.default.createElement(L.FlexBox,{className:S.content,direction:L.DIRECTION.vertical},r.default.createElement("div",{className:S.itemTitle},`${_t(l.coinAmount)} ${e.symbol}`),r.default.createElement("div",{className:S.itemSubTitle},$t(l.coinAmount))),r.default.createElement(ue,{onClick:()=>ye(l)})))));return r.default.createElement(r.default.Fragment,null,r.default.createElement("div",{className:S.main},r.default.createElement(Q,{activeId:i,style:{height:"auto"},size:Q.SIZE.sm,category:Q.CATEGORY.outline,hideContent:!0,type:Q.NEW_TYPE.highlight,onChange:ve},r.default.createElement(Q.TabPane,{tab:t("wallet_extension_top_tab_unavailable"),id:2}),r.default.createElement(Q.TabPane,{tab:t("wallet_extension_top_tab_available"),id:1})),Te()),r.default.createElement(ce,{selectList:I,utxoData:C,activeTab:i,handleConfirm:ge,divDecimal:_t,handleSelectAll:O,isSelectAll:z,symbol:e.symbol}),r.default.createElement(le,{visible:_,closeCallback:s,detail:ht,getUSDtoCurrency:be,detailLoading:Nt,detailUTXO:A,fetchDetail:lt}),r.default.createElement(ie,{visible:c,close:()=>U(!1),token:a?.symbol}),r.default.createElement(me,{tipData:x,handleConfirm:()=>v({...x,visible:!1}),symbol:e.symbol}))};o();n();var Xt={container:"_container_8wg37_1",headerIcon:"_headerIcon_8wg37_8"};var De=()=>{let e=(0,fe.useHistory)(),m=R(),_=m.get("addressType"),s=m.get("coinId"),{baseCoin:i={}}=te(s||J,!0),x=vt(rt)[_],v=()=>{e.go(-1)};return nt.default.createElement("div",{className:Xt.container},nt.default.createElement(Rt,{title:t("wallet_extension_header_title_manage_utxo"),onBack:v,closeable:!1},nt.default.createElement(Ut,{placement:Ut.DIRECTION.bottom,title:i.symbol?t("extension_defi_popup_tooltips_text_utxo_usage",{token:i.symbol}):""},nt.default.createElement(W,{className:(0,xe.default)("okds-information-circle",Xt.headerIcon)}))),nt.default.createElement(de,{addressType:_,baseCoin:i,looker:x,coinId:s}))},Hr=De;export{Hr as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=ManageUtxo-MWORBEH2.js.map
