import{b as he}from"./chunk-Q255HBS7.js";import{a as Ee}from"./chunk-ATT4JLQO.js";import{d as ge}from"./chunk-BNCPRLHO.js";import{a as M,b as _e}from"./chunk-Y4NQNAEQ.js";import{a as we}from"./chunk-Q2BK5I52.js";import{b as X,c as ee,d as oe,e as te,f as re,g as se,l as ae,m as ne,n as ie,o as le}from"./chunk-XZVVM3AM.js";import"./chunk-2CODIL7S.js";import"./chunk-KOYKYCEB.js";import{a as de,b as ue}from"./chunk-5OABWI4F.js";import"./chunk-YDUQEL3D.js";import"./chunk-SWHCYDK2.js";import{P as H}from"./chunk-FJBNQZUR.js";import{a as fe}from"./chunk-DKN2AV5Y.js";import"./chunk-YV3R2S6K.js";import"./chunk-RJO5LUBF.js";import{l as z,m as Z,n as j,o as G}from"./chunk-DRPGNVVL.js";import{a as ce}from"./chunk-UEENMIFU.js";import"./chunk-A264YTOP.js";import{F as q,Ra as J,a as N,ha as Q}from"./chunk-PVSNAFN3.js";import"./chunk-JYKQJVIF.js";import"./chunk-GBQG32PI.js";import"./chunk-Q6XXIWBJ.js";import"./chunk-VWYA3Z7M.js";import{o as Be}from"./chunk-A3FIPWG3.js";import{ac as pe,rb as me}from"./chunk-NTISK7TT.js";import"./chunk-CU7RFE6B.js";import"./chunk-J4UWPXXS.js";import{a as He}from"./chunk-QZUNX5I4.js";import"./chunk-OG3IV3YP.js";import"./chunk-45FKVGCF.js";import{ca as B,da as Ue,ta as V,ya as ve}from"./chunk-KSCBZ3RY.js";import{d as $,f as Ke}from"./chunk-37O7OMRA.js";import"./chunk-VL5VJIZ7.js";import"./chunk-TU7CE5HJ.js";import{Ic as Y,Oc as De,ic as D,o as v,oc as Fe,z as xe}from"./chunk-YILNSICT.js";import"./chunk-ORQMOT6Z.js";import{D as g,H as K,q as A}from"./chunk-L4N7WJIQ.js";import{F as W,pa as We}from"./chunk-LBCQTFOD.js";import{N as Me,w as n}from"./chunk-V63HWKAL.js";import"./chunk-XFAFBXWC.js";import"./chunk-7EEPBGCR.js";import"./chunk-CY6DCOJP.js";import{ca as T}from"./chunk-2EJYCNYZ.js";import"./chunk-V2K75WCG.js";import{a as U}from"./chunk-B75PPTYD.js";import"./chunk-2AWSM2JA.js";import"./chunk-QXPU36HD.js";import"./chunk-QI5O5UGB.js";import"./chunk-2OGSVQVK.js";import"./chunk-Y5BBPTSN.js";import"./chunk-5LMNZ6ME.js";import"./chunk-LQWZRQFF.js";import"./chunk-VGOLUGG3.js";import"./chunk-6SIBAM5N.js";import"./chunk-42IJDSSW.js";import"./chunk-BMKS7XLD.js";import"./chunk-MTFM4GGW.js";import{f,m as w,o as _}from"./chunk-UGZFXKPB.js";w();_();var t=f(U()),k=f(pe()),L=f(Be());We();Me();Ke();w();_();var E=f(U()),S=f(pe()),Pe=f(He());Ue();function Te(){let c=(0,S.useDispatch)(),i=(0,Pe.useHistory)(),u=(0,S.useSelector)(me),[d,b]=(0,E.useState)(!1);return(0,E.useEffect)(()=>{u&&!d&&(c(B(!1)),i.push(N))},[u,d,i,c]),(0,E.useCallback)(()=>{b(!0)},[])}Fe();w();_();var Ae=c=>{let{onboardingTabs:i}=c.metamask;if(!i||Object.keys(i).length!==1)return null;let u=Object.keys(i)[0],d=i[u];return{location:u,tabId:d}};xe();De();ve();var p={SEED:"seed",KEY:"key",HARDWARE:"hardware",CREATE:"create",MPC:"mpc",BULK:"bulk"},To=({history:c})=>{let i=we(),u=g.useForm(),[d,{set:b}]=(0,L.useBoolean)(!1),[l,be]=(0,t.useState)({}),r=(0,k.useDispatch)(),{seedPhrase:h,privateKey:I,mpcInfo:ye,unlockHardwareWallets:y,chooseNetworkList:x,isTonMnemonic:Ce}=(0,k.useSelector)(e=>({seedPhrase:X(e),privateKey:ee(e),mpcInfo:te(e),unlockHardwareWallets:oe(e),chooseNetworkList:re(e),onboardingInitiator:Ae(e),isTonMnemonic:se(e)})),Re=Te(),F=i.get("from"),Ne=F===p.HARDWARE,C=F===p.BULK,{setValue:Se}=ge(),P=async(e,m)=>{try{r(he(!0)).then(async()=>{if(Re(),await r(fe()),e===p.CREATE){c.push({pathname:Q,search:`?type=${Y.INITIALIZE}`});return}let s=`${q}/${e}`,{keyringName:a="",walletName:o=""}=m||{},R=`${a}-${o}`;if(e===p.HARDWARE&&D()===v){globalThis.platform.openExtensionInPopup(`${s}?anim=1`);return}c.push({pathname:s,state:{walletName:R,anim:"1",next:N}})}).catch(console.log)}catch(s){console.error(s.message)}},O=t.default.useMemo(()=>{let{password:e,confirmPassword:m}=l;return!(e?.length>=de&&e===m)},[d,I,h,y,l]),ke=(0,L.useMemoizedFn)(async()=>{if(!(d||O)){b(!0),H();try{if(h){let o=await r(Z(l.password,h?.trim().toLowerCase().match(/\w+/gu)?.join(" ")||"",{isTonMnemonic:Ce}));P(p.SEED,o),r(ae())}if(I){let o=await r(j(l.password,x,I));P(p.KEY,o),r(ne())}if(C){Se(l.password),c.push(J);return}let{cipherText:e,privateKey:m,mpcId:s,userInfo:a}=ye;if(e&&m&&s){let o=await r(G(l.password,{cipherText:e,privateKey:m},{mpcId:s,userInfo:a},!0));P(p.MPC,o),r(le())}if(!W(y)){await $().setPassword(l.password);let o=await r(Ee(y));P(p.HARDWARE,o),r(ie())}if(!h&&!I&&!(e&&m&&s)&&W(y)){let o=await r(z(l.password));P(p.CREATE,o)}}catch(e){e.message===V&&K.error(n("wallet_home_toast_network_error"))}finally{b(!1)}}},[O,l,h,I,x]);(0,t.useEffect)(()=>{if(C){let e=document.querySelector("#app");e&&(e.classList.remove("fullscreen"),e.classList.add("popup"))}return()=>{if(C){let e=document.querySelector("#app");e&&(e.classList.remove("popup"),e.classList.add("fullscreen"))}}},[]);let Le=C?{position:"absolute",bottom:0,left:0}:{};return t.default.createElement(_e,{title:n("wallet_signup_maintitle_set_password"),desc:n(Ne?"wallet_extension_signup_subtitle_set_password_hardware":"wallet_extension_subtitle_password_unlock")},({formClass:e,formErrorClass:m,itemClass:s})=>t.default.createElement(g,{form:u,size:T.SIZE.lg,validateTrigger:["onChange"],className:e,errorClassName:m,onValuesChange:(a,o)=>{be(o)}},t.default.createElement(g.Item,{name:"password",style:{marginBottom:0},className:s,label:n("wallet_set_password_subtitle_password")},t.default.createElement(A.Password,{autoFocus:!0,autoComplete:"off",inputClassName:M.passwordInput,size:A.SIZE.xl,placeholder:n("wallet_settings_reset_passord_placeholder_input_desc")})),t.default.createElement(g.Item,{noStyle:!0,shouldUpdate:(a,o)=>a.password!==o.password},({getFieldValue:a})=>{let o=a("password");return t.default.createElement(ue,{password:o})}),t.default.createElement(g.Item,{name:"confirmPassword",style:{flex:1,marginTop:"32px"},dependencies:["password"],className:s,rules:[({getFieldValue:a})=>({validator:(o,R)=>{let Oe=a("password");return R&&Oe!==R?Promise.reject(n("wallet_set_password_errortip_password_not_match")):Promise.resolve()}})],label:n("wallet_set_password_subtitle_confirm_password")},t.default.createElement(A.Password,{autoComplete:"off",inputClassName:M.passwordInput,size:A.SIZE.xl,placeholder:n("wallet_settings_reset_passord_placeholder_input_desc")})),t.default.createElement(ce.FooterActions,{renderNative:!0,affixStyle:Le,buttonGroup:[{loading:d,disabled:O,block:!0,type:T.TYPE.highlight,category:T.CATEGORY.fill,size:T.SIZE.lg,btnText:n("wallet_set_password_btn_confirm"),onClick:ke}]})))};export{To as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=CreatePassword-ZHTLAMS6.js.map
