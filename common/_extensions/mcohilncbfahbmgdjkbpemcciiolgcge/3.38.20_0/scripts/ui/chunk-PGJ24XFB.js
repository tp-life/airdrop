import{a as Dt}from"./chunk-OZVA7WG5.js";import{a as O}from"./chunk-UVEUQXM6.js";import{b as Bt}from"./chunk-ZM5QX5NG.js";import{a as kt,b as Wt}from"./chunk-TTRHX25W.js";import{a as bt}from"./chunk-ZORPRUU7.js";import{a as wt,b as St,c as ht,d as It,e as Ft,f as At,h as Pt,i as Ct}from"./chunk-BGIT66CC.js";import{a as Nt}from"./chunk-EMVP43OQ.js";import{a as Et}from"./chunk-TEHSOGCP.js";import{a as D}from"./chunk-4U65LWXX.js";import{a as k}from"./chunk-WMQSMBLA.js";import{b as gt}from"./chunk-3RJOXTRR.js";import{j as Q,k as xt,l as Tt,m as yt}from"./chunk-NNO7KFUF.js";import{d as _t}from"./chunk-4NCQWC2K.js";import{a as pe}from"./chunk-GTKGSYH4.js";import{q as x}from"./chunk-GBQG32PI.js";import{a as de}from"./chunk-Q6XXIWBJ.js";import{o as ue}from"./chunk-A3FIPWG3.js";import{Y as pt}from"./chunk-NTISK7TT.js";import{_ as F,k as ut}from"./chunk-CU7RFE6B.js";import{e as ft}from"./chunk-DHNKVM4B.js";import{c as M}from"./chunk-TU7CE5HJ.js";import{Ba as it,Jb as ct,Ob as U,Pb as lt,Ya as ce,fc as me,tb as K,wb as le}from"./chunk-YILNSICT.js";import{A as I,G as dt,N as z,c as v}from"./chunk-L4N7WJIQ.js";import{K as j,ka as at,pa as st}from"./chunk-LBCQTFOD.js";import{N as q,w as f}from"./chunk-V63HWKAL.js";import{A as mt}from"./chunk-2EJYCNYZ.js";import{a as C}from"./chunk-B75PPTYD.js";import{f as b,m as r,o as n}from"./chunk-UGZFXKPB.js";r();n();var m=b(C());q();r();n();var _=b(C()),Gt=b(ue()),Lt=b(de());q();r();n();var Y={tabContent:"_tabContent_klbwj_1",data:"_data_klbwj_4",abi:"_abi_klbwj_7"};var fe=t=>{let{data:e,copyable:a,tooltipZIndex:i,kysRet:d}=t,u=d?.intention?.contract?.[0],s=u?.methodName,l=u?.methodParameter,p=(0,_.useMemo)(()=>s&&l?JSON.stringify({[f("wallet_extension_transaction_tab_func")]:s,[f("wallet_extension_transaction_tab_params")]:l},null,2):"",[s,l]),o=(0,Gt.useMemoizedFn)(c=>{(0,Lt.default)(c),dt.success({title:f("wallet_receive_toast_address_copied")})},[e]);return _.default.createElement(O,{data:e,copyable:a,tooltipZIndex:i,title:f("wallet_extension_transaction_tab_advanced")},_.default.createElement(z.Underline,{size:mt.xs,noLine:!0,noPadding:!0,paneSpacing:24},_.default.createElement(z.TabPane,{tab:f("wallet_dapp_connection_subtitle_data_label"),id:"wallet_dapp_connection_subtitle_data_label"},_.default.createElement(M.Box,{className:Y.tabContent},_.default.createElement(I,{graspBaseDom:!0,title:f("wallet_receive_btn_copy_address"),type:I.TYPES.neutral,trigger:I.TRIGGER_TYPES.hover,zIndex:i},_.default.createElement(x.Text,{forceWrap:!0,onClick:()=>{o(e)},size:x.SIZE.sm,className:Y.data},e)))),p?_.default.createElement(z.TabPane,{tab:f("wallet_extension_transaction_tab_abi"),id:"wallet_extension_transaction_tab_abi"},_.default.createElement(M.Box,{className:Y.tabContent,onClick:()=>{o(p)}},_.default.createElement(I,{noWrapper:!0,graspBaseDom:!0,title:f("wallet_receive_btn_copy_address"),type:I.TYPES.neutral,trigger:I.TRIGGER_TYPES.hover,zIndex:i},_.default.createElement("pre",{className:Y.abi},p)))):null))},Mt=fe;le();r();n();var Z=b(C());var _e=({message:t,bordered:e=!1})=>Z.default.createElement(k,{bordered:e},Z.default.createElement(O,null,Z.default.createElement(Dt,{message:t,noPadding:!0}))),Yt=_e;r();n();st();q();var w=b(C());r();n();var N={root:"_root_ap48w_1",title:"_title_ap48w_1",detail:"_detail_ap48w_4",detailText:"_detailText_ap48w_7"};var xe=({permission:t})=>{let e=(0,w.useMemo)(()=>{let a=[];try{t.forEach(({after:i})=>{i.detail.forEach(({authGrous:d})=>{d.forEach(u=>{a.push(u.address)})})})}catch{}return at(a)},[t]);return e.length?w.default.createElement(k,{className:N.root},w.default.createElement(gt,{titleType:x.TYPE.danger,title:w.default.createElement(x.Text,{size:x.SIZE.xs,className:N.title},f("wallet_extension_tronsettings_title_authorize_address"))},e.map((a,i)=>w.default.createElement(M.Box,{className:N.detail},w.default.createElement(x.Text,{size:x.SIZE.sm,className:N.detailText,type:x.TYPE.secondary},f("wallet_extension_tronsettings_subtitle_addressnum",{num:i+1})),w.default.createElement(x.Text,{forceWrap:!0,size:x.SIZE.sm,className:N.detailText},a))))):null},Vt=xe;r();n();st();r();n();r();n();var W=b(C());ce();async function Te(t){let e={fromAddr:t.address,scenario:ut.SCENARIO_INTERACTION,inputData:t.inputData,toAddr:t.toAddr,dataLength:t.inputData.length};t.value&&(e.value=t.value);let{info:{fee:a}}=await pt({coinId:it,address:t.address},e);return a}var vt=(t={},e=!1)=>{let[a,i]=(0,W.useState)("0"),[d,u]=(0,W.useState)(!0),[s,l]=(0,W.useState)(!1);return(0,W.useEffect)(()=>{(async()=>{try{let o=await Te(t);o&&i(o),l(!1)}catch{l(!0)}finally{u(!1)}})()},[t.inputData,t.toAddr,t.address,t.coinId]),e?{error:s,trxFee:a,loading:d}:a};me();r();n();var X=b(pe()),ye=t=>{let e=t.params.transaction.raw_data||{contract:[{parameter:{value:{contract_address:""}}}]},a=t?.params?.transaction?.raw_data_hex||"",{data:i="",amount:d=0,to_address:u,contract_address:s,call_value:l=0}=e.contract[0].parameter.value,p=e.contract[0].type,o=l||d,c=s,T=s||u;try{c=X.default.address.fromHex(c),T=X.default.address.fromHex(T)}catch(h){console.log(h)}return{data:i,callValue:l,finalAmount:o,contractAddress:c,finalAddress:T,tronHexData:a,txType:p}},B=ye;var ge=({coinId:t,unapproved:e,verifyGasLimitRet:a})=>{let{data:i,callValue:d,finalAmount:u,contractAddress:s}=B(e),l=D(e),{loading:p,trxFee:o=0,error:c}=vt({coinId:t,address:l.address,inputData:i,toAddr:s,value:u},!0),{isOffline:T=!1}=e.params,h=Et(t,e.walletId)||{},{coinAmountInt:g}=h,A=T||j(g)||U(g,o)&&!xt(a),P=!0;return lt(d,0)||(P=j(g)||U(ct(g,o),d)),{loading:p,networkFee:o,networkFeeProps:{coinId:t,loading:p,estimateFailed:c,networkFee:p?void 0:o},isSufficientGas:A,estimateFailed:c,isSufficientBalance:P,coinWithBalance:h}},zt=ge;r();n();var S=b(C());var Ee=({unapproved:t})=>{let e=yt(),[a,i]=(0,S.useState)(!0),{host:d}=Nt(t),u=D(t),[s,l]=(0,S.useState)({}),{data:p,finalAmount:o,finalAddress:c,tronHexData:T}=B(t),h=(0,S.useCallback)(async G=>{let{coinId:E,chainId:H}=G,L=await e({coinId:E,checkTypes:[F.VERIFY_GAS_LIMIT,F.TRON_PERMISSTION,F.KYS],amount:o,from:u.address,to:c,txType:3,domain:d,tokenAddress:c,inputData:p,chainId:H,additionalData:{tronHexData:T}});l(L),i(!1)},[o,c,p,d,e,u.address,T]),g=(0,S.useMemo)(()=>s[F.VERIFY_GAS_LIMIT]||{},[s]),A=(0,S.useMemo)(()=>s[F.TRON_PERMISSTION]||{},[s]);return{kysRet:(0,S.useMemo)(()=>({loading:a,...s[F.KYS]||{}}),[a,s]),loading:a,preExecute:h,setLoading:i,preExecuteRet:s,verifyGasLimitRet:g,tronPermisstionRet:A}},Ot=Ee;var be=(0,m.memo)(({unapproved:t,onCancel:e,onConfirm:a,backable:i=!1,onBack:d,asPage:u})=>{let{extraData:s,isOffline:l=!1,extParams:p}=t.params||{},o=_t(K)||{},c=o?.coinId||K,{contractAddress:T,txType:h,data:g}=B(t),{initialType:A}=D(t),P=p?.shouldSend,G=Ot({unapproved:t,coinId:c,baseCoin:o}),{kysRet:E,preExecute:H,verifyGasLimitRet:L,tronPermisstionRet:R}=G;(0,m.useEffect)(()=>{o?.coinId&&H(o)},[o?.coinId]);let{networkFee:V,networkFeeProps:Zt,isSufficientGas:$,estimateFailed:tt,isSufficientBalance:et,loading:Ht,coinWithBalance:ot}=zt({coinId:c,unapproved:t,verifyGasLimitRet:L}),{isBalanceLoadError:Rt,coinAmount:Jt}=ot,jt=wt({initialType:A}),rt=h==="TriggerSmartContract"&&!T,qt=()=>rt?{type:v.TYPE.warn,message:f("wallet_extension_confirmation_toast_not_compatible")}:null,Kt=()=>Q(R)?{type:v.TYPE.error,message:R.msg}:null,{permissionMsg:J}=E,Ut=()=>J?{type:v.TYPE.error,message:J}:null,Qt=ht({isBalanceLoadError:Rt}),Xt=St({estimateFailed:tt}),$t=It({verifyGasLimitRet:L}),te=Ft({kysRet:E}),ee=At({kysRet:E}),oe=Pt({baseCoin:o,isSufficientGas:$,coinAmount:Jt}),re=Ct({isSufficientBalance:et}),ne=kt({},{custom:[qt,jt,Kt,Xt,$t,Qt,oe,re,Ut,te,ee]}),ae=(0,m.useMemo)(()=>l?{...s,serviceCharge:V}:P?{serviceCharge:V}:{},[s,l,P,V]),{buttonGroup:se,handleCancel:ie}=Bt({coinId:c,preExecuteRet:G,unapproved:t,feeLoading:Ht,onCancel:e,onConfirm:a,networkFee:V,estimateFailed:tt,isSufficientGas:$,isSufficientBalance:et,extParams:ae,needCheckMpc:!0,chainConfirmDisabled:rt||ft(A)||Q(R)||Tt(L),coinWithBalance:ot}),{permission:nt}=E;return bt({kysRet:E,handleCancel:ie,coinId:c}),m.default.createElement(Wt,{backable:i,onBack:d,asPage:u,kysRet:E,unapproved:t,tipMessage:ne,buttonGroup:se,networkFee:Zt,contractAddress:T,chainTxDetailSlot:m.default.createElement(m.default.Fragment,null,J?m.default.createElement(m.default.Fragment,null,m.default.createElement(Vt,{permission:nt}),m.default.createElement(Yt,{message:nt})):null,g?m.default.createElement(k,{bordered:!1},m.default.createElement(Mt,{data:g,kysRet:E,copyable:{hideDesc:!0},tooltipZIndex:101})):null)})}),or=be;export{Te as a,or as b};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-PGJ24XFB.js.map
